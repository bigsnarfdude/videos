Quiet? Yep. Okay. I'm Fredipa. I'm a postdoc with Professor Susan Holmes at Stanford University. I'm going to present about some approaches that we took to address three different challenges posted in the hackathon. It is important to characterize the tumor ecosystem. Characterize the tumor ecosystem to identify prognosis and treatment in breast cancer patients. There are several different ways to measure the protein expressions in cells. One of the methods is Cytof, where we can measure the protein expression for 14 or 14 different protein expressions on each cell. And the other method is MTOF image-based proteomics, where we can measure, in addition to the protein expression, we have the spatial locations of spatial information of cells. Tumor ecosystem is heterogeneous, as we heard from previous talks as well. So, and these So, and these single-cell proteomics, single-cell targeted proteomics methods measure different sets of proteins in each cell. So, in order to get a deepened understanding of the tumor immune ecosystem, we need to integrate multiple targeted proteomics methods. So, the first goal of our work was how we can integrate partially overlapping proteomics. Integrate partially overlapping proteomics data collected on different patients with a similar phenotype. See, here I am considering only the triple negative breast cancer patients. Let us look at the hackathon data that that has given to us. The gray color is the site of data where we have intensity is divided by 5 and axine transform for protein expression. For protein expression in each cell in different sets of patients. And the blue table represents the MTOF data. The cells are actually counts are divided by cell size, then arc sign transform later standardized across markers. And the rows are indicating the cells, and the patients are completely different from. Are completely different from what we have in the site of data. There was a concern on the transformation that when we get the summaries of M2F data, because they are the standardized across markers, we expected the range between negative 4.2 to 4.2, but there were markers with expression more than 4.2. So we developed the, we So we developed the, we extended the multi-assay experiment class in the bioconductor package to integrate partially overlapping proteomic data. So given the empt of and site of data of the tumor immune ecosystem, we also have the cell information and the clinical information from patients. And we have two arrays of one array represents the protein market expression, and the other array is what are the properties of the Is what are the properties of the proteins? We can import everything to the R and we can create a multi-assay experiment. We have written different methods to pre-process inverse transformation for topic modeling and remove units of measurement effect and extract spatial information actually missing the imputation method. We can also do dimensionality reduction and topic modeling, model assessments and some visualization. And some visualization. We need to remove a genus of measurement effect. In order to do that, we consider the matrix Z as the inverse transformation of a set of data because we know what the transformation have been done to the data. We just took the inverse transformation. And then we try to scale the empt of data to the range of site of data. Range of site of data. So, given the transform data of MTOF data, and it has the problem of the range of values like they are not robust. So, we thought that we can directly use the transform data to scale to the range of site of data. Then we round to integer the site of the blue color site of and the brown color mtof data for the topic market. Data for the topic modeling. We can match, there is another alternative that we can match the quantities of site of and MTOF data if we have a robust transformation. Then we included the protein marker expression on the V-scale data and the green color of the site of data and the orange color of the empty of data are included. M-toff data are imputed using the simple K-nearest neighbor averaging. So, next is why topic modeling. We try to address two different challenges using the topic modeling. That is, given the CITOF and the MTOF data, CITOF data does not have spatial information of cells, but MTOF data set has spatial information of cells. So, the goal number two is without including the spatial xy coordinate of site of data, how well can we predict the cell call location of site of the immune cells in the site of data? So, the toy example is if I have site of data here and the mtof data in the second picture on the right side. And if I found these cells are in the topic one and these cells are in the topic. Topic one and these cells are in the topic one, then I can just infer this spatial location to this immune cells in the site of data. And the third goal is how we can predict the special expression patterns of proteins that is not measured in MDOF data using the site of data. So, because we are going to fit a topic model, we can after fit. The topic model, we can after fitting the topic model, we can simulate from the topic model. So that will give us the protein expression of M2F data that is not measured actually. So let us see what is actually the topic modeling. Here we use the latent DDCLA allocation. Simple explanation is given the count data, we try to decompose the matrix. Decompose the matrix as protein topics matrix and topics cells matrices. So, here what we assume is cells are mixtures of topics and each topic has distribution of protein expressions. Because the posterior distribution is approximate, we use the Hamiltonian-Monte Carlo no-utern sampler algorithm written in the Algorithm written in the stand model. So, in order to do that, we wrote the stand model and then use the R interface for the stand model, R stand, to do the Bayesian inferences. Here I'm showing a results on subset of data. We chose one patient from Cytop and we consider the lycells immune panel. And we chose one patient from MTOF, but it is. MTOF, but it is ideal to use MTOF from the same patient. We kept 10% cells from MTOF for the test data to choose the number of topics based on the posterior lock likelihood. And we did the model assessment. How we did model assessment was we simulated data from the fitted model and we computed the median protein expression in the simulated data in thousands time and we have the Thousands time, and we have the observed data. We can compute the median protein expression. We look at the visualized to see whether they corroborate. So, for the example data, we choose the predictive lock likelihood in the test data to choose the number of topics. So, here we choose five as the number of topics. And here, I show you the estimated topic proportion of. Estimated topic proportion of selected 50 cells. We can see most of the site of immune cells. The topic one is dominated in most of the site of cells and other topics are dominated in mixtures of B cells, CD4 cells from the MTOF data. And here I'm showing the protein marker distribution in each topic. We can see the first topic that is The first topic that is dominated in most of the site of data, CD45 has the highest proportion. And we can also see clusters of proteins, they are expressed in different topics. And then we, as I discussed earlier, we did the model assessment where first asset is the observed data, median expression, protein expression of observed data. And I choose like 19 different simulated data, and we can see. Simulated data, and we can see they are similar. The observed data and simulated data are similar. And I infer the spatial co-location of cytoslles. And we can see the cyto cells are some of them are labeled in the spatial location using the topic modeling. And finally, we predicted a spatial pattern of proteins that is not measured in the MTOF data. We can see on the left. We can see on the left the UMAP with measured proteins. So, here we don't see clear clusters, but for the particular patient, when we add the predicted proteins, we can see the protein markers in the dark brown color. They are clustered and we have CD3 cells and macro pages like overlay on that cluster. And as Professor Body Miller discussed, we can see. Discuss, we can see the tumor and the immune cell interaction clearly if we can integrate the site of and the empty of data. In conclusion, we integrate partial overlapping proteomics data using existing Nauti SA experiment from the Bioconductor Packet. And we leverage topic modeling to infer spatial location of cells of cytof data, as well as predict the spatial protein. Predict the spatial protein expression of MTOF data that were not measured in the proteomics method. There were challenges, that is, there are a lot of challenges. Some of them are we need to have a robust transformation and we need to account for the units of measurements of difference. And it is ideal to have the same subjects measured in both platforms, and we have to handle with computational cost of topic modeling. Computational cost of topic modeling. We also had to identify the best range of topics, and I used the U-map on the observed data to find out what would be the possible range of topics. And in future, I would like to integrate the topic modeling to a spatial point pattern with multivariate marked processes so that we can have the spatial information and this hierarchical. Information and these hierarchical things integrated well. These are the selected references. And thank you, Professor Holmes and Chris, for giving me brainstorming sessions and make these slides presentable. Thank you. Thank you so much. Thank you. We may have time for one very quick question, but I also want to give Chris. But I also want to give Chris time to present his work. Ajwari, could you please expand on how the number of topics were selected? Oh, sure. I kept 10% of cells from MTOF data and I And I fit the model, the latent ditch allocation. Then we have the estimated parameters. So then we can compute the lock likelihood for each iteration. So there would be like thousands of 4,000 because I use four chains and 2,000 iterations with 1,000 warm-ups. I have 4,000. thousand warm-ups I have 4,000 simulator data so I computed the lock likelihood for the test data for each iteration and computed and then I compare with a different number of topics the predicted like posterior lock likelihood and then choose the number of topics. Cool. And you can talk more on the Slack channel about that. Chris, would you like to share your slides, please? your slides please