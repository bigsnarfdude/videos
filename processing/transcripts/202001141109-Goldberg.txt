I shall know. Yeah, so thanks, Omar. Okay, so I need is it recording already? So this is a bit of a digression from talking about ice dynamics. And also, this reviving thing might seem a bit ominous in the title, but hopefully it'll become clear in a few slides. Just want to say a couple of years ago I got a sabbatical. A couple of years ago, I got a sabbatical. I don't, in the UK, we don't get full-year sabbaticals just a semester, but for part of that semester, I went and stayed with Patrick in Texas. So, this kind of came out of the work that we were doing there. So, adjoint ocean models, there's been a lot of talk about adjoint ice models, but there's been a long history, longer than adjoint ice models, I think, in adjoint models of ocean circulation, sort of like being used to study ocean. Sort of like being used to study ocean dynamics. And in a nutshell, I know they've been talked about already, so I'll just say this quickly: they can be used to assess gradients of sort of model outputs to very high-dimensional inputs, and they can do so efficiently. So that's sort of like the main selling point. They've been used in the context of the MITGCM ocean model to look at sensitivity to wind forcing. To wind forcing and also sensitivity of sort of overturning circulation to bottom topography. And these uncertainties can then be used to sort of like characterize the impact of uncertainty in these input fields on sort of like the global ocean circulation or aspects of it. So this talk is about the impact of bathymetry on ice shelf cavities and the impact of bathymetry on ice shelf. On ice shelf circulation is quite important to study because, well, for two reasons. Bathymetry has a very strong impact on cavity circulation. We know this from observations and from modeling and from theory. And also, like every, almost every day, our knowledge of what bathymetry looks like under ice shelves is increasing with VED machine, with gravimetry, with more gravimetry. So it's kind of an important sort of like. So it's kind of an important sort of like thing to look at if we can. I just want to make a caveat. I'm in the sort of uncertainty quantification session. This talk is not what I would consider to be uncertainty quantification. That would involve like actual constraining of a posterior PDF. But adjoint sensitivities have been a prerequisite for uncertainty quantification in a number of ice and ocean systems, including the one that Noemi was just sort of discussing. And adjoint sensitivities of ice shelf melt. Sensitivities of ice shelf melt topimetry is something that's not really been studied before, and therefore it's the focus of this work. So, in terms of what's already been done, the MIT GCM ocean model adjoint has been used before to study sensitivities of melt rates to various input parameters. But the sensitivity of melt rates to bathymetry were not really considered. They haven't been yet. They haven't been yet. And I don't know the full reason as to why, but I can sort of guess. It's in part due to code structure. So it's been said already in this meeting that to facilitate algorithmic differentiation or automatic differentiation, whichever you believe AD stands for, the code that's going to be passed through the AD tool has to be designed with AD in mind. And for the most part, MIT GCM, its OSHA model, works. MITGCM, its OSHA model, was, but the bathymetry part of it was not. And this sort of like triggers those non-differentiabilities and kinks and discontinuities that Christian was asking about yesterday. So the implementate, this is a very simple cartoon of what bathymetry in MITTCM looks like. The bottom layer of cells is sort of seen as partial. It's only partially filled with fluid, depending on what the pathymetry is. What the pathymetry is, and then these sort of like openings between these cells are partial as well. And these depths, these like cell phases, their depths can depend non-differentiably on the thicknesses of these bottom cells. And also, there is a minimum threshold on ocean cell thickness. So, if you were trying to sort of like examine a perturbation and you perturb bathymetry such that you triggered this. Such that you triggered this threshold, then automatically that cell goes away and you get discontinuities. So bathymetry is rife with problems for adjoint sensitivities, and yet going to try to do it anyway. And to some extent, smoothing of these non-differentiability smoothing of these kinks can be done, and that's what was done by Martin and Patrick in their 2007 paper. But still, these adjoint sensitivities to bathymetry tend to be a lot more noisy. Tend to be a lot more noisy than other fields, such as wind stress. So that's just something that I think it might be because of discontinuities or might be because of raw physics, but in any way, that's sort of what we face. I should say it wasn't most, for the most part, we've just, for this study, used a lot of things that have been done before, but I do want to talk about things that were, you know, new. So, you know, just very briefly, time-stepping of the barotropic mode in the MYTGCM involves. mode in the MYTGCM involves solution of an elliptic PDE, which can be discretized as a linear system. And a linear system is not, solution of a linear system is not something you want to pass through an adjoint tool. You want to sort of like write the adjoint of it by hand. And the adjoint looks like this. Now, this part, which sort of propagates the sensitivities of the free surface back to various ocean parameters, that's already written in MITGCM. Already written in MITGCM, it's been in there for quite a while. This, passing the sensitivities of the free surface back onto the actual matrix, the matrix coefficients, which actually depend on the depth, which is now potentially changing, that's new. So that's something that was done new. The other thing, which is kind of a bigger deal, is that rather than using TAF, which is a commercial AD tool and costs a lot of money to use, we're using with the open source tool OpenAD. And for various reasons, these runs take quite a long time. And the ability to be able to restart not just a model, but an adjoint model is quite difficult. And so that's another thing that was sort of introduced for this work. So the ideal, for the rest of the time, hopefully I'm not used up too much, I want to talk about two experiments. One is more idealized in nature, basically based on the isomip experiment, which a lot of people I think know, in order to make sense of the bathymetric influence. Of bathymetric influence. And the next experiment is to apply this experiment to a realistic domain and sort of like place the results from the first experiment in context. The idealized domain that I used for this study is based on isomip. It's a very simplistic ice shelf cavity geometry. This is the cavity down here, filled with cold water, and you get sort of an overturning circulation due to what's called the ice pump mechanism. That was called the ice pump mechanism. Modified it just by sticking a ridge in here to make the pitimetry a bit more interesting. It doesn't look like it, but the ridge is actually sort of it goes all the way across. So I took the isomip setup, the isomip ridge setup, spun it up for a single, for one decade, just to sort of like not have to differentiate through any model spin-up, essentially. And this is what it looked like in terms of the overturning stream function. Looks very similar to what it would look like. Looks very similar to what it would look like if I just, if this ridge wasn't here, except for the fact that you can see the water on the downstream side of the ocean-facing side of the ridge, is a bit warmer than the water behind the ridge. And that's why, and so this warm water has to get over the ridge somehow in order to cause melting to happen. And it takes this sort of very circuitous path. So, this is a top-down view of the barotropic stream function. That's what the contours are. The shading is meant. The shading is melting. These negative values mean there is circulation that's going cyclonically or clockwise, but here there is anti-cyclonic circulation sort of going in this direction. So what's basically happening is cold water comes out here, mixes with warm water, has to make it over the ridge by traveling along it, and then there's a jet sort of going over the top of the ridge because water has difficult sort of like, it has difficulty moving across. Like, it has difficulty moving across topographic obstacles. It likes to sort of maintain its depth. So, you get a lot of these sort of jets going across rather than directly over. Then it gets inside the ridge and sort of like circulates around and dumps water out. So, this is the sort of like base state that I'm working with. The adjoint experiment that I did was to run this, take this spun-up model, run it for an additional two years, and at the end of those two years, calculate what we call in sort of adjoint parlance a cost function. Parlance, a cost function, which is just the area integral of melt rate, the total melt rate that's happening at the end of that two-year run. And then I use the adjoint to find the gradient of this cost function with respect to every sort of, with respect to bathymetry, which is defined cell by cell. So I can plot that gradient as a sort of map plane sort of image. That's what the shading is here. So this color bar. So, this color bar, the way to make sense of it is: here's the ridge, here's the open ocean, here's the sort of grounding line. Where it's positive, where it's red, that means raising the bed will increase melt. Where it's negative, where it's blue or negative, lowering the bed will increase the melt. So these sort of regions pop out. The open ocean regions, or the sort of like ocean-facing regions, where there's a big area where, if I raise the bed, that would increase the melt, lower the bed. But also on the ridge. But also on the ridge, we see there's a big part of the ridge that, if the ridge were sort of like not as high, that would lead to more melting, which I don't think is a surprise to anyone. What was a surprise to me is there's a big region that indicates where if we would, if the ridge were to be raised a little bit, that would also increase melt rate. It's sort of counterintuitive because it sounds like we're blocking out warm water and at the same time increasing melt. So I want to sort of make sense of these various So I want to sort of make sense of these various regions and what the sort of dynamic response is in terms of ocean circulation to perturbations in these regions. So first I examine these two, these ones are a bit simpler because the bed is already sort of flat in those regions. Sort of top-down view, these two areas where raising the bed should increase melt rate and lowering the bed should increase melt rate. I place sort of Gaussian shaped perturbations in those two regions separately. These are two separate simulations. These are two separate simulations. The one here induced, the shading shows, the shading is sort of like depth-integrated barotropic stream function. So it's sort of showing the sense of the circulation in response, the perturbed circulation in response to this bump. So this bump here gives this sort of large-scale perturbed cyclonic circulation. Isn't the deviation from your extreme function? Uh stream functions. Yeah, the stream function here is a is a perturbation stream function. This is the ridge, but this is the bed perturbation. So this gives a sort of cyclonic response, this gives an anticyclonic response. And in terms of, well, I'm not surprised to see this response because it's kind of similar to various sort of like papers on interactions of circulation with seamounts. You get this like anticyclonic bit on. Anti-cyclonic bit on the gyre on the upstream side, cyclonic on the downstream side. But what I think is happening here is that this circulation is sort of like acting along with the background circulation that's already going like that. So any perturbation which sort of like helps this large-scale gyre along would increase melt rate, and anything that acts against it would decrease melt rate. That's just my theory. I'm not exactly sure if that's the case, but that's all I could think. True of that's the case, but that's all I could think of. In terms of these regions over here, I did a similar experiment, and broadly the results look similar. This C mount over here gives this sort of like, well, anti-cyclonic, or cyclonic sort of over here, barely seeing anti-cyclonic over here. But the result is that, well, in this case, or in this case over here, the results are broadly the same, but what I think is happening. But what I think is happening is that either depressing this or raising this over here is taking that jet of warm water that travels across the seamount and sort of like pushing it further into the ice shelf cavity. Still, I'm not exactly sure that that's what's raising the melt rate, but that was all I could think of. Perhaps Adrian might have some more insight as to what's going on. So that's the sort of simplified experience. So that's the sort of simplified experiment. The takeaways are that in the presence of a ridge, lowering the center can increase the melt, but so can raising the ridge in the margin. Seaward of the ridge, bathymetry can control transport of warm water into the cavity. So if that, you know, if it's if bed s the bed sort of arranges in a way to sort of like either increase or decrease warm water into the cavity, well that's something that can control melt rate. Well, that's something that can control melt rate. And there's also very weak sensitivity within the cavity itself of melt rate to pathymetry. So, this sort of like a large part of the cavity is not influencing, pathymetry is not influencing melt rate at all. So, this second experiment, this realistic one, is I'm looking at two ice shells called Dotson and Crossin that are sort of like tucked away here in the Amundsen and Bayman, something that, which is in West Antarctica. Which is in West Antarctica. They don't get quite as much attention as Pine Island, but in recent years they're starting to keep, they've gotten more and more attention. And they're melting quite fast, and Smith Glaciers are treating quite fast. And so they're important to look at. And also I did a study on it before, which made this easier. So the bathymetry in this domain here is based on the precursor to that machine, a paper by Romain Milan. The far-field ocean conditions come from a regional run of Bayman. A regional run of the Amundsen. And the ocean is a bit modified from this study here in that it's coarser, the viscosities are higher to allow for longer time steps, and the forcing is steady. And all these changes here are basically because OpenAD takes a long time. So it was all about efficiency. But still, I was able to get some interesting results. So this is the sort of like the state that I want. The sort of like the state that I want to look at. This is the model melt rate that after the mod, once the model is spun up, because the forcing is steady, I can do that. This is the outflow from dots in ice shelf. So where it's red, there's water going out of the ice shelf cavity. Compares qualitatively well with observations. This is these are ADCP sort of observations at the mouth of Dotson. Basically this outflow has the right magnitude, but it's too wide. The right magnitude, but it's too wide. But on the whole, it doesn't look too bad. So I'm kind of reasonably happy with this sort of state that I'm trying to perturb and look at bathymetric sensitivities. So I proceed with the adjoint experiment, just like I did before. Run for a single year. Cost function is the total melt rate. And then I find some sensitivity dipotymetry. And this is what I come up with. It looks, the result is noisy. It looks, the result is noisy, much noisier than before, but it does show similar elements to that idealized simulation, particularly over here. So there's this, there's a ridge over here. It's not very pronounced, but there is one, at least in the Milan data set. There's this similar bimodal pattern where deepening in the center of the ridge increases melt. Raising on the sides of the ridge increases melt as well. The trough geometry also is controlling inflow. There's this deep trough. Inflow. There's this deep trough that's bringing warm circumpolar deep water into Dotson ice shelf. And this is sort of the left-hand side, from the point of view of water that's entering it, this is the left-hand side. And what this broad pattern is showing is if we steepen the side of the ridge, it will increase the melt rate by bringing more circumpolar deep water into the cavity. And overall, cross an ice shelf, under cross an ice shelf, the bathymetry is controlling the The bathymetry is controlling the overall melt rate much more than under Dotson Ice Shelf. Which is kind of important because there's been a lot of explorations under Cross and Ice Shelf with AUVs recently. Pierre Dutriot was sort of sending those underneath. And there was big changes. There were lots of uncertainties shown in this region here, but they might not project on the uncertainty of melt rates. So, sort of on that, I can do Sort of on that, I can do some analysis. I can take, well, this is the, you know, one of the applications of a first-order adjoint field. You can take the adjoint and sort of like take a perturbation, which could be, or a sort of uncertainty field, and see what the response is to that. In other words, I could take the difference between the Milan bathymetry and the Bedmachine bathymetry, which is quite larger than I expected under dots. And so I've got to talk to Matthew. And so I've got to talk to Matthew about that. I didn't expect that. I hope I did everything right. But if I take this difference and sort of like dot product it with the adjoint sensitivity, well then the total melt, the total sort of melt response to this perturbation is about 10% of the total melt weight, which is not small. But you can also see over here, well, from that image over here, this is basically This is basically this model, this difference times, you know, cell by cell times the adjoint sensitivity gives this over here, which shows that all of this uncertainty, or all of this difference, I guess, under dots and ice shelf, most of it's not contributing to this number here. Only this region and this region and this region over here. So there's a lot of uncertainty that sort of like gets hidden by adjoint by. Hidden by adjoint by this sensitivity process. Just one more thing. Am I okay on time? You haven't hit the 20-minute warning yet. Okay, okay. I'm almost done. So I also, it's also interesting that the reason we started this work was to see if we could take a coupled model and pass adjoint sensitivities from the ice model to the ocean model. Sort of like look at, for instance, adjoint sensitivity. For instance, adjoint sensitivity of grounded ice loss to some aspect of the ocean. So, in that 2019 paper, I also took an ice sheet adjoint model, and this is just one sort of result from that. I'm almost done. And these are the adjoint sensitivities of sort of mass loss from grounded mass loss from Smith Glacier to melt rate under Dotson and Crosson Ice Shelf. So, where it's An ice shelf. So, where it's red, that's where melt rate has a larger impact on grounded mass loss. So, that's what I found there. This is sort of similar to what, using different symbols, but similar to what Patrick was showing at some point yesterday. If I take the melt rate from my ocean model, sort of like dot product that with these adjoint sensitivities, and use that as an amended cost function, well, then you can convince yourself that the adjoint of this new. That the adjoint of this new cost function is actually, in some sense, in some very approximate way, the adjoint sensitivities of grounded ice loss to bathymetry of the ocean. And that's what it looks like. The interesting thing, or maybe not interesting thing, is, this has, never minding the magnitude, this has a very, very similar pattern to what I showed you before. So in essence, taking this, like this pattern, This, like, this path, like, well, I'm still trying to make sense of what this actually means, but if I had to say it, I would say bathymetry is not as strong a control on pattern of melt rate as it is on magnitude of melt rate. But clearly, melt rate patterns matter to ice ship, to buttressing. So it might be that the ocean is too much of a filter for the pathmetry to actually matter that much. Matter that much. Or perhaps. As I said, I still need to think what to say about it. But the conclusions are that the temperature can affect neural rates strongly, but only in certain locations, and sometimes counterintuitively. Adjoint depth sensitivity provides a means to identify those locations. I didn't say this before. But it provides a means to identify locations where bathymetry, bathymetric uncertainty is most impactful on melt rate. As in we can look at that map of sensitivity and say, this is where we need to. Sensitivity and say, this is where we need to know bathymetry better. But melt rate alone, for the same reason, is not likely to be able to constrain bathymetry. Basically, you could never constrain bathymetry by melt rates in this region over here, because you're just getting sort of no information about it. And so finally, I just want to say the use of this open source AD tool is promising and could potentially be applied to sort of like an on-site. To sort of like an online coupled isochia model, such as the one we've got in MITGCM. But performance improvements are needed. So I didn't show this before, but as I said, everything was about efficiency. I had to make this OSHA model very poor so it could run effectively. And that is because the time to run this adjoint simulation took 44 times as long as the Ford ocean simulation, which is just not tractable. Simulation, which is just not tractable. You compare with six to eight times for the TAF, the TAF software. It means that more work is needed to make this OpenAD model effective when applied to global ocean models or even regional ocean models. That's all. Thank you. Sorry for going over. Okay, we have six or seven or eight minutes for questions. Comments? Discussions? I'm just wondering about that. I'm just wondering about that 44 times. Are you figuring that's that iterations or is that just local cost of evaluating functions? So this is a source-to-source transform, source-to-source algorithmic differentiation. And maybe other types would work a similar way. But what this means, this is just a sort of diagram of the computation that's taking place. We've got the Ford model, and then multiple sort of like re-evaluations of various. Re-evaluations of various periods of the Ford model, plus the actual model as well. What I didn't say is that when you take algorithmic differentiation and apply it to a code, even the Ford model you get back is not the actual Ford model. It's modified. In fact, OpenAD, for OpenAD, this Ford model is taking two and a half times as long as the untouched Open MIT GCM. So part of that 44 is So part of that 44 is that 2.5 times factor. I think that's multiplying everything else. It's because every sort of like real variable, every double, every float becomes two floats, one containing the Ford information, one containing the adjoint information. So I think everything, there's more cache hits being caused. Everything is just bigger. Yeah. Maybe I can comment on this. I mean, the TAF is kind of an AD tool. Is kind of an AD tool, it's almost like driving a Formula One car, right? So it's highly tuned, and AD tools, because you're doing your differentiation across a non-linear trajectory, and you're doing it in reverse, right? And so basically you need to know the state around which you linearize for each point in time. And now there's two extreme cases. You can either store the entire trajectory along an int, which is impossible. You can't store Which is impossible. You can't store. Or you recompute everything, which again is impossible because at the last time you would now have to recompute up to t minus 1 in order to evaluate the derivative and then you do again to t minus 2, you rerun the model. So again, it's impossible. So there's this multi-level checkpointing scheme. TAF is basically follows the philosophy: we compute everything by default, and we go into the model, we actually tell. We actually tell, we help the tool to actually say what it needs to store, what it should not recompute. OpenAD is the other way around, it's memories, it saves everything by default. And OpenAD, it's kind of over-conservative in what it stores. And it does recompute certain things, but it's in some sense over conservative. There are certain assumptions there, which is kind of a simple deep assumption. Kind of a simple assumption. And my bottom line is that OpenAD is kind of much more recent and it hasn't been as widely applied. And these are things that I think can be figured out if the OpenAD developer at Argonne knows there is a user base and problems and there's funding, they can tune this, right? You need the people to work on this. You shouldn't be afraid by using the tool. By using the tool and saying, oh, this is expensive. It's expensive because it's not as mature as TAP. But by having people using it and telling the algorithm people, this is great. We need more of this, we'll help them to justify improving. And that's a good point. It's DOE software. So there are sort of concerted efforts in climate modeling in the DOE. It's just that this connection is not quite. That this connection is not quite unfortunate. I have unrelated questions, or if there are others related to this, maybe first. My question is: have you thought about trying different ocean temperature states? Because I could imagine the sensitivity to bathymetry would be quite different with, say, a case where the thermocline is quite a bit higher or lower than the. Presumably, you're talking about the realistic one. Yeah, the realistic case. But the idealized case, you know, the same kind of. You know, the same kind of processes could come into play if you had a different far-field forcing, like more like an isometh. Originally, I wanted this to be sort of run for several years and seasonally forcing, with seasonal forcing, maybe inter-annual variability, and then I quickly realized how slow it was going to be. Right, no, I I think that's infeasible, but you could do like one thermocline up here and one thermocline down here, say yeah, kind of what we see with different extreme years. But it's in a different extreme here. So this is assuming oh, the UNCO bathymetry, you're kind of assuming that it's fairly well known. Because presumably you could see at the bottom where there's a bridge. You're saying that changing the bathymetry. It can't find what's not there. Yeah. I think that's what you're that's the point you're getting at. And that's a important that's a sort of weakness of any linear sensitivity study. Sensitivity study. Yeah, and that's a good point. This is probably a dumb question, but for years I've been to these waste meetings, and Laurie Patton would tell me that tides control melting. And now I see all these simulations of MIT GCM that don't include tides. And I think that tides would have a pretty profound interaction with topography because you're going to get critical scattering, internal mixing of internal gravity. There was a study that showed like the latitude, there's a very strong latitudinal dependence. Like a very strong latitudinal dependence on how much of an impact tides do have. But you're right, we don't do that in any clever way. We just add a background term and decide what, and sort of like decide for ourselves what that background mixing term should be. And maybe it should be, we should have dies in there. It depends very much on what that ice shop you're looking at as well. So there, the piloting currents just very much. And the ice pump is very strong, right? Very strong, right? But Nico Jordan did a study in NEMO with tides, and it's not negligible even in this region, is what he concluded. I think MITGCM, a bit of a problem to show with barotropic tide. No? Does MITGCM struggle showing, like, getting the barotropic tide?