Today, let's talk about the analytical integration of vorticity equation and its application in the transverse field diagnosis. The original idea of this talk is from Professor Jiezhungwu, and yeah, I mainly talk on behalf of him. So this is the This is the main contents of this talk. So, as we know, in the alarming description, we have a spatial coordinate and we fix this coordinate and observe different particle modes and passes here. But in the Lag Langian description, we need to label every point, and so it should contain the richer information. So, the Lag Language. So, the Lagrangian description has been widely used in previous researchers, such as Laglangian evolution of the vorticity gradient tensor, and also in the study of flow separation and the Lagrangian coherent structures. And in this work, Professor Jiji Wu also using the Lagrangian method that's shown in this figure to Method that's shown in this figure to find the colour mechanism of the in the establishment of the air for your circulation. And they found some they traces different streak lines and particle different streak lines and particle traces and find some critical process in the establishment of the circulation. And the Lagrangian method is also used in the vortex. Method is also used in the vortex structure extraction by Young. He did several very amazing topics before. So let's start from the roticity transport equation. It's the governing equation of the transverse process. So in the roticity transport equation, on the right hand On the right-hand side, there are two terms. The first term is the stretching and tilting of vorticity under the surface deformation tensor. To understand the meaning of surface deformation tensor, we can imagine there is a material, surface element. It has a direction of the normal direction of n and the area of ds. So the time derivative of this material surface is itself dot product with the surface deformation tensor. When compared with the vorticity transport equation, they almost have the same form, but the difference is the sign of difference because when a material surface expands the vorticity. And the vorticity actually reduces because of the Hamhol theorem. So the second term is the viscous effect and the beroclinic effect, the non-conservative force comes from different processes. So if we assume the coefficient of the yeah, the coefficient of the The coefficient, the surface deformation tensor B and the inhomogeneous source term, the curve of the acceleration is already known. Then the vorticity equation becomes a first-order ordinary differential equation, and it permits analytical integration. And the mortis transform equation has another form, it's called the Has another form. It's called the Bertram equation. It observed the compressible effect by You and Professor Wu also derived the generalized potential vorticity equation by introducing a material quantity F. So if F is become is a Lagrangian Is the Laglangian coordinate. So, this generalized potential vorticity equation can be integrated easily. And so, by doing this, the truth styles fundamental vorticity formula can be obtained. So, it has two terms. One term is the initial vorticity modulated by the Modulated by the deformation tensor. And another term is the viscous effect. So inviscid flow, this equation reduces to the Cauchy's potential flow theorem, which says if there is initially no vorticity in the flow, there should be always no vorticity. But this But this formal solution contains the transformation between two spaces, one Lagrangian space and one Olarian space. It is linked by F. So we wish to transform this integration into a pure physics space. Like we can do just solve this by tracking one particle. So um So we first derived the evolution of the deformation gradient tensor F and its inverse. We first do the material derivative of the inverse of F and it have the same this form. And by using this identity, we obtained the We obtained the Gauman equations for the F, the deformation gradient tensor. And we also take into account the compressible effect and introduces the Jacobian of the transformation. And the Jacobian also satisfies the continuity equation. So by multiplying J with the F, we obtained a similar equation. Obtained a similar equation to the invested vorticity transport equation. So at last, since we tried to remove F in the solution, we adopted a Magnus expansion of the variable coefficient ordinary differential equation. So in the So, in the Magnus expansion, the solution of the variable coefficient, the matrix equation, can be expressed formally into this form. And the capital omega here is a serious expansion. And the first term is just the same as a constant coefficient. And the second term has a double integration. The double integration and the square bracket here is a commutator of the matrix. So, if the matrix is commutable, then the matrix multiplication is commutable. So, there is only the first term. But in the fluid mechanics, unfortunately, it is not commutable. So, this term is still need to be kept. And if we further increase the term at Increase the term at high-order terms, it becomes very formidable complex. But the benefit of the Magnus expansion is it expresses the Cauchy's formula only in physics space. So we only need to know B, we don't need other informations. And the Magnus expansion can also be extended to the viscous flow by taking. By taking into account the inhomogeneous term, and it formally can be written in this form. And the definition of the expansion and omega have the same formula. So the Magnus expansion of the viscose flow actually expresses the true stairs formula in physics space. So the main task of this work is Um is it's not to develop a predictive method to solve the equation actually, but we wish to use this uh integration formula to diagnose the flow to see how the vortex is generated, how it involves like how it breaks down. So, the main equation we use is these three: the first is the direct integration of the vorticity transport equation, and the second is Equation and the second is the fundamental vorticity formula first found by Trustell. And the last is the Magnus expansion. So to do this, we use the numerical method we use the spectral element method originally developed by Spencer Sherving and kind of. Um, Spencer Sherving and Kanye Dickens, and um, yeah, this code uh is um nectar plus plus. Um, so it uh uses the finite element mesh with the C0 continuous and within within each element it does the spectral polynomial type spectral expansion and the first four um 1D bases. 1D basis is shown here. They are modified Jacobian polynomials and have some sort of orthogonal property. And the 2D basis is the tensor product of the 1D base and it can be applied to both triangle elements and the quadrilateral elements. And in a span-wise direction, since there is no variation in our geometry, we use the fully. I use the Fourier Fourier expansion. And this is the example of 2D finite element grid. And this is the example of the span-wise Fourier plan. So we still started the incompressible flow and we solved the incompressible Navier-Stokes equation in the body frame. And the equation, this equation is this creation. Equation. This equation is this creativized using the velocity correction scheme. The body's motion can be determined from fluid force or it can also be prescribed. So here are three examples. The first one is the plunging and pitching motion of the airfoil. And the second one is we did before of the areas of the plunging. Of the plunging wing, and the third one is a self-propelled airfoil. And to achieve the log lounging tracking in parallel, we designed four parallel log lounging point tracking method in NECTA. So both the finite element mesh for fluid. Finite element mesh for fluid simulation and the particles are partitioned into different threads. And the core of this work is finding which element contains which log launching points. And to do this, we first search local mesh partitions to see if the point is stored locally. And if it's not found, we packed the data globally and do some global search. By doing this, Global search by doing this. So, not all since the particle doesn't move a very long distance. So, this method is very efficient. And by using this, we can achieve very many Lagrangian points tracking in NECTA. This is the example of 60,000 points. And the total time used for Lagrangian tracking is almost not. Is almost not 0.05 percentage of the total simulation time. This time is almost negligible. So, this is an example of the lag 90 point, and this is an example of the trajectories. So, we also tried two meeting points tracking on the fluid solver. The fluid is solved using 128 cores, but we tested different numbers. We test the different numbers of cores for point tracking, for example, one thread for point tracking two for eight, and we found the parallel efficiency is almost there is almost one. So we start the case, we start, yeah, we started the case of the leading engine vortex evolution of the Again, vortex evolution of the plunging air foil since this case is relatively mature. Yeah, it is one work we did recently. So in this work, we mainly studied the 3D transition of the flow path of the airfoil. And in this picture, we fixed the Reynolds number at 800, and the amplitude is also fixed. Amplitude is also fixed. We only vary the planting frequency. From low frequency to high frequency, the flow experiences a transition to 3D. And like, for example, at this point, as the minus file, point file with minus left side of point file, the flow is two-dimensional. It has a very high lift, but as the But at the right side of this point, the flow transits to 3D and is accompanied by a very low lift. It is this one. So we selected this case to study the vortex evolution, leading in vortex evolution using the previous formulas we derived. And in this case, the spanwise wavelength of the flow is. Wavelength of the flow is about two cord lengthies, so it is the long wave instability, and the period of the flow is twice of the plunging motion, so it is a period doubled mode. And the leading edge vortex undergoes a bending deformation and finally becomes a stream-wise vortices. This is an example of the particle tracking. We initially places Uh, we initially places the two medium particles in the center of the leading edge vortex and it evolves in this manner. So the evolution of the leading edge vortex can be divided into two stages. In the first stage, it is the formation of the almost 2D leading edge vortex. In the first stage, In the first stage, the airfoil moves downwards, so the boundary layer separates around the leading edge, the upper surface of the leading edge, and it rolls up into almost two-dimensional leading edge vortex. In the second stage, when the FOR moves from the lowest displacement and upward, this leading edge vertex starts bending and starts bending and finally becomes very streamwise. So we first study the formation of the leading Aegian vortex by doing a inverse tracking of the Laglangian particles, Laglangian points. So we first place the points at the center of the leading edging vertex and do the inverse track. And do the inverse tracking. So, this can, yeah, this can be achieved in numerical simulations. So, in this movie, the time goes inwards. So, the trajectory, so this streak, yeah, looks like streak line, but it's a different mean. Yeah, this line is the point that constitutes the leading edge vortex. A leading edge vortex. Yeah, and all the common thing of these points is they all pass the they all contact with the airfoil surface. So we select one particular point. It has the maximum vorticity as the initial time. So the Time. So the trajectory of this point is like this. It touches the leading edge and then it moves to left. And the vorticity also is dominated by the span-wise vorticity since the stream-wise and the vortical component are almost zero. And this particle initially has a zero vortex. zero vorticity and when it touches the leading edge it it is it obtains the relatively strong vorticity and this this plot shows the different components of the vorticity transport equation and this red line is the total time derivative and the blue line is the Line is the term caused by the vertex scratching and tilting, and the black line is the viscous effect. So in this line, the viscous effect dominates in the generational vorticity. This is consistent with the boundary vorticity explanation, which says the vorticity is created on the wall and diffused into fluid. And we tested the performance of these three equations, integration equations. The left top of the plot is the integration, a direct integration of the vertices transport equation. And since we did inverse tracking and the start of the integration is actually the right, yeah. Right, uh, yeah, the right age. So, um, the different terms have like the integration, uh, yeah, in the direct integration of the vorticity transport equation, the tilting and stretching term is almost zero, and the in the viscous effect dominates the vorticity generation. Generation and the summary of the right-hand side, yeah, initially equals the real vorticity, but it have some accumulated errors, maybe because of the time stamp is relatively large. The second picture shows the result of the fundamental vorticity formula of Formula of true styles formula. And the black line is the initial vorticity modulated by the deformation gradient tensor. And it is almost a constant value since the leading engine vortex in this stage is almost two-dimensional. And so, in this term, the integration of the viscous term also dominates. So, the left bottom of the figure shows the Magnus expansion using one term. Since in this generation stage, the surface deformation tensor is almost a constant. A constant, so just one term or Magnus expansion also agrees well with the actual result. And we found if we introduce the second term to the work, initially the performance seems good, but then the integration diverges fast, quickly. And after After studying the generation of the leading vortex, we studied the deformation of the leading anger vortex. This time, we placed the particles in the one quarter of the span-wise wavelength. So here have the very strong stream-wise vorticity. And the evolution of this particle is shown by this animation. It has very complex. Very complex deformations and rotations, and it is stretched into elongated into different shapes. And the coordinates of one particular particle also have a more complex trajectory. And the vorticity in this time, the vorticity initially, there is almost there is almost no span-wise, no stream-wise and vertical vorticity and initially the vorticity is dominated by the span-wise vorticity. But gradually the span-wise vorticity decreases and the other two terms grow indicates the vortex becomes stream-wise or directed to other directions. We also plotted the Plotted the Z components in the vorticity transport equation, and it also agrees with the previous observation. Initially, the viscos term dominates in the evolution, and after the dimensionless time, after dimensionless time of one, then the deformation term dominates. And we first studied the z components of the The Z components of the vorticity. And the left top of the plot shows the direct integration of the result. It shows initially the screen term is very small and it is dominated by the diffusion. And then the dominance term starts grow and the viscous term reaches the plateau. And the right And the right top of the figure shows similar have similar meaning. Initially, the black line is almost constant and then the blue line reaches a plateau. But the Magnus expansion in this time have a relatively poor behavior. So first, if we use the one term, Magnus expansion. The one-term magnetos expansion because it doesn't take into account the variation of the surface deformation tensor. So, when the surface deformation tensor becomes strong after time equals one, it departures, it departs from the real value. And if we introduce a correction to this term, it even fails and becomes generates a very strong oscillation. The x component of vorticity have a different behavior since the x component initially it is zero, and this term is generated by stretching because different directions have different stretching rates. So the vertex tilted into the x direction. So in the generation of x vorticity, the black line that is the stretching term dominates. Stretching term dominates, and the Cauchy's integration formula also agrees with the direct integration. But in this time, the Magnus expansion seems totally failed. Both the first order approximation and the second approximation doesn't capture, they only capture the initial condition because initially it doesn't have evolution. So, but just after the initial condition, it seems After the initial condition, it seems the behavior is not very good, behavior is totally bad. And we analyze the similar thing for the Y component. And the Y component have a very similar behavior with the X components. So, in summary, this work is still in progress, so we only have some summary of the current status. Of the current status is the Laglandian description potentially has the better way to describe the vortex deformation, the vortex evolution, and the Magnus expansion expressing the true staff formula in physics space, but it still suffers from the convergence issue. I think this is maybe because of the exponential terms. So in future work, we will try to refine this. Work, we will try to refine this thing.