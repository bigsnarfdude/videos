Our next talk by Hanath Mowi from Howard University and he'll be talking about optimal transport in the design of freeform optical surfaces. Thank you. Thank you very much. Thank you, the organizers, for giving me this opportunity to be part of this great workshop. So I'm going to So, I'm going to discuss the application of optimal transport in the design of lenses. So, the general outline for this talk will be, so first I'm going to say, okay, what is this design problem? Then the main theme of this talk is the design of lens between two anisotropic. Between two anisotropic media. So I will pose that problem. And then I'm not going to say much about optimal transport, of course, but I'm going to just mention the ingredients that I need for solving this particular problem. And then finally show you how the design problem can be solved by using the OPMA transport technique. So that will be the roadmap. The roadmap. So, this lens or mirror design problems, they are inverse problems where you will be given a source data. So that source data contains the domain, which could be a patch on the unit sphere, or it could be like a flat surface. And every point on that patch, or every point on that flat surface. Patch or every point on that flat surface corresponds to an incident ray. And then there is a density function g, which describes the intensity of light coming from that source. You will also be given target data. The target data also consists of a domain, which could be a set of directions, or it could be a surface which is going to be illuminated. And on that target domain, you are given a On that target domain, you are given a density function f, and that tells you how you want to illuminate that target. And the objective is, of course, to find a lens or a mirror that can transport the source to the target by using reflection or refraction in such a way that the distribution on the target is achieved. Okay, so this, as you can see, is. So, this, as you can see, is an inverse problem because you're given the source, you're given the target, and you would like to know what has happened in between, right? So it's not like you're given the lens or the mirror. So, it becomes a problem of designing a lens if it is a refraction problem, and it becomes a problem of designing a mirror when it is reflection-based. Okay, all right, so. All right. So to fix ideas, I'm going to start with something that we've known since grade school. So if you have two mediums of different optical densities, and if a ray of light is issued from the first medium, then as it hits an interface between the two medium, that ray, as you know, bends in some way, and that's governed by the snail's law. Governed by the Snell's law, which tells us that the material properties N1 over N2 is equal to the way the bending happens, sine theta2 over sine theta1. But really, the main thing I want to say here is if the incident ray coming out of the medium line is the unit vector x and this, yeah, the unit vector. Yeah, the unit vector x, and the point of incidence is this point where the normal to the interface is the unit vector nu. And if m is the refracted ray, then this vector, this refraction law can be written in vector form like that. And I just wanted to define this map, which is also known as the ray tracing map. And what it does is it tells you. And what it does is it tells you for every incident ray, if you know the interface between the two, what would happen to it? And that would be this form. Okay, so it tells you, if you give me the incident ray and the interface, then I can give you what would happen to it, which is the M. So just keeping an eye on this piece of R, which is the ray tracing map. Map. So, with that in mind, if for example, I consider the following setup where you have a point source of light here, which shines through this aperture omega from a medium one. And if your target set consists of finitely many directions, so I'm considering a semi-discrete refractor problem, or it could also be a It could also be a finitely many set of points where in each direction you have an intensity which is prescribed by F1, F2, and F3. So I'm saying that the target intensity is given by a linear combination of direct deltas here. Then it happens that the solution to the problem of sending this source to this target, which means the problem of finding this interface. problem of finding this interface, which sends omega into omega star in such a way that the prescribed intensity on the target, which is this right-hand side, is exactly equal to the amount which is sent into that target, which is the left-hand side, are equal. It happens that this solution is made of snippets of surfaces. So these snippets of surfaces, so if you see the whole refractor, So, if you see the whole diffractor, which is this purple thing, then you can see that those surfaces, that surface is not symmetric. And that is where the name freeform comes from. Okay, so this application, this beam reshaping problems have several applications in medical devices, in the design of solar panels, and this one is. And this one is something very recent. If you are, for example, you are like me, and if you are suffering from both near-sightedness and far-sightedness at the same time, then the current, what you have is the following option. What you have is either you have a bifocal where there is a line on it, or there is progressive lenses where you don't have a line. But the problem with those progressive lenses is that if this is your lens, Is that if this is your lens, then this part and this part basically are useless parts because when you see when you just move your eye, you will go here and here and you're gonna see a blur. You have to see always front or down. You have to be like robot, like test or like that, right? So the intention is to widen this area, which is useful, right? So that is the current design. The current design or the current application of preform lenses. So, there are several applications in order to make your view wider when you use it in camera, when you can use it in automotive lights. There are several applications of these beam reshaping problems. So, here, like I said, I'm going to focus on the refractor problem in anisotropic media. Anisotropic media. And so this anisotropic media setup is going to be more complicated than the isotropic case. There are several things that will be challenging along the way. So one of the things that happens is that your ray, as it hits an interface, it will not just bend into one ray, but a splitting of the ray happens. So what happens is that So what happens is that if this is your interface, the ray as it hits here, it will split into two different rays. So controlling the amount of intensity which is distributed after refraction is one issue. Another issue is that the rays in anisotropic media, they are not perpendicular to the wavefronts. So that is also another. So, that is also another issue. So, in order to handle this, at least, I mean, of course, you can't try to model everything, but we tried to at least catch one of the behaviors that the rays are not perpendicular. To that end, we used two convex norms, N1 and N2, which are not Euclidean norms. not Euclidean norms. So any point, the radius coming out of the origin is not perpendicular to the unit spheres, which are defined by these two norms. Okay, not necessary. So after that, then the question becomes, okay, how do race bend in this setting? So even the snail's law that I've Even the snail's law that I showed you at the beginning also is obtained from this basic principle of propagation of rays, which is known as the Fermat's principle of shortest paths. So what it does, or what it says is that as a ray moves from one point to another point, it could be across an interface or it could be within even the same medium, it always takes the path which is the shortest. Shortest. So you use that principle and try to say, okay, so if you have a ray which is emanating from this medium, as it hits an interface here, what would happen or what's the behavior of the refracted ray? Then from that, it's possible to recover this Nails Low in anisotropic medium. And that formulation will be something like this one. Okay, so it's similar to what I showed you earlier. You earlier, but here you're going to have P1, P2, which correspond to the gradient of the norms. If it was an isotropic media, then the relation would have been something like this, x minus kappa m is parallel to the to nu, where of course nu is the unit normal, the unit vector perpendicular to this interface. Vector perpendicular to this interface. Okay, so you can see some similarity here, but there you have the gradients of the north. So once you know how the wave or how the ray refracts, so the next question is, okay, then set up the problem in anisotropic media. So the setup will be similar to what I showed you earlier. You will have a source pair. The source pair this time is going to be This time is going to be a domain, which is a patch on the unit sphere corresponding to the norm one. And we assume array is issued from the origin, and all this is in medium one. And you have an intensity of the source, which is given by this density function against the surface measure. And then you have a target pair, which is a set of directions again, corresponding to another patch on sigma 2, which is the unit sphere corresponding. Which is the unit sphere corresponding to the norm 2, and you have intensity also on the target set, which is given by rho 2. So you have this mass balance equation between the two saying that the intensity from the source matches the total intensity, match the total intensity of the target. And you have this some geometric conditions that you have to assume so that you can be sure that array X can be actually refracted into array M for X and M chosen. For X and M chosen from omega 1 and omega 2. So this is to say, if it was an isotropic case, there is a scenario where, okay, if you have a ray, so if you have a ray, I mean, if you have an interface between two media, one and two, then as any incident ray which hits here, say it bends away from the normal. Bends away from the normal, then, as you go lower, I mean, as you go further from this normal, if you come here, for example, then there will be a certain angle, which is known as a critical angle beyond which there will be no refraction. Everything will be reflected back to the first medium. And so, in order to avoid something like that, you have to assume some structure on omega 2, omega 1, and omega 2, which is given by that. By that, okay, all right. So, this is the then the question. The question is, of course, uh, all right, so you have this source pair, you have this target pair, and what you want to do is obtain an interface between the two medium, uh, media, medium one and medium two, so that any ray that hits the interface will be refracted into some direction in omega two as it crosses the interface. And of course, you want the total. Of course, you want the total amount of illumination which is prescribed already on your omega 2 will be exactly equal to the total amount which is sent in the direction. That's to say for any measurable set in omega 2, then you have this relationship, which means that the ray tracing map has to be a measure-preserving map. That's what you want to find. Okay, so there are So, there are several techniques. There are three standard ones. So, one of them is what's known as the Minkowski method to solve this problem, where you say, okay, you take omega 2, you split it into several subdomains, and then you say, and then you solve the semi-discrete problem and use some compactness argument and try to obtain a solution for it. That's one way. Another way of doing it is, of course, you use the Of doing it is, of course, you use the energy relations and then try to obtain this complicated PDE of Montjampier's type or generated Jacobian equation and try to solve that. And the third that I'm going to discuss here is the one where you use optimal transport. Okay. All right. So, but regardless of which one you choose, the first thing that you need to do is say, okay, if the target set happens to be exactly one. The target set happens to be exactly one direction, right? So, what is the special surface which sends everything to a single direction? Okay. So, the question here is, for example, in the case of the medium are both isotropic. So, what happens is if you take the inside of this, for example, filled out with medium one, the glass, and the outside with air, then what you're saying is if you have And what you're saying is: if you have a source of light here, what is a surface or an interface between them? So that any ray that hits the interface will be refracted into exactly one direction. So all these rays that you can see are parallel. So that is just one direction, right? So this is for isotropic, and it happens to be an ellipse in this case. And now, when it is anisotropic, what is that corresponding surface is the question, and that surface happens to be this one. Happens to be this one. And the idea is: I mean, if you think about this, and if you use some Euclidean norm instead of that, then this will be the radius will be something like this. So it's b over 1 minus kappa x dot m. So you can think of this like as cos theta or something. And then this you can see is the polar form of an ellipse if the kappa here is less than one. If the kappa here is less than one, or if it is greater than one, it is a hyperbola or something like that. So it has that kind of structure. So this surface has a uniform refraction property. And so if whatever your source domain is, if your target domain is exactly that, then this surface is a solution to the problem, right? Because first of all, okay, like I said, this surface will send everything to M1. Send everything to M1. So the fact that everything is sent into this direction is attained, but it's not always, it's not just about direction, right? We want to make sure the intensity question is answered. That means if you pick any set in omega two, then the total intensity which is prescribed on here must match the total intensity which is sent into that direction. Well, you have. That direction. Well, you have if you pick any set here, you have only two options: either it contains M1 or it does not. And if it contains M1, then this inverse of the ray tracing map will be either empty or omega 1, depending on whether E contains M1 or not. Since the mass balance condition is an assumption, then the two left and right-hand sides will be equal, regardless of what E you pick, and therefore, this is a solution. So, once you get that solution, like I said, we can use now one of those three techniques. In particular, here, I'm going to discuss the optimal transport method to solve this problem. So, I'm not going to say much, like I said, on optimal transport, only the things that I need. So, the dual problem to the counter-overbitch optimal transport problem between two measures, mu and nu. Mu and nu for a given cost function c, which is say continuous in this case, is given by that. And this problem has a maximizer of the form this type, a pair, where phi here is a c concave map, and phi c, which is the c transform of phi, is given by that. And if you define the C super differential of phi, which is already discussed in the earlier talk as well, to be this, then and if this happens to be single-valued, then this generates the solution for the Cantor of problem, which is it generates the optimal plan, and as well as, and as well, key is a measure preserving map from new. Measure preserving map from new to new. So, this is assuming that this is the single value. So, I did not mention any reference about these results, but these things are at this point standard facts of optimal transport discussions. So, if you want to delve into this, then you can use Filippo Santambrogio's book, which is my favorite book at this point. And also, I use the word dead, but this is not from ChatGPT. GPT. So I did not copy my talk from ChatGPT. That's all I'm saying. Okay, so okay, so this is the idea. And now that I have this and then I've also set up the problem, the next question is: okay, how do we use how do I use the refractor? How do I use this optimal transport? I use this optimal transport ingredient that I just mentioned in order to solve the refractor problem. Okay. So now we're setting up the refractor problem as an optimal transport problem. So by now you have guessed this. We need two sets. Those two sets correspond to omega one and omega. Correspond to omega 1 and omega 2, which are the patches on sigma 1 and sigma 2. This is the source domain, and that's the target domain. And corresponding to the two probability measures that we have in optimal transport problem, we have the two measures here, which are the intensity on the source given by row one, and the intensity on the target, which is given by row two, given by density functions G and F. Density functions P and F against the surface measure. And then, of course, you need a cost function here. So, the cost function is this logarithmic cost function, which is given by that. And then you ask, okay, so for these inputs for the optimal transport problem, right, this one, this one, and this one, the dual problem will have a solution. A solution, which will have a maximizer given by this pair, just as I mentioned earlier. And then, okay, so at this point now, the question is from this solution of the dual problem, how do I recover the solution for the refractor problem? That's the okay. So the intention is to write or Write or to define that interface between the two radially by this expression where rho is e to the power pi x, where phi is the potential that we obtained from the dual problem for the Kantarovich problem. So, my job after this is going to be to say, okay, this surface that I have obtained from the potential function is Potential function is actually a solution for the refractor problem. And so there are two things that I need to convince you. One is that this surface sends, so if any ray is issued from the origin and hits this surface S, then the refracted ray will end up in omega 2. That's one. The other thing I have to show you is, of course, that the ray tracing map, which is obtained by, or which is determined by this. By or which is determined by this S is actually measure preserving from row one to row, right? And if I do that, then my job is done. Okay, so the solution for the dual problem, as we remember, is a C concave phi, which is which, and from that C concavity result, you say, okay, you for, and if you fix X naught, You for and if you fix x naught, then you will obtain this relation. Well, you will first of obtain it in terms of phi here, but then you take e to the phi and you will get some relation in terms of rho. So, what this is telling you is the surface S here is for any given point x naught in omega 1, this surface is supported from outside by a surface whose radial function. A surface whose radial function is given by this. And this surface whose radial function is given by that, or defined in polar coordinates by that, is that special surface that I was talking earlier about. It is the surface which sends everything to the direction M0. So any ray which hits this surface from the origin is actually Is actually hitting that special ellipsoid kind of surface that I said earlier. So it means any ray which hits this surface S will be refracted into some direction in omega 2 because for each x naught in omega 1, my m0 is in omega 2 here. Okay, so this shows that the rating, the ray tracing map actually does its job. That means you pick an x from here, then the p sub s of x will be P sub s of x will be an element of or will be in omega 2, I should say. Okay. Okay, so that's the first part. Then the next part is, okay, how about the distribution of intensity? Is it actually created on omega 2? And then the answer is yes again. So the idea is: so the first thing is the C super differential that we defined again. Differential that we defined. Again, this comes from this C concavity result. We can show that this expression is exactly the same as that expression at a given point for almost every X or rho and almost every X. And then the other thing that we know is that from the fact that this surface S is supported by this surface, you can show. Surface, you can show that the S is Lipschitz. And using that fact, you can recover that and you will have that the T sub S is actually single valued. And the T sub S is single valued, and these two are equal almost everywhere. These two are equal almost everywhere. So that's single-valued almost everywhere again. So the two are equal. So this, okay. So again, this one is single-valued. These two are equal almost everywhere. And therefore, this one will be single-valued almost everywhere. But then when it is single-valued, as I mentioned earlier, as a consequence of the theory in optimal transport, what happens is that the measure, which is the Which is the map, which is the piece of S or this one, will be a measure-preserving one. So, if that is measure-preserving, that's exactly what I needed, right? To say the energy distribution on the target is created by this interfacing, right? So, this means that I showed you that this is the two conditions are actually achieved, which means that Achieved, which means that the surface S here is a solution to the refractor problem in between two anisotropic media. Okay. And that was I say it is my job, and that job is done. So I'm also done. Thank you very much. Thank you, Hano. We have time for a couple of questions. I think. So, this is for the far field problem. Can you handle a sort of near-field version of this? I would not think it is significantly difficult, but it is something in the process, yeah, that we can think about. Yes, instead of the PDE, yeah. Well, so you that now that you mentioned that, we So now that you mentioned that, we didn't even try much on assessing the regularity of this surface. Any other questions? Thank you for the really nice talk. I was just hoping if you could comment on the choice of the cost function. Yeah. You said, ah, that was the, yeah. What is the motivation? Yeah. Good question. I was thinking about it in the morning. Good question. I was thinking about it in the morning and I don't think I have an answer for you. But the thing is, one thing that you can tell at least is that the cost function is somehow looks like this surface. Right. So, and this surface is that special surface which gives you that special, or which has a uniform refraction property, I should say. Refraction property, I should say. I mean, at this point, that's the best I can say, but I don't know. Yeah, Wilfred, do you have another? Yes, this is the units here which are defined by norms. So you have a replacement of minus this square by the point because s squared, the number of square the number of square. Okay, yeah, thanks. I'll think about it. Yeah. P2 is there. That's just it. Yeah, in the isotopic case. Factored by some. Okay, thanks. Oh, uh, the same thing. So, this polar thought I saw from, I don't know if you know the TV, you know. So, she actually gave a talk about it. So, there's a direct thought. And I asked her what's the motivation for this part. They're like, I don't know. But then, yours is actually. I don't know. But then yours is actually kind of using this cost for an actual problem, so I think I just want.