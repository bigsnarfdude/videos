Trying to understand what shapes the overall fitness of SARS-CoV-2 at the host population level. So just so it's clear from the very good go, what we're interested in here is not the fitness of the virus within the host, but the fitness of the virus at the host population level in terms of the transmission potential of the virus to be transmitted from host to host. Transmitted from host to host. So, we, like a lot of other groups in the world, have been interested in whether particular genetic variants of SARS-CoV-2 can be transmitted at a higher rate. We've been particularly interested in, for example, the spike D614G mutation that has been given a lot of attention over the last few months. But we've also been interested in bigger questions about what factors or what features of the virus shapes its transmission potential. Shapes its transmission potential overall in the host population? For example, are there other genetic variants out there that might also play a role in shaping the virus's fitness? And what is the relative importance of these genetic factors versus extrinsic or non-genetic factors in shaping the overall fitness variation of the virus at the host population level? So, before I go on any farther, I'd just like to say that. Farther, I'd just like to say that this has been collaborative work with two really fantastic PhD students in my group, Lenora Kepler and Marco Havens-Portolas, who are both here in the audience, if you'd want to contact them. And so overall, what we'd like to be able to do is try and understand how many different, what we'll just call features, whether it's the genetic variants or the geographic location of a given viral lineage, shapes its overall fitness. And to do this, what we have. And to do this, what we have are: we use a fitness mapping function, which translates all these different features or maps them into the expected fitness of a lineage in our virophylogeny. And so for SARS-CoV-2, we're not trying to do anything fancy and we want to use simple models that we can actually understand, models that are interpretable. So we just use these simple linear models where each variance or each Each variance or each feature in our model, xi here, has a potential fitness impact, beta i, and the fitness effects are multiplicative on a linear scale, but on a log scale, we get this additive linear model. And we also allow for lineages to have sort of random fitness effects, lineage-specific random effects to take into account that there might be additional features shaping the fitness of these lineages that we're not directly accounting for in the model itself. So, our overall goal then is to learn what this fitness mapping function is from the viral phylogeny. And we can do this using phylodynamic birth and death models that allow us to compute the likelihood of the tree evolving as observed given the fitness of each lineage in the tree or given its respective birth and death rates, which here for a virus, we can think about the birth rates being roughly equivalent to the transmission rates of the virus between hosts. The virus between hosts. And so, if you're not familiar with these birth-death models, the idea is very simple. The basic idea is that more fit viral lineages will be transmitted more often from host to host and therefore branch more often in the viral phylogeny and leave behind more sample descendants. Whereas less fit lineages, like the ones shown here in cooler or blue colors, will be transmitted less often and therefore will bring. Less often, and therefore will branch less often and leave behind fewer sample descendants in the tree. So, just from the evolutionary dynamics or the branching structure of different lineages in the virophylogeny, we could already try and estimate what the fitness of these different lineages is from the tree alone. We take a slightly different approach, though. We don't try and directly estimate the fitness of each lineage in the tree. What we try and do is first reconstruct the features that might predict. The features that might predict fitness onto the phylogeny using ancestral state reconstruction. And then our goal is to try and find the fitness mapping function that maximizes the overall likelihood of the phylogeny given those reconstructed ancestral features. And so there's many different ways we could fit or train such a model. But in our case, what we've done so far to try and speed things up is we've implemented these models in the TensorFlow machine. Models in the TensorFlow machine learning API. And this allows us to use very efficient optimization algorithms, such as the stochastic gradient descent algorithms implemented in TensorFlow. And this allows us to basically do likelihood-based inference in a very fast, efficient way to fit the models and estimate all the parameters in our models using sort of the techniques of modern machine learning, but still doing likelihood-based statistical inference. So we sort of hope this is like the best. So, we sort of hope this is like the best of both worlds. So, overall, our workflow for SARS-CoV-2 is that we download all of our sequences from the GISAID database. In our last data grab, I think there was slightly over 22,000 whole SARS-CoV-V2 genomes that we downloaded. We reconstruct trees using RaxML, and then we date those trees to get time-calibrated trees with branch lengths in terms of real calendar time. And then, once we have those dated trees, And then, once we have those data trees, we reconstruct the ancestral states for each fitness-predicting feature in our model using PastML, which actually Olivier talked about in his talk this morning. Since we have to reconstruct ancestral states, often for hundreds of different traits on phylogenies that have tens of thousands of lineages, we found that PastML is really one of the only programs that allows us to do that efficiently. And so, what we're left with then are a bunch of different With then are a bunch of different ancestral states or ancestral features mapped onto a phylogeny. And we can translate then this into just one big binary data vector where for each lineage or each row in this matrix then the rower vector gives us a binary representation of all the traits that a given lineage has, all of its ancestral features. So we've started to fit such models to start To fit such models to SARS-CoV-2 phylogenies, before we even started to consider genetic variants, we first wanted to see how much sort of spatial and temporal variability there were in transmission rates. So we could take into account that background spatio-temporal variability, which might otherwise confound our estimates of the fitness effects of, say, particular genetic variants. And so we did some preliminary model comparisons. And we found that the sort of best fitting And we found that the sort of best fitting model from the ones that we considered are this model that allows the transmission rate of the virus to vary over both space and time, which is not too surprising. So the transmission rate can change over one month intervals, and then it can also change between different geographic regions in the United States, where the regions we're using correspond to the same regions that the US Department of Human Health and Services use. Services use. And so we can look at how our estimates or how transmission rates change over space and time in the United States based on our inferences from the phylogenetic trees alone. You can see that roughly what we estimate from the trees corresponds to what is known about the known spread of SARS-CoV-2 in the United States. In March, for example, we have lots of transmission occurring in New York, New Jersey. In New York, New Jersey, and New England, there's sort of this law over April and May, and then things start to heat up again in the summer, and there's a lot of transmission in June and July. So this is sort of a sanity check to show us that we can actually estimate how transmission is varying over space and time from the phylogeny alone. And so now that we know how these background rates of transmission are changing, we can control for these effects when we try and estimate the fitness effects of particular genetic variants. Genetic variants. And so the genetic variants we considered, we actually considered a number of different genetic variants, including structural variants like insertions and deletions in the virus. But the ones that I'll focus on today, because I think they're the most interesting, are these 52 amino acid variants that reached a frequency of at least a half a percent at some point in the US over the past nine months. And we can't necessarily estimate the fitness effects of each individual variant on its own because some of these variants only occur in the same genetic. Of these variants only occur in the same genetic background, in which case we have to estimate their fitness effects together of those linked variants together. And so, again, since this is a multiplicative fitness model, at least on the linear scale, neutral mutations will have a fitness effect of one, deleterious mutations will have a fitness effect less than one, and beneficial mutations will have a fitness effect greater than one. And you can see overall for the vast majority of these amino acid variants, their fitness. Amino acid variants, their fitness effects are very much centered around one, often with confidence intervals over overlapping one. So, as we might expect, it seems that most of these variants are neutral. Although there are quite a few that seem to have fitness benefits in the range of, say, 5 to 10 percent. And then there's this one really intriguing variant, the Q19H variant in NSP15, which is the viral endo-RNA ACE and plays an important role in. ACE and plays an important role in replication fidelity. So, this was a particularly interesting one to look at because when we estimated the fitness effect of this variance, we estimated that it had about a 35% fitness increase relative to the wild-type virus. Sorry, one second. But it almost immediately occurred to us that this was likely to just be sort of an artifact or an outlier. Because if we look at where this variance occurs in the viral phylogeny, it occurs just along. In the virophylogeny, it occurs just along this one lineage. It's a very, very rare variant spreading mainly in the upper Midwest. And though that rose quite rapidly in frequency in the middle of summer, it also rose rapidly in frequency as sort of sampling dropped off everywhere else. So we were very suspicious about this one. And we realized when we first saw these results that the only way that we'd ever really be able to sort of verify this is to just sort of wait until more sequence data came. Of wait until more sequence data came out and look at the fates of this variant as we progress later and later in the year. So, at the beginning of October, we did another big data grab from GISAID where we actually downloaded our full data set of 22,000 sequences and we ran the analysis based on even larger trees. And overall, what you can see is that for this bigger data set, our fitness estimates of these amino acid variants really seems to Acid variants really seem to stabilize with fitness estimates of most variants being really close to one, including for this Q19H NSP15 mutation, and that there is some beneficial mutations, but most of these beneficial mutations have fitness effects in the range of one or two percent. And so to address the elephant in the room, we can also look at our fitness estimates for the spike D614 G mutation. G mutation. For this variant as well, we estimated that the fitness effect was about 1%. And this seems to be very consistent across all the different models we fit using different data sets that at most we estimate about a 2% or 3% fitness benefit for the spike D614G mutation. So we're interested in reconciling this with the rapid spread of this variant. It seems like the direct effect of this variant is only about a 1 or 2% fitness increase. Or 2% fitness increase. Yet, this variant, which is linked to this other mutation in the viral RDRP, spread very rapidly throughout the world and throughout the United States. So we also wanted to look at whether or not this 614G variant occurred in, for example, geographic backgrounds or spatial locations that just by chance happen to have higher rates of transmission. And also, whether this particular gevariance happened to. This particular G variants happened to occur in genetic backgrounds that had higher on-average genetic fitness. So, to do this, what we can do is we can look at the fitness predicted by our model for each lineage that either has the D variance or the G variance. And then after removing or controlling for the effect of the variant itself, we can look at the average background fitness of those lineages. And what we find is that the G variant on average does seem to have higher background fitness. To have higher background fitness, but it's only about a 4% fitness increase over the D variants. And this seems to arise because the G variants occurred in lineages that have slightly higher spatial fitness in terms of they're in locations with higher transmission rates, and in genetic backgrounds that are just one or 2% higher in fitness in terms of their genetic background as well. So we didn't find any evidence for the G variants having substantial fitness. Substantial fitness benefits that could explain its rapid rise throughout the United States. And we're still sort of wondering why it spread so rapidly. But to get back to our bigger questions about what particular variants or what particular features explain most of the fitness variation in the SARS-CoV-2 population, and whether this is due to intrinsic features of the virus, such as genetic variants or extrinsic factors. Or extrinsic factors like differences in background mobility or climate. We can also use our phylodynamic approach to try and partition fitness variation in the viral phylogeny into its component parts. So we can use our fitness mapping function to project onto the virophylogeny the fitness of every lineage in the tree. And then if we look at all lineages in the tree at a particular time, At a particular time, we can try and decompose the fitness variation for those lineages into its component parts, into features due to, say, spatial or geographic factors versus genetic factors. And so, first, we looked at the overall contribution of just random effects. So, again, random effects are supposed to account for fitness variation that we didn't specifically include as features in our model, such as other background variants that we didn't include. Background variants that we didn't include in our model. And overall, we find that about in, say, mid-summer, about 50% of overall fitness variation can be explained by random effects. And we can turn this around and then say that then our model is actually doing a pretty good job in that we can account for about 50% of fitness variation overall just with this very simple additive linear model. And so we can also then look at how much. At how much spatial variation or geographic components of fitness contribute to overall fitness. And what we found here is that early on in the epidemic, most of the fitness variation is explained by geographic differences in the transmission rates across the United States, which I would argue sort of makes sense because early on there was very large-scale differences in how people responded to the epidemic and whether they modified their behavior or not. But over time, Their behavior or not. But over time, that spatial component of variance has declined in importance. And last, but not least, in terms of it's probably the most interesting, we can look at how the genetic component of fitness has changed over time as well. And what we find here is that early on in the epidemic, there was almost no fitness variation explained by genetic variation of population, which makes sense because it was almost a Make sense because it was almost a completely homogeneous viral population. But slowly over time, genetic variation starts to explain more and more fitness variation in the population. And that by, say, mid-summer, it seemed that genetic variants in the population could explain as much as 30% of the overall fitness variation in SARS-CoV-2 in the population. So, overall, I think what we found is that while no single genetic variant strongly determines Genetic variant strongly determines the fitness of SARS-CoV-2 at the population level. There are several variants with MOS fitness effects that sort of collectively explain a rather substantial fraction of overall fitness variation in the viral population. And what we expect is that these genetic variants are going to start to explain more and more variation in the fitness of the lineage over time as genetic diversity grows in the population as well. And so we like this phylodynamic. And so, we like this phylodynamic framework that we developed because, while it is simple, it allows us to not only estimate the fitness effects of individual variants or other features, but put those fitness effects into context of in terms of we can actually then partition overall fitness variation into its component parts. And so we can understand whether, for example, genetic variants or extrinsic factors like geographic effects drive most of the fitness variation we see. Of the fitness variation we see in SARS-CoV-2 populations. So, with that, thank you everybody for listening, and I'll take any questions if there's time. Thank you. So, I can read from the chat in order if that's helpful. There was a first question during the talk. Are you using an absolute metric for fitness or it's a fitness vis-à-vis the other circulating lineages? Yeah, so fitness here is defined in terms of the growth. Find in terms of the growth rate of the variants at the population level. And so, actually, what we're doing is we're considering fitness to be the relative transmission rates of the viruses versus other viruses. So I would guess be more standard in evolutionary theory or population genetics to look at fitness in terms of the growth rates. But here we're assuming the death rates or the removal rate of all the viruses in the population is. Viruses in the population is constant through time. And so we can really think about fitness as being the relative birth rate or transmission rates of the viruses in the population. And then the second question that came up was from Troy, what about the influence of host factors on fitness? For example, host age? We haven't tried to do that yet. And I guess the biggest reason we haven't is that we likely think that, you know, since We likely think that, you know, since SARS-CoV-2 is being transmitted between hosts relatively rapidly, that we wouldn't probably be able to reconstruct very accurately what type of host a given lineage is in, at least before the host that it was sampled in. But that would be interesting to look at. Maybe we could look at not particularly what host it was in, but different features of the host population, like whether viruses happen to be. Whether viruses happen to be in a slightly older or younger population. Looking at coarser scale host features like that might be possible, Troy. So there's a lot of many other great questions, but I'll delay them to the discussion. Yeah, and yeah, please come chat with us.