On today, traditional custodians, and also thank our wonderful organizers for bringing us here. I'd say the views on top of Saltfur Mountain yesterday were maybe not life-defining, but definitely one of those moments will hopefully stick around. Melissa, this is my most important slide. So, could you please give me a non-subtle warning at around 12 minutes and I'll rush through everything else. So, this is important for probably. So, this is important for probably three reasons. The first is the title. So, take from this title that I do spatial analysis with omics data. Come talk to me afterwards if you're interested. Also, on the left of this plot here, we've got a slide or an image of colorectal tissue stained with three colours, there's three proteins. And you can see here that there's cells that just have blue, and cells that have green, and cells that have both. You can see all of this. Have both. You can see all of this crazy structure. And I think this is just an important reminder that with just three markers, we can see a lot of complexity in tissues that are related to cells. And the third thing you can't see here, but we've been able to generate these images for like 80 or 90 years or something. And so single cell analysis is not new. We've been doing this for a long time. And I think that's important to contextualize sometime. Even though we feel like we're at the cutting edge, it's Like we're at the cutting edge, it's relative. And so, I guess, talking about the cutting edge, we have had this huge leap in progress in how we do image cells in the last maybe five or so years. And so there's been kind of two streams of technologies that have been developed, maybe not independently, but concurrently. And so, there's protein-based technologies where we can measure like 50 to 100 proteins on cells in. Proteins on cells in space. And then we've obviously spent a lot of time today talking about the RNA-based technologies. And so both of these technologies can be retrofit to measure both RNA and protein, but they're definitely in their own camps. So most of my exposure to spatial analysis has been with SISIF, IMC, and now Phenocycla. But then through Gene and Sheila, I've been exposed a little bit to the spatial transcriptomics, and so I'm obviously excited to hop on the train. Excited to hop on the train, I believe the phrase the little train used was. Here's just another image. We've got some head and neck cancer here, and now I've highlighted six colours. So we're not at the hundred, we're just at the six, but even just with six, doubling the number of colours, we've clearly dramatically increased the amount of complexity. And so I think when we're thinking about spatial data and spatial omics, we've really got to appreciate that what we eventually want to be consistent. That's what we eventually want to be conceptualizing is something that's actually very, very complex. And we shouldn't just be thinking about a couple of cell types or cell clusters and xy coordinates. Okay, next bit of context. So I'm very fortunate to be positioned in a very stimulating environment at the University of Sydney, and I've had the opportunity to contribute to lots of the development of lots of different analytical methods and the development of a lot of different R packages. Lot of different R packages. And all of these R packages, at least, can nearly be laid out in a structure of how you can get to analysing or getting information out of these high-dimensional spatial omics data sets. And so on the right here, we have some of our basic data processing, like our segmentation and our normalization. We've got some cell type clustering. We've got some methods for pulling out various spatial features and comparing various spatial features. And comparing various spatial features, like we've got the spatial localization or cell interaction, I believe we could just call it. We've got some cellular neighborhoods or spatial domains, and then right at the end we're looking at using all this information to classify patients with random forests buffer. And so today you heard Jean talk about BidCell, tomorrow you heard Ying Xing talk about SC Merge, and today I'm going to really skim quite closely. I'm going to really skim quite quickly over our spatial package, performing cell state analysis in a spatial context. Okay, so I use the word cell state. We had a great hour-long conversation about cell types. I don't want to go near that conversation. When I say cell state, I'm really using the word in a statistically pragmatic way, in the sense that with cell types, you can. With cell types, you can cluster and cluster and cluster, but when I think of cell states, I think of a very particular type of analysis. And it's a shame that Mark left, because Mark has this great diff sight package where he lays out some really interesting approaches and methods for doing cell state analysis in suspension technologies. And there's effectively two flavors. One, you do cell type clustering, and then once you've done your cell type clustering, you can calculate average marker expression within those cell types. Within those cell types and compare them between conditions. So that's really, really beneficial because you're able to kind of get this coarse clustering. And so it's really easy to interpret when you just say macrophage. And then you can look at as many markers as you want changing, and you still know that something's happening in a macrophage. The other approach, you just clusters to a really fine resolution, over clusters data, and then you can look to see if the proportion of those clusters. And then you can look to see if the proportion of those clusters is changing. So they're both ways of getting towards finding a resolution of phenotype of cells and knowing if they're doing something. When I say cell state, I'm really just talking about thinking about things just beyond a single clustering, but either finer resolution or additional information. And so that's in suspension. And so what I want to expose you to right now is how we can potentially start to shift those kinds of things To shift those kinds of analogies into a spatial context. And so the first way is to again think about average marker expression. I've got a little toy example here where I've got two different types of cells, square cells and circle cells. And what this diagram or toy thing is supposed to be showing you is that as square cells get closer to circle cells, or there's no causal thing here, right? When square cells are closer to circle cells, they Closer to circle cells, they seem to have a higher expression of a particular marker. And so, this is a really potentially easy thing to tackle analytically, at least if you think like I do. And so, a way you could do this is to simply, for each square cell, you calculate its nearest distance to a circle cell, you calculate the average expression of a particular marker, and you end up with a scatter plot, and then you do some sort of regression, whether it's a linear regression or you start. It's a linear regression, or you start fitting GAMs, or you start doing something complicated. And this is something that's actually done kind of in your Seaside package, Rafa, I guess, in a slightly different context. And it's something that we've actually tried. So one of the great things about Seaside is it does cell type deconvolution. The technologies that I'm working with, we don't need to deconvolute, arguably. We've got individual cells, nothing to deconvolute. But it turns out our segmentation is horrible. Turns out our segmentation is horrible. And so, what we end up finding when we do these types of analyses is that when T cells are near tumor cells, we see C D3 going up in tumor cells, so a marker of T cells. And so we know what's happening. There's just lateral spillover of these markers into tumor cells, and we just see that over and over and over again. And so, trying to filter stuff out is tough, and we've tried cell type deconvolution, and it hasn't gotten us anywhere, and I think it's because of the smaller. Anywhere, and I think it's because of the smaller marker space we're working in, where we've just got these 40 people ones. And recently, we've been thinking about doing cell state analysis in a slightly different way, where here we've got two cell types, cell type A and cell type B. And if I over-cluster cell type A, I can potentially break it into two states and maybe find something different. And here, I hope you can at least see that now we start to think about this in terms of like cell localization or cell interaction, as we'll call it. Or cell interaction, as we were talking about it before. So, what do I mean by cell localization? Well, I mean are two cells localized? Do they tend to be close to each other or do they tend to be far apart? Which again is quite simple and statistically we've got a lot of methods for testing this. So, we constructed a little R package, SPICER, which does this and it allows you to compare spatial localization between groups. Between groups. The lighting's horrible, but you can technically see that here everything's random, here different cell types clustered, and maybe you want to find these kinds of differences. And the machinery behind all of this is, again, machinery that's been around for a long time. So we analyze, or we've at least been analyzing our cells as points in space, simplifying things down to XY coordinates, analyzing things as point process models, where one summary of a point process model is something called. Of a point process model is something called the k-function. And the k-function is really, really simple. For each cell type A, you go through and you calculate the number of cell type B within a certain radius of it. And then a really cool, funky bit about it is that you scale this summation by the expected number of blue cells in the image, and that allows you to kind of compare across images when you've got different numbers of the cells. So the king has a hat. Is that supposed to be estimating something? Yeah, I'm a bad static. Yeah, I'm a bad statistician, yeah. So, what is it estimating? It's estimating this localization. I guess I've got little D's. Little D's, maybe I can use a hat there. Maybe? Bad statistician. Okay, so I want to take you back to this type of image and really emphasize that, or at least the k function, one of its properties. At least the k-function, one of its primary assumptions is that things that are randomly scattered are throughout an image. This is clearly very rarely true in true tissue. And so the k-function has a few nice twists where we've got something called the inhomogeneous k-function, which allows you to kind of start to model some of this structure. And this is what we end up using in our later methods and approaches. So, again, acknowledging that tissue can have structure. Acknowledging that tissue can have structure, and we do have ways of dealing with that structure, there's something else that took me a long while to kind of conceptualize. And that's something that really kind of starts to feel a little bit like a statistical design problem. So here I want to show you a really simple image. We've got some blue cells and red cells, and they're randomly spattered throughout my image. If I happen to look out a little bit further, now I can see that the two things are dispersed. Now, I can see that the two things are dispersed. They're separated from each other. No longer random, they're dispersed. If I zoom out even further, now I see they're actually localized down in the bottom right-hand corner of the image. And so depending on how I look at this image or depending how I sample my image, I could potentially end up with quite different conclusions and interpretations. And so we've been trying to think about this, and we kind of Trying to think about this, and we kind of believe that sometimes analyzing things in terms of cell states might be a way to kind of at least fix our interpretation of what's going on in a tissue. Where in this tissue, maybe we want to see if red cells are closer to blue cells once we acknowledge that pink cells, which are another state of that cell, kind of exists. And so, a really talented student, Fahan, has developed this method called contextual, which Contextual, which constructs cell hierarchies, calculates densities of where you expect particular cell types to exist, combines it all, and then comes up with these new things. Thank you. 30 seconds. Here is a perfect... How many? Three minutes. Three minutes. So here is a little toy example from a MIMBITOS data from multiple years ago. And so what's highlighted here in black. Highlighted here in black are immune cells, light gray are just tumor cells, and in red are p53 positive tumour cells. And so, depending on how you squint your eyes, if I was to look at this, I would potentially start to think that p53 positive tumour cells are localized with immune cells. I think they're kind of closer. That's what I look at it, that's what I see. But in reality, they're dispersed. They're highly dispersed. Because if you think about it like oil on water, they really don't meet. Oil on water, they really don't mix. Highly dispersed, but when you put them in the context of where tumor cells should be, they're probably closer. And so, this is the nice little toy example we have. If you just naively go and apply a k function, you end up finding that these two things are dispersed. Of course, if you put these p53 positive cells in the context of all tumour cells, you end up finding a particular radii that you look over where they're positively associated. Where they're positively associated. And so you can then go and take lots of different summarizations of your data and potentially use these to classify people. Here I've tried to perform some survival analysis and predict people with cell type proportions. I predict people with the L-function. And in this particular cohort, if you use contextual with either a predefined hierarchy or a data-driven one, it tests. Driven one, it seems to perform better in this particular case. So, to briefly summarize, I've talked about one method of doing cell state analysis. There are lots. I'm happy to talk to you about them. The method we've developed is called contextual and not conditional. And so that's a really subtle concept that I don't have time to really explain. But again, I would love to talk to you about how you interpret these models. And then repeatedly, no matter which kind of cell. Repeatedly, no matter which kind of cell state analysis approaches we choose, even the ones that I said were highly kind of confounded by this lateral spillover, they quite often end up performing really, really well for patient classification. So there's a lot of valuable information there, even if it's not necessarily biologically too important. And again, just to acknowledge everyone, this is primarily Farhan's work, and I'd like to acknowledge, again, the great environment that I have in C. Thank you. 