So, in fact, I'm starting from a hyperbolic PD, as usual, and when you want to approximate this, you have to make several choices. So, first, how do you approximate the computational domain? What choice of approximation space you make, what you do with the divergence, and in the end, what you do with time. And so, in practice, we do it most of the time with political. Most of the time with polygonal shape elements. Then you have many methods in choosing the approximation space, whether or not you want to take into a discontinuity of the solution or not. And the official motivation for this is local conservation. I will show it's not as simple. And then you can do a variational approximation of the divergence of the flux, and in many cases, Divergence of the flux, and in many cases, you will choose a method of line. And as I said, a common belief is that if you allow a global continuity of the solution, this is not good for local conservation and not good for discontinuities. And this is not really true. So this is really a master stasis example. So what you teach in master classes, sorry. So you start from your conservation equation. So you start from your conservation equation and of course the one I'm interested in is fluid mechanics. So the vector of conserved variable is mass, momentum, total energy. This is written in the Eulerian coordinates. And you are working on a domain of states where the density and the internal energy is positive. And then you have an additional relation about the entropy, which is given by the, in the simplest case, by the Gibbs identity. So T ds equal d E. identity so T d s equal d e plus minus p minus p over rho squared zero and then when you multiply the pde with this using the information contained in the gibbs equation you get either the transport of the specific entropy and or a conservation law for the mathematical entropy and of course this is true only if the swallow is moves and this is a very general And this is a very general statement, as I recall later, below. And this mathematical entropy has a nice feature to be a convex function of u. And then let's try. So you take Berger equation. So Berger equation is not only the simplest non-linear hyperbolic problem you can consider, but it's also related to the fluid mechanics. Because if you take the Euler equation with gamma equals 3, this is essentially. Equals three, this is essentially the non-linear Riemann invariant, follows the Berger equation. So you take the classical initial condition, as you know, after some time the solution becomes discontinuous. And this makes question the meaning of the derivative. And the answer has been given, at least in the math community, by Peter Lax, but in the mechanics one, it was known much before. So you take your PDE, you multiply by test function. You multiply by test functions, which are smooth enough. You multiply, apply divergence theorem, and then you end up with the second line, this relation, which accommodates the initial condition and the solution if it exists. And for the entropy, you do exactly the same, but you take positive test functions. And then, in fact, because in fact the entropy. Because in fact the entropic equality is not an the entropy PD is not an equation but an inequality. So in fact you get this negative of zero here which accommodates the fact that you are dissipating information in discontinuities when they are created. And then how do you translate this into a numerical setting? So again with the barrier equation you have two ways to write it either a conservative form Either a conservative form or the no-conservative form. So I'm going to take, assuming that U is strictly positive. And the first idea, you take a mesh, and then you approximate, you say that UIN is the approximation of U at time Tn and at location X sub i. You consider the non-conservative form and then you update by the following formula where implicitly you have assumed that U is positive and this is a perfectly stable. And this is a perfectly stable scheme, it's easy to prove. And the second idea, you say that the UI is not the point value, but the average value, which is compatible with a conservative formulation. And then you get this flux formulation, where again, now you assume that U is positive. So the natural flux is the only flux is the uplined one here. And then you take your computer, you put twenty or forty thousand points. 20 or 40,000 points, and you see what happens. So, what you get is a non-conservative equation, is the one which the solution is the one with a dotted line, and the conservative one is the one with the circle symbol, and the exact one is the one with a plane line. And of course, as expected, I have of course. The conservative system, for reasons I will not explain yet. I will not explain yet, will convert to the right solution, but not the other one. And this distance is really a finite distance. It's not 10 mesh points, but it's a finite length. And the explanation or part of it is given by the Alexandrov theorem, which has been published 61 years ago. Yes. And as you know, you take a mesh. What is important is that you have this formulation of the flux into a. This formulation of the flux into in of the scheme in terms of flux, where the flux are functions which are continuous and episode continuous of their arguments, they are consistent. You assume the stability of the scheme in L infinity and some L P norm, so P equal to here, for example, and then that there is a subsequence which converts to in L2. And this limit is a weak solution, and the proof is simple. It is just a mimic of A mimic of what is done at the continuous level, and you have a multi-dimensional extensions. And so, since 60 years, we are all playing with this. So, is it the end of the story? So, in fact, you have a couple of questions. So, the first question is what happened when you want to approximate the known conservative system. So, a partial answer is given by a paper by Tom Rowe and Philippe LeFloch, so published in 1994 in Matthew-Compre. And they show that if the scheme is stable, like That if the scheme is stable, like in my case, then in fact, you are not converging toward a solution of even in the distributional sense of the PDE, but something which is this equation equal not zero, but a Borel measure. And the Borel measure is conjecturized to be sitting on the discontinuities. And in addition, they assume or they make the following conjecture that the Borel measure is a sum of the Dirac which are localized. Measure is the sum of the Dirac, which are localized at the discontinuities, multiplied by functions which depend on the left and right side states with respect to this discontinuity. But there is no information about this function, and in particular, it can be zero. And if it's zero, everything is fine. So the first question is, can we play with this? And of course, this is forbidden by law. Or this is what we say. When we teach. So, the second question is: Can we change variable? And we all know that this is not permitted. And the example is a change of variable of equal U cube in the Berger equation. And the proof is just that you don't have the same shocks. But now, if you are thinking in terms like you want to solve engineering problem, you don't care a You don't care, I would say, forgive me, a damn shit about the conservation form. You are interested in physical variables, so density, velocity, pressure, internal energy, temperature, and you don't care about total energy, which is completely meaningless. So you would like to deal with a non-conservative form. And we all know that it's impossible. Another example where it's really more necessary, probably, is MHD in astrophysics, for example. In astrophysics, for example, where the total energy uses the square of the magnetic field. And if this magnetic field energy is too large, and if your scheme is not good enough, then you will run the irrequity into negative pressure. So you would like to deal with this, but it's not possible. But in fact, it's possible. I'm going to explain why. The second one, which is the answer of a question raised by my colleague, so Bernard Kurbert Toner. So, Bernard Kurbi at 200, so 25 or 30 years ago. So, where are the flux? So, if you take a finite element method, for example, for steady problem, just to make things more simple, you take the SUPG formulation, which is written here. So you have a test and try function, which are in the same continuous space. Say, think of a local polynomial, globally continuous. Then you have this first term, is a Galiantin term, and you stabilize by using. Lengthen term and you stabilize by using streamlined terms. So this is a dissipation. The H is just to scale, and tau is a positive number or positive matrix. You have other variants with, for example, with gem stabilization. This is the work by Eric Berman and Peter Hansbaugh. You have a discontinuous Galiartin function. So, okay, the classical setting is you look at UH and VH, which are piecewise polynomials. But in fact, you can look at them. But in fact, you can look at them differently. You can project this into a piecewise constant substate, like, for example, sometimes Gregor Gassner in KÃ¶ln does. And you don't see anymore the flux. Of course, there is the boundary flux, but what about this term? So you would have the same problem with FCT by cousin, stabilized Galarchin, and also the schemes I was working on and I'm still working on. Working on, and I'm still working on so this obscure residual distribution scheme. So, there are many works related to conservation. For example, recently, a paper by Xi Wong Shu and another Chinese. In France, Raphael Urban and many, many others. So, I claim that you have a different and maybe more flexible way of looking at this. So, let me explain this. We take this problem. So let me explain this. We take this problem and you have a mesh, and a mesh can be made of triangle, tets, squads, x, etc. And in this mesh, you define degrees of freedom. So you can assume that the solution is globally continuous, but you can also assume that it's partially discontinuous across edges, whatever you want, in fact. And then again, you mimic the flu, you have the following future. You have the following flow charge, you have the domain, so you have elements as a discrete setting. So, what you assume is that there are non-overlapping samplex which cover omega. So, at the continuous level, you have points. Here you will have the degrees of freedom. So, think about Lagrange approximation, but you could think of Bezier or things like that. So, here, for simplicity of the exposure, I will assume that I have a globally continuous approximation. Globally continuous approximation. But this is not essential. Then you have the divergence of the flux, and I will introduce this residual. So these are functions of the quantity. So for each element, so for example here you have P2, you have six degrees of freedom. So you will have six of this quantity, which are indexed by the label of the degree of freedom, k the element, and uh, some description, so the description of your solution. And you assume that you have. Of your solution, and you assume that you have this relation. So, whatever k the sum over the degrees of freedom of this residual must be equal to an approximation of the integral over the boundary of this element of the normal flux. So, think that you are doing exact quadrature, which is not really needed. And then, of course, what matters here is that. Uh is continuous, and so you have continuity of this term across the edges. If you were doing a non-globally continuous element, then you would introduce a numerical flux here, and you would have exactly the same problem. And then you have a way, so once you have done this, so this is the core part, once you have done this, you can integrate. It's not exactly like this that we integrate, but we integrate in time. And then there is a And then there is a Lax-Van Droff type theorem saying that if this residual, so the residual, you have to think them as difference of fluxes. So if they are continuous functions of their arguments, they satisfy some Nicholas continuity requirements. So essentially, this local conservation, this was introduced by Phil Roe, say, 20 or 40 years ago. And if you have a sequence of mesh which is well behaved, if you have a sequence of meshes, Behaved, if you have a sequence of a sub-sequence of UH which converts to something in L2, and the sequence UH is bounded in L infinity, then this something U will be a weak solution of the problem. And then you have a similar result for the entropy if you have an entropy inequality, a discrete entropy inequality. Okay, and in fact, you all very well known this. For example, if you take a first one-dimensional equation, so this Equation so du dt plus df dx, and you want to discretize it with the finite volume method. So you have to introduce the length of your control volume, you have the time step, and then the flux here. But you can rewrite this as instead of a difference as a sum of fluctuations, and these fluctuations are the information coming from the so it's written here. So you have the cell here, so you have the information coming from the left of the cell. Coming from the left of the cell towards this cell, and the information coming from the right of the cell towards this cell. So, one is given by an arrow pointing from the left to the right, and one from the right to the left. And this quantity are obviously the difference of the numerical flux and the continuous one. And when you add this up, the central term disappears, and then you recover exactly the finite volume scheme. So, you can do this for any element. So, instead of considering the Instead of considering the volume, so the edges of the volume, I'm going to consider the elements. So an element is a segment here, so ii plus one. For each of these segments, you have two residual, two fluctuations, which are defined here. And again, when you sum up these two fluctuations, again, the numerical flux cancels, and then you get this relation. And this is, in fact, it's reminiscent of the row average. Of the row average, because in fact, if you carefully look at the paper by Philerot in 1981, this is exactly what he wanted to do. He wanted to have a method of characteristics. So this is, he was designing not the flux, but something this update has the Merman flux, the Merman scheme, sorry. And he had to choose the average so that you get this conservation relation. This conservation relation, and this is nothing more than the row average. So, in fact, all the schemes I have shown before can be rewritten in this form. So, for example, for the SUPG scheme, the fluctuation will be nothing more than this. So, the only difference, or the thing which looks a little bit weird, is that you have to introduce a boundary flux or the boundary approximation, the flux approximation on the boundary, which will cancel if you implement this. Which will cancel if you implement this. But in the analysis, you have to do it. And for the discontinuous Galliardin scheme, this is nothing more than what you want to write, etc. And because the sum of the basis functions are always set to one, when you sum up this quantity, for example, for SUPG, then the sum of the gradient will be zero. So the sum of this term will cancel. Here you again have the gradient. So the sum of this term will cancel. And the sum of the phi. Cancel and the sum of the phi is equal to one. So you recover my conservation relation. And here, because we have non-globally continuous approximation, as I said before, the sum of this term will cancel and the sum of the boundary term will be the integral over the boundary of the normal flux. And all the scheme I know, except one, the one I'm going to present at the end, satisfy this constraint. So now. So now, in fact, I want to answer the question of this engineer, Bernard Corbett. Can you give me a scheme which satisfies some conditions, so you have guessed this conservation relation? Can I write it as a finite volume scheme? Of course, it's not going to be the classical flux, but something like this. And the inspiration comes again from the finite volume. So this is a So this is a not very nice picture. So I have a triangular mesh. Around this triangular mesh, I define this control volume, so joining the centroid and the midpoint of the edges. And the flux is going to be the contribution over the finite volume scheme, sorry, will be the contribution of the sum of the flux to across these boundaries. These boundaries. And you can easily see that, in fact, instead of looping over the edges, you loop over the elements. And then you can rewrite exactly the same scheme as in fluctuation form, where the fluctuation associated to this vertex seen from that element is written here. So, what you do is that you take the flux here, you add the flux here, so you minus the flux from the direction three to one, and then you add. And then you add this term, which is nothing more than the flux carried by this portion. And then you can redo exactly the same analysis as I did in 1D. This is the same thing. And then you end up with something very similar. So in general, the question is the following. So you want to introduce multi-dimensional flux. So these are functions of the states around your cell. Around your cell, depending on the vector, the normal, and you want them to be consistent. So, when all the states are equal, then you must have this relation. The numerical flux computed for these states is equal to this quantity. And then, in fact, you redo the analysis here, which is written here, but no problem. So, what you want to say is that the residual associated to sigma is a summer. The residual association is summoned to the summary The residual associated to sigma is the sum of the flux here and there minus a portion of the boundary flux. So the sum over the edges, so for P1 there is only three edges, plus the boundary term. And then these are the flux from the degree of freedom sigma to sigma prime. And of course, because you want them to be flux, when you switch the two degrees of freedom, you get a minus. So when you change the sign of So, when you change the sign of the normal, you get a minus. So, you end up with a linear problem. For example, for a P2, you take this degree of freedom. Again, you take this flux plus this flux minus this. For this one, you take this flux plus this flux plus this flux minus that, etc. So, you end up with an inner system. So, this is a relation I was writing. So, you see that the right constant. So you see that the right quantity are not the fluctuation, but the fluctuation minus the contribution on the boundary. So this is what I call P. And then you introduce a vector of the P, you have the vector of the F, the flux. So it's a linear problem, and this matrix is nothing more than the incidence matrix of the graph associated to my system here. This is the P2 graph. This is a P2 graph, and then you can solve this problem again because the sum of the C is equal to zero by conservation. This is the only place where conservation plays a role. So then you introduce the Laplacian of the graph. And the Laplacian of the graph has one zero eigenvalue, which is the state 1111. And because my graph is connected, it has only one eigenvalue. And so I have identified the kernel. I identify the kernel. The kernel is made of the constant states. So I can inverse because it's a symmetric matrix on the orthogonal. And I have an explicit formula like this. For example, for P1, I have my difference of residual minus my flux. These are my flux expressed in terms of this C. This would be my normals. For P2, it's a bit more complicated. For P2, it's a bit more complicated, but I what I just want to show is that you have an explicit formula. And as you have noticed, I have not used the fact that I'm using a globally continuous approximation or not. I'm just working at the level of the element. So this applies to a discontinuous approximation like DG. And for example, for DG1, you will have this flux, which is a bit weird, but it is what it is. If I do DG3 on the If I do DG screen on a prod, then I can write explicitly again my system, my incidence matrix. Then I can invert the Laplacian matrix, and then the flux is this. So you see this coefficient will give my explicit formula, and the same for the normal. So everything is explicit. And so my conclusion is that all of most, in fact, the only one I know is the one I hope I will be able. Is the one I hope I will be able to talk about at the end? Is admit a flux form? So, in fact, it's nice because we are all talking about the same things. So, if you have a fine of DG, you can you are allowed to do this, but of course, but you are also a fine of finite volume, but this you knew before. If you are a fine of Cg, then you are also a fine of finite volume, etc. etc. So, everything is fine. Okay, so now what can we do with? Okay, so now what can we do with this more? So I want to add constraints. So I will take the example of the entropy. So remember, I have the equation for the Euler equation, and I have for Sprouse Law an additional conservation relation about the entropy, mathematical entropy. So I want to have a scheme, to define a scheme which satisfies everything. So what is the problem? So this is my same picture with the elements and the degrees of freedom. Degrees of freedom, my same flow chart. So I have the divergence. So this is where I come my residual. I have this conservation relation. So I have my conservation relation for the residual. And then if I want to have a conservation relation for the entropy, I just dot multiply my initial high-perfect problem by the entropy variable. And then because it's the entropy, I will have exactly this relation. I will have exactly this relation. So, at the discrete level, I'm going to dot multiply my residual by the entropy variable associated to the degrees of freedom. And I would like to have that this sum is equal to the integral over the boundary of the entropy flux. And of course, this is not true in general. If you start by a scheme, there is no chance to get this. But in fact, you can modify the scheme to get. To get conservation on each equation, and experimentally, then I have no proof, you don't degrade the property. So, how do you proceed? So, you start from your initial scheme, and then you are going to perturb the residual. So, I would call the new result C. You want to be conservative, so the sum of the C has to be equal to the sum over the boundary of the normal flux. You want to be conservative for the entropy, and then you have a... Conservative for the entropy, and then you have a similar relation for the PC. Then, because the relation between the Phi and the P C is just by this perturbation, you can rewrite everything in terms of the perturbation. And this means that the sum of the perturbation should be zero. This will guarantee local conservation for the initial system. And then you have this relation for the entropy. And so, it's very easy to find there are many of choice, many choice of R which satisfies. Choice, many choice of R which satisfies this. And one example is this. So this is depending on which community you belong. So I come belong initially to the finite volume community. So this is the local Lux Federich dissipation, in fact. If you are in finite element, you're going to call this the Laplace of the graph. So the idea is the following. So you are going to introduce a perturbation, which is a parameter. Perturbation, which is a parameter alpha, multiplied by the difference between V sigma minus the average of the V sigma. So, whatever alpha, for sure, the sum of the R sigma is going to be zero. This is the purpose of introducing the average here. And then you solve, you can just put this in this relation, and then you get finally this answer for alpha. And in fact, And in fact, what you are doing, what you have done is the following. So you are going to add a dissipation operator, which is because the Lapelian of the graph or local Laxphysics is nothing more than dissipation. And you tune the dissipation operator, the matrix, to get the proper sign in the creation of discretion of entropy, which means that if steam already dissipates, then you'll take a negative alpha. Then you'll take a negative alpha because you want to keep the balance. And if it doesn't dissipate, then you will take a positive alpha or it's the opposite side. I don't remember. So then you have constructed an entropy conservative scheme and then, of course, you can tune the dissipation along your wish. And this extends to DG, of course. There are, of course, many, many other words in this scene. This thing. But this particular thing, I have not explained really why, but I could. You do not degrade. If you start from a scheme which is of order P, you still have a scheme which is of order P. You don't degrade the order. And this technique, as I will show later, can extend to other problems. For example, I will give one or two examples later. So it works. So I take a Berger-like equation. So here the flux. Berger-like equation. So, here the flux is a hyperbolic sign. So, why? Because I want to make sure that I will not easily find a quadrature formula which will be exact for this flux. And but first, it doesn't degrade the. So, I start from the baseline scheme. So, my favorite one. If it was second order initially, it's going to be second order after this. If it's third order initially, it's going to be third order after this. And so on and so forth. After this, and so on, and so forth. Of course, this is a bit long, but of course, you don't have, because I'm conservating entropy, you cannot have the butter and the money of the butter. So if you start from a scheme which is nice, for example, this one, where you have a nice description of shock, or this problem, it's a bit complicated to explain. But when I add this, in fact, I improve the structure in the fan. The structure in the fan, and in fact, I can even lower this parameter, which is a way to tune the dissipation I was adding by hand. But clearly, you completely kill in this example the structure of the shock. This also funnily improves schemes which are supposed not to work. So, if you take the pure alerting scheme for Aler, which is known to be unstable, in fact, it's more complicated. To be unstable, in fact, it's more complicated than this. It can be stabilized not just by the boundary condition, in fact, but it was not done here. So, this was a calculation done by Philippe Hofner. So, in fact, by using this entropy correction, you improve the quality of the solution. For reasons which are a bit mysterious. For example, before the correction, the code was crashing at a time equal 0.16. Time equal to 0.16, and this is at time 0.25. After it, maybe it's going to crash, I don't know, but at least you have a nice structure of the solution, and it's improved only in this, at least in this example, the robustness of the scheme. You can do P3, you can do sure-like things. So, this is where there is absolutely no jump dissipation, only this control of the artificial. Only this control of the entropy. And so, what are the plus and the minus of the method? So, the plus is that, or the minus, but of course, there are many entropy conservative or stable methods. So, there is nothing new. But the problem of all this method is when you change the system, for example, you go from single phase to multi-phase, everything has to be written. Here it's always the same method. It's always the same code. It's always the same code, there is nothing to change, and the transformation is really multi-d and it's in fact it can accommodate other constraints, for example, entropy, kinetic energy, etc. So it has, for example, yes, kinetic energy, kinetic momentum preservation, and so on. So it is, say, more flexible. Along the same line, you and using again the fact that you are looking at the conservation. The fact that you are looking at the conservation not at the level of edges but at the level of elements, you can do many other things. For example, you want to instead of working with the fully conservative variable, you work with a system where the velocities are put at the velocities are put at the vertices of the mesh, but the thermodynamical quantities are put inside the elements. Put inside the elements. So it's similar to what is done in Lagrange and hydrodynamics. So you are going to use this system instead of that system. And I will not know this. Sorry, I've sorry, sorry, sorry. I was thinking of one, the next item. So let me rewind. So you want to. You want to work with this form of the equation for particular purpose. So, the motivation was multi-phase flow. And in multi-phase flow, you want to have a nice description of the pressure at the interface between two flows. And if you don't do it correctly, you get oscillation, it may lead to the crash of the code or so on. So, the best system is to use the non-conservative one, but of course, you are going to. But of course, you are going to have a problem of conservation. So, what I'm going to describe on this example is a way to start really from this version, but so a non-conservative version of a conservative system. And so, what we do is that we take some approximation of this. For example, here is the conservative relation, so NICE. We do using a conservative approximation of the flux for the moment. For the momentum, again, it's a conservative system. So, again, we take this is just local Lax Kodrix, in fact. And for the energy, we do what we can. So, we have two terms, u dot nabla e and the rho c square, in fact, time divergence of u. So, we take an approximation of u dot nabla e plus this, whatever we do. So, what we do, I assume, for example, here that I have a Assume, for example, here that I have a linear approximation of the U and E. So the gradient will be a constant. So I'm going to take the arithmetic average. And here I will do whatever I do, I can. It's not really important. What is important is that you control the stability by this dissipation and then you update the scheme by something like this, as before. As before. And of course, there is a big problem. So, where does the problem come? It's in the energy equation. So, then you remember this relation that at the continuous level, the differential of the total energy, the differential of the internal energy, minus u dot the differential of the momentum minus u square divided by 2, the differential of the entropy. And so, using specific time steps, so this is this. Specific time steps, so this will not work for at least to my knowledge for all time stepping. Then you introduce the increment in time. And then, in fact, you have a nice way to discretize this, which is consistent with the time increment, is the following. So, if delta theta is the time increment of a quantity theta, then the time increment of the total energy will be written like this, and there you have to. Written like this, and there you have to introduce two averages of the velocity and the square of the velocity, which are given here. So, which means that the un is the velocity at time tn, un plus one is the velocity at time tn plus one. So, which means that you have to know them in a way. And so, by and you know this because you are going to solve first the relation. First, the relation on the density and then on the momentum. And you can do this safely because these are conservative relations. Again, the only problem is on the energy. And so for the energy, I want to mimic my conservation of total energy at the level of element. So what I'm going to call phi E is the integral over the boundary of the energy flux. And what I want to enforce is that I want to enforce is that this quantity is equal to these things. So, where does it come? It comes from here. So, you see, you have an agreement in the internal energy plus u bar dot delta m minus u squared delta rho. And then when you think a little bit and a little bit more, then you see that here is the u bar and here is the u square. And here is a u square. And because you do it at the level of element, you have to add up all the degrees of freedom. And then you want that this quantity, this is your wish, your goal, and of course it's not granted for free. You want that this quantity is equal to the integral over the boundary of the energy flux. So again, you know this. Again, you know this, you know that, you know this, this, this, and you want to modify this. Well, this is a bit complicated, I'm sorry. So, you are going to modify the result of the internal energy again by a perturbation. And the perturbation you just computed by solving the linear system, fast system. So you have one equation. And because there is no reason to say that one degree of freedom is better than the other. Degree of freedom is better than the other degree of freedom, you will say that this doesn't depend on the degree of freedom, only on the element, and then you have this formula. And this works very well. For example, if I take a non-linear equation of states with this parameter, it's a classical test case. So you see that I can compute the exact solution, it's just a Riemann problem. And for this case, which is a For this case, which is quite strong, sorry, for this case, Alias, which is here, which is quite stronger. So you have a ratio of 10 to the 5 in pressure, for example. So you see you perfectly match the velocity, the pressure, etc. I even have a proof of this. And if you make a zoom, you see that I don't know why the non-conservative formulation is better than the conservative one. Conservative one. But I don't know why. You can extend this to staggered grid. This is a reminiscence of what you would like to do with Lagrange hydrodynamics. So I will not detail, but the idea is similar. And this works really well. For example, on SOD, you see that you perfectly match. You see that you perfectly match the thing, and I can prove why it's and this can be extended systematically to high order. So, these are all the examples I know which fits in this framework without any difficulty. So, you can rewrite them in terms of flux. And these fluxes are non-standard. For example, for my multi-phase problem, the flux would depend on the state, some states at time Tn. states at time tn and some states at time tn plus one for the energy well so there is another another point of view which just to uh to show you that the story of uh designing scheme for conservative problem is not ended so this is uh inspired by a work by a recent work by filerot and the question is are we forced to use the same conservative and non-conservative version or are we Are we forced to use for all the patch points the same version of the PD? And the answer is not necessarily. So I consider two versions of my problem. So think Euler. So this is a conservative form and this is a non-conservative form. For example, V would be rho, U and P. So I have a special representation made by a mesh. Representation made by a mesh, and then I will use inside the elements the average of u and at the points the point value of v so my average will be u bar j plus one half in the interval j j plus one and then v j and v j plus one will be the approximation of v at the corners and somewhere I will need an approximation of u at the mid Approximation of u at the midpoint that I will explain how to get. So, the idea will be to use a conservative form for the average and the non-conservative point form at the grid point. And of course, there is not much choice. So, for the average value, but you just integrate, so you have this formulation, so you don't have any flux, or you have just a Have any flux, or you have just a continuous flux. And for the point value, you have more freedom, and then you, well, because I'm used to do this, I split into a fluctuation coming from the left and the right. And what is coming from the left has to be associated with the negative eigenvalue, and what is coming from the right with the positive eigenvalues. So there are several versions of doing this. Doing this. For example, the simplest one is just to do the print approximation for the DVDX. But the more complicated version, everything is contained by a paper by Itserle, which was published in 1981. And then you can prove Alexandrov's theorem. This is very strange, but you can prove it with a classical assumption. Classical assumption. I will not prove this, of course, but I'm going to show it words. So, this is an example, the simplest third. So, I have the exact problem, and then I use a third-order scheme. So, it's going to be what is funny is that here you don't see the order of accuracy. The order of accuracy is only carried here. So, I have a third-order version in a several formulation. So, for example, if I use So, for example, if I use the entropy variable, so I use p, u, and s. So, it's really non-linear. Or I can use rho, u, and p. And then I can use a limited and stabilized and non-stabilized version. You see the non-stabilized version, you have some wiggles around the discontinuity, but not so much, so many. And the quality of the approximation is really good. Approximation is really good. So, this is for the velocity, but of course, you have some wiggles here for the non-stabilized version. And you can also look at the entropy production. So, this is we have just three minutes left. Okay, I'm finished. Well, just to say this works fine, and my message is. My message is that first, the story of conservation is not ended. And second, I think that a much more flexible way of looking at conservation is not to look at what happened at edges, but in elements. Because of the argument I have given here, that I can explain for those who are interested later. And the last thing is that. And the last thing is that most of the methods, if not any of all, are in fact finite volume method. And this is contained in these papers, if some are interested. Well, sorry for being a bit long. You're fine. Thanks. I found this very interesting. You know, as a student of Randy Levesque, this fluctuation form is the way I was always taught to look at things first. To look at things first, so interesting to see it in the finite element context. Do we have a question? Yeah. I have a question. Please go ahead. Remy, could you please go a few slides back when you explained this issues of staggered grid for UNV? I did not get it. And this is very And this is very important detail. No, no, for active flux. No, no, for active flux. Yeah. No, no, no. Next slide. Please, next slide. When you explain the evolution of U and V. So here you evolve U, but to evolve U, you need to have UI plus one, U, and UI. Do you use them from time n plus one? use them from time n plus one no no no so the the thing is that you you believe this this is just finite volume yeah and you you can believe me here and as you said you have um the problem is that you you have a v j v j plus one and you the average at uj plus one half and so uh if i understood correctly your question you you need this information yes yes she's not given to a grand Yes, yes. She's not given torogunts. This is very easy. From the V process. Just to give an example, V will be rho U and P. So you have a transformation from rho u P to the conservative variable. And it's a pointwise transformation. So you apply it for Vi and Vi plus one. And then there is no loss of accuracy. There is no loss of accuracy. No, no, no, but here in the first equation, you write ui plus one and ui, but you don't put the index n or n plus n. Oh, yes, it's n, it's n, yes. Of course, it's n. It is n. My answer to the question, which is that ui and ui plus one are not given because my discrepancy. And the way here I use the transformation that for. That from Rho UP, for example, to the conservative variable. The thing which I have not explained is that to compute this quantity, I would need an approximation of U at I plus one half. And this is really not given for granted because you know that the transformation of the average is not the average of the transformation. And so the way I do is from the V, I compute the U at the corner of the. At the corner of the elements. Then I can easily compute a quality polynomial from the screen formation, point-wise and average. Then I compute the value of U at the midpoint, and then I pass by, if I need, to V by the transformation. Okay. Is it written in your paper? Yeah, yeah, it's written in my paper. And this I I did it only one D, but in fact, it's very easy to extend it to multi-d. To extend it to media, could you please send me the paper after the lecture? I was finishing the revision before the session, so I will give you the current version. Okay, thank you very much. Thank you. Hi, Remy. This is Alina. Do you understand correctly if I follow up on Alex's question that you just go back and forth between conservative and non-conservative variables depending on where you need? Variables depending on where you need the information here, either in the corners or the middle of the cell. Yeah, yes, but I never use this back and forth mostly for approximation purpose to guarantee the order of accuracy. But so what is really your question? No, no. Really, your question. No, no, I just was trying to understand. So, the same question: like, if I need u at point gi plus one, so I use a non-conservative, then I can recover. My belief is that, and probably very little, very few people will agree with me, but this is my belief, is that when you do you do an approximation and you have information inside the element, Information inside the element and on the boundary. What is really important, and the only thing which is really important is what you have on your boundary. The rest, what you put inside, is just for technical issues. Here, this is just to guarantee conversions of the Lagrange World stream. But the average value is not interesting. I see. And for example, if my belief is true, then you have. If my belief is true, then you have lots of freedom. For example, you can do kind of globally continuous elements with non-conformal meshing. What I'm saying is I know it's weird, but because you are just using the information on the boundary, it's very similar to what the people from Pavi are doing on virtual finite elements. I think this can be done. So, what, and I get this belief from a discussion. I get this belief from a discussion I had with Phil Rot, say, 20 years ago, and I think this is also his motivation for the active flux. He wants to put all the interesting information on the boundary, and the rest inside the element is just to make things work correctly, but no more. No more. I understand. For example, in terms of volume, there is something which is completely absurd, is to take to extract the pressure. To take, to extract the pressure from the conservative variables. Because the pressure is a point, it's a point-wise information, it's not an average quantity. And from the thermodynamic point of view, it's completely absurd. And this way of doing this kind of active flux technology is a way to avoid this. Using a pointwise value to approximate, like I kind of did in the rest of my. I kind of did in the rest of my talk, is also a way to avoid this kind of issues or thermodynamical issues. This is why I was saying it's more philosophy than the rest, but I really think it's a closer. Thank you. Thanks. Okay, I think we're supposed to be in a break right now, officially. If people want to keep discussing, maybe that's fine to do so, but we'll let people. So, but we'll let people sign off if they need to. Thanks again, Remy. Thank you.