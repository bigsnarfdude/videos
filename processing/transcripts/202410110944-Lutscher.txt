has been using holistic type program and usually under fairly simple conditions there will be boundary conditions that I'll talk about later we have steady state here We have a steady state here. And then we're asking if there is another species or another population with a slightly different trait value. So we have the same movement operator, but now we have a different D and the same tomography. The same demography, so Z R of X, but of course, in general, the two of them both compete for the same resource at the same strength. And so technically, there would be a minus V here, and there would be a minus U minus V here. The full model. We say this mutant species is X. Newton species is at small density, so I'm going to take this out. And then I get a steady state that looks like this. And here, I'm looking only at the linear equation because, again, v is small. So I have this. And I get the u star here, really. And so this becomes a linear equation in V. V and then I have typically something like a dominant eigenvalue. And so this is the invasion exponent. Sometimes we can compute this explicitly, but most of the time when the model is interesting enough, we can't. But we know that if lambda is positive, then V can grow in this environment set by the resident u. And then we make a bunch of other assumptions. Sometimes we can prove, sometimes we can't prove them, that if V can invade, that it will take over. That means. So that means they invade, and then we say the evolution goes in that direction. For example, if that's the case, then this dispersal in some sense is smaller than the one for you, then we say smaller dispersal for both. As I said, this we can often not count compute, but sometimes we can compute this. Or dv and dv equals du. So we can compute what happens when our dispersal of the potential invader is just a tiny bit different from the dispersal of the resident. And this is called the selection gradient. And so then if this And so again, if this is positive, then we would again say that larger diffusion, sorry, smaller, sorry. This is negative, then we would say smaller diffusion bits. Yeah. You are using lambda for the operator and the eigenvalue at the same time? Oh, right, okay. So I didn't mean this to be an operator, you're right. To be an operator, you're right. I say that lambda is, so this is the operator, and the eigenvalue is the lambda. Okay, so now I can explain in that sense where this idea of slower diffusion wins comes from. And so This paper has also been mentioned a few times and to Thomas' great disappointment, this is not in JMB. But it was before my time. But then Dr. Riet I'll fix that and put up the paper in JSP that deals with the That deals with all of that. So, what's the model that Hastings and others used? So, this is just and have no flux boundary. And the statement is that V can invade if and only if its diffusion rate is smaller than that V. Rate is smaller than 90. And Chris has already hinted at how this happens, why this happens. So here is my space X, and I have a non-constant resource distribution R of X, and the steady state U star by maximum principle has to necessarily be less than R at the peak. Be less than R at the peak and more than R at the trough. And so this expression here, R minus U star, is positive at least somewhere, the peak of R. And so if V, the invading species, can really concentrate on this, then it can grow in this environment. And so, what we need, what insights are, we need a non-homogeneous resource. That was mentioned a few times already. And what else do I have here? And then the diffusion prevents the resident from. Prevents the resident from reaching the resource all the time. The diffusion prevents matching of UStar and the resource. And then both Steve have mentioned that and Chris have mentioned that in your talk, there's a large literature on what kind of movement patterns would allow you to reach to match your resource. To reach to match your resource. I don't want to go there. I want to go to the boundary conditions. But the other thing that we observe here is that diffusion doesn't increase, incur any loss at the boundary because of the no flux conditions. So diffusion occurs no loss. So, what happens when we have boundary diets? A long time ago, when Ulo came to visit me in Arto, I asked him, So, what if we pick different boundaries? And he says, Well, if you put hostile boundaries in there, that means diffusion is just That means diffusion is just going to push more individuals out of the domain, and hence it's another reason why diffusion is bad for the population to persist. And so, again, slower diffusion would prevail. And he said, well, everybody in the community knows this, so nobody has written it up. Okay, fine. I think that something is happening. So, in addition or in support of what he said, In support of what he said, is that if we now make the resource constant here and hostile conditions, boundary conditions, then my resource is this, it's a constant, but the steady state profile view is something like this. Is something like this because of these boundary conditions. So the boundary conditions do two things: they increase, they lead to some dispersal loss across the boundary, but they can also turn a homogeneous resource in a heterogeneous landscape for the invader. And so And so I'm looking at the movement part only. So I'm looking at only this part. And z of 0 is z of whatever L, let's say. And in order to quantify the loss here, I would do something like this. 0 to L Z of So, if I only want to know how much individuals are lost, I would say take the total population density and look how that changes over time. We now look at movement. And this, of course, is something that gives something like Zx of L minus Zx of 0. This is negative. This is positive, with the minus sign is negative. So, we see there is definitely total. So, we see there is definitely total loss from population, but we can't calculate the explicit value because we would need the explicit solution. What is true, however, is that it is somehow and it is in some limits when z is small enough, it is given by minus the dominant eigenvalue of this operator with these boundary conditions. So, mu So mu is the dominant eigenvalue here. And in this case, this is an increasing function of d. And so we see that this loss that comes from the boundary is just increasing, and that makes now two reasons why populations want to have smaller dispersal. Number one, the invader wants to. Number one, the invader wants to have small dispersal to take advantage of the extra resource that's out here. And number two, so that it doesn't go out so much, doesn't lose so many individuals in here. So this was a step in between because what I really want to A step in between because what I really want to talk about is rivers. And eventually I want to get to river networks, but for now I start with just a single river. So I have a domain where there's, I also call this attraction, or downstream, downstream drift. And for me this is always going to that direction. Direction. And so my equation now becomes ut is duxx minus qux plus u1 minus u. And q is positive, that corresponds to a vection going to the right. So now I need to decide what my boundary conditions are. So this is upstream, this is downstream. This is downstream. And here I put no flux. And so the flux is dux minus qu here. And downstream, I'm putting two different options. One is hostile. So in other words, u is equal to zero. And the other one that we call outflow, which is ux, is equal to zero. Is equal to zero. So that means that downstream, so there are two things going on, right? There's the advection that pushes individuals out, and there is diffusion by which individuals move in both directions. And what we're saying here with the outflow condition is that the diffusion in and out balances, whereas the drift is still there. It's still there. So there is an outflow, but it's not connected to the diffusion parameter. And so what we observe is that if D is really small, let's say it's zero, then this is a transport operator, and so everything will just be pushed down and eventually out of. Got enough. And so D really small means the population cannot persist. And so that's the first indication that something's going to be different here because really small d will not benefit the population anymore. So let's see if we can make this a little bit more precise. So small. Can you say it again? If d is 0, u y minus 2 cannot restore the. Yeah, so if d is 0, then everything is just going to be washed out at the Everything is just going to be washed out at the bottom. Yes. Nothing is coming in. Small D is detrimental. Thank you. So that's the observation or kind of the intuition, biological intuition that can be made precise in a number of ways. I'm going to I'm going to do a simplified system first to kind of sharpen your intuition. And I do that by taking this part, so the movement operator, and replacing it by this expression. So now I'm thinking, I have I have a variable capital U, which I'm thinking of the integral of U here. The integral of u here, and I say u prime is at least approximately equal to minus mu of d u plus u times 1 minus u. And so few people have played with this idea of replacing a complicated movement operator with just a dominant eigenvalue. Because what I'm interested here is the fact that Here is the fact that this essentially confers loss of the population, and how much loss? Well, approximately this. And just because Thomas is here, I want to mention a paper that I put out with Christina Kobel here in 2013 in JMD, where we looked at this and showed that in some sense this is an optimal approximation of the total density. The total density and what it does here. Of course, it can't approximate all the details, but it can do something. And so, if we now write down the steady state, this is going to be 1 minus mu of du, mu being that dominant angle here. And then if I write down the v equation, Well, then 1 minus u just becomes that eigenvalue over there for mu of dv du and so I see that in the end it is really just the difference between the loss rates. Oops. It's really just the difference between the loss rates that makes. That makes the dynamics here. d V minus mu dq times v and so if this is smaller than this in other words if the loss rate from the of the invader is smaller than the loss rate of the resident then the invader can come in and in this very simple Can come in, and in this very simple ODE model, you can show that everything else works as well. There's no coexistence, and so the invader will take over. Sorry to interrupt. So here you see the whole PD are an OD, but continuum. Exactly. These are ODEs, yes. I'll get back to the PDE in a second. For now, I just do the ODs. And so, what you can do is you can plot μ as a function of D. And in the case of And in the case of the hostile conditions, you get a function that looks like this. And so here you see that when d is really small, and then this here would be negative, so there is no steady state. At some intermediate level, the loss rate from the domain is the smallest. And then if d gets really large, then our Gets really large, then the outflow through the hostile condition downstream gets so large that again the population can't persist. So we have the two things balancing. And so in this case, we get intermediate dispersal to evolve. With the outflow condition, however, our dominant angularity looks like this. And so exactly what I said earlier, the Q is always there, but the D goes in both directions. Goes in both directions. And so the D doesn't contribute to the loss, but it contributes to the population being able to get upstream. And so here we have higher D evolved. So I promised I would come back to the PDE now. And it turns out that this statement, the same statements are true for the PDE level. So the same is true for the PDE, but much harder to prove. And so this is what I did with Yuan Law in 2014. And again, 14, and again, to please Thomas, we send that to Jamie. And what I want to do here is I want to show you for the steady state of view, so for this equation here, I want to show you what the phase plane looks like, because that I will need for the river network case. The phase plane in the relevant case looks something like this. Something like this. And this is my boundary condition, the upstream condition for the boundary. And the solutions that I'm looking for with hostile boundary conditions are this. So I start at the upstream condition, so this is dux minus qu is equal to 0. And this here is my downstream. And this here is my downstream condition that says u is equal to 0, the hostile case. And so in a spatial profile, this corresponds to, well, I clearly have to end at 0, so this corresponds to something like this. And you can see that with respect to the constant 1, there is space here and space over there that an invader could use. Use. On the other hand, if I use the outflow conditions, then I need to have ux equal to 0 at the downstream end. And so this here corresponds to my steady state solution, and that means my steady state solution is going to be increasing. And so my evader can only use that part upstream. Part upstream. Again, high diffusion allows the invader to go against the advection here and utilize this little bit and therefore invade if it has higher TV. Excuse me, can you just explain how you choose your branch, which one you the graph it seems a bit you. Which of these here? Yes, it seems to have a graph. Yes, that's a matter of how long the domain is. So, one crucial thing in the proof that the higher diffusion will win here is we can actually calculate the selection gradient. If I have enough time, I write down the formula later, but I'm not sure. And there's no test, so you won't have to memorize it. But we can explicitly calculate that, and under the Calculate that. And under the two conditions, that u is bounded by the parent capacity, which is given because the pressure is parabolic, and then that u is increasing, we can show that this thing is actually positive. If this was four, then I was five network. So now I'm going to uh So now I'm going to. Ah, I wanted to use different colors for this. I'm going to put this together to build a larger network, something like this, where this is the flow downstream. So I have a segment zero, I have a segment that I call one, and I have a segment that I call two. I have a segment that I call 2. And each segment has a length. So I have lengths li. Each segment has a cross-sectional area at that segment. And I have the density of my population on the segment. And on each segment, I have exactly the same equation as over there. So up here, I have no fluff conditions. And down there, I want to only work with the outflow. So that in the end, again, like in the second case over there, diffusion does not incur any loss here. So no loss due to diffusion. And what I'm interested in is interested in is how the different lengths of these three reaches affect the steady state of my resident on this and then eventually the evolution of dispersal on here. And so for that I need to do a few things. Namely I need to tell you the matching conditions here and I need to justify why I'm using the same parameters D and Q in the entire network. Q in the entire network. So I'm using the same D in the entire network because I'm thinking of this as a species-dependent thing. That's kind of what the species does dispersal. I'm thinking of Q as something that the environment does to the species. And if I want that to be constant throughout the network, I have to have some kind of consistency condition. And that consistency condition is that A1 plus A2 has to equal A0, so that the amount of water that comes in from here. The amount of water that comes in from here combines and gets a large enough area so that the flow speed is the same everywhere. So that's the first of the consistency and matching conditions. The second one I have is u is continuous at this junction here. And the third one is the flux And the third one is the flux of U that comes from 1 plus the flux of U that comes from, sorry, from 1 and 2 equals the flux that goes into 0. And if you put this all together with these conditions here, you get A1U1x plus A2U2X equals to A0U0x. And now comes this picture comes back. Because I have the same equation in each of the upstream regions, I have the same phase plane on each of the regions. And what I need to do is I need to find solutions. So three branches make one solution that. That works with these matching conditions. And so here is my upstream boundary condition that I need to connect to this here. And so I have a branch one that starts something like this. I have another branch two that also starts on the no flux condition. And I have the branch three that starts at the bottom. Starts at the bottom, and the way the three have to meet is at the same value of u, because u is continuous, and they have to satisfy this condition here. So in some sense, this has to be a weighted average of these two guys. So if I can find a solution like this, then this is my steady state in the whole system. In the whole system. And what you see from this steady state here is that it's increasing in the first branch, it's increasing in the second branch, it's increasing in the third branch. How long do I have? Five, ten minutes. Oh, you're very generous. Thank you. Maybe I should ask the rest of the audience. So the slightly longer and slower part of this is we did the same plus u times 1 minus u, where u now is in some sense the integral of u0 plus the integral of u1 plus the integral of u2. The integral of u2. So this over segment 0, this over segment 1, and this over segment 2. So in other words, I just tried to get something for the entire density, for the total density, and I approximated this with the eigenvalue for the entire graph. Not just for a segment, because that doesn't exist, but for the entire graph. So the exact same calculations as here. I have the exact same outcome. I know that if this. Same outcome. I know that if this loss is less than that loss, then the smaller disperser will win and will take over at least to this non-spatial approximation model. And so that means now I need to provide you with the corresponding figure of that graph here. So this is D, and this is ν, and this is now for the network. And we find. And we find two different things that can happen depending on the ratio of the lengths. So, this is one thing that can happen. In other words, that corresponds exactly to the outflow condition here. And I didn't draw that far enough down, but slower dispersal will win. But we also found a second case that looks something like that? Faster, yes, thank you, faster. Faster, yes, thank you, faster. But we also found a second case that had an intermediate minimum. So in the non-spatial approximation, there would be an optimal D that would win. And so that was kind of strange. Can I draw this? Okay, you remember this? I'll just take this out. Because then we looked at what does that, what, what kind of thing? What does that, what kind of length, what steady state does that correspond to? And so it turns out, if you make the L1 large, or let's say larger than the L2, you can get something that looks like this. This is the L1, this is the L2. Do I get this right now? Roughly. And in some cases, we even make. And in some cases, we even managed to get to this point. So that means that the maximum density over my network is somewhere here on my upstream part. So in other words, just the geometry of the network, the relative length of these streams, turned a monotone, or potentially monotone. Potentially monotone solution into solutions that have intermediate maximum. And if that is the case, then we have the same thing as before, then we have an intermediate maximum here, then a disperser who has, well, then an intermediate disperser allows to persist and at the same time use enough of this, like match this better than one with higher or lower dispersal. So it turns out, so this is the non-spatial approximation that gives us an idea of what we're trying to do. It turns out you can calculate this for the network. And it is more or less what you expect. It's the formula for each reach added together, weighted by the areas. Areas. And we can also show that if the steady state of the resident is monotone, then this is positive. So that higher dispersal, well, mutants with higher dispersal will be able to invade. But as we've seen a little bit earlier, the steady state of the resident is not necessarily monotone. And so, to sum up, there is one way to introduce non-homogeneity and therefore the potential for evolution of dispersal and for slower dispersal by having an R that depends on X. So, even if that doesn't depend on the boundary conditions, May induce a steady state that is not homogeneous, and then both of these effects typically mean that slower dispersal is an advantage. If we have something like downstream flow, then there are reasons why low dispersal is not advantageous. And then there is an intricate difference or interplay between the boundary downstream. Interplay between the boundary downstream and a flow that can either give us intermediate or high dispersal as the best option. And what we've kind of added now is the geometry of the network that even if the boundary disk itself doesn't create this heterogeneity or doesn't lead to extra loss, the geometry of the network itself can lead to. Itself can lead to intermediate maxima and therefore select for either intermediate or higher dispersal. And I should mention that this last bit here is joint work with Olga Vasilieva and a student of hers, Dylan Smith. And unfortunately for Thomas, this was also not in JMB. This was accepted just three days ago at Bulletin. Just three days ago at Bulletin. But I think there's a lot of interesting stuff still to be done. I think we've only just scratched the surface, so if anybody would like to collaborate on putting some of that into a JMB paper, I'd be more than happy. Thank you for listening. Any questions for us? Very nice at all. I'm trying to take a the on the message. I'm clicking the L2 on L1. Message: I'm flipping the L2 on L1. So now I you said L1 is very big, now I say L2 is very small. So you expect in that case that the lever number two will play such a low role. So how can you reconceive the limit? Is it consistent with what you said? Or is there more complexity that two should not be too small and then one should be large enough to give it L zero? Yeah, my question is that I I guess you have a precise description, but can you say like roughly what uh what are the conditions on L zero and two and once you have I think it's an excellent question. What we have shown is that it is possible to get to intermediate maxima. We haven't been able to, probably not even seriously tried to kind of map out what this is in terms of these relative lengths. So that, yeah, really studying how that depends on this, how the steady state profile depends on the LIs is definitely something worth looking into more. One of the things that we're thinking of now that we know that this is possible is we would look at the case where the red one here actually ends right on there. Then we have something that's independent of the rest, and we can kind of sit on. The rest, and we can kind of sit on that point and do bifurcation analysis there. That's that's kind of the next step that we wanted to do. What if it's just costly to swim against the current, or is that already taken? Yeah, that's interesting. We don't haven't thought about that yet. And so, in some sense, that would mean there's an additional loss term and Q is high. Right, or the higher D is. Right, or the higher D is. Oh, right, so the D is potentially against the curve. My last question, if you have an interpretation of this bump, if I understand it, it gives you a bump in the density of the red, uh of the red uh density. Yeah. It's unmolotonic. Is it because you have an inflow at the junction that comes from the second river, which would be like a reservoir that Would be like a reservoir, but that will go against the flow in that one. I don't know, it's just like a. I haven't thought of it that way. As I said, it typically happens when this is small compared to that. And so, in some sense, I was thinking of it as what's coming here. No, I have to. No, I have to. I'll get back to you on that. We have thought about this, and it was a little bit unclear where it comes from. I won't get back to you on that. Thank you. Just a biological comment. The original boundary conditions that you put on this make it seem not a