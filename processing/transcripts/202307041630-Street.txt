Thank you very much. Very happy to be here. This is a really cool conference. I'm very glad that I was able to be at it at the extreme last minute. So yeah, super happy to be talking to you all now about single-cell TCR sequencing. This is an interesting project that I've been working on longer than I expected when I started it, but it's been very sort of interesting and rewarding to work on. Rewarding to work on. And to that end, I want to start by thanking all of my fantastic collaborators on this project. I also have to thank Keegan, who actually introduced me to David Braun when we were all at Dana Farber. Merceda and Jill were fellow postdocs alongside me in the Rafa lab. And then it was just the four of us for quite a while, but this project has gone on long enough and grown new branches that we've now taken on new students. Taking on new students. Mingji was a student who worked with me for a good chunk of the last year. And Maya is a student who works with David, who's now at Yale. Oh, and so is Marcia. So this is where I started. And since this is a computational crowd, I think T cells have come up enough that most people in this room know what they are, but this is where I started on this project. I was like, okay, what are we interested in? T cells are a white blood cell, they're part of the immune system. Blood cell, they're part of the immune system. T cells have a very specific structure and it's very highly adaptable. There's a lot of different potential components, so they use this PDJ recombination to make a wide variety of different T cell receptors, which can then recognize an extremely wide variety of different antigens. You don't need to understand all of this. I'm just going to call your attention to the CDR3 region, which overlaps. Which overlaps the V, the D, and the J regions. This is an mRNA. We can sequence that, and we can get some information about what that T cell receptor looks like, or maybe what it's doing, hopefully. So I'm actually going to start by talking about somebody else's paper, because it's a really interesting paper, and I think it sets up the motivation for the problem really well. So this is a clustering paper on TCR sequences. Clustering paper on TCR sequencing. And they took patients with a bunch of different diseases, found some clusters of different T cell receptors, and basically created a predictive model to guess, based on someone's T cell repertoire, whether that person had, you know, MS, COVID, lung cancer, ovarian cancer, this list of diseases. And it's pretty interesting. Their test for COVID versus healthy was actually better than some existing over-the-counter. Some existing over-the-counter COVID tests at the time, which was pretty cool. And maybe you can see how people would get excited about this. My keyboard is not working. They talk about super pie in the sky ideas here of what if we could turn this into a universal diagnostic tool, right? What if you could tell any patient, you know, here's what You know, here's what's wrong with any patient based on a simple blood drop. It's a big idea, we're a long ways off, but it's a cool idea. So this is where I came into this problem, was for a single-cell project in renal cell carcinoma, which is a specific type of kidney cancer. Immunologically speaking, it's an interesting type of kidney cancer, and we were, that's why we. And we were, that's why we did joint RNA sequencing and TCR sequencing. I'm not going to talk too much about the RNA side, but I guess we should have called this palteomics at the time. Anyway, just wanted to set up the study design, we took samples from tumor and normal, like from the tumor itself and from adjacent normal kidney tissue, in patients with three different stages of this disease. Here's that t-SNE plot again showing that we. Here's that TCNA plot again showing that we got a bunch of T cells, and for a good chunk of those T cells, we also got this paired TCR sequencing information. A little bit at the bottom showing that we got wildly variable numbers of TCRs per patient, but what you can see, if you really, really squint at these pie charts, is the idea that we see lower TCR repertoire diversity in the tumor samples as opposed. In the tumor samples as opposed to the normal samples. And that's because we think the immune system is actively responding to something. So certain clonotypes have been expanded, and those sort of grow to not quite dominate, but certainly take up a larger percentage of the overall repertoire. This is where it gets interesting. This is single-cell data. It's highly ambiguous at times. There's a lot of issues with dropout. A lot of issues with dropout and inefficient capture. We don't always get a perfect readout for each cell of here's the CDR3 region for the alpha chain, here's the CDR3 region for the beta. And sometimes you can get even like pretty extreme numbers of multiples in terms of how many alphas and how many betas you've got. It only takes one alpha chain and one beta chain to produce a TCR. So if we're interested in what So, if we're interested in what a T cell is actually recognizing, it's going to be determined by some combination of an alpha and a beta chain. But knowing which ones are actually producing that TCR in a particular cell is a difficult problem. And in fact, at the time that we published this paper, we basically just ignored that complexity. And we've seen a few other people do this. Basically, we just took the 67,011 cells. 67,011 cells for which we had perfect data. We had one alpha and one beta chain. But that's only about 50%. There's a lot of cells that have some sort of ambiguous data, and it really bothered me that we weren't making use of this. One particular reason why it bothered me, going back to the motivating paper, is that they mention low-frequency clonotypes are actually very important for them when it comes. Very important for them when it comes to predicting diseases and patients. And so these low-frequency clonotypes can be very important. So here's my little cartoon where I talk about the different ways in which these cells can be ambiguous. I said we can sometimes have perfect information where we've got one alpha and one beta per cell. We can have just an alpha, just a beta, two betas, two alphas, one beta, six. 2 alphas, 1 beta, 6 alphas, 7 betas, which is too big to fit in a cartoon, but there's a wide range of ambiguity that you can observe. But it's easily categorized. If we count the number of possible clonotypes, obviously it could be one. If it's two and two, then there's only four possible clonotypes. If there's only an alpha chain, then the number of possible clonotypes is sort of proportional to the number of observed beta chains. So that's actually a fairly Beta chains. So that's actually a fairly large number. But this is very much analogous to like an EBO blit group type of thing. This is a very good setting for something like the GM algorithm. And that's what we did. So we took, you know, in a simple case like this, where we've got a cell that has a single alpha chain, and we observe that alpha chain in two other contexts. Ones that's with beta chain one, and ones with beta chain one. Beta chain 1 and ones with beta chain 2, then we would essentially just proportionally assign that cell as two-thirds clonotype 1, 1/3 clonotype 2. And that's after an iterative process that started with spreading it out over all however many thousand possible clonotypes. This is what it would converge to. And so, as I mentioned, we get a decent bump in the amount of data that we can make use of. The amount of data that we can make use of. And I think this is the real selling point. If you get more data, that's almost always good. So that's honestly if you take nothing else away from this talk. I think that's the important part. We also show that we do a pretty good job at boosting those smaller clonotypes. So if you look on either of these plots, You look on either of these plots, and this is just on a raw scale and on a log scale, the counts that you get from the unique method where we throw out all of the ambiguous data, and then the counts that you get from the EM where we've got proportional assignment, so it's no longer integers anymore. We get a nice boost in signal to some of those low-abundance phonotypes that can be very informative in terms of overall health. More interestingly, if we look at the overall diversity of the T-cell repertoire within each patient, I'm showing a measure of entropy here, normalized entropy, measure of diversity. Merceda has spent a lot of time thinking about different types of measures of diversity, and there are a lot of different things out there. I'm sticking to normalized entropy now just to keep it simple. But we can see, again, if you squint at the unique. Again, if you squint at the unique results, you can kind of see that diversity is lower in the tumor samples. And as the disease progresses, you get less overall diversity. But that pattern is a lot more clear using the data from the EA. And so I think that's a really big improvement just in terms of being able to see the patterns that you expect on the data. I mentioned there's a whole lot of different diversity metrics out there. Most of them. Out there, most of them, a lot of the new and really good ones are really built around count data. And so I'm hoping that we can start to work on developing methods that work with non-count data since we've got non-integer counts with our expected counts framework. But this is not really my area of expertise. And then my student worked on a simulation study where we simulated from ground truth and just measured the total variation distance. The total variation distance between the recovered distribution of clonotypes and the original distribution of clonotypes from which we were simulating. And not surprisingly, you see that we got closer, we got a lower distance, we're closer to the truth using all of the data as opposed to just unique vertics. All of this is available in the Bioconductor Package VDJ Dive, which has actually been out for a while now. And I'm very proud of it. I think it's a very good package. A very good package that does a pretty basic thing in this sort of field of analysis. I'm going to mention, however, one complicating factor, which is why we don't have a paper yet, that I mentioned this distribution, this joint distribution of alpha and beta chain. As of Cellar Ranger 3.1 and higher, they introduced this new heuristic or set of heuristics called nclone that reduces Reduces the number of chains that you get. They're trying to reduce the ambiguity. So they're trying to make it easier to just look at the unique cells, which is great in principle, but it means throwing out some of that data that we had before. And I think this ends up hurting more than helping. And so if we actually go back to sort of the before and after signal, the picture, you know, there's still a little bit of benefit. You know, there's still a little bit of benefit, but it's not as clear. The EM looks more like the unique here. And there's a lot less ambiguity, which is good, but there's also a lot less data because a lot of it was removed. And so we're now thinking about sort of benchmarking studies, what experiments could we run to show that maybe we shouldn't be doing this, maybe we should be using the old version and just taking all of the data and then doing the EM of that. Data and then doing the EM with that. Oh, sorry, I didn't advance the slide. If you're good, that was the same, that was the before picture, this is the after picture, where the EM and the unique are very, very similar. Yeah. And the overall signal quality, like the trends in the data that we want to see, are much blurrier. Okay. And with that, I want to thank Mike Library as well again, and thank you all. Library is one. Yeah, and thank you all very much for having me. Yeah, really nice work. So I'm not sure if the collaborative discussed this with you, but is it possible that T Sa will have two alphas or maybe two? Our collaborative seems to think so, but I don't know. I've heard some discussion of whether or not it's like biological. Of whether or not it's biologically possible for a cell to have two alpha chains, in which case it could make two different receptors. I think it's not unreasonable to still do some sort of proportional assignment in that case, because there are two possible phonotypes that this cell could be producing. It's a similar argument for doublets. One of the things that nclone really aggressively goes after is filtering doublets. But if you only care about the overall repertoire of, you know, The overall repertoire of T cell receptors, then a doublet is almost like two cells worth of information that you're getting rid of. I think that might be a real thing, and I think this is about the best way we could handle it, although I'm willing to discuss it. Good question. So, is that applied within a patient's compilation results, or is that across? Yeah, so what we've seen and what I've heard from other people is that. And what I've heard from other people is that, like, 99% of the time, any given CDR3 that you look at is going to be specific to that one patient. So, you really don't gain. You don't want to assume similarity across. Right. You wouldn't really gain much, and it would cost a lot of computationally. Your outputs can be extended for analyzing some other kinds of data? Um I think it could be extended for analysing B cells, but B cells are more complicated from what I've heard because of somatic hypermutation. Heard because of somatic hypermutation. So I don't know that you would get the same, it might just be nothing but extremely low-level. Like there might not be any sort of highly present, you know, high-abundance monotypes that we saw. We haven't looked into it much because he only did TCR sequencing. 