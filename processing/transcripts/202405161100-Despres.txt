The father from the ultra-weak rationale formulation. So it's also impossible not to invite him at a FEFS conference. Too bad. Too bad. Yeah, okay. Bad luck. Okay. So okay. So thank you very much. So uh what I will uh speak about is a new result that we have this year with Emile Parolin and Nicolas Gallant. And Nicola Gallant. Nicola Gallant now is preparing his PhD. Okay, first, Hélène, you notice that it is in Ria before Sorbonne University. So, okay, take a picture and send, please. Okay. And so, but Nicolas started up here. Okay, so actually, Emile came last year to me and told me they have really new results with these results that were presented by Andrea Moyola. I think this Parolan, Moyola, Librecha. ideas on using a vanescent wave. Okay? And I read the paper and I thought it was really mathematically something I thought new. And I said, okay, then it's enough to start a PhD on that. And Nicola comes from the group of from Andrea, actually. He's from that university. Okay. So actually, okay, so okay. So but so my talk is split in four parts. Split in four parts. Thank you very much. So, actually, I have paper. I don't know if it has been shown, but I would like you really to make a comment first. So, my four parts on general introduction on TREF and Elmolt's equation. Then I will make my, not my purpose, completely, I will rephrase the Vibrés modular parallel. The Vibrech modular parallel idea, because I think there is a paradox to explain before using the technique. Then the third part will be really based on our new results with Emile and Nicolas, with new orthogonal families of trust bases. And the third part, the fourth part, excuse me, will be if I have time, if I have time, on an applicative project with a previous PhD. With a previous PhD student, Guillaume Morel, and a co-advisor Christophe Bue at COR, where we use the trust method not for wave equation, because I was not working on this wave equation that much, but for transport equation for neutron propagation. And there are some very nice applicative things that you can do. And okay, I I will I will go fast, but you I will try to really pinpoint on where the trust method is really good for such transport equation. Okay. Transport equation. Okay, so first in the middle, you have Trevz, Eric Treff, and on his right you have Ritz, and on his left, you have Galartin. Okay? Of course, Ritz and Galerin are much more known, but Trevz made some tremendous contribution in science. So in my opinion, Trev's method now, we use them personally, a special mixed formulation or DG with non-polynomial special basis function. Polynomial special basis function. There have been many names: PUM, the ultra-weak method I work with, with Olivier Snar, REFCDG, you see the W, the wave-based method, and there are so many instances. They're quasi-Trefs, whatever. But whatever, the paper of Tref is a super smart paper. I recommend really to read it because actually the idea of Trevor was not to improve the accuracy of his numerical method. The accuracy of his numerical method, like we try to do. But he made a super smart remark, then for a variational problem, if you use the Ritz method, because you use the discrete space, you will have an approximation of the energy, the quadratic energy, from above. And he said, oh, if we would have an approximation of the quadratic energy from below, we would... From below, we will have a true interval of confidence. Now it is called a posterior error estimate. So essentially, Treft made. He had the idea of an a posterior error estimate, and then he designed a new method so that it was possible to have this approximation from below. You really have to know that at that time, there was absolutely not all this mixed formulation, this weak formulation, this formulation with... this formulation with uh with dual dual variable. So it was much less rich than than than now. So and then it was for that reason that he designed his method and he proved everything and at the end for a conti-level problem essentially he obtained the true interval of continent. So really in my opinion it is the first paper on upper posterior estimate. I mean the seminal paper on the idea. It is super smart. Okay. Okay, but now I will focus for the three first part on using the trace method for working on the Helmholtz equation. And I would desire to incorporate exact solution of a linear PDE on the approximation, especially because here the PD is homogeneous and it has been shown a lot of times, so that's fine. So here, let us just have a look at plane waves, standard ones. At plane waves, standard ones in red. Okay, then you sample a certain number of directions. All my notations are in two here. You have to imagine it goes in three. Okay. And the natural remark is that the plane wave, of course, they are, okay, now we take them as basis function, but they are not orthogonal functions, of course, in any normal of any possible space, L2 base space. So you have your domain, if you look at the L2. domain if you look at the l2 space in omega or the l2 the l2 space on the boundary of omega of course it cannot be orthogonal so there are it may when you then when you assemble the matrix a n with n plane waves on okay last line of course you you get a dense matrix and the condition number okay we know can be super bad now there are plenty of estimates that which shows that it scales perhaps uh exponentially with respect to n With respect to n and also with respect to other parameters. So, but so, but it's kind of a teaser of my talk. I will show this statement is not completely true. Okay, if you use evanescent quotes. Okay, so first we have to, okay, so I had plenty of references, so personally, I am okay. I am okay in the past normal. But what I really want to mention is that in all these numerical papers, there were a lot of papers dedicated to the preconditioning, to ill-conditioning of this thing. Probably the Pere de Bin paper in 2006 was the one most specifically dedicated to that issue. But there have been so many papers which really Which really focuses on that. So it will be somehow one contribution of my talk to propose a new solution of that problem. Okay. So first section, I want to rephrase and to explain the paradox why it is natural to use evanescent wave if you formulate the problem in a certain way. So first, let's just forget about the... first let's just forget about the the Helmholtz equation and just like take a function u in the plane u of x of course it is known that you can you have the Fourier transform so with the Fourier transform u is the integral of its Fourier coefficients times plane wave because k the Fourier number the Fourier vector k is in R2 you see so there it is an integral of plane wave and with the Fourier transform there is absolutely no problem There is absolutely no problem of ill conditioning. So, and okay, so it is well done because the Fourier operator is isometric. Okay, but the key thing, look, is that we integrate over all k in R2. And the fact is that the HP norm of U is the L2 norm of U hat, the Fourier coefficients, times certain polynomial in the absolute value of K. Absolute value of k. I hope I did not make an error. That's correct. Okay, but then you can specify the regularity of the q and this estimate makes sense because k is in R2 is in a set which is unbounded. So if you look at different p, you have different type of regularities because k is unbounded. This is the point. So exactly. Geometrically, k is you integrate. Geometrically, k is you integrate in a domain which is unbounded. Okay, so the Fourier operator is okay in this formulation, or in this way of looking at the problem, because you integrate in an unbounded set. Now, let us look at the Helmholtz equation. Of course, the natural idea is to specify in our all these Fourier modes and take only those which are relevant with respect to the Are relevant with respect to the Helmholtz equation, meaning that k now, you take k, modulus of k is kappa. So now you rewrite the Fourier operator, but you specify, well, it's called more Herglots representation, but it's not that important. You have now another function, I call it V hat of theta, and then you integrate on a circle, of course. Theta is between here and into the 0 and 2 pi. Your input into the zero and two pi, and then you have a look at the regularity of the function u. And it is just evident that you can differentiate the formula. And it's evident that you will get, if you differentiate with respect to x, you will get some powers of k which will go, yeah, yeah. But you can bound. And because the modulus of k is kappa, kappa, now you can get it outside of the integral. And you see that if you vary p P, the specification on V hat is always the same. So you gain nothing. And the problem, okay, it's known since a long time, of course, that this mapping T is compact, is injective, you can range this dance, you can prove so many things. But the key thing that I want you to look at, to observe, is now the set K on which we integrate is bounded. integrate is bounded. This is the point. And so ultimately it is because k here is bounded that t is a bad operator if we try to evaluate its inverse operator. So conclusion, t minus one, which is formally you can define because t is into is injective, is an inbounded operator for from x to y for any reasonable pair of subless spaces. Of turbulent spaces. Okay, so it is really ill-conditioned. So the takeaway it has in this way of formulating the problem, it is due to the fact that we integrate in a bounded set. So now that we have this in mind, let's look at the proposition made in the paper by Vibrech, Moyola, Parolin. And we say, okay, but no problem. So you think of K. But no problem. So you think of k initially for the Fourier, for the Fourier representation, k is in the plane. For the Erglott wave, k is in the circle. So the only direction in which you can go to be unburdened, it is in the vertical direction, meaning in the complex direction. So now K is complex. So K now is K D, where K is fixed, it is the wave number, and D is any vector, complex vector, such that, of course, you have no choice. Such that, of course, you have no choice. D dot D is equal to one, so that it is still a solution to the Helmholtz operator or Helmholtz problem, Helmholtz equation, excuse me. And then you parametrize, so it is exactly the parametrization that they propose. Actually, so now you split it in two parts, the real part and the imaginary part. Necessarily, because this d dot d is equal to one, you have that the real part to the square minus the imaginary part to the square is equal to one, and both are. equal to one and both are orthogonal so you see for example that if the imaginary part is zero then the real part is as modulus one so it is once again on the circle but now you have an additional degree of freedom and the construction okay you start first to take a vector or d or of d outside of the circle of r outside yeah okay boundary included and about outside of the d And outside of the disk, the boundary included. And after that, you go in the orthogonal direction and you set a vector imaginary of D. And then you have a, it is a way to parameterize the thing. And at the end, their annotation is that you need three parameters. So it is called here, y, which is theta, the direction of the real part, ψ, which is the length of the imaginary part, and s, which is. And S, which is plus one or minus one, because in this construction, you can go both ways. Okay, and there, so it is, so now, no, so now what is proposed to, okay, it is necessary to go in the unbounded direction, but it is not because it is necessary, I mean, not to fall in the trap that we have explained before, that it is sufficient. And what is fantastic with their result is that their result explains that it is sufficient. Explains that it is sufficient in the case of the ball to use this evanescent wave. They call it evanescent wave because now the wave, the wave vector is imaginary, so in certain direction you have evanescence. So you write your glass operator, but integrated over all y. All these, okay, by construction, TV, of course, solved the Hymnh equation. And then you specify two Hilbert spaces. Bert faces. The second one, B, is the set of functions in H1, say, that solve the equation, the Helmholtz equation. And the first one is a subset of L2, of Y, where you have a weight, or there are certain subtleties, but the weight is not that important, because it is explicit in their paper. It is explicit. So the point is that, so why it is a subset A? Because you have to construct by. To you have to construct by hand the pseudo of a inverse, the inverse. So it's not because we have overparametrization in terms of the number of plane waves. We have to select the inverse that we construct. But it is completely explicit in the paper and the theorem. So Emile agreed that I put the theorem like that. So I'm okay. Assume omega is the disk, then T is bounded and invertibly. And invertibly bonded from A to B, and so continuously with respect to all the norms. So now I understand that going using evanescent weight is a good idea because it solves the paradox. Okay, there are one cases. No, why, no, no, why, why, no, no, why, why is the parametrization, but okay, why, why, capital Y? Okay, so it's how you, it is the set of parameters that you use. Set of parameters that you use to parametrize all the invanescent waves. But you really have to understand that the boundary of the invanescent wave is the circle. So you have much more waves that you would like to have, actually. But what is important is the functional setting and the fact that the operator is invertible. Okay, so now, okay, so then we had a lot of discussion. So I, okay, we had a lot of discussion. discussion. So I okay, we had a lot of discussion with, excuse me, so the two papers, the first one was in 2D and the second one was in 3D. But then we had a lot of discussion with Emile. So to understand the point which is made in their paper. And with Nicolas, we said, okay, let's try to use this to do some things interesting. We'll see if it's possible. And actually, it's not that easy. Okay, if you try to generalize their integral on... generalize their integral and the property of their integral operator and to find the way for general domain. So far, we have no solution to propose. And it was evoked in the talk by Andrea. And it's a difficult problem, but it is an open problem. And personally, I think it probably would, it should have a solution. But okay, so with Nicolas, we have decided to look at simple domains, simpler domains. And because we think of using developing a numerical method at the end. Developing a numerical method at the end, okay, at some point. Of course, in the numerical method, we like very much square cells or rectangle cells, small cells. So, can we define, use their idea in rectangles or squares in 2D? Okay, so omega now is a rectangle of a square, Lx and Ly at the end, it will be h, it will be small. Okay, but we have not done that so far. So, what I will show now is So, what I will show now is this new orthogonal family. So, first, okay, so the domain is a square or rectangle. And for us, it was important, so I introduced that notion immediately. So, you can symmetrizome some functions by operators SX and SY, either by symmetry in the X direction or symmetry in the Y direction. Now, it is nice because actually the group symmetry. Because actually, the group symmetry of the shape you are using seems to simplify a lot when you use it in a convenient way. So, we define these operators and then we define four orthogonal projectors in L2, in L2 of R, but also in L2 of the boundary. Why it is written R, it is L2 of omega, no R for the rectangle. So, omega, there's the notation, R is the rectangle. Okay, so and okay, you can check there are the PGIT. You can check there are the pgs, they are just four orthogonal projectors, okay, with respect to that. And beware, in the notation, a pg is equal to one divided by four i to the power j plus k, but i is the purely imaginary number. Okay, so by definition, you check, but if you do don't want to use this projector, don't use them, but it simplifies a lot. You will see next slide, okay? So, by construction, L2 of the boundary. construction L2 of the boundary is the is the sub yeah the sub okay uh okay it's bad it's not it's not that sum it is the it is the orthogonal sum with a O and a plus okay I made mistakes you using my LaTeX but okay you understand what I mean like it is it is it is the sum of uh of uh vectorial spaces okay and then you take a plane wave a standard one or perhaps not a standard one One, or perhaps not a standard one, it depends of if phi is real or complex. You don't care at this level. And you apply your four operators to this plane wave, and you take, you obtain four functions which are necessarily one orthogonal to the other. Okay? If you take one phi, okay, because these operators are orthogonal projectors. And let's be super constructive. Let's decide. Let's decide, let's make a selection on phi now by asking that the functions must vanish at the end point. And you will see it will have wonderful properties in X or in Y. Okay? So when you look at your four plane waves, they immediately you get four algebraic equations. Cos of kappa, the first one is cos cos cosine of kappa cosine of phi Lx divided by two equals zero. You can solve. two equals zero, you can solve, of course. And the other one are the same, except that cross is changing by sine and LX is changed by Ly. Okay, which I will comment only on the first one systematically. Okay? And then you solve. So if the cost of something is zero, it means that this something is 2n plus 1 divided by 2 pi. So you get that cost pi is now 2n plus 1 divided by 2n plus 1 pi divided by kappa LX. So you understand. So you understand that there are two regimes. Either n is small enough, then phi, you get it as a real number, it is the arcos of what is in between, or 2n plus phi is greater than 1, and phi starts to be imaginary. It is an imaginary number, and you have to, yeah. And you do the same for the other ones. So now you generate functions. Okay. What are the Okay, what are the properties of this function now? It is the question. So first, let me take the first family. So I remind you that the first family is pi 00 of a plane wave is the cos of kappa cos phi, where the phi 0 nx means that they are solution of the problem that I have shown. So it is a recall here. So this function actually, they are a combination of four plane waves obtained by isymetry. Obtained by estimator. So let's have a look. So actually, what is important is not the value of phi 0 and x, it is the value of the cosine of phi, 0 and x. And of course, the value of the sine of phi 0 and x. So the cosine of phi 0 and x, I remind you. So it is a family. For any natural number n, you get a value. And then, of course, you get the sign by just solving the square root. But of course, if n is too large, Course, if n is too large, you get an imaginary number, and then the sign now is an imaginary number, it is the second line. So you see immediately now the direction, these d0 and x, these vectors, now they are either real or complex, but clearly they are bounded. In the sense that if n goes to infinity, the norm of the n goes to infinity. So we recover this symbolous principle. This embound principle that was in the paper of Parolin and Libreche and Moyolin. And actually, Emile, okay, he knows a lot about all these things, but he pointed to us that such very similar functions have been designed by Vim Desnet some years ago, but without all this presentation, of course. It was essentially a numerical engineering paper, but okay, we have to compare. But okay, we have we have to compare. We know. So, okay, let me now show. So, for example, for kappa equals 16 and L equals 1, for on the left, you have, we call it a propagative because all the direction is purely real. So you see that it vanishes on two edges, as mentioned, and it oscillates on the other ones. And you can see the value of the function and the boundary and the value. The value of the function and the boundary, and the value of the function inside. All these functions solve the Helmholtz equation. And on the right, you have the same, but now it is the evanescent wave. So clearly, there is a hyperbolic cosine effect in the y direction because it's very, the wave is, there is a boundary layer, and there is a boundary layer. Okay? Okay. So now, okay. Okay. Okay. So now, okay, so we have our functions. So now what are the what what is the what what are they all are belong to the trace space B but the funny thing and it was not expected immediately they are all orthogonal in L2 one to the other not only one family is orthogonal to the other family but in one family if you take n and if you take m different from m, they are orthogonal. Why? Why? Because on the boundary Why? Why? Because on the boundary, look, let me go back. By construction, oh, no, it is the Neumann case. By construction, on one side there are zero, so you have no problem. And on the other side, they are just the cosine of a 2n plus 1 over 2n plus 1 divided by 2 i x divided by l x. So it is just that, okay, excuse me. Okay. Where is this written? Nowhere. Nowhere. Yeah. Here. Is it good if oh no no no okay nowhere but because yeah exactly here because of the selection of the cosine of n zero you if you in the interval lx divided by two or minus lx divided by two lx divided by two all these things these things generate they are just a Fourier basis in 1D For actually it is exactly the basis of the eigenvalues of the second derivative operator equipped with Dirichlet boundary condition and you select only even function. And this because of that, they're okay. So they are all orthogonal. So for this colour product. And actually, as a matter of fact, you can compute. And actually, as a matter of fact, you can completely using the trace color product mentioned in the claim. So now all our claims, because we have not issued the paper, even the preprint on this, but you can change the scalar product as well, because it's not really important if you use the Division trace or the Nominee trace, so you can play for degrees of freedom. So you can generate many, many, many families like that. And for example, if you use Like that. And for example, if you use the Neumann product, what we call the Neumann product, it means that now we look at the scalar product on the boundary, which is the L2 integral of the Neumann traces. So you have the same, except that now at the end point, it is the Neumann trace which vanishes. But okay, so you have propagative wave, you have evanescent wave, and you have plenty of waves. Okay? So now applications. So now applications, so we have done so far only one application, but I will show you the neural result for improving on the condition number. So take any of these familiar scalar products. So for simplicity, I use now for this result the Dirichlitz scalar product. And I make the assumption that there is no exceptional frequency in my rectangle, which is, if you know what. if you know what's going on with helmoles equation with dewicher trace you're not you're not surprised but what what what we have constructed now is an orthonormal because all these orthogonal functions you you normalize it is very easy it is an orthonormal and complete family of the scalar product so it is the funny thing now and a hint of the proof just to make to show you where where uh okay where uh okay there are many things to say but it's very elementary okay but hint of the proof of okay uh hint of why you you need to exclude uh exceptional the exceptional frequency so the exceptional frequency means you assume that kappa square is not equal to any of this frequency where you vary n and m so the reason is that the plane wave pi 0 0 it is something which is a cosine in x times a cosine In x times the cosine in phi, but by construction, the function vanishes already on two edges. So it's good that it does not vanish on the other two edges, because if though, you have nothing. So you absolutely need that the cosine of kappa sine of phi y does not vanish if, ah, and here there is a mistake, if cosine of kappa sine phi and y divided by two. So you by two. So you the non-digital condition writes that the cosine of kappa sine phi Ly divided by two is not equal to zero. And you solve and you get, of course, immediately that the frequency is that kappa square is not an exceptional frequency for a certain pair of integers. But since you have the three are the cases to tackle, then you vary all n and m, and they are not only two. 2n plus 1 and 2n plus 1, they are not only odd numbers, but you have all the natural numbers. So, this is why, at the end, what is necessary is the condition on the top. Okay, so then we said to us, okay, okay, let's try it. What's going on? So, okay, so first, okay, so you can have a look at the condition number. So, here it is the condition. Okay, so on this plot, what is it? So, let me describe. On the horizontal axis, it is n. horizontal axis it is n the number of basis functions in our family so the matrices have size n times n more precisely they have size 4n times 4n because of the four family and i even i think uh nicola told me that because there is another hard even symmetry principle so it's more eight n times eight n but it's not important it scales linearly with respect to n okay and Okay, and actually, what is interesting is to mix the two the two the two the two the two um scalar products why because it is a natural scalar product for example in the ultra-weak for variational formulation if you are looking in the ultra-weak variational formulation at the level of the block the diagonal blocks actually it is that this colour product which is computed so since i like very much the ultra-weak method of course i asked them to so this is what we have I asked them to. So, this is what we have done first. Okay, so now let me comment. So, on the horizontal axis, it is the size of the matrix, so the number of basis functions. The blue curve is the condition number, so lambda max divided by lambda min. First good news, you observe that it is comparable asymptotically to the red curve, which is quadratic. So now, first, it does not grow anymore in an Grow anymore in an exponential way. We have a proof of that. Okay? But you will see later it will be even better. But nevertheless, there is also a vertical line. The vertical line is exactly where you have the exceptional frequency. If you, for example, if you if you try probably it is a so you you you you you look okay we okay in a certain way but okay you you look at the Way, but okay, you look at the n and m. Okay, let's let's decide that n and m are the same. You look at the n such that kappa is an exceptional frequency for that n. So you can somehow plot where is the exceptional frequency with respect to the horizontal axis. Okay? And what you see is that there is a jump close to the exceptional frequency, which was not expected. So which means that the singularity is So, which means that the singularity is still there somewhere. So, we have not so far made a detailed analysis of this, but it was nevertheless very. Okay, so if ever, if ever, I have to still to discuss with Nicola Randaco, but if ever you select, you change a little the kappa so that this exceptional frequency is closer to what can be captured with a certain selection of N and M. With a certain selection of n and m, the jump is even greater. But then we look at what's going on, and it is just because locally close to the exceptional frequency, actually there's no degeneracy because we use this mixed now scalar product. But the point is that a certain number of the basis functions that we have designed, now they are very close one to the other. But the point is that it's only close to the exceptional frequency. It's only close to the exceptional frequency, so it means that there are only a finite number of this basis function which are involved. So it means that if you rescale within this finite set the basis function, you can always rescale function, okay? Then it should improve because it is because in terms of the space which is generated, it is all the let me the space which is generated by this function is L2. Is L2 is the full L2 space. So you can pass through the continuity. So you only have to rescale the basis function. And this is what we get. So now we get exactly the same, but the jump is controlled. Actually, it was, okay, I have to say that we have no theory so far for that, no written theory. It's only a numerical experiment, but there are so evidence, and the principle is so simple. So actually, this scaling technique, Actually, this scaling technique came to us by looking at some paper by Moyola, Ipmer, and perhaps someone else, Ralph perhaps, would correct me, looking at the low frequency limit of this, the condition number of the low frequency limit of these plane waves. So it is exactly the same technique. Okay? So you do linear. And then, okay, so now honestly, the condition number. The condition number is much better, but it still grows quadratically. So we have to look at that. And actually, the point is that we not made a mistake, but there was a choice that was made on purpose. Was our first numerical result, it was all the normalization was done with respect to the Dirichlet trace. But actually, in terms of bilinear forms, it is very clear that the Neumann trace. Clear that the Neumann trace is more demanding in terms of regularity. So, the good idea is to normalize with respect to the Neumann scalar product. So, these now are the results, re-normalize, normalize respect to the Neumann scalar product. And what you see is that first, okay, now the red curve is asymptotically bounded. So it's just fantastic. I was just, and you can look in detail. So, what is the green? What is the green curve? What is the green curve? Yes, the green curve and the magenta curve that you do not see are the lambda max and the lambda mean of the Neumann operator, but renormalized. But okay, but the Neumann matrix now, it is just the identity matrix. So this is why the green curve in log scale in the right direction, in the horizontal direction, it is one actually. The green curve is one. The magenta curve you do not see. Okay? The yellow curve, what is the yellow curve? Yes, the yellow. The yellow curve, what is the yellow curve? Yes, the yellow curve is the inverse of the minimal eigenvalue of the Dirichlet, the scalar product. So it grows. Okay, it seems that there are some connection between the condition number of the global matrix and this yellow curve, but okay, we have to. Okay, you still see that there is a jump near now the blue line, vertical line, which is somehow where we which is correlated to where is the. which is correlated to where is the ex the exceptional frequency even if it's not a fully fully uh fully uh fully rigorous because okay the exceptional frequency the the the the the the exceptional yeah uh to check if you're if if a plane wave is a if a basis function is an exceptional frequency you have to check something which is computed with respect to two parameters Is computed with respect to two parameters, n and m, and here you see just one, so it's not fully regular. Okay, so now I close my first part, my third part, yeah. And my the claim is that all what I shown can be proved. Okay, essentially, okay, we have a draft with Emil and Nicola. So, okay, and there are also all the fancy properties on the examination, so it's fine. So, from my perspective, from my perspective, Perspective, from my perspective, the problem of the condition number is solved if you use evanescent wave for the square cell. Okay? So you can say that there is kind of a theorem that says evanescence yields orthogonality, which is a nice statement, but it's correct. It's correct. I mean, for this cell. But nevertheless, it is not a magic bullet. Because you can immediately see, okay, let me use it in my code. It will solve everything. No, there will be. code it will solve everything no there will be a problem let me now explain so it's it's it is an application of this very famous no free launch theorem or it means that this method is not a magic bullet why and it was exactly also mentioned somehow in all these the talks and the in previous the one by by it may is that it's still good to preserve spectral accuracy it's good when you have a family an orthogonal family but you have now to to look at the But you have now to look at the rate of approximation of standard functions. And the point is that now all basis functions they all vanish at the corners. So it means that if you think that you will approximate a general function, it will not be that fancy. Or the rate of convergence will be slow. Actually, it will not cannot be spectral. But the key thing, actually, is that with this technique, we traded accuracy versus stability. So the good. Stability. So, the good thing is that with this fability, ultimately, we can use them in an hybrid mode, meaning we can enrich some bases, we can remove some of these waves, we can play with them. So, now, nevertheless, we have a way to control, completely, to control the stability by means of these orthogonalities. But now, of course, we have to go back again to the question of the accuracy. Accuracy and also I do not claim that the way we design the basis function is the best one. So perhaps there are the choices. Okay. Okay. So so so so so so it is a restriction that we see but we will look at that problem mathematically and after that we will make our choice later for assembling a numerical method. But nevertheless all my conjecture, all conjecture is all what has been reported so far will be observed. So far, will be observed on a trust method implemented with its basis function with Cartesian cell. Okay, oh, yes, and this one is very important. So, on the left, you have Emile, and on the right, you have Nicola, and actually, they both will be at the WEF conference. So, if you want to ask what are the improvements on that, I go directly to the tall guy and you ask him. Okay, you can torture him. Okay, you can torture him. He's the PLG guy. So now, do I have five more minutes? Yes. So now I want just to show you a problem. It was more an engineer. Okay, it was another PhD, but before working on an applicative problem. And we thought that using TRESS would be good. Actually, we wanted to solve neutron propagation problem for a serial application at COR. And you actually want to solve a kinetic equation because f is a function of t, x, and the direction of the particle. And there are certain parameters in the fundamental equation. c divided by epsilon is the velocity of the particle. Epsilon is a small parameter, just reminds you that usually the velocity is large. Omega is the direction of the particle. Sigma A is the... Is the absorption coefficient? It depends on the matter. And sigma s is the scattering coefficient. It depends on the matter as well. And you see that you have on the right-hand side minus sigma a. Is it correct? I'm not sure it is minus sigma a. And the f between between triangles, it is the mean of f. I'm not sure it is. I'm not sure it is. It is bizarre my equation. No, probably it is minus sigma A F, but it's not important. It's not important. I'm just presenting to you the general principle. No, it's not the same. Yeah, yeah, yeah. No, no, but perhaps there is. Okay, but it's not important. What is important is that you have three physical parameters and that they can vary a lot and you can describe some physics with them. It is a linear equation, then you have to select some harmonic polynomial. Some harmonic polynomials, or some, we call it PN method. Below it is written the SN method. But if you now select a certain, you project on certain harmonic polynomials, you get a system which is a Friedrich system, DTU, where U is the collection of all your moments, I mean all your projection on certain harmonic style ways. And then A and B are some big matrices. And in R, you, you are, R. In R, R is a matrix where you have the absorption and scattering coefficient. And actually, this system is super close to a system that has been studied in the TRESS community or in some papers by Peter and Gabar and okay. Except that in our case, we are really we focus a lot on the physics which is in in R. So just to to go first. Oh oh yes, but uh I started in late. I started in late. So, how much minutes do you give me? Now it's okay, but let me more scientific. Okay, let me continue. So, here it's a boring slide where it is explained if you pardon diminute 20. Oh, I will have finished before. Okay, it's not sure. It's a boring slide where A boring slide where it is written that if xkm is a real spherical harmonic, then the original kinetic equation, you use it to project, and then you have u, which is the collection, which is the vector of the orthogonal projector, we call them moment. But now u is a function of t and x, but now you have a vectorial system, of course. You can describe completely how you compute the coefficient of the big matrices A, curly. Matrices A curly and B curly, okay, it depends on A. Actually, you see that A curly is a symmetric matrix, which makes which is excellent. And here we have specified everything for the case where you are in a slab, meaning the particles, there is a symmetry principle in the Z direction. This is why you do not have DZ. Okay, you have to make your calculation. It's not important. What is important is that we will select a certain number of moments. we will select a certain number of moments capital n and uh we will uh make okay okay we will have a lot of we will have a lot of uh of we will have a vector capital u of i size because we always want to use large n to have good accuracy but now the good the good thing with the trust method let me focus why the trust method is a good method for this problem so instead okay so the general So instead, okay, so the general method when we project on n real spherical harmonics, we call it the P N method. It is standard denomination in neutron propagation community. But now let's have a look at the P1 model. So just one moment. Very simple. Actually, at the end, the model is just the wave equation with a certain right-hand side. So if you look at stationary solution, it is the C divided by epsilon dx of V equal ma. By epsilon dx of v equals a certain absorption parameter p and then the other equation in c divided by epsilon dx of p equals minus sigma t v. You can ask me why you have not written d it as u z the known or not u zero u one u two you know because okay it is just because here it is so close to the linear wave equation that you have we have changed the notation and sigma t is the total scattering coefficient which is the sum of sigma a and sigma. coefficient which is the sum of a and simple so now you have to find some so it means that you want to design a trust method in 1d and after that once you will have it in 1d what we do once we have our basis function in 1d we rotate the basis function using exactly the same angular trick as has been described many times but you have first to find solution in 1d so you have to solve the equation so actually a natural way to solve it is So actually a natural way to solve it is is to recognize the that the solution capital U here, which is V P, you try to find a generalized, okay, you formulate it as a generalized eigenvalue problem. So you try to find a vector z and the number lambda such that u is equals z exponential of lambda x is solution to the equations. And you plug in it, you obtain one, and it has the form of a generalized eigenvalue problem. Why generalized? Because capital A is not Is not the identity, and capital A is a degenerate as well in many cases. But nevertheless, you can solve, and you get two basis functions, E1 and E2. And the fantastic thing is that E1 and E2, you can see they really have the knowledge of the physics of the problem, because sigma t and sigma a and c and epsilon, they can vary a lot. So you see that the physics somehow is That the physics from R is in R in the basis in the trace basis. So, we really had the idea that using this basis function adapted to the physics can help a lot. So, it is the general principle. Okay, so within, so I will show you now, just to show you that we are serious people. We used within the thesis of Guillaume Morela all the advances. All the advances in terms of the numerical analysis of the TREF methods. In particular, we use all these clever works that have been done on working on showing quasi-optimality for... Okay. But at the end, we managed to obtain the following theorem that, okay, to everything is okay. We have H converge. But which was quite difficult because we... But you chose quite difficult because we have to handle these big matrices. So, the quasi-optimality is something on the stability of the continuity, but at some point you have to explain that you have a good interpolant or a good local approximation. You have to work. But essentially, it's okay. And all what has been known so far for press function is okay. I don't want to take too much time to comment on this estimate, but it is the same. Estimate, but it is the same as in terms. For example, if you look at the complexity, the ratio between the complexity, how much basis function you need to obtain h to the power n, you see that it is linear. The number of basis functions is linear with respect to the order, which is kind of okay. So, now just numerical results, which are more physical results. So, on the left, there is a domain which is a square, and but in this domain, But in this domain, you have a sub-square, and you see there's a typical test problem. Sigma A is zero everywhere, meaning no absorption, and you have low scattering. And inside in omega one, you have still low absorption, but non-zero, and high scattering. Scattering, it means physically speaking, that you have immediate redistribution of the particle. So, with stress function, you okay, so we design the basis function. So we design the basis function and with stress function we you you can you can you you you have to choose the direction but in this problem because it is an interface problem actually there is something interesting is that the problem described by uh by uh by Raf It Meyer was also an interface problem at the end okay but okay but okay but but here so it was possible to adapt the the direction of the basis uh the basis the the trace basis so it is the the the the red the red the red uh the the red arrows, but locally so that we systematically capture the normal direction at the interface between the two materials, which are very high contrast. And it is very important because we expect, it is the physics, that we have boundary layers at these interfaces. And of course, why do you have boundary layers? Of course, because of that. Just have a look at the basis function. You see that we. The basis function, you see that we have some exponential, the second one, some exponential of exponential of minus epsilon divided by c square root of something divided by x. So for example, if epsilon is 1, c is 1, but sigma a or sigma t is large, the square root is a large number. So it means that you have boundary layers locally. So the physics is in that. So we have this by construction with the trif method. With the trif method. So, and there are results. So, there is a flow of particle coming from the left. You have your object. So, your object, yeah. And we have compared many times. So, I will not show you, I will show you any few results. The result obtained by the trace method, which is in the center. Okay, so on the right, it is the reference solution obtained with a superfine mesh. In the center, it is the TREF method, and on the right, it is. TREF method, and on the right, it is a method obtained with a standard DG method, obtained with standard G method, with only polynomial functions, which, of course, are not adapted at all to capture boundary layers. It's not a surprise. But okay, we check, and with the same number of solutions, you obtain that the solution with Stref is much better, and it has been confirmed by all calculations. And my last slide is the following. So, on the left, you the following so on the left you you have this okay you have an assembly of of little squares so you have eye contrast between the squares you really have to figure out okay so why why this test problem because it is a simplified problem of what you have in a nuclear plant because in the nuclear plant you have roads of fuel which is which are the uranium bar bars and and you have water everywhere so the basic problem is that really if The basic problem is that really, if you make a cut of this, if the basic problem is that you really have a discontinuity of the coefficients and the propagation of Newtons is described typically by this kind of. Okay, so in the center, it is one result that was good. And on the left, okay, we also looked at the condition number of the method. And once again, we observed that the condition number of the trace method. Observe that the condition number of the trace method is super sensitive to all parameters. So it is the blue curve much worse than the red curve, which is with the discontinuous galactic method. And in this case, it was sensitivity with respect to epsilon. Honestly, it was before the result was obtained before our new understanding that I proposed to you, the result with Emile and Nicola. It is for sure clear that if I have to read. Clear that if I have to work again on this problem, I would incorporate these ideas of local orthogonality to have control of this condition number. But okay, it's in perhaps the future. Thank you. I'm done. Do you have uh any question? I I I have one. I I have one. Why you don't try to reduce your basis like we propose? No, no, no, no, no. I agree with you. No, no. There are two things. Okay, so it is for the first part. There are two things. First, okay. First, I can try to control the condition number by using all the techniques that have been proposed in the literature. First. But before, I wanted to understand the... But before I wanted to understand the source of this bad condition number and also the connection with these new techniques of using evanescent wave. So I do not say that our technique is the best one. Never I will say anything like that. I only say that if you use a vessel plane wave, then it generates orthogonal basis. And it is a way to control the condition number. And I have proposed to you this slide. These slides because it is okay for us. It was interesting because then we can compare with all these asymptotic results. So, yes, we are not trying to design the best method. We are trying to understand what can evanescent wave, what they can bring to this business of test methods, which is in my opinion more. Okay. But I agree with you. I agree with you. And in particular, I agree with you. And in particular, and in particular, the problem with our method is absolutely not that the condition number is better or less than the one obtained with all the techniques. The problem is that there is this no-free launch theorem is now that we have, somehow we have traded accuracy versus stability. So we have to understand where we can recover spectral accuracy if it is possible or not. There are some mathematical questions in it before using the... Okay, this is my. Before using the, okay, this is my answer. Okay? Okay, well, thank you. I have a mess in my head, so I just try to clear this up if I could. So you set capital Y, is that in one dimension, that would be a strip? Okay, for the first one, when you started and introduced capital Y, is that a strip? First, it is the okay. First, it is the notation. It is the set of parameters that. Set of parameters that you use to parametrize these waves. Okay, so look, essentially, K, okay, D, D, D dot D is one. So D is a vector. So, okay, but it is a complex vector. So, since it has two components, you need initially four degrees of freedom. But now, d dot d is equal to one, so it is in complex algebra. So, it is two equations. complex algebra. So it is two equations. So you need three, you know, you need two continuous parameter first parameters to describe D, for sure. And because of their parametrization, they add one, the last one, which is plus or minus one, which is the should go in the right or right on the left. So it is a strip, really, right? No, no, no, it is not a strip. It's difficult to say. No. It looks like it's a product of the internet. This looks like it's a product of this interval. The only thing which makes sense is, okay, you can forget about the picture if you don't want. The only thing that makes sense is that you need two continuous parameters, at least, to parametrize all these vectors. And you define capital Y as the set of the parameters that you choose. I do not say that I'm not sure it is the best parameter. It's not. It is the best parameter, it's not uh so if I would interpret it this way, so you've got if you look at all possible waves evanescent and propagating, yeah, uh, in one dimension, right, it's gonna be half, it's gonna be half of half the plane, right? The problem is that in one dimension, do we have uh no, in one dimension, uh yes, yes, yes, but I would have to die. Yeah, yeah, it would be half the plane, so in two dimensions, there would be no there is no in one direction you did, no, okay, I know no, in one dimension, you are. I don't okay. I don't know in one dimension you have, you have, you have because it is this d square is equal to one. So if this is a plus i b it will be a square minus b square is equal to what? Yes, you're right, you're right, perfect. So in two dimensions, that will become a product of those. Yes, I agree with you, but if you look at the erglot operator T, as a matter of fact, you can always perform a change of variable because it is an integral. So it doesn't matter very that much if you use another set of. you use another set of parameters another way to parametrize this evanescent wave because in the aug lost operator you will have the same the same operator t at the end because because only the jacobian will show up somewhere somewhere between between this parameterization and the one you are everybody's time right so my confusion is with primarily i guess whether you uh st you're stuck with the uh dispersion condition or or not right so whether you're representing solutions of like Representing solutions of here, nothing is interpreted so far in terms of dispersion. Okay, this is the only thing that I can say. The other thing that I can say, perhaps, which is more, which has perhaps a better physical content, is that there are, okay, so in our case, not in their case, but in our case, when we look at all these basic functions, you can split into the ones which are called propagative, as usual, and the ones which are And the one which are clearly non-propagative and which are evanescent in a certain direction, you can imagine you have a hyperbolic cosine somewhere. You need not consider ways that are oscillating and decaying at the same time. With this parametrization, it's not done like that. The only thing that I can say is that here, the parametrization, you have all the possible ways. all the possible waves so you cannot uh you cannot imagine a wave uh a complex uh direction d such that d d dot d is equal to one which does not belong to this set so okay but the bottom line is uh in kind of birds i view is that you you start with uh let's say Fourier transform which is stable, right, and end in in some in an infinite domain, and then you find a way to trun to truncate that domain in some way that it becomes stable. That domain in some way that it becomes stable. No, it's not exactly like that. I said the Fourier transform has no problem. Then I used the classical sampling with a propagative wave. And now it has a problem because the vector k are sampled in a bounded domain. So I need to go in bounded. That's it. I think I don't want to take everybody's time. Maybe you can talk about that. Yeah, of course. Yeah, there's no interpretation in terms typically of signal processing or Fourier numbers. Okay, we just say we need to be going bounded. That's it. Let's do it. Yeah, the wave is imaginary. I have no physical intuition. I just wanted to comment that these sort of waves are used in inverse scattering. Oh, yeah, of course, of course, of course. They're called geometric optics. Yeah, no, of course, of course, of course, of course. But that wouldn't be pretty difficult. But now you have now you have sort of thrown away a little bit of the advantage of preference. Yeah, of course. But you have an extra parameter. So you give big polynomials of a common element that you have quadratics in the quadratic growth in the number of unknowns and so on. Is that right? Yeah, absolutely. Absolutely. But you know, okay, perhaps I should not say that, but I am a pessimistic guy. So any program. It's the guy. So, any progress we make, we have to pay for it. I think it is a correct statement. No free lunch. No free lunch. But at the end, nevertheless, if you have a method which is spectrally super accurate, but you have problem of stability. And if you have another one which is fundamentally stable, which is not spectrally accurate, for sure there will be a hybrid method in between when we will think like an engineer when you... Think like an engineer when you will try to take advantage of both regimes. But for this, you need the two regimes. So, before there was only one, not completely true, because as Sebastian told, for thus, there are ways to control the conditional numbers, of course, but of the classical basis. Yeah. A very naive comment or question. But the issue here is a lack of orthogonality of the set of truck functions, right? That is the center. So the caveman in me would choose my threft spaces as I always do, as many as I need. And then I would just do Gram Schmidt. Yeah, yeah, of course. Good idea. What would happen? Something different for sure. But you have really. But you have really to perform the Gram Schmidt and they also have a certain okay. But I agree it is a possibility. Probably it has been done by some papers, perhaps by you. Okay. Exactly. What has done stuff in Rudya? I think. Yeah, yeah. Yeah. And also the paper I mentioned where they look at the low frequency limit of a family of plane waves and they rescale. They rescale in a way. Scale, they rescale in a way such that they recover linear independence of the basis function. Of course, it can be done. Of course, of course, of course. But here it is, I try to explain that this new idea of using a vanescent wave is also able to contribute to this issue, nothing else. Is there any online question? No? So this finished this session. There is just one formal discussion and then we have no and 15 minutes. There is another session. Bye. By Timo. By Timo. Yeah, it gives us the interpreter that looks like a script with the pencil.