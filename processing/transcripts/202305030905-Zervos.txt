About some work that I'm doing with Gristov Skovsky. As a matter of fact, all this project starts from Christophe. It was his idea. And some of the good ideas here are Christophe's. And all the nonsense in this talk is mine. And it's also And it's also with one student we have just in degree. And it's about market equilibrium with two agents, transaction costs and in a stochastic factor model. So how does it go? First we start with an economy with two agents and what you have is And what you have is two guys who are starting with zero initial endowment and have an infinite time horizon in front of them and a discounting rate, common discounting rate, are strictly positive. Now, each of the two agents over time receives a flow of endowment which we model by this process. We model by this process capital Xi, which is a stochastic integral of some small process Ci. Now what that means, that means that as time goes by, each of the agents receives the cumulative flow capital CI and they use it for whatever they use it. For the best part of the For the best part of the talk, Xi will be a function of a stochastic process Xt that is a one-dimensional diffusion. This is the stochastic factor from the title. So what is probably okay, I'm going to not talk about assumptions so that there is no distraction, and I'm not going to talk about literature. About literature. So, this is not a completely new problem. The version where Xi is just a constant has already been solved. The novelty here is that XCI is a function of this diffusion, which makes the problem two-dimensional rather than one-dimensional. And it presents features that I hope I Features that I hope I will convince you are interesting in some respects. Now, what is the idea here? The idea is that this process XT models the state of the economy while the functions HI that determine the run endowment reflect the sensitivity. Reflect the sensitivity of the agents on the state of the economy. Now, we next assume that the two agents are risk averse and they both have mean variance preferences with different aversion parameters, gamma 1 and gamma 2 strictly positive. What does that mean? That means that each of the That means that each of the two agents has a payoff of this form. So it's the expected value of the discounted utility of the increments of the endowments. Here is the mean, here is the variance. And if you make the simplification for general process XC here, all this is just the This is just this quantity, this quadratic here. So, this is what is the utility of each of the two agents in the absence of an interaction. The two agents are alone and they receive the impunative endowment and the push. And this is the utility that they have. They have just from existing. Now, the next ingredient is introducing a risky asset. And to simplify the limitation in the analysis, we assume that this risky asset is in net zero supply. I mean, we can put it constant supply, but this would not make any difference. So it's in zero net. So it's in zero net supply and the two agents can trade this risky asset. Next assumption is that the risky asset is modeled by this stochastic differential equation where you have three elements. First element is initial endowment, initial value S0. Second element is volume Second element is volatility sigma, and the third element is the drift μ. Now, in this model, the assumption is that the initial condition is not, and the volatility sigma are exogenous. Whereas we're going to determine the drift mu t in equilibrium. And talking with my finance friends, they say, all right, let's. They say, alright, what you eventually do may be halal, but this is not a very nice problem. It's not a very nice problem because, yes, you assume that volatility is exogenous, it would be better if it was endogenous. Anyway, what we are doing here is generalization of existing results. So, this is what it is. I'm sorry. Okay. In the future I have been trying to extend results this way or that way so that sigma is also endogenized. So what we are going to do is mu is going to be arbitrary until we determine it in equilibrium, which is one of the big objectives of this problem. Objectives of this problem. Okay, now what we assume, not what we assume, what we denote is theta i t to be the number of cells that each of the two agents has at time t. And because we are going to do dynamic programming, we assume that theta i 0 can be any value. But what is important is that What is important is that we have the market clearing assumption, which means that the total number of shares in the market should be equal to the total supply of the risky asset. In other words, theta 1 and theta 2 have to be equal to zero at all times. Market clearing condition is what will impose the equilibrium and what eventually will And what eventually will determine the equilibrium drift rates? Now, if we denote by YIT the total wealth process of agent I coming from trading, then YT is the initial value of the shares that each of the Y agents has plus plus what you get from changing in the stock price, plus the endowment, which all together white oops pressing buttons without meaning all together is this expression here so y t total weight of agent i at time t is half Is having this expression. No transaction cost at the moment. First, we are going to solve the problem without with zero transaction costs and then based on that solution we are going to introduce transaction costs and see how things change. So in this frictionless setting, we have again mean variance performance. Mean variance performance criterion with the discounting rate R of mean minus variance preference here to the calculations using the expression for y that we had before in the previous slide and we have this performance criterion. So the utility of the two agents is this expectation here with mu zero Here, with mu zero, I put a zero for zero transaction cost, is the drift of the risky asset. Here you have a quadratic, you want to find the optimal theta, and it's straightforward to solve because you just pointwisely optimize in the quadratic. So, what you do. So, what you do is you maximize. Quadratic is looking like this. So, it has a unique maximum inside the expectation. That maximum is given by this expression. And this gives the optimal for each of the two agents number of shares that they should hold in each of the risky assets. The risky assets in the risky asset assuming that the drift rate is mu0t. So, given a rate mu0t, this is the optimal number of shares that each of the two agents should hold. Market clearing means that theta 1 hat plus theta 2 hat should be 0. Solving the resulting equation. Solving the resulting equation for new zero, you have the zero transaction cost equilibrium mean rate of the risk asset. And the solution here follows the usual kind of approach. What you say is, I want to determine the drift mu zero in equilibrium. So pick an arbitrary mu, make the optimization. Make the optimization for each of the two agents, and once you do the optimization, impose market clearing, solve the resulting equation, and determine the optimal equilibrium new zero, the equilibrium drift. Okay, so that's what I would call the standard way to do it. And I stress this because here it's possible. Trace this because here it's possible, later it will be different. Yes? Xi is the endowments rates. So each of the agents receives this amount. Okay, so C is the rate with respect to the Brownian motion. And Motion. Think about it, trains payoff, trains dollars. Okay? And in the garden of which of the two agents. Okay. And beyond what I just described, C will be a function of X. Here? Okay. So, we have the equilibrium drift, and to connect with the absence of trading, we calculate the optimal payoff in the presence of trading with the payoff that the agents would receive if they had no trading between themselves. And what you can see here is that, okay. See, here is that, okay. Probably it needs a little bit of algebra, but what you can see doing the algebra is that this sign here is equality if the agent's endowments, the endowment rates, are equal if weighted by the relative risk aversions. So if this equality is true, then there is no benefit to the agents. To the agents to have any trading between themselves. If this equality is different, which requires that their risk aversions are different, then the agents strictly benefit by entering the trading agreement. Okay, that's well, that's a justification of okay, we have. Okay, we have everybody being on their own. We have the two guys actually doing business together. Is it worth doing business together? The answer is always yes and strictly yes if this equality fails. Okay, in other words, by trading with each other they are not doing worse. Alright, now from now we are going to impose that Now we are going to impose that the endowment rate x is a function of the stochastic factor Xt. And in this case you can calculate the stock holdings and the drift to be these expressions. From which expressions the most important is this function theta. And it's most important because we are going to solve the problem explicitly. The problem explicitly, not we are going, we have solved the problem explicitly. If theta is increasing, if theta is like this, or if theta is decreasing, or like that. Okay, and this is the most interesting case. I hope to solve later. Okay, now Now suppose that we now introduce transaction costs. In other words, each time that the agents trade with each other, they pay a proportional cost with proportionality constant lambda. Okay, so now trading is not for free, it is having friction. And in this context, And in this context, the previous solution does not hold, because the previous solution keeps the joint process theta txt on the graph of the function big theta. Given that Xt is a diffusion, it's infinite variation, so infinite transaction course. So what we expect here is that trading should be some Be somehow close to this one, this original equilibrium function, big theta. In other words, we would expect that, yes, if you are here or here, you trade, if you are here, you do not trade. But this is a detail we are going to see later. Now, what we are going to do is denote by mu lambda By μλ the drift that we will determine in equilibrium in the presence of the proportional transaction cost. And now, what is the objectives? The objectives is exactly as before. This is as before, objective from trading exactly as before. But we add this term here, multiplied by lambda. By lambda, which is the transaction cost that the two agents pay. Alright, from this point you do some algebra, effectively complete the quadratic kind of argument, and so that the minimizing maximizing this one is equivalent to minimizing this performance criterion. Okay, where we have introduced the notation theta, which is the optimal stockholdings of agent one in the absence of transaction costs, and capital M is the equilibrium drift in the presence of no transaction costs. So, what we want is each of the two agents has to mean Has to minimize this quantity here given a drift mu lambda. And here is now what is the equilibrium problem that we are facing. We have two performance criteria, I1 and I2, for the two agents. They both depend on the drift. On the drift mu lambda that we want to be determined in equilibrium. And we need the market clearing condition. So theta 1 plus theta 2 has to be 0. So what we want is determine. Yes. I have a question about transaction costs. Yes. Sorry, there are two agents. So when I buy, I buy for a higher price, one plus one, right? That's right. No, the assumption here is that whenever we transact, you and I, you pay lambda times the amount you transact and I pay lambda times the same amount. So we both face exactly the same transaction. The money goes away. The money disappears, yes. It's like friction in a machine. Okay. Consumes energy which disappears. Disappears. That's the idea. Okay. Yeah, because otherwise there's a problem. Otherwise, I'm not. Any question about the model? So you have this market theory condition, but at the same time you have this price that evolves stochastically. And So the price is not price, it's the state of the economy. Yes, I'm talking about the price process. That's the price process, right? And it has a stochastic component. And it has a stochastic component. Yes. So I'm wondering how you think about this stochastic component, because the market clearing is just determined by these two agents. And so what drives this additional uncertainty in the price? The weather. Sorry. The weather. But the weather. No, but the weather would have to intervene through the trading orders, right? Okay, okay. It's a model and then it's a unit in imagination. And last time I tried imagination, it was a disaster. No, no, no, no. No, no, no, no, no, no. Think about trading real assets that is influenced by the weather. Okay. So for example, we have well, I have not thought about it. Well, I have not thought about it. Think about uh we live in an island, okay, there are no economies, no stock markets, nothing. We live in an island, uh, I receive uh I live uh we live in an island, this is my side, this is your side, you get your rain, I get my rain, and then we have some common ground here, and we decide: okay, these pastures. Decide, okay, this pasture we are going to monetize it and we are going to top it as an asset and we are going to trade it. Okay, and what grows in that area is affected by the sun, etc. It's a silly example now. And this, the price of what is produced commonly here, we possess it, say, somehow. Say somehow is the risk acid. So that's why it's affected by some noise. Okay, that's a silly idea, Carlos. But I guess what I mean is that all these things, they should end up, you know, when you talk about the price, they should end up being sort of summarized by the orders that people put, right? If you think about the price, not and so here the orders are the orders chosen by the agents. No, it's not this. No, it's not this side. No, so I don't know what the phrase is. No, no, no. This is not in this line of market prediction. This comes more from economics. Actually, there is lots of literature following this kind of direction. From that, I am confident. The example, I don't know if it's probably single, I don't know. Anyway, let's. Anyway, that's it. I'm sorry. Okay. Sorry, let me. Yes. A quick question. Do you have a sense of what would happen if the price was determined in equilibrium? There was nothing exogenous, was truly determined by the economy. I cannot do that. And I don't know anybody who has done this in this context. Okay. And all right. This is the equilibrium we have. I stated explicitly. I state it explicitly because usually it's not stated explicit. And what's the idea? The idea, we need to find a strategy theta hat and new lambda such that the payoff of either of the two agents, theta one, theta two here, is greater than the payoff than The payoff than if agent one has theta hat and agent two has the market equilibrium minus theta hat. Okay, so this is the definition of the equilibrium. And if we can find theta hat and mu lambda such that this is true, then we say that these strategies are the These strategies are the represent an equilibrium trading strategy. Womans, your questions. Why do you dislike this? I didn't say that. I was advised that you would not like this. That's the wrong advice. Wrong advice. Okay. Okay, are you maximizing or minimizing? I couldn't. Now we're going to be able to do it. Originally we maximized. Originally, we maximize, but we did some algebra to minimize. Okay. Alright, now. Okay, how did you solve this problem? How do you solve this problem? You pick arbitrary mean rate of return new. It appears as a condition here. You pick arbitrary mean rate of return nu. rate of return new you solve the minimization pro you solve the two minimization problems related to I1 and I2 you determine theta hat1 as a function of nu, theta hat two as a function of nu, and then you determine the equilibrium rate by imposing the market clearing condition. Market clearing condition. So, this is what I would call the standard way of equilibrium, would be used to solve this problem. Okay, but following this approach, we failed miserably. And what I'm going to say is that uh in this problem, I would be extremely surprised if anybody can actually solve it following this line. In this lambda. In other words, what we do is we solve the problem by determining the equilibrium mu lambda and the optimal strategies at the same time in this problem. So which step are the main trouble? First go ahead. No, no. Main trouble is the following. You can prove existence easy. Prove existence easy. Okay, more or less straightforward application of Koblo symbol. You can solve this as existence, but then when you do the equation is okay, so how do we solve it? Now, this way of solving it is tailored in this example with quadratics mean variance preferences and And the structure we have. If it works more generally, I don't know. I mean, that's something I want to find out. So, what you do is you factorize the payoff for arbitrary theta in terms of the payoff of theta hat, where theta hat is going to be your optimal, plus some positive quantity, plus some other quantity. Plus some other quantity plus this difference where I have j's here. Again. So this is just algebra for the first guy and algebra for the second guy where you have payoff of theta or minus theta relative to theta hat or minus theta hat, some positive quantity the same in both cases. It is the same in both cases. And plus q2 minus q2, this has to be killed. If we want both inequalities here, we need this guy to be zero, okay, because it has opposite signs. And if theta hat is optimal, this should be positive. Alright? Alright, now what are these three quantities? Q is this quadratic, and this quadratic is theta minus theta hat is zero, is zero, is positive, or zero if theta is equal to theta hat, if theta is equal to the optimal, to what we want to be optimal. What is q two, which has opposite signs? Which has opposite signs. Q2 is this thing that depends only on theta hat minus the drift. And that immediately has to be zero because it's a plus and the minus. But you can see that this immediately gives you the mean rate of return of equilibrium. Once you have determined theta hat, You have determined theta hat, and you determine theta hat by solving this stochastic control problem here. Alright, it's not a very standard control problem because you want to minimize over the red theta given the optimal theta hat which appears inside the graph. So that's a control problem that they have not tried. Control problem that they have not really seen, but is not difficult to actually solve. Summarize: suppose that we can find theta hat such that this objective criterion is such that if you put the red here, it is greater than or equal than if you put theta hat. In other words, if theta hat, Theta hat. In other words, if theta hat is maximizing this one, is minimizing this one. And as before, this gives, once you have solved the control problem, theta hat gives you the mean rate of return. Okay, so that's the answer to this problem. Assuming you solve this control problem. In other words, find theta hat. Theta hat such that this is true. Now, lots of control people here. Please tell me if you have seen anything similar because I have not. Just a type of error. Yeah. The quality. So the right hand left left hand side should be data hat on. It is not data on the index, right? No, I want to find processes. No, the J, J theta X of H. Theta is the initial condition. So it's different than the theta. Oh, the theta red one is different. Theta is kind of graphic. Sorry, for Greeks, these details differ from this. I apologize. You are right, they are different. This is the initial condition of this one. Okay. Of this one. Okay. Alright, now, control problem. How do you solve this control problem? Okay, what we want is find theta hat in the minimum in the minimizes of this quantity. And what we did is we solved this problem using this free boundary problem. And again, this is a free boundary problem I have not seen before. Problem I have not seen before, and I ask, please come and tell me if you have seen anything similar. Determine a function v. This function v is not continuous. Here it is continuous, here it is not continuous. But the function for fixed For fixed x, the function is continuous, satisfies this constraint, and inside the region where this holds with strict inequality, satisfies this linear equation. This is exactly like if you think v as the derivative. As the derivative of a single agent singular control problem value function, if you think of V as the X derivative of a singular control problem for a single agent, this together with this one is the singular control agent equation with one big difference. We do not require We do not require that this one is less than or equal in the complement. Okay, now this does not look usual. What is the thing that I found extremely surprising is that once you take this problem and you apply it to this big theater or this big theta, Big theta or this big theta, the free boundary problems that you obtain are identical with the free boundary problems that we get from singular control for single agent, which I find super surprising myself. Alright, now, how do we do that? Okay, I'll say here in this case what we've got is Is the zero transaction cost case equilibrium line and then you have the sell region like here, the buy region like here, that's for agent one, the picture for agent two is symmetric like that. And what happens is like in signal control, you do you do nothing when the joint You do nothing when the joint process calligraphic theta t var theta t comma xt live in the continuation region otherwise reflect in these two lines to keep the process inside this band and here now I have to talk about how how much time? Five minutes. Okay, I will finish earlier. All right, now Now, how did we solve this? We solved this by imposing these two conditions, and these two conditions, going back to singular control with single agent, are precisely Vx equals lambda, Vx on the other boundaries minus lambda, Vx theta equals Vx theta equals zero on both boundaries, which are the smooth pasting conditions. Which are the smooth pasting conditions of singular control. And it turns out that with V, instead of the singular control Vx, you get the solution to the free boundary here. And solving this free boundary is solving a single agent problem. Okay. And now, now what I find. Now, what I find one of the most impressive stories of this problem: if big theta, big theta is the optimal in the absence of transaction cost, looks like this. Alright, if you want intuition, think about the single-agent version of the problem because it's the same three-boundary problems it ends out. How would you give? How would you keep this line to account for this function? You cross, but how do you cross? And then you invert on the other side. How do you cross? In a point, no? At the maximum. Okay. It is like this here. Okay. Locally here, at least for small lambda, is clearly like this, no? Yes. This, no? Yes. And now it's Christophe's brilliant idea. That's not my idea, it's all due to Christophe. You do cross, as you say, but you cross like this. Straight line. Okay, it's straight line. And from the inside, like this. Alright. So continuation region is this one. That's called graphic C. And the important bit is that this line here, I'll do a different color. This line here is continuation. Or is not boundary. It's continuation. So what happens is So what happens is, suppose we start here, we jump in the blue line, and then we do nothing. Okay, we move along the blue line. That's why I say it's a continuation region. When we reach here, we start reflecting down. So we reach here, we go down like this. Okay. And say sometime we hit here and then we reflect. Here, and then we reflect up like this. And if we ever reach this point, we are again on the continuation journey. Alright, I found this brilliant. Okay, this is Christoph's intricate. I'm jealous. Okay, and one night. I think that's what. I think that's what I want to say. Okay, there are many, many cases about here is big. We have small asymptotics. Okay, bench. Okay, thank you very much. We have some time for a couple questions. The transaction cost is usually two-dimensional problem. Yeah, it is two-dimensional. And these pictures are two-dimensional. What you've got is. Mentioned what you've got is in this line is theta, number of cells, and this line is x. It is two-dimensional. This picture is, I mean, this picture dimensional. No. It's theta, x. P T here P T here has derivatives only. Derivatives only. It's what we call with some guys doing that stuff one and a half dimension, right? And yes, and because I talk about continuity, in this case, the value function is discontinuous. Because here is lambda. Obviously, here, the blue line satisfies this, it's different from lambda. So you have a discontinuity here. Yes. So because you say that some people claim that it's not fully halal, right? And the fact that sigma is not endogenous, do you think that this admits like a multiple equilibrium type of interpretation in the sense of like the agents conjecture a certain sigma, right, which will give you the full dynamics of the price, and then you come and say markets are clearing, agents are optimizing. So it's a well-defined equilibrium. Okay. But they are indexed by the signals. Are indexed by the sigmas? You can see it like this: indexed by sigma. I have big respect to economists, so I don't try to play the economist. So I usually ask my friends for economists. This line of equilibria has some parameters, exogenous, some endogenous. Um the kind of uh holy grail equilibria everything of the stock price should be endogenous. All right, but because this is a hard problem however you try to approach it, there's lots of literature where they do equilibria by assuming, yes, for example, sigma is exogenous. And you can of course think of it like you say. Of it, like you say, all right, we pick any sequence associated with a different equilibrium. In other words, parametrized equilibrium. But then the unsatisfactory thing that I see is that yes, but what it elements this sigma? Somehow this would become a s this should be also coming out from some equilibrium argument. I don't know if that makes sense. I don't know if that makes sense. I think we're out of time, so let's move to Stefan's talk. And thank you. So Stefan will now present money implements optimal contracts. 