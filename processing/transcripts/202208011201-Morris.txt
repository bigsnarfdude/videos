And he's going to talk about Monte Carlo simulations of non-spherical particle flows. Welcome. Well, yeah, thank you very much for the invitation to speak here. And I just want to acknowledge a lot of the work I'm going to talk about today is done by my PhD student, Andrew Hong, who just defended a few weeks ago. So he'll be moving. Defended a few weeks ago, so he'll be moving on to Sandia National Labs. And this work was funded through the American Chemical Society Petroleum Research Fund and also some support from NSF. So many in this room and on Zoom are already familiar with granular flows and multi-phase flows, but these types of flows arise all over nature from Saturn's rings and mudslides and sandstorms, as well as in industry. And sandstorms, as well as an industry where you have different manufacturing processes or solids handling behavior. And it's an interesting problem to me because there's rich applications with industry and nature, but there's also a lot of complex physics that happen that give rise to some counterintuitive phenomena. So things like segregation, if you're dealing with heat transfer and granular mixtures, you can get very different behavior than what you see in. Very different behavior than what you see in just typical molecular fluids. And a lot of that complexity comes from behavior that happens at the small scale, such as particle interactions, particle shape, the inelasticity between particles, those can affect large-scale behavior. So it's a really challenging problem from somebody doing modeling because you're trying to bridge all the physics that happen at the small scales to the larger scales. Skills. So, my talk today is basically about looking at a different type of modeling approach for handling these systems. So, these are two of the kind of traditional methods for modeling granular flows and gas solid flows. You have your dispeed element methods where you're tracking all individual particles. But in the context of non-spherical particles, DEM. Particles. DEM methods can be extremely computationally expensive because if you're trying to find the contact between two spheres, you just take a difference of their positions, compare that to the radii of the particles, and you know they're in contact. But if the particles are cylindrical or spherical cylindrical particles, then you have to look at the orientation as well. And just the contact detection time becomes very expensive. On the other end, you have continuum models and in continuum. And in continual models, these will rely on closures for the solid stress, so you lose all the information about the microstructure, the exact orientation of the particles. And you basically try to capture those physics in terms of a solid stress relation or a heat flux, those types of constituent relations. And from theory, you can get pretty reasonable constituent relations for spherical particles for closures for the transport properties. But really, when you get into But really, when you get into complex particle shapes, a lot of the theory is just kind of lacking. So, what our objective is is to develop a Monte Carlo method that goes back to the underlying kinetic theory of granular flows, where you're basically doing a numerical solution of your Boltzmann or Enscog type of equation, and basically try to extend that to particle flows looking at two different particles. Looking at two different parts. So, the first part of this talk, I'll talk about how we adapt our direct simulation, Monte Carlo, it's DSMC, to denser granular flows. So for those familiar with DSMC, this was a method originally, it started off with rarefied gas flows. So it was looking at very dilute molecular gases. And you're solving the Boltzmann equation. You're looking at the probability of particles colliding. The probability of particles colliding, there's a depletion term and a replenishment term, and you're basically solving for what your velocity distribution function is. So, the first part is: you know, how you know, how can we extend this DSMC method to a denser flow, which is typical for particle systems. And then the next part of this is: you know, once we kind of establish a Monte Carlo framework, then there are methods that you can use to extend it to more complex particle shapes and realistic ones. So, kind of Unrealistic ones. So, kind of the ultimate goal of this is to see if we can kind of find some sort of middle ground between our discrete element modeling, where we're looking at the deterministic context of all particles and a continual model and trying to find a middle ground between those two. So, as a little bit of background on DSMC since it's not maybe not as common, so DSMC is. And so DSMC is basically a stochastic approximation to solving the Boltzmann equation. Or if you're getting into denser granular flows, the revised ENSCOC equation. So just shown here. So this is the Boltzmann equation describing the time evolution of the velocity distribution function, f. And on the left-hand side, this is the convective side. So the velocity distribution function can change as part. Distribution function can change as particles of one speed come back to different regions of space. It can also change if you have body forces, which is this blue term. But really, the complexity in the Boltzmann equation ends up being on this right-hand side, which is our collision integral term, where we're looking at how velocities of the particles change. Or if you look beyond velocities and you say, well, you have a velocity distribution function, but you also have a rotational energy distribution function. If you have If you have particles that can vibrate, you might have a vibrational energy distribution. So you have basically changes in all of your particle distribution functions as a result of collisions. But in DSMC, unlike in discrete element methods, instead of tracking all individual particles, it uses the idea of representative particles. So really, instead of tracking individual particles, you're tracking what the probabilities of particles existing in a given state are. In a given state, are. But the assumptions that we have to try to overcome in this are the molecular chaos assumptions. So when you basically are splitting up our collision integral, you have to assume that the spatial and velocities are uncorrelated. And then the other aspect is, so this correlation gets into, then also in dense phosphor volume exclusion effects. So you have to account for how that would affect your collision. Have to account for how that would affect your collision, collision rate. But the benefit of DSMC is you don't have any, you don't have to assume or know any of the constituent relations. The constitutive relations for things like the solid stress and heat flux, those are outputs from the model instead of instead of inputs. So in DSMC, we start off by having some region of space and we discretize the space into collision cells. And the collision cells are typically on the order of the mean-free path. Order of the mean free path or the mean distance between particles colliding. Within a collision cell, you select the number of candidate collisions, and this just comes from a kinetic theory. So the number of collisions that you get, it depends on this cross-section sigma and the relative speed of particles. The brackets are an average. And n here is the number of particles in your system or in your cell. And this Fn, this is basically the ratio of real. Basically, the ratio of real particles to simulated or representative particles. So, there's another free parameter in your model that's just basically your stochastic resolution. Once you select the collision partner candidate collisions, then you can accept or reject the collision based on the collision probability. So, as particles are moving, they're sweeping out some volume of space. So, what's the likelihood that they collide with something else? And then, once particles collide, And then, once particles collide, then what's done for spherical particles is you pick a random orientation, impact. And then based on that impact parameter, there's a scattering, and then you update your velocities to the post-collisional velocities. And there's going to be some energy loss due to your dissipation. So, this alpha is a coefficient of restitution. So, you have to know a priori what your scattering function is, as well as what your cross. As well as what your cross-section is. And then once their collisions are done, that'll repopulate your velocity distribution function. And then you just move to the next part where you're just invecting those particles through your system. So the key challenges for DSMC when you apply it to granular flows is, well, how do you get beyond this dilute limit? We're looking at very low concentrations to something that might be more relevant to a lot of physical processes. Processes. So, two of the challenges are: well, as the concentration increases, you have more volume exclusion effects and you have an enhanced collision frequency. And you can account for that using some sort of radial distribution function. But the other key assumption that breaks down is in DSMC, where it invokes a molecular chaos assumption. So your positions and velocities are uncorrelated. But as you move to denser and denser flows, there are correlations between those two. Between those two. And traditional DSMC, because it doesn't, because it assumes things are uncorrelated, you don't recover your correct virial or collisional pressures when you get to denser flows. So what we've done is we've looked at in the literature, some ways that people have tried to modify DSMC to recover the collisional stresses and things like that, are to alter the collision phase of it. Phase of it. And it's basically in trying to select particles in a way that you recover the collisional stresses. But what our idea was instead of modifying the collisional stage, say those collisional stresses, the reason that you're not capturing them is because there's no restriction that would prevent a particle from moving into a cell that might have might not have space for that particle to exist. So using that idea, So, using that idea, we use a random walk method, this modified metropolis algorithm. And here, the particle positions in the advection phase, when you're moving a particle, you have to calculate what the change in the potential is. So, from Ma and Amadi, the change in potential, there's this kinetic component, which is this normal 3SKT one, but then you also have this. One, but then you also have this collisional term, and this is because of when you have particles in close proximity, there's an additional pressure that keeps them repelled. And you can calculate what the change in the potential is. This is in a granular matter paper. It's not referenced here. But you can calculate the change of the potential is. And then in DSMC, you just move the particles. You look at what's the change in the mean field potential, and then you accept that movement. Potential, and then you accept that movement based on this probability. So we've implemented that, and in this graph here, we show this left, this is a measure of the compressibility versus the concentration. And what we have is this black line. This will be the ideal gas. So not recovering any of the virial pressure terms. There's no collisional pressure. So the compressibility doesn't change basically as it becomes more dense. Doesn't change basically as it becomes more dense. And if you just use traditional DSMC, well, you also don't recover any of those virial terms. But if you account for, if you use this modified metropolis algorithm, then this is the EDSMC plot, the triangles. And those actually match very closely with what we get for a non-ideal guess. And the black squares here, let's see the mouse, the black squares here, these are event. Squares here, these are event-driven molecular dynamics. So, just by doing this, incorporating the mean field potential into your advection phase, you can recover your non-ideal equation of state. And also, we found that you're also able to recover your equation of pressure. So this is a PXX versus concentration. And here, this is a comparison of the new DSMC variant. And then this is a group from brain. This is a group from Bray and Montanero doing an NSCOG simulation in Monte Carlo. So we get a good agreement in recovering the non-ideal equation state in the collisional pressures. Also a problem that this solved is in DSMC, if you don't include those collisional pressures, particles can overpack. So if you have some external force field like gravity, that's causing particles to settle. Particles to settle, then in DSMC, you will get unphysical solid concentrations. So, just for a test case here, this is, it's a little bit of a complicated, it looks a little complicated, but this is basically just a settling bed. So, the y-axis is the height, y over h, where h is the height of our domain. And then the x-axis is time, and the colors here are by concentration. So, at our initial time, we just start off with a homogeneous cloud of particles that then settle. Cloud of particles that then settle and it settles into a stable bed with a concentration around 55 or 60 percent. And in DSMC, we're able to recover that as well, and it forms a stable bed. So now that we've talked about kind of extending DSMC beyond the dilute limit and getting into recovering these coercional stresses that give rise to all this rich physics and granular flows, now we want to take it to the next step and say, It the next step and say, well, how can we apply this now to more complex particle shapes and things like that? Because in DSMC, remember for the collisional integral, you just have to know what the scattering behaviors is, what the post-collisional outcomes are for a given state. So there's a nearly infinite parameter space that you can look at when going to particle shape. So to start in as simple as a manner as we can, we basically looked at spherical. Basically, we looked at sphero-cylindrical particles and varied the aspect ratio. So, the reason for doing this is as you go to an aspect ratio of one, they go to spheres, and then you can look at the effects of elongation of the particle. There's also analytic expressions for the contact detection, and now we also have additional degrees of freedom. So, we have rotational energy that we can store as well as translational energy. And this energy is an interesting part because. This energy is an interesting part because, in a lot of the continuum models in kinetic theory, you're just neglecting the energy that can be stored in rotational modes, and especially when you have dilute flows, and if it's agitated, then there actually can be a considerable amount of energy trapped in those modes. So, in DSMC, remember we talked about how this is the major change when you go to non-spherical particles is in this collision integral. So, this J is. integral. So this j is our collision integral. And what we have to do is find expressions for what the scattering function is as well as our scattering function and our cross-section. So in what we do, we've kind of already talked about this, but we randomly select a collision pair. Then based on the cross-section, you can accept that collision. If it's accepted, then there's these there are scattering functions that you can sample from. Scattering functions that you can sample from. So these are scattering functions that can be derived analytically for spherical particles with different restitution coefficients. So if it's a restitution, if it's an elastic particle, then the scattering ends up being isotropic. And then as you increase or decrease the restitution coefficient, you end up with more backscatter. But the assumptions here were molecular chaos and uncorrelated collisions. Molecular chaos and uncorrelated collisions. So, if we want to extend this to non-spherical particles, we have to have a better representation of what the scattering distribution function is. Accounting for the orientation effects, we have to have an estimate for what the collisional cross-section is because the cross-section will depend on the orientation of the particle. And then we also have this translational and rotational energy exchange. So, now energy can move back and forth between these two different modes. So to get these distribution functions, we use DEM. So in DEM, we just initialize particles from equilibrium distributions. And so this is an equilibrium distribution of colliding particles. And then we randomize the impact orientation. So it's just two particles that are coming together at just random positions and orientations. And then we do the collection. Orientations and then we do the collision in DEM and then we measure what the output, what the output post-collisional properties are. So we can extract things like the cross-section. So this is an effective cross-section versus the aspect ratio. And as you'd expect, the cross-section increases as the aspect ratio increases. And this matches the theory that, so there's some theory on what the collisional cross-section Venus isn't going to. What is the collision of cross-section Venus is in good agreement with that? You can also sample what the scattering function is. So, what we have here is the probability of the particle scattering into a given direction, where chi equals zero is backs, is, I think, forward scatter in this case, and chi of pi, or yeah, at pi, we have a backscatter cohesion. And as you increase your aspect ratio, Your aspect ratio, then you're basically increasing the likelihood that the particles are forward-scattered because it's more of a glancing collision. So, you might have more energy that goes into rotational modes, but the particles can move forward in their original trajectories a little easier. So, it's basically a way of thinking of it as the particles can slide past each other a little easier if they're elongated. And these are also for binary collision pairs. Binary collision pair. So we're not looking at, I guess, one of the assumptions is we're not looking at the effects of all the neighboring particles. It's just looking at these in isolation. And then the last closure that we sample from our discrete element simulations is our translational rotational energy exchange. And we found that for all the aspect ratios from one up until five, which is a very elongated particle. Particle, the probability of the energy that resides in our kinetic energy versus our total energy of the system. It seems like there's a nearly universal curve for all aspect ratios in this case. So that made implementation to DSMC slightly easier. So the next bit is then, well, how do we incorporate these into DSMC? So the cross-section and scattering angles, these are all very simple. Angles, these are all very simple. A translational rotational energy exchange just is a little bit more complicated. So, what we do is we borrow ideas from rarefied or non-equilibrium gases, and we use a Larson-Bernachi model, where when you have a collision, a fraction of the collisions are assumed to exchange this translational rotational energy. And in order to determine what fraction of particles are going to transfer those energies. Transfer those energies. We look at the relaxation rate in a homogeneous granular gas. So here we're looking at Gene's law, and it's just saying the change in rotational energy is proportional to basically how far away our rotational energy is from the energy of equipartition. And then this is going to depend on collision time, which is tau eq, and the rotational relaxation number Zc. And so we've mentioned. And so we've measured what are basically how quickly our rotational energy relaxes to the equilibrium bottle value. We fit a rotational relaxation number to it, and we find that for all these aspect ratios, it gives us a five-thirds value. And I guess this was somewhat expected because it was just based on what we saw before, how when you had the energy exchange from kinetic to rotational didn't really depend. Kinetic to rotational didn't really depend on the aspect ratio in the previous results we found. So, our next step then was incorporating this into DSMC. And here we're plotting out, this is basically a scaled version of our translational energy. So, at a value of one, this is our, we set up a homogeneous gas or homogeneous granular gas, and we just initialized it. So, all the particles had some granularity. It so all the particles had some granular temperature and they were moving, but none of them were rotating. So, over time, as the particles collide, some of that translational energy would be dissipated because of the inelasticity, but also some of that energy will go into the rotational modes. So it's a little hard to see, but there are solid lines and then there are dashed lines. And the translational energy between our discrete element simulations and DSMC match pretty closely over time. So, this tau here, this is a non-dimensional time based on. Here, this is a non-dimensional time based on the collision time. So, after five or so collisions per particle, you're reaching an equipartition state. And then, if you look at the rotational energy here, it also goes to equipartition. And it's not quite as good agreement, but it's pretty close. So, going back, one of the whole motivations of this was to try to come up with a way that is going to be computational. With a way that is going to be computationally more efficient because doing the contact detection in DEM for non-spherical particles is just very expensive. So, what we did was just taking our kind of benchmark code and setting it so that our number of representative particles are equal to the number of real particles, just to try to keep an apples to apples comparison. But remember, in DSMC, you're free to change this parameter here so you can. Change this parameter here. So you could also reduce the computational cost by having fewer representative particles in your system. And we looked at how much time is required to perform a set number of collisions with 10,000 particles. And then we varied the aspect ratio in these cases. So as we increase the aspect ratio, the volume of the particles increases. So your concentration increases. So in our DEM simulations, it It didn't really depend on the concentration so much because our time step was already fixed based on just what the soft sphere collision time is or the stiffness of the particles. And in DSMC, as it becomes more concentrated, well, you're having more collisions to end up doing. So there's more selections and more can equations that you have to consider. So the computational time increased a little bit, but. Computational time increased a little bit, but in general, for this case where you're assimilating the same number of representatives as real molecules, computational time was about almost two orders of magnitude faster for just mildly elongated particles. And then as we get to very elongated particles, there's about an order of magnitude speed up on it. So I think there's some promise in this type of technique. But obviously, you have to take the next several steps and To take the next several steps and look at what the solid stresses are and the shear flows and things like that to further assess the validity. All right, so in conclusion, we have used kind of Monte Carlo methods, so the direct simulation Monte Carlo approach to look at modeling how applicable can this be to particle flow. So we try to overcome two of the limitations of traditional DSMC of extending it to dense. Of extending it to denser flows. And we've done this by using a modified metropolis algorithm or random walk. And we can recover the correct varial pressures, collisional pressures, and also prevent overpacking in those systems. And we've also applied this to shear flows, and the results we have excellent agreement with for shear flows as well. And then we took the SMC. Then we took DSMC and we tried to see how far we can push it for applying this to non-spherical particles. So we basically used DEM data to build probability distribution functions that we then feed into our Monte Carlo model. And then from that, then we don't have to do any of those micro scale contact detections and we just sample from the probability distributions to determine the Polish coefficiental states. And we're able to recover. And we're able to recover things like non-equilibrium between rotational and translational modes. But obviously, more work needs to be done to see if we can get the correct stresses and things like that. So the Monte Carlo methods, it shows promise in reducing the computational cost. And hopefully, some more work, we can start applying this to more realistic particle flows with complex shapes to larger scale systems. Scale systems and hopefully enable doing some validation with you know small-scale experiments and things like that. So, with that, thank you for your time and I'll take any questions. All right, thanks, Aaron. I'm not that familiar with DSMC, so maybe I'm asking some kind of pretty naive questions. The first question I have is related to the non-spherical particles, and the PDF scattering is similar to the spherical one. Is similar to the spherical one? Is that correct? Pretty similar to it. So these are just our aspect ratios. So the black line would be a spherical particle. And then as you elongate the particle, there's more forward scattering that you end up getting. That's just because the particles are the collisions are less head-on collisions and they can continue moving forward and retain their momentum. Okay, I see. Okay, I see. And do you consider the friction between particles when they're in contact or just the rebound? Yeah, so that's a good question about friction. In this case, there wasn't a frictional model included in this one, so there was no dissipation that way. No dissipation that way, there was just the normal component that was transferring energy into rotation. But the energy mostly just dissipated by that's right. But you could include friction and things like that, but then your distribution functions would probably change. So that's. I have a question. Yep. Hello. Hello. Hello. Hello. In fact, it is connected to this remark because when you have, for example, a non-spherical particle or ellipsoidal particle, the rotation around the axis of the particle is only transmitted by friction. The rotation along the other axis is transmitted by collision due to the irregular form of the particle. But the rotation But the rotation around the symmetry axis of the particle is due to friction. Yes. So it's a very peculiar behavior compared to classical redistribution mechanism from translation to rotation, for example. Do you have some justification? No, no, justification, not at all. Some insight. Some insight. For the moment, it's a very open question for me. So, do you have some insight how you can handle this effect, which is dissipative by nature, and that is taken into account as a redistribution effect by the Monte Carlo method? Yeah, I mean, it's so right now we're only including the two degrees of freedom, so we're assuming there's no rotation along the way. Okay, sorry, sorry, sorry. Okay, sorry, sorry, sorry. Yeah, um, but in principle, you could do that. You would just have to have a frictional model in DEM, and then you would measure basically your rotational energy. And the rotational energies and translational energies also in the, you know, your rotational energy in the different directions might also transfer at different rates. So I think it will end up becoming quite complicated because I think. End up becoming quite complicated because I think if you have friction, then the rate at which energy is transferred into the axial rotation might be different than the other rotational modes. Exactly. So I think, yeah, that's a very good question. I have to say that we have tried to analyze that, in particular, resolve simulation in very dense system on the Very danced system, and it's very complicated to maybe. Maybe a related question. It seems to me that these kinds of phenomena might be quite different if you went to the disk shape type and isoturby rather than, I guess, these are more like cylinders. So is that in the works? Is that of interest? Yeah, disc-shaped particles, we kind of veered away from that initially just because I think. Just because I think they tend to be, at least from some of the collaborators that do more of the non-spherical particles, said there's more issues with alignment that you get in those types of flows. So it's so there's another then, you know, question of correlation. Can you make these sort of molecular chaos assumptions in that case? So it's, yeah, this is. It's yeah, this is trying to start as simple as possible with this and then grow from there. How many particles did you want to use EVM to get your prominent distribution functions? Oh, it was at least millions. Adding friction would not really increase your what to look like that. No, the DEM is. No, the DEM is very quick. Actually, for when you're just doing two particles and you don't have to worry about anything else, those simulations end up being pretty quick to populate these distribution functions. So yeah, it could be done including those other physics, but then how you actually take those distribution functions and data and integrate that into the Monte Carlo, I think, is where the challenge will be. Thank you, Erin. So, our next speaker