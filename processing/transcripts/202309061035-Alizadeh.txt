Right, thank you. Hi, everyone. First of all, thanks the organizer for organizers for organizing this event. Hi, Ashok. Ashok was my PhD advisor. I graduated in 2018. I was supposed to be in person, but unfortunately I got sick. So here I am presenting remotely. Presenting remotely. Okay, let's. Do you see? Yeah, that's the full screen. We can see the full screen. Okay, perfect. Want to change the side panel? Is it okay now? It's okay. Yeah, it's fine. Okay, perfect. Okay, perfect. So today I will be talking about my work where I try to relate cell morphology and senescence. Obviously, this is a work in progress, but I wanted to give a quick update on what's going on. So my project is part of actually NIH's Common Founds Cellular Senescence. Um, cellular senescence network program. Our main goal is building an atlas of a cellular senescence in different organs in mice. We work with six primary tissues, placenta, pancreas, kidney, adipose, heart, and hypothalamus. Different researchers across the U.S. are part of this program and they work on different tissues and some. On different tissues, and some work on humans. But here, I will talk about my part of this program. So, here at JAX, we collect different data modalities. We work with spatial transcriptomics data. We have H and E image. We have this imaging mass spectrometry, and then we work with Codex. I have different colleagues that work on part of these modalities and Of these modalities, and my goal is actually glue together these modalities using image registration, and then also because everybody, all of these modalities have HNE image as well. So as you can see, I show here different tissues. And the reason is that we actually are two different cores we have. We are data analysis core, and there is biological analysis core at JAX, who will generate these. At JAX, who will generate these data, but we don't have the data set yet, so we work with whatever data that is available at JAX to develop our pipelines. And that's why you see a kidney here, there is a tonsil here, and then this is endometrium. But the main goal is to have this unique tissue with different modalities and try to glue together and find a marker for senescence. Senescents. Okay. I don't think it matters, but a part of my slide is not showing. So my talk is actually going to be two part where I use HNE image to calculate nuclei morphology, like area, elongation, perimeter, intensity of eosin or hemotoxilin. And then there's a second part where I will talk about use. Will talk about using special transcriptomics data, which is basically gene expression of different spots in the tissue to calculate senescence score based on those gene expression. And then the goal is correlate these two together. So, the data set that I'm using for now to develop my pipeline is generated by Elise, who is also. Narrated by Elise, who is also a JAX. This is derived from endometrium of individual with endometriosis. It's the eutochic region of endometriosis. These are fresh rosin samples. First, we use special transcriptomics analysis to calculate sentescent score. How do we do this? So we have this Visium slide where it has two or four capture areas. Each capture four capture areas. Each capture areas will have this barcoded spots which will be able to which has the barcode and then when RNA absorb which we can track back where those spots came from. So the tissue is culture is put on the slides with the capture area and then it's stained and imaged. And then it's stained and imaged. Then we permeabilize the tissue, and then the RNA releases and binds to this capture area. And then what happens is that the bar-coded cDNA is synthesized from these capture RNA. Then these are sequenced, and then since we have this information of where these Captured RNA came from, we can map them back where each spot came from. So here is one of the gene expression across the tissue, pair spot. EPCAM is epithelial marker, and as you can see, it has variation in this tissue. And then we'll have this information for about 19,000 genes here. And then we have. Here and then we have accompanying HNE image that we can look at the morphology of the nuclei. So the other thing that Elise actually did was using single cell analysis of this endometriosis data, and then she was able to see that there are five main cell types within this tissue, which is epithelial, lymphocytes, myeloid, endothelial, and estromal. Endothelial anastromol. And then she's recorded the marker genes for each of these cell types. What I did was using those marker genes to calculate each of these cell type markers, pair spots. And then as you can see, epiterial and stromal markers are very visible in these tissues. So we are actually trying to see, trying to identify senescence markers based on morphology. So morphological markers of senescence. So we need actually have some information about whether these spots have senescent cells or not. So what I did, I have used some new gene sets that have That has reported to be working better than previous gene sets as identifiers of senescent cells. Here is the table comparison. These are all SAS pathways, and then they report enrichment score between old and young human and mouse. And as you can see, that Sen male genes have higher enrichment score than. Score than the SAT pathways. So I will stick to this publication as using a score for my senescence spots. In this paper, they report nine different pathways of senescence with their marker genes. So I will plug these in these marker genes to predict a senescence score per pathway. Here are the results. Here are the results. As you can see, the protease inhibitors and metalloprotes have really obvious variation. Some of them, we don't see much variation, but like overall, we see some senescent cells in our tissue. So Elise, when I was confirming with Elise, she mentioned that the stromal spot should have higher senescence scores. So I wanted to validate that. So, I wanted to validate that using the Stromol score and metalloperitis score that I had. And it looks like we're good. So the second part of my talk is actually using HE image to calculate morphology features. I've done this for almost 10 years and I started it at Oshik's lab. It was really interesting and we were able to actually develop To actually develop good tools to do calculate morphology features. I'll go into detail of it in a bit, but my workflow is that I take HNE image and I segment the cells. And then here's the segmented, I will segment the nuclei. HNE image, the only the nuclei segmentation is valuable. Cell segmentation, I really honestly don't trust it. I really honestly don't trust it. So I just work with mostly nuclei segmentation. I split the channels into hemotoxylin and yucin using cell profiler. And then I use these three channels to quantify cell nuclei. So one of the questions that we usually have is that how many cells can be fit in a spot? And it looks like it's it rather. Looks like it varies a lot from tissue to tissue. Some people, I was always seeing 10, but like 10 cells per spot, but like in case of my data set, I'm seeing average of 25 per spot. And here you can see 25, but it can go up to 54. These are 50 micron spots. But how do we represent the shape of the cell or nuclei? So, as I said, I work with these four channels. I use some regular geometric features that you probably are familiar, area, primature, major axis, minor axis. Like I fit an ellipse, there will be elongation. Obviously, these are cells that are not HNA image. This is from again. This is from again from Pressal Lab. The other thing that actually I wanted to mention regarding the morphology was these two that I worked. These two back when I was in PhD were really different to me, to my eye. But then when I was using different morphology, Using different morphology features, for example, here, just those geometric features, they were overlapping a lot. And it was really bothering me because if you gave me these two, I will give you with 100% accuracy predict which cell they are. These are control cells. These are treated with cytd drug. So I spend a lot of time trying to find features that will separate these two. That will separate these two. Vinlong helped me a lot in Ashup's lab to actually come up with this feature that basically separate the cell into different bands and then calculates mean intensity per band and then also like calculating variation in the bands as another feature. These features help me to actually. Me to actually do this, to do this separation. Back then, Venlong actually wrote the code using some other articles. But then now, interestingly, Cell Profiler has added this feature. So it's easily accessible. I actually have the code online too, but like this one, you can actually add to your pipeline if you are working with Cell Profiler. This is one of the features I'm still using. The features I'm still using, and I'm trying to use every feature that I can and then filter out later on. The other features are the texture features that is based on gray on the GCLN metrics. So, what happens is that let's say this is your cell, and then what you do is that you define a direction. Let's say I direction and I direction and sorry, pixel apart and angle. Let's say I am one pixel apart and 45-degree angle. So, what I'm gonna do is that say I'm gonna say if I go from one pixel and then move in that direction, what the intensity changes. So, here, let's say the intensity changes from four to three. So, from four to three, I will add one pixel here. And then I will add how many pixels are in this and are in here. R in this and Rn here. And then the same here. So obviously, what happens is that, like, if I go from intensity of three to three, that means that I have homogeneous cells. So when the diagonal is big and large, that means that the cell is very homogeneous. When the variation in pixel intensity is a lot, that means that I don't. That means that I don't have homogenous cells. So there are many different features that I calculate based on this table, but just keep in mind that some of them are homogeneity and entropy and stuff like that. The other features are some stats, like integrated intensity, which is like some of the pixel intensities within an object, mean intensity. Intensities within an object, mean intensity, like standard deviation and intensity, and so on. As I said, there is, I don't trust cell segmentation because it's like I don't, there's not really clear boundary of cell in HNE image, but what I can do and trust is neighboring information. It looks like the neighboring factor is important in our data. Important in our data. So I use cell profiler to find the boundary of the cell. It's not accurate, but what is almost accurate is that how many neighbors will each cell have? And I use those information. So for example, this one has five neighbors and then 100% of the parameters and is in touch with other cells. That information is going to be useful. Information is going to be useful. This one of person touching is zero, neighbor number of neighbors is zero. This one is half percent is touching, and there's only two neighbors. So this information I also use, which is important to us. So here is what I have. So basically, HE image is divided into a hemotoxylin, eosin, and mask, and then I calculate some morphology features based on. Some morphology features based on those. And these are the Pearson correlation between features. And as you can see, there are a lot of features that are like lowly correlated, which is actually a good thing for us. We are trying to find features that are not correlated so that we are working with unique features. There is the red ones are in progress. This one I have never done, but I think the ESPN properties and the density. Properties and the density is very important and is correlated with Sun Asense. So, that one I will be adding. Irregularity, I have worked with before, but I'm trying to move to Python and then cell profiler. So, I'm trying to redevelop this irregularity feature, but I will talk about it in a moment. I think one of the talks yesterday, I think it was a skeleton, I think some of the talks. I think some of the talks that I saw might benefit from this feature that I will be talking about. Maybe it's a good thing. So I'm not using this data set and this feature yet, but I will add it just for the benefit of this talk. I wanted to add this. So basically, what happens is that this is boundary of myself. I open it and then try to fit full year series to it. And then so. And then so it's going to be basically a linear combination of different Fourier series with different frequency. And these amplitude, the magnitude of, a sum of magnitude of these are going to be rotation invariant value. And then I can use those as a descriptor of these shape. I really like this feature because it's a complete set. It's a complete set, and I can use those. I usually use 10 frequencies, and it's actually good rotation invariant and complete set if you want to describe a shape. Here, and then you can reconstruct those shapes using those moments. As you can see, the blue, maybe it's not clear, but the Blue, maybe it's not clear, but the blue boundary is my reconstruction based on 30 moments, I think, and then black is actually the cell boundary. So I think this might be useful for some of you. I actually have the quote online, but I've actually looked and see that some people are using it in some of the packages. We can talk about it more if you want. Talk about it more if you want offline. But then, what I do is that I actually subtract the original shape from the reconstructed boundary and then the remaining is actually the, I call it roughness measures, is the error of the fit basically. And there are different features that I can use to describe that error of fitting. So, this is the Pearson correlation between features, and as you can see, there are many. Features, and as you can see, there are many features that are not really highly correlated, so I can use them as a sort of complete set to describe the shapes that I have. So, I calculated 200 features per nuclei so far. And then what I do is that in a spot, as we talked about, we have a so sines and sport is per spot, but then a morphology is paired nuclei. So, to be able to connect these, I calculate. Connect these, I calculate the mean and standard deviation of each of these features in each spot for all the nucleus that fall in that spot. So I will have 400 features. So here comes to my part where, okay, I calculated nuclear morphology and then I calculated the nuclei, I calculated the senescent score. Then what is the correlation between these two? Actually, just to mention that, like UA. That, like, UA, one of my colleagues, is actually trying to go from this HE image directly, training the image and using machine learning to predict senescence score. But what my goal is here, trying to unbox this black box using these morphology features. So, I'm basically aiming for linear models or single features to identify as senescence. To identify a senescence marker. Here is the correlation between each of these features and each of these senescence markers and then the cell types. And as you can see, there are some features that are highly correlated with the Sen-MayO scores. Here is one of the features. It is intensity, those grayscale metrics that I talked about based on that, and then it's the correlation. On that, and then it's the correlation of the pixels, neighboring pixels. And as you can see, there is this high correlation. And actually, this is very big results for me. I've found one single morphology that is highly correlated with some gene expression data. This is something that it's usually hard to convince people that, like, morphology is very important for. Important for especially those biologists who work with this massive gene expression data that, like morphology itself, could be enough for predicting something. So, this was work in progress, and here's zooming in into some of these spots. I don't know if it's clear in the presentation or not, but like this line has. Like this line has the same intensity feature. So these are more homogeneous features. And then these ones in this line, these two spots have more porous structure in the nuclei, and then they look similar in their texture and texture value. Just wanted to point out some visualization of these features. So after doing all this morphology extraction, what I will try to do, first of all, I will add more features like irregularities that I talked about and then some BCM features, but I will also start with some linear and simple models to predict enrichment score from the morphology features. This grant This grant is written by Sean and Matt, and Brian is my manager who's been answering all my questions and attending all the meetings. Elise provided the data set. Antonius, Yue, and Miao, we are trying to glue together these three data sets. And then data was collected in the single cell biology lab with Bill Fillen. And that's it. And that's it. If you guys have any questions, I actually have a hard time hearing the questions. So, hopefully, it will be clear and I will be able to answer. So, I can't see. Can you hear me? Yes. So, I can't, you know, couldn't help but see you're trying that you're doing this reconstruction of these. Reconstruction of these sort of regular cell shapes with Fourier modes. The nice thing with Fourier is that it's like fast, fast compute it, and it works in a lot of general cases, but it's usually not the best thing to use in any particular case. And to me, this almost screams like a dictionary learning type problem where you take a bunch of cells of different types and you learn an over-complete dictionary, so larger than the size of the basis. Than the size of the bases, and then you can do sparse coding, and that would still give you like a sequence of numbers. Like, you could still talk about like the 10 largest modes, like the best way of representing each of your cells is like a linear combination of, say, 10 in the dictionary atoms or 15 or whatever that number ends up being. But it might actually be more meaningful. I mean, especially with these like non-differentiability, like non-differentiable points on the boundaries of some of the cell types. Some of the cell types and see if something like that might be more informative than trying to force 40 onto those types of boundaries. So you're saying that these, so you're talking about this reconstruction, right? So, like the more irregular it is, the harder it's going to be for a Fourier series to reconstruct. So, if you, instead of using a Fourier series, use a different sort of collection that's actually been trained on that particular kind of data types, then you could probably get a better reconstruction and actually have to use fewer. So, I think you said you're using about 30 here. You're using about 30 here, a Fourier, you're still having some issues, and maybe it could be like 10. If you run a dictionary learning algorithm, you only need a linear combination of 10 to get really good approximation. And maybe it's more informative about the structure. Yeah, correct. It definitely depends on the data set. And you can go as high as the number of pixels, but since we are comparing different cells, we have to go with the same. Go with the same number of terms and paraphrase. What I'm saying is, if you don't use Fourier, you use a trained dictionary, it's more likely that you will be able to have a similar level of sparsity that works across all the different cell types. Yeah. Okay, let's relate to this. You mentioned this is done in a rotationally invariant way. So can you comment more on that? Oh, can you comment more on that? Was that actually implemented? So the features, so do you mean why we are using rotation invariant? I think that there's a try, but how you actually achieve the variance? So this AN and BN value will depend on where you cut this. Cut the cell cell boundary, right? Yeah, so that is not impairance. If you rotate your cell, the coefficients are going to be different. Yeah, if you rotate or if you cut in different place, it depends on where you open your cell, right? So these are going to be different values, but their A n squared plus B n squared will remain the same. Oh, so you're using spectral energy coefficients? Spectral energy coefficients, correct? Yeah, so our group is also doing a pretty similar thing here. We use a separate analytic basis to fit the cell shapes. So when we deal with the rotation EPCU actually, we did another post-processing stack. We try to align the cells by their major and the minor axis. So that will eliminate the degree of images. Outro images. And regarding the previous point on the dictionary building, I guess the point here is that there's always no 3.0. There's a IS process variable. So if you just focus more on a particular state set using the correct learning domain of the generalized components. Right, so you've got different sell-ups. Right, but if you train on like a diverse deal, but that helps us. Yeah, yeah, okay. One more question? Sorry, I'm not yet. So my question will be about your feature discrete. So I was a little confused. Did you segment individual cells? Because it looked like the bibe masks was just. Just I was a little confused about that. And then the other question I had was: how do you relate the single cell to your spots again? Did you just average the spots?