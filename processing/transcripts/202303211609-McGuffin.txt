And I did this work in my PhD at Carnegie Mellon with my advisors, Eric, who is in the CAPD Center, and then Peter Adams, who is in this Center for Addisburg Particle Studies. And I want to thank the organizers for having me. It's been really great so far. So yeah, as he said, my title is Using Process Control. So Eric is expertise in passivity-based control theory. Compassivity-based control theory, and I used this and applied it to atmospheric inverse problems. And so, specifically, I want to show the first kind of proof of concept, which was with the estimating sea spray emissions. So, just to kind of ground anybody who's not already familiar with aerosol, this is one of my favorite diagrams from NASA's Assimilation Office. Says Assimilation Office, and it just kind of shows a day with the aerosol field that's from AOD aerosol optical depth measurements. And you can see the different types of aerosol here. So you have soot or black carbon from wildfires or combustion sources. And then you also have desert dust. And then finally, the sea salt, aerosol, which comes from these different storms. Comes from these different storms, but also just from sea spray from breaking waves. And so these, this is just to show that sea spray is important to understand. And aerosols are generally, we want to understand them because the different types of aerosol can have different effects on your climate. So you see that black carbon ends up warming because of its absorbing power, whereas the sea salt and dust are more scattering, so they can actually have a cooling effect. Have a cooling effect. And so that's just shown here with an old IPCC report where they estimated this radiative forcing due to the aerosol and also all of the other constituents. But I'm just showing aerosol here because if we look at, we reference a CO2, which has a big warming effect. The aerosol has, in general, a cooling effect, but the uncertainty is big. Uncertainty is bigger than its cooling effect actually. So a lot of this total uncertainty in our climate model, radiative forcing estimate, comes from this aerosol radiative direct or indirect effects. And so hopefully by understanding these sea spray emissions and other aerosol processes, we can better constrain climate change. And so the way we're doing And so, the way we're doing this in this work is with the chemical transport model, GEOSCHEM. And this is my kind of simple cartoon of the chemical transport model where you have a bunch of different sources and then you also have atmospheric chemistry, dispersion, and transport, and then you have aerosol processes that it's resolving in a bunch of grid cells. It's driven by meteorology, so it takes in that as an input along with initial conditions. With initial conditions as well as your emissions data, and then predicts like three-dimensional maps of different pollutants that vary over time. And so for this work, GeosChem was driven by Meritoo, and we used this online aerosol algorithm called TOMOS. And just kind of some background on the aerosol portion of this model. So for soot or So, for soot or organic carbon emissions, those are generally from the emission fields input. But for dust and sea salt, those are actually calculated online based off your wind fields. And so the sea spray aerosol parameterization, it takes the wind speed at 10 meter altitude and puts it to the power of 3.4, and that's approximately how much is emitted. The issue with this parameterization is that it Parameterization is that it is based on some breaking wave theory, but it was an empirical relationship based off of measurements taken off the Hawaiian coast. And so you can imagine extrapolating this across the globe, you might not get the right emission estimates when you're looking at other regions. Okay, so for this case, what we want to do is use satellite measurements, and so the Satellite measurements, and so the particular measurements I'm going to look at are these aerosol optical depth measurements, which you can see are pretty sparse because you have certain swaths that you're covering and then you also have clouds that you can't see through. But this is just one day where you can see what this MODIS satellite measured for aerosol optical depth. So, using these satellite measurements, our new model, the inverse model, will take in the original inputs, but it will also take the satellite measurements into its estimator, which applies a scaling factor to the sea spray emissions in the model. And then, out of this, we'll not only get our estimated sea salt aerosol concentration, which should be closer to the measured AOD. To the measured AOD, but also the estimate of emissions. And that's kind of our goal. Okay, so some background, I guess, which has already been covered a lot in this workshop, so I'll try to go quickly, but just to highlight kind of the way I think of this in terms of a block diagram and also the challenges in the current approaches to defining this estimator. Estimator. So this estimator will take in your model observation bias and be able to estimate your unknown input to your model. In our case, it's a scaling factor for sea spray emissions. And so common methods, which we heard about a lot, are based off of least square minimization. And so kind of like one of the, at the two ends of the spectrum, we have a column and filter, which is We have a Kalman filter which is analytical. And so the challenge here is that it simplifies a lot of your nice complex atmospheric model into this parameter K. On the other end of the spectrum, you can have an adjoint model which calculates that Jacobian online and then iteratively or numerically solves for your maximum up posteriority using something like 40. Posterior using something like 40 bar. And so you have a nice function that's calculated for the sensitivity of your unknown input to your model error. But the challenge here is that it's expensive. This adjoint can be on a similar scale to your original model. And also, it's also quite a lot of work to create the adjoint itself. And so if you're making updates to your model, You're making updates to your model, your app joint could become obsolete. And so instead of these approaches, this work was looking at a passivity-based control theory, which is using something called an input observer. And so you'll see a big challenge here is that you need to know the derivative of your measured value, which can be difficult, but it's not a huge. But it's not a huge setback because there are ways to differentiate noisy signals and measurements. So the passivity-based input observer, or PBIO, is what we called it. And it's just based off of kind of a subsystem of your complicated atmospheric model, which predicts your entire state space of X, which are the different Which are the different concentration fields. And so we can kind of project that onto a smaller subspace of inventory variables that we choose, Z. And we can just write down those dynamics here where we separated out the uncertain from the more certain dynamics. So in this case, the G is going to be the uncertain process, which is the sea spray emissions that we want to estimate. That we want to estimate, and we scale it by our input that we're estimating, which is the scaling factor μ. And then all the rest of the dynamics, which is going to be all the transport, deposition, chemistry that's affecting our set of inventory variables is F. And then kind of going forward with this control theory idea where you have your system dynamics and then you have your outputs. Our outputs are just going to be the inventory variable itself. The inventory variable itself, as well as the rate of change of that inventory variable. And so we can define our error as just the difference between our model and our observations for both of these outputs. So as I said, the error rate of change is going to be that deviation in our second output. So we need to know the derivative of our observations, which is Observations, which is so for this case, we're going to use an inventory variable of just dry aerosol mass. And so we have an observed dry aerosol mass and the rate of change of that here. And so in this case, instead of using the kind of common approach of minimizing your model error, we're going to take an approach that we want to converge that model error to zero. Model error to zero, and so we want to just find input parameter mu that decreases that error. So, what we end up doing is just forcing the error to exponentially decay. And so, if we set up this kind of control law where the error rate of change is negatively proportional to the error, and we have this tuning parameter, k, which is kind of like a gain, and actually, this has. Actually, this has units of 1 over time, and so we can actually think of it as convergence time scale in terms of its convergence time scale. And so, all we have to do is kind of plug in the definitions of the error rate of change and the error into here. And we end up getting a pretty simple system of linear equations. So we have our model dynamics, our observation net derivative, and then we have our model bias. And then we have our model bias or model error. And we can just directly solve this for our parameter scaling factors μ, and we get something like this. It's just a system of linear equations. And so to go back to kind of what we found in the previous methods available, this method kind of satisfies those challenges that I pointed out in that it's just a set of linear equations, so it's efficient computationally. Computationally, and we didn't simplify any of the model equations in doing this. We are kind of focusing on a subsystem of the atmospheric model, so that's so that we're not considering the entire state, but we're not simplifying any of it. And then also we would be pretty independent of model updates because you can calculate these F and G terms in your dynamics with like online methods just by doing a differencing. Doing a differencing between time steps. So, going applying this to our sea spray problem, we're using our measurement of aerosol optical depth and using a pretty crude estimate of an inventory variable we've chosen, which is the aerosol dry mass, which is just according to the mass extinction coefficient and the surface area. And the surface area that the satellite is observing over. And then we can use that in our input observer along with the current estimate of the concentration fields to update the sea spray emissions in Geoskim. And to kind of show why we need to do this, I guess, this is an example output from GS. Output from GSChem of the sea salt concentration near the surface. And you can see over the southern ocean band, the concentration of sea salt is significantly higher than anywhere else. This is because you have really high winds in the Southern Ocean band, and so it's elevated because of that parameterization that goes to the wind to the power of three. And so we're specifically going to apply our PG. Going to apply our PBIO estimator to this southern ocean band region, taking in measurements of AOD and adapting the sea spray over there. And I also should mention this is 4x5 degree resolution, so it's pretty coarse. And the measurements were daily AOD. So this is the results of this first application. This first application, where you can see, if we look at the measured AOD in black, it has this pretty low trend, and it also is decreasing during June, the winter time in the southern hemisphere, and increasing in the other time. Whereas the original model has a pretty opposite trend if you assume this calculation for AOD based off the mass extension. IOD based off the mass extinction coefficient using the dry aerosol mass. And so we apply our online observers to estimate the, to scale the sea spray, and we get a new estimate of the AOD closer to the metric value. And this is just proving that the algorithm does work. It does get you convert you to those measured values that you're inputting. And then we can also look at the full. And then we can also look at the full kind of model output over a particular month. And so this is over October of 2010, and this is the total column dry aerosol mass concentration. And you just see that in the Southern Ocean band, we had a very high value, but with the scaling factor applied, we basically decreased the sea spray emissions significantly. And so that's really the only thing that changed between the two. And so, investigating this a little further, we looked at the scaling factor that was estimated and applied in the model. And that's shown in this blue time series, which varies around a factor of 0.5. So, we're actually reducing sea spray emissions by about a factor of two. And the nice thing here is that we did the Here is that we did this quite a long time ago in version 9 of GeosChem. And so in version 10, there was an update with this Yagli correction with ship-based measurements of sea spray flux. And they have a correction which is due to the sea surface temperature that was implemented. And our correction is pretty similar to theirs in terms of magnitude and seasonal trend is pretty similar, but there are some. Is pretty similar, but there are some differences between them. This empirical correction for sea surface temperature was based off measurements that went, I looked at it going into the Southern Ocean band for maybe like two hours of the entire field campaign. And so it may not be the perfect correction for this region, but it does highlight. But it does highlight that some of these corrections we're making could be due to the temperature in the Southern Ocean Band being so different from the temperature in Hawaii, which is where the parameterizations was created for. So that's kind of the summary, all I wanted to say. So in summary, I showed this formulation of a passivity-based input observer for atmospheric inverse modeling. Modeling, and we were able to recover, somewhat recover this model update that ended up occurring later. I just listed some thoughts that could improve this better that we didn't really get a chance to look into. The conversion from AOD to dry aerosol mass was pretty crude, and so if we were to use like a radiative transfer calculation instead of a constant extinction coefficient, that could improve our results. That could improve our results. And we should probably investigate other uncertainties in the model besides just sea spray emissions, so transport or deposition velocity differences. And also, as you saw in the AOD picture, it doesn't cover the Southern Ocean band that well. And so, if we had more data, then we could even get better results. And then finally, this kind of method. Finally, this kind of method that I showed the equations for is very generalizable. You just need to choose the right inventory variable for the parameter or state you want to estimate. And it provides a way to do inverse modeling with minimal computational effort. So I think that's all I have. So thank you for your attention, and I'd be happy to take any questions. Are there any questions for Bradina? Optimal control approach computationally feasible? Yeah. So it's really just that, it's just a set of linear equations, and it's the size of your subspace, your set of inventory variables. Variables. So, yeah, I go back so if you're just solving this set of linear equations, it's really quick. Quick. So there, yeah. The dimensions. So in this case, I Dimensions. So, in this case, I used six sections over the Southern Ocean band, and so there were only six parameters and six measurements. So, it was just a six by six system that I solved. I did apply this in other problems and found some numerical issues. If you get an ill-conditioned system, it doesn't really cause you more computational effort, but it does provide you with bad solutions. You with bad solutions. I think the one thing that's probably hidden is you do need to know the sensitivity, this G array, of your subsystem or inventory variables to your uncertain parameters. And so that could take extra time because you kind of have to call those routines in order to determine that sensitivity. So basically, how much would the sea spray emissions be? Would the sea spray emissions be at this time? But yeah, it's really, it didn't add any computational effort when I did this problem. Maybe in other more complicated problems, it'll. Do you also recommend this to upscale this to a global data assimilation system? Um, whatever. Can we do it? So the problem I'm running into with it is I'm running into with it that this it works really well if your only set of uncertainties are in this mu. And so if you have other model errors, then it's going to correct for those in your scaling factors. And it may not be able to converge very well. So I guess it depends. I mean, if you're talking about just scaling it to If you're talking about just scaling it to higher dimensions, then yes, I think it would be fine. But its performance may not be very well when you have all these other sources of uncertainty. Questions for Jenna? Sorry. I think I'm losing power. So I do have one question for you. So is it fair to say that what you're trying to do here is to get Trying to do here is to get a correction to the C-spray that arises because we're currently seeing the wind view at all. Is that it? No, I would say that we're saying that the, I mean, it could be from the window, it could be from anything, but we're saying, like, if we have this parameterization for sea spray emissions that is kind of like a Emissions that is kind of like a lot of parameters times wind to the 3.4. What if there should be temperature or salinity or something else included there? Then we can include that in our we can estimate that in our scaling factor. And I think if we were to compare with other variables, we could get some correlations out. And the parameterization in GS. And the parameterization in GSChem for this is based on. So, what are the met variables? There's temperature. Yeah, so in this one, the original model was just wind. It was corrected later to include C surface temperature. Thank you. 