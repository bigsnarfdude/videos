He is a postdoc and is now at the Safama Medical University. The models that we cut our teeth on when we learned about population genetics, selection, and drift typically focus on either haploid populations or fifth-wide populations. And even if they were sexual, they kind of ignored the other phase, assuming that selection and drift was just irrelevant in the other phase. But of course, many organisms undergo development and selection in both phases. In both phases. This is commonly true in algae and fungi, many protists. And so this talk is about how do we incorporate selection and drift in both phases into our population genetics models. And particularly this talk is going to be about the kind of building up the population genetics theory regarding drift that has been ignored in previous. Okay, and it started because Besho came and we were doing something else. Because Becho came and we were doing something else. We were modeling spatially structured models and Floyd, and he's like, oh, so Sally, what is, I need the fixation probability. What is it? Oh, that's going to be easy. It's going to be similar to, maybe it's not. What? You know, maybe it's going to be similar to the sex chromosomes with two X's and an X in the male, and maybe. But we're like, okay, well, I bet I worked it out. So, I'm going to walk us through a series of stories. The first one is about a species with a strict alternation of generations, where it really is cycling sexually in every generation. We'll talk about asexuality later. And we're going to look through quickly what happens in the birth-death model, the Maran model, Wright-Fisher model. You're going to assume a constant population size. That's a whole population, the composition of it. Population. The composition of it will depend on the fitnesses of the types. We're going to solve for the fixation probability using branching processes and diffusion approximations because they all kind of tell us a little bit different kinds of things that I think are interested in. Okay, so first of all, how are we even going to measure the allele frequency in this population? You might think that that's obvious, but I'm just going to let you in your head decide what's the allele frequency. What's the allele frequency when you have this alternative engineer? Do you count the number of alleles of both? You know, that depends on the population size of each. Do you double it for diploids? And how do you even decide what the natural allele frequency is? What's the effective population size? How do you average selection going on, that kind of thing? So let's start with the Moran model. That's birth-death model. We've heard about it many times. So there's only, it's a little bit of So there's only it's a little bit of a tweak because you have deaths in both diploids and in haploids, births in both haploids and diploids. You randomly choose an individual to die, randomly replace it with a birth weighted by their death and birth probabilities. There's a little bit of finesse, which I'm not going to talk about now, that has to do with, you know, if it's diploid making a haploid spore, doesn't have to be fertilized. If it's a haploid making gametes, they have to be fertilized. Making gametes that have to be fertilized, and that could also come with a cost, cost of sex. So the population size constraint is on the sum, the number of haploids and haploids. Total population space. And that's held constant. I'd say a word like what? I would have thought. Number of space. So space is basically being inhabited by this algae. There's only so many spots. It actually doesn't matter, and we did look at ones that were waxed up, but. Ones that relax a lot, but for reasons that will become obvious later. So, when the mutant gene is absent, the resident population approaches an equilibrium, and that, depending on all these birth and death rates, where we have a haploid population size and a diploid population size. And then, that's why it doesn't really matter because if you had an ecological model that would acryloibrate, you can just calculate that with kind of care any puzzle. And then. And then we introduce mutations. The notation is going to be: if it's got one subscript letter and it's a haploid, there's a mutant, there's a resident allele, it's got two, it's a diploid, so this is a homozygotic mutant, a heterozygote mutant. And then we can interpret those changes in birth rates or death rates in terms of these selection coefficients and dominance coefficients. So it's in terms that are kind of more natural to us, H and S, that we are familiar with. All right. All right. So, how do you do the standard fixation probability calculation for an example? With a branching process, you work through the logic like you do in all of these branching process models, but I'll just tell you how that works. You haven't seen it. So I'm going to actually focus on pi, the probability of loss, which is one minus the probability of fixation. And it happens in a population where it either happens in a haploid. Either happens in a haploid, it arises, there's none of it, and then it arises in a haploid, or it's a single copy in a diploid individual. So if it's going to be lost, we have to think through what are all the possible birth-death events that could happen. If the first thing that happens is that the mutin allele dies, then you know it's going to be lost, and with that probability, you've lost. But if somebody else, like one of Like one of the resident haploid or the resonant diploid is the first one to die, and it's not replaced by this mutant. Then you're just back to where you were starting. And then you have these other terms that have to do with, well, actually, somebody else could have died and the mutant was the one that reproduced. And so now you have one copy of the half-boid, that parent, that did not die, and it gave rise to a kid, and that kid's in the other ploy face, the half-boid mix. Other floidy things that happen. It's a diploma. You do the same thing for diplomacs. You have two equations and there's two unknowns, and you solve for the fixation probability. You have to account, and then if you want the fixation probability overall, you have to say, well, the mutation could have risen by chance in a haploid population or a diploid population. So you would just weight that by the number of targets that mutation could hit. So, with weak selection and a little bit of massaging, we'll come back and talk about this term later. But you get something like a term that depends on the population dynamics times this average selection coefficient. And kind of the first thing to note is that it comes out of this model that it's really the average or the sum of the selection coefficients and the half. Of the selection coefficients in the haploid phase and in the dipole phase that matters. So it doesn't, it's not weighting them by the population sizes or anything, it's just the sum of those. So what if the populations aren't large, because that assumed the branching process where it was large, then diffusion is typically how we solve these models. But diffusion models are quite limited if you don't have a single variable. If you have a single variable P, you're A single variable P, you're in a good position. But if you have multiple variables like we do here, where we have some global average allele frequency, we have the difference in gene frequency between haploids and diploids, the departure from Hardy-Weinberg, as well as a fraction of haploids in the population, which is also dynamically changing. How are we going to proceed? And again, I don't even know how to start because I'm not sure which inference is. So here's the trick that we try and do. We try and find a separation of variables that separates the variables. And we want fast ecological processes like the population region and dynamic equilibrium, and then slow processes that involve selection is weak, and that selection and only selection is driving the change in allele. So if we measure the allele, If we measure the allele frequency, say, by weighting it by the number of the frequency in haploids, weighted by the fraction of the population that's haploid or the fraction of alleles that's haploid, you can't separate the time scales. Turns out that changes in the allele frequency depend on slow ecological changes, particularly in the allele frequency difference between alkaloids and diploids. You can't separate. And there's only one weighting that allows the separation. That allows the separation to proceed. And that weighting is this one: where we weight the allele frequencies in haploids and diploids basically by the amount of time, the longevity, in the haploid and the diploid phase. If they have equal death rates, let's focus on that for a second, then it's just half and half. Half the allele frequency in haploids, half the allele frequency, doesn't matter what the population size. It doesn't matter what the population cycles are. Did anybody have that in the back of their head? Good. It's actually a surprisingly oddly hard question. And I think it needed math to help us through. And in hindsight, oh, we probably all should have figured this out. This is one of those things, like in hindsight, yeah, obvious. But if you go think backwards in time, the alleles are spending half the time in haploids and in diploids. If they have different longevity, it's a little bit longer, the two. Longevity is a little bit longer, the two, and they have actually higher class reproductive values, they spend more time in one phase and this work. That feels like Mark's average. Right? That's how much time you look at an allele. Yeah. It's half and half. It's half and half. Yep. It gets, there's a little bit more complexity later. But yes, exactly. We have to know what fraction of the population of births are happening in each age class, in each voiding class. So, when with this and only this allele frequency waiting, then changes in the allele frequency are only proportional selection. Selection's gone, no change in allele frequency. That's not true of the others. Where changes in delta can drive changes in P. And now, once we have a single equation for changes in P that depend on the selection, we're back to the diffusion world. Back to the diffusion world, where we can calculate when there's the sampling of the population in this Wright-Fisher model. We can calculate the mean allele frequency change and the variance in allele frequency change through that sampling process and plug it in. We could get the, once that we had that, we could get the probability of fixation, which is I'm showing here, but everything else, we wanted the probability. We wanted the time to fixation or conditional time to fixation. All of those other things are now possible because of the separation of time scales. And with weak selection, this reduces to a kind of standard form, but we have to define what is the effective selection coefficient of this model, what is the effective dominance, and also what is the effect of population size. And I should say. And I should say a few things. If there's no dominance, then this again depends on a selection coefficient that is the 2 means it's actually summing rather than s, which was averaging. So basically summing the selection phases. And the other thing to say is any has to be defined relative to a reference. And just for this talk, I'm defining it as if it was a Wright-Fisher model that's different. So that the Moran model being The Moran model, I'm being, I'm comparing everything to that same standard when I'm defining any. Okay, and this is just saying simulations confirm that we haven't gone crazy, crazy wrong. The branching process worked well with strong selection, as we would expect. With weak selection or negative deleterious alleles, the diffusion works well. And it works well even in surprisingly small populations, which has always been a remarkable aspect of diffusion. Aspect of the patient. So now I'm going to turn to the Wright-Fisher model. That was all birth-death, Wright-Fisher model. I might have misspoken before. This is the first time we've seen Wright-Fisher model. Where everybody dies, and then the population is reseeded in proportion to the fitnesses of the haploids and the diploids in the population. For branching processes. For branching process, you can do the fixed. Everybody dies at the end of each phase. Yeah. No longevity. No overlapping generation. So how Haldane derived this fixation probability was assuming the population size was large enough that that multinomial sampling is approximately Poisson. So your chance of dying is a chance of having k kids, and then all k of those kids independently have to die. Independently have to die. But they're all, if the mutant appears in a haploid, all the kids. If the mutant appears in a diploid, all the kids. And these can be solved, these sums, and approximated with weak selection to give us a fixation probability for the right Fisher model. It's double for that. So you can probably memorize it, I'm sure, from before. And it's basically twofold higher than what we're doing. And it's basically twofold higher than what we saw with the Moran model. And that's typically the case, that the Wright-Fisher model gives you twice the fixation problem. It's easier to establish if the whole population is erase at once. And the way I like to think about that is that in the Wright-Fisher model, there's only the birth so stochastic. Everybody dies. Whereas in the morale model, there's kind of two stochastic aspects in the choice of the birth and then the choice of the death. I'm not sure if that's a good way, but that's how I. I'm not sure if that's a good way, but that's how I. It's typically the case that the right pressure model has less variance in lead-up to success and a higher expression probability. So again, we might ask, how do we do the diffusion? What's the natural allele frequency? Is it the same allele frequency? Or what do we have to use here? And it turns out again that we can only get separation of time scales. Ecology is not going to cause changes. The allele frequency only... An allele frequency only in these flow dynamics, only if we take half of the allele frequency here and half of the allele frequency there, regardless of how many individuals are there. And again, we can get a fixation probability and under weak selection, reduce it to these same quantities: an affected population size, and a slight. Population size and a selection and dominance coefficient. So basically, these are saying things like the selection and dominance coefficient have to describe the diffusion, the mean diffusion, when the alleles are rare or when they are common that matches what we would have seen in the reference right-fisher population. That's what I mean by an effective dominance coefficient. It's the same properties. So that if you substituted these in into the Ziploid-Wright-Fisher model. These in into the diploid-Wright-Fisher model, you'd get exactly the same diffusion. And it works. So, let me do a few comparisons, and I think some interesting insights. This is for the Moran model, this is for the Wright-Fisher model, diffusion, branching, and the weak selection approximation. And first of all, these are just rescales. So, this is, they're all divided by S, but this fixation probability is approximately 1. Probability is approximately 1s in the Moran model, 2s in the Deployed model. But that's kind of not the most interesting aspect. The most interesting aspect of this is that the fixation probability becomes really, really low if the population is predominantly haploid or predominantly diploid. If there is a phase that's super reproductive and making lots and lots of babies, you'll actually have a lot of the other phase. But very few of the highly reproductive. Very few of the highly reproductive phase. And that means that drift will be very strong in their rare phase, which makes sense. The other aspect is you could ask, when is drift minimized? And it would be minimized. This axis is the frequency of haploids in the population. It's minimized if two-thirds of the population is haploid. And that kind of makes sense because then you have equal numbers of chromosomes. And you have equal numbers of chromosomes in the two phases, and the kind of strength of drift is similar into two phases. Here's a comparison. So going back to, this will be easy. It'll just be like the excellent case. It's not. The NE is not the same. Dynamics are not the same. And this is just calculating what the NE is as a fraction of haploids in this model. Of haploids in this model or of males. And the sex link case is blue, autosomal case, but where you have separate males and females in black. And then this haploid diploid case. So it is unlike the other cases, and that's because in this model, diploids have to give rise to haploids, haploids have to give rise to diploids. That's not true in the absolute case. An XY male can give rise to daughters and sons. So you just don't have. Daughters and sons. So you just don't have the same kind of cycling through the plugin phases. I don't know if this is helpful or not, but this is another way I was thinking about it, is that in some ways it's interesting because drift is effectively less in haploids because when you're sampling two alleles and the diploids that descend from them, whereas haploids are not as well sampling the diploid parent. And so having more haploids. Having more haploids is actually increasing the effect of population size. That's maybe one way to think about it. Whereas in the sex-link case, it's the opposite direction. You want fewer males to maximize the affected population size, and that's because the females are carrying two exits. So it goes in opposite direction. One other comment I mentioned is briefly again is that the ignoring of fertility slope. Ignoring the fertility selection, it's really the total amount of selection in the two phases that determines the speed of adaptation. And this is with dominance. All right, so just a few other notes. That was a strict alternation of generations. Actually, most algae and fungi are capable of asexual reproduction, like we were just discussing. And so we added asexual reproduction. And so we added asexual reproduction into this model, and you still get this kind of one and only one weighting of the allele frequency leads to a separation of time scales, but now they are weighted by the class reproductive value. What fraction of the population will descend from the haploid class today or from the diploid class today? This is consistent with all of the other models that I've just shown because if they're either If they're equally long-lived, then that's 50-50. If they differ in longevity, then more of them will descend from the more long-lived. Okay. So this is kind of good and kind of bad. I mean, it's nice that we can generalize it. Everything, the allele frequency, N, E, S, and H now depend on the class reproductive values. This is a little bit. Value. This is a little bit problematic because we're not going to know the class reproductive value in order to get the right allele frequency. So, unless they're kind of similar in haploids and diploids, it actually kind of raises this challenge for knowing what the right P is. And if you don't know the right P, then you may mistakenly attribute to selection what differences between haploid and diploids are doing. Between haploid and diploids are doing. I think I'll skip that. This is just results as you change the amount of haploids asexuality. And I think the key thing is if your allele is favored because it does something in haploids, the more haploid asexuality you have, the higher the fixation probability. If it's doing, if its benefit is in the diploid phase or more than the diploid phase, it's the opposite. That makes sense. All right. All right. So there's another aspect that we thought about when we were doing this, and that was kind of inspired by some work that Mark Kirkpatrick and others were doing about the FST between the sex chromosomes. We were wondering, well, maybe we can use FST between haploids and diploids in order to estimate the amount of sex that's going on in this population. If it's really, really well mixed, we're not going to have much FST, but if it's really low, But if it's really low, then maybe we can estimate it. So that's what we looked at, and this is the work we were just doing recently. And we used Rousseau's measure of FST, which is an identity by descent measure. And it asks, how identical by descent are two alleles if you happen to sample them from either the haploid population, but they're both from the haploid, or both from the diploid population, relative. Relative to if you sample from the different employee phases. I mean, that we calculated, and following Rousseau et al. in the limit of no mutation, you get an FST measure. That's the FST measure based on this. 95%. And in the case where there's not much sex, so this is when you expect FST to be hottest, right? This is the best case. Highest, right? This is the best case scenario for estimating the numbers of sex because they're not well mixed yet. Then you can estimate the number of migrants effectively from diploids to haploids, let's say amount of sex in the diploid phase, or from haploids to diploids, using these SST measures and haploids and diploids. And now you don't need the class reproductive values, which is nice, but you don't know. You do need, the other thing you do need is a fraction of. The other thing you do need is a fraction of individuals that are halfway, but that's measurable. And this is just simulations to show that you can get a rough estimate of how much sex is happening. In this case, so this is NM, the number of migrants. This is one, just different simulations with roughly one sexual event in the population in each direction, each gender. The population in each direction, each generation. This is the amount of sex from diploids to haploids, haploids to diploids, and the average. This is what the equations I just showed you. In the simulations, we couldn't have really small mutation rates, so there's a correction for the mutation rates not being that small. We would have had to have a bigger simulation in order to get realistic small mutation rates. So anyway, I think it's going to be a noisy measure. Don't expect to have a lot of precision in your estimate of the value. Precision in your estimate of the amount of sex, but certainly order of normality. So I think I'll stop there. You mentioned the, like, you're thinking about what is this like in the X chromosome? I mean, while you're talking here, we thought of that kind of haplodiploid systems, and then you have the, I guess it's somewhat the X chromosome. I guess it's some of the X chromosome. That's exactly like that sex chromosome. Yeah, so if you're thinking of Hymenoptera or things like that, then it's like the whole genome is either XX females or XY males. Right, and you have an alternation that happens every two generations rather than one generation. Right, like the sort of, but like the female to male, like diploid to haploid back to diploid or diploid, but you got the different. No, no, because like in each generation, a female can give rise to. Each generation, a female can give rise to a female. Yeah, so it's not quite the same. Yeah, it's one of these, like it should have been the same thing. Do you get like an allele that really specializes in eating haploids or diploids or something? Yeah, I took those out, but if you have ploidally antagonistic selection, you can maintain a polymorphism here. Just like you can with sexually antagonistic selection. Thank both Seffie and Mark. So