I also would like to announce Al because he was there to hack and wrangle the data for this hackathon. So for all the speakers, I have the squeaky pig and I will do this after 10 minutes. So when you have five minutes left and then when you have two minutes left. Okay, go for it, Darren. Hi, thanks. Hi, thanks everyone for joining. I'll be presenting on the SCNMTC challenge and just go over my thought process when preparing these data sets and also be talking about a multimodal integration that we did with feature selection using a method called projection to latent structures. So, just to give a bit of biological background. Biological background. Here we see a simple schematic of early stage mass development during gastrulation when germline cells are being formed. So on the left, we're looking at the early stage and on the right at the late stage. Basically, this is the time where the structure of the embryo is being formed with the formation of primitive streak. Primitive streak and then later on, so this is called the bilaminar disc of epiblast and hypoblast. So, what happens is first the epiblast cells kind of invade and replace the hypoblast layer with endoderm cells, which is the first germline layer being formed. And then later on in the invaginated cavity created over here, the mesoderm cells are formed. And then, as Oliver was As Oliver was discussing, the ectoderm cells are kind of the default path for whatever's left from the Epiblast cells. So obviously, you know, we start with the same genome and the classic question is what are the underlying mechanisms that lead to these different cell type specifications? And in specific, over here, we're interested in looking at. Over here, we're interested in looking at these coordinated changes across these modalities that kind of co-vary with the transcriptome. Now, to look more specifically into this published data set as provided by Ricard. So, this is a picture from the publication. So, we're looking at the stages. Looking at the stages and various cell types that have been profiled from multiple mice embryo. The single cells have been profiled using a CNMT-seq protocol, which Oliver was talking about and you're familiar with. So the measurements are on transcriptome, DNA methylation, and DNA chromatin accessibility. And we can see a breakdown of the number of embryonic cells in each stage and putative lineage. Lineage. For RNA data, we only use just the batch corrected and log-normalized counts. And we looked at the cells that were matching across modalities only and those which could have been successfully assigned to a lineage, which totaled to 815 cells. Now, just a brief look at the transcriptome. This is a This is a UMAP of, so yeah, UMAP is basically a non-linear dimension reduction method which does a local embedding and using manifold learning. And we're looking at the third and fourth dimensions. We can see that a separation by stages. So basically, the early stage cells are sitting separately from the other ones, which shows they're transcriptionally, they should be pretty. Transcriptionally, they should be pretty distinct transcriptionally, and we can see that the mid-stage cells are kind of also sitting on the edges of this manifold. And in the middle, we can see the later stage cells. Now, if we color them by the putative lineages, we start to see this transition. This transition from early stage endoderm and then to endoderm and then mesoderm cells. But it is obviously it is not a discovery, it's not a champagne moment because the lineages that have been assigned have used transcriptome data to be assigned. So this is more like a more of a checkup kind of stage. Now, looking over at Now, looking over at the DNA level data, that is where the tricky part is. So, just to give a bit of background on this, we rely on CPG and GPC labeling to kind of make these observations. And we add kind of exogenous methylation to some regions, and that is. And that is what brings a bit of problem because in some trinucleotides like GCCs or CGCs, we will have some ambiguity in terms of the mapping of coals. Now, this is what a set of observations would look like over a region. For example, for a given genomic region, you have For a given genomic region, you have a total number of calls that support accessibility or methylation or the lack thereof. And there's a bit of variation in different regions. Now, if we assume that these observations are independent, we can model the sum of supporting calls using a binomial distribution with the number of trials being the total number of calls and the probability of success being the methylation. Probability of success being the methylation or accessibility rate. Now, I followed previous literature in preparing the data and used a maximum, a posterior estimator for the rates with an unformative prior to sort of stabilize the variance of estimated rates in low coverage regions. But this is not a gold standard, and we just basically wanted to add some suit accounts to be able to use less stringent filtering. I also calculated the standard error of estimate for these regions and provided with the data, which can kind of serve as weights for the observations. Now, we summarize these over some genomic regions that I've described here. Here we're looking at a section of chromatin. This is the coding and non-coding regions of genome. Regions of genome, the promoter regions, which over here is described basically as 2,000 base pairs around the transcription strength site. Now these annotations were provided by Recard again, and some putative enhancer sites, and also the DHS sites, which are basically the highly accessible regions where the chromatin has lost this condensed structure. Has lost this condensed structure, which can be interesting, and also the CG islands. And these are the name of the data sets that I'm going to be referring to basically for these methylation and accessibility markers. This is a breakdown of the number of features. We can see that the modalities differ in the number of features, which is an aspect that we need to be wary of, as the larger data sets in some integrative analyses can actually bias the Analyses can actually bias the results. So it is, you know, it is in some areas can actually create some bias. So these are obviously the, we look at the features that pass that minimal filtering. But even though we've done the filtering, if you look at a snapshot of data, for example, here, promoter methylation. Here, promotomethylation. Here we're looking at the cells, and here we're looking at the features. And we can see the, even though we've applied some stringent filtering, we still have some missing values. And this also, this layer, this is kind of a shadow matrix of weights of observations that we can see. This is kind of a challenge to be aware of that, even though we have some observations, there's different levels of observations. Observations, there's different levels of uncertainty inherent to it. And we can see a variation in the coverage of these features as well. And in general, the accessibility data have more coverage. And the reason is that in the genome, we tend to have much more number of GPCs than CPGs. So this is an inherent bias in the data as well. So we next data as well so we next what we did was just looking at this single uh every single data set and we performed a a pca using a uh using an iterative uh pls algorithm that uh kind of can ignore all the missing values uh and kind of not have to impute them uh which was kind of uh you know what we wanted we wanted to stay away from You know what we wanted, we wanted to stay away from imputation. And we can see that different data sets, these are colored by stages. Different data sets contain different levels of phenotypic relevance when we look at them. And one problem is that we don't know whether it was the lack of signal or just the abundance of missing values. So this is something to be aware of as well. Now, the current methods for single-cell multimodal analysis mostly focused on single-cell RNA. Mostly focused on single-cell RNA-seq, obviously. Surat does CCA, but is more focused on anchoring the data sets onto a reference. MOFA and LIGER, as has been discussed already, perform shared and data-specific access variation as well. MOFA is very efficient when the data can be assumed to have Gaussian distribution. And also, the learn factors can be sensitive to influence. Learn factors can be sensitive to initialization because it's a stochastic algorithm, and you need to homogenize the data set. So, the range of the number of features that we have can be quite tricky for MOFA. And Liger basically does the joint clustering on the feature space. So, basically, you need to have completely shared features to be able to do the joint clustering. Now, we wanted to assess the performance of a motor. The performance of a multimodal sparse PLX integrative approach that has been implemented in Mixomics. And basically, for a set of data sets that can be your different modalities on the same cells, but you can have different number of features. We know we can have a low rank approximation of each of these, where we have the embedding of the cells or components and the weights or loadings for the features. For the futures, and what we're interested in is looking at the sum of covariance between the components of a response, kind of an interesting matrix and the other ones. And subject to some shrinkage, we can also perform variable selection using the LASU. Now, we applied, sorry, it's important to also be aware that these data sets can have missing values. Data sets can have missing values, and it's important for the method to be able to deal with them ideally without having to impute. So we applied that to a subset of these data sets. We used Transcriptome as the reference kind of data set, as the response data set, and we wanted to look at the coordinated variation of DNA methylation and control accessibility in multiple modalities. And we chose two number of And we chose two numbers of components, and we didn't do tuning, but chose a reasonable number of components to look at. As you can see, the axes of coordinated variation in RNA are kind of representing the phenotypes that we can see. And some of them capture, some of them. Some of them capture, some of them are driven more by lineages. So, gene set enrichment shows that these are either differentiation or developmental terms. And we can see when we look at the loadings by positive and negative loading, we can see developmental terms being either being some of the genes either being suppressed or activated down the line. Or activated down the line. We also looked at the methylation promoter sites and kind of saw the regular enrichment of some regulatory terms. And then looking at the gene body, we also realized that most of the features just follow the global patterns, but just more strongly. So we looked at the late-stage cells only, but we didn't see much different signal. The only interesting thing was that the Only interesting thing was that the promoter methylation has been its global landscape has been established. And one interesting finding was that we realized that the genes that were activated later on were kind of correlated with some of the putative enhancers. So just to summarize, you know, multimodal sparse PLS can integrate Can integrate multiple modalities of various sizes. Some of the selected markers kind of characterize the embryonic stage mostly, and the modalities differ in their level of coordinated variation. And most of the integrative analysis focused on transcriptome. But there are challenges, obviously. We only looked at the shared axis of variation, and we need observations on the same number of cells, which is a limitation. The limitation, and we need continuous variables as input. And it's also a question, as Oliver was talking about: it might not always be a region that is interesting, but just a motif in a region that is of interest. So we're to summarize also an open question. And later on, we wish to expand it to a supervised kind of framework and be able to look at the epigenetic data that are. Epigenetic data using the petitive lineages and also benchmarking is also very important. I'd like to thank Ricard for all the support and all LICAU members and especially Kimen, my supervisor and mentor, and also many others who helped a lot and also the funding organizations, ARC and Chan Zuckerberg Initiative. Thank you. Thank you, Alex. So we have a few questions. The first one is: you know, The first one is, you know, when you show your UMAPs, this is a question from Susan Holmes. You mentioned the third and fourth dimension. What happens on the first and the second dimension of UMAP? What do you mean? Yeah, so the first dimension was very strongly, was basically looking at this one and just a cross-section of these data sets. So I realized, so basically in these In these data sets, although still the early stage cells are sitting across from the other ones, we can see the variation in other dimensions. But if I was to basically look at first and second dimension, I would see all these cells from late stage kind of squashed on a single line. So instead of showing like two representations, I showed the kind of Showed the kind of the third and fourth dimensions. We have a question from John Hani Kim who asks, who is surprised by the final number of sites filtered for P300? You have about 100 and for DHS you have about 29019. Is the low number due to the dropouts or representative of the proportion of these sites in the genome? Basically, Basically, I think it's a combination of the length of these regions and their GPC or CPG content. It could be a combination of both, I think. But basically, what we did was we had the calls, we had a matrix of the genomic ranges and the calls, and we just what we did was just And we just, what we did was just simply summarizing it. But that is, that would be my guess: that it's the length and cytosine content. Emrit wasn't sure if you applied a block SPLS or block SPLSDA. I applied block SPLS. I applied also block SPLSDA. I haven't shown the results here. They're very similar. So it means that, you know, when you take the matrix of Take the matrix of transcriptome as a response, and also when you take the lineages as response, the results are very similar. So that was quite a promising kind of thing to look at. And Yukao asked if you have explored the enhancer features. So the extent of, I have to rush through it a little. I haven't It's a little. I haven't explored deeply, but what was interesting to me over here was that these enhancer markers, you can see that these markers, the RNA markers, there are some that are being kind of, there are mesoderm markers that are being activated later on in the positive loadings. And for those, we can see that there are some enhancer marks that kind of act opposite to the global trend. So as you can see, these enhancer marks are marked. As you can see, these enhancers are accessible in early stage globally and inaccessible later on. But the markers are the ones that are kind of behaving the opposite. These are inaccessible and accessible. While, for example, for negative loadings, they're kind of following the global pattern. So, this was an interesting thing to look at and matching enhancers, these enhancers. Enhancers, these enhancers to individual cells is always an open question. You can look at a window in the vicinity, but I haven't explored it further, but this was an interesting observations that I had from the data. Great. Thank you, Al. So in the interest of time, we're going to move on. You still have a lot of questions that I will put in the Slack in the NCNMTC channel. In the NCNMTC channel, so feel free to respond to the other questions. We're going to move to the next speaker, who is Joshua Welsh from the University of Michigan, and he applied LIGER to the SCNMTC data.