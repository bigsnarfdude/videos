That goes back to Delaware? Yes, yes, absolutely. So she and I were in Delaware most of the same time. Shared an office and kept in touch and done some work together. Okay, so the microphone is yours. Oh, thank you. All right, so I'm going to give a talk about some preconditioning strategies. So as you mentioned, there was this joint work with Nilema. Maybe over the last eight years or so, she sort of turned me on to DJ. She sort of turned me on to DG methods, and we've done some work in there. And what feels like a long time ago, we were having a conversation. She asked me if I wanted to look at any preconditioning. I thought, oh, that'll be fun. And it's kind of interesting. So this is kind of where we are and what we're looking at. So if I can get this right. You don't need to read the abstract. There we go. Okay, so we're going to work on a DG method. Going to work on a DG method here, and we're going to use the usual Trefis basis functions. And as I mentioned, well documented that as the number of plane waves increases, then the conditioning and the variational methods sort of degenerates, or it doesn't sort of degenerate. It does quite quickly, as we found out. Okay, so this is the problem that we started looking at. This is a usual DG method with the jumps in averages on the boundaries. With the interior faces and the exterior of the boundary faces, and this is the right-hand side with the G defined in terms of that. So, pretty standard formulation. And so we give you a little bit of motivation as sort of why we went in the direction that we did. We could have programmed things up. It's just an example here where we took the U to be a combination of a Bessel function and a plane wave, just to sort of mix it up a little bit so we could tell if things were capturing. If things were capturing the or getting the right solution just on a standard mesh. And what we did in this case then where we took about 20 evenly spaced plane waves for each triangle and then put the matrix, the formed the solution, the system matrix there. And so the reason I have all this, everybody's familiar with this, but there's a lot of block diagonal going on with the interaction of the just of the local on the elements. And so we've tried to think of things. Elements. And so we've tried to think of things in terms of preconditioning first along the diagonal or that part of the system matrix. Okay. So what that leads to, then from the formulation, there's a typical mass, cross, and stiffness matrices, depending on the interaction and the gradients between the functions. A lot of what I'm going to show you today, or we talk about, we worked out some stuff with the mass matrix and there's some extra stuff. stuff with the mass matrix and there's some extra stuff with the cross and stiffness matrix as you go that kind of follows. But with the basis functions and you take the gradient, just the wave number and everything falls out. So it's not too bad to extend it in that regard. Okay, so as we all know too, you can't address conditioning necessarily from a reference element and then map it in some way to the other elements of the mesh and find your bounds and things like that. So what we were thinking initially was, Initially, was with the mesh, typically with a triangular mesh, you usually define it in terms of the H, and that's the biggest radius of the disk that fits around, circumscribes all the elements in the mesh. And so we decided to think mainly, or what would we do if we started looking at the conditioning on a circle or on disk? And the idea was then to go from the disk to maybe a regular polygon and sort of, if we could understand things well on the disk, then we could inch our way down to a regular polygon. Disc, then we could intro our way down to a regular polygon and then maybe onto a triangle or some more practical shapes that we might use. So there we go. Okay, so I wanted to put in some work that I would say is kind of in line with what we've done. These are some of the papers that we've been looking at as we've gone along the process here. Perry and Debain paper, the conditioning of the least squares and the calcation method. Muella Hitmar Perugia. Moyola, Hitmar, Perugia, this is really a priori or convergence analysis of the plane wave DGE method. This is where I got the discrete formulation that I had earlier. Roke, Mandali, Diaz, and Trudeau, some local SVD and QR based strategies for the plane wave conditioning. And then Parallel, Fibricks, and Miola, complete work based on evanescence plane waves. Okay, the contrast in particular to the last paper. The contrast in particular to the last paper there is that what we're going to do is we're going to stick with the original plane waves and we're not going to try to modify them. We're just going to jump in and see what we can do in terms of preconditioning there. So this is sort of the process that we went through. We characterized the spectra of the plane wave on the disk. Like I said, moved to a regular polygon and then maybe down to triangles or more convenient. What we ended up focusing on a little bit was circulant preconditioners, and that's because of the behavior. And that's because of the behavior that we can see on the disks. The local matrices are circulant. And so we thought maybe we could apply that to the regular polygons. And then from there, what we hope to do is assess in some way the impact of the preconditioning on the condition number, of course, the L2 error, and in particular, the GM residual method. That's a slide at the end. That's kind of where we're still kind of looking at, but I have just a couple of slides on some results. Just a couple of slides on some results that we have there. Okay, so as I said, we started on the disk and everything's pretty convenient and works out. A little bit of a new identities and things, but you can write down the entries of the mass diphthong and cross matrix there in terms of the Bessel functions, and that's what's very convenient. So we've got the Bessel function of order zero for the mass matrix, the cross matrix error, order one. Cross matrix error, more to one, and then we get the split there because essentially that's because of the way that the derivative, pardon me, is defined. Getting the plus one and the minus one pops out there. So you get a nice closed form in some sense of the entries on the disk. And so from there, what we're able, what you could show quite quickly, it was not too bad, actually, have kind of an outline of everything here. Sorry, wrong button. That the mass, cross, and stiffness matrix. That the mass, cross, and stiffness matrix are real, circulant, and symmetric. So they're easy enough to work with. So, this is where we just wanted to characterize and see what was going on on the disk and then try to move to some polygons. So, this is just a quick proof there. It's pretty straightforward. I'll spare you the details of that. Okay, so we focused again, as I said, on the idea that it was circulant matrices. And so, the nice thing that we get immediately from the circulant matrices is that we can characterize. From the circulate matrices, is that we can characterize the eigenvalues and eigenvectors of the matrix. So, of course, then thinking ahead in terms of maybe preconditioning, we know then that we can write the circulant matrix as the decomposition is pretty straightforward. We know how to compute all those entries. And then, in fact, we know how to compute the inverse if we need to in that case. So, still on the disk, everything working out very well. And so, then being on the disk, then we were able to characterize. Being on the disk, then we were able to characterize using the formulas for the circulant matrix and the stuff that we had on the entries. We can write down pretty easily the entry of the eigenvalues, formula for the eigenvalues on the three matrices respectively. We can characterize their behavior as the wave number, or I'm sorry, as the number of the eigenvalue gets large as well. So we dig a little bit deeper into the formula that we had on the previous page there. So the eigenvalues on the disk, for instance, we can look at the behavior as the essentially as the number of plane waves we use increases, as the L increases, we get one over the gamma function essentially there. So as soon as the omega h is small or this becomes small, then the gamma function is going to take over and that's going to win in the end anyways. And so what that at least tells us is that. And so, what that at least tells us is that the eigenvalues are going to get small, and that's where the problem on the conditioning on the disk comes from, is that they get small very quickly. So, this is an example or just a sort of a numerical verification of the formulas that we had there, where the triangles, I'll do with the red triangles here. The red triangles are the eigenvalues, and the trend, which is the dashed line with the square, is the. Dashed line with the square is the formula that I had on the previous page. Let me go back to that real quick. So this formula, plotted that to see how accurate it really was. And so you can see that it's pretty close when the wave number is fairly small. And then as it sort of gets a little bit bigger, it's not necessarily as close, but the trend at least provides a bound for us in that case. Okay, and this is the. Okay, this is the excuse me the similar result on the cross matrix there and it's a little bit tighter in terms of the bound But it's it's pretty much the same thing very accurate bound it seems for the smaller wave numbers and then as it gets bigger Okay, so given all that we know the formula for the eigenvalues we we have a little bit of characterization of them in terms of the asthmatotics and so we can actually write down what the condition number So we can actually write down what the condition number, how the condition number behaves. I have the formula there for the mass and the cross matrix to make it a little bit convenient without being too much on there, but the largest eigenvalue. And then as L gets bigger, we have the bigger eigenvalue. The L, it goes over to, we do that, P is the number of plane waves. So we divide it by 2 because the eigenvalues, they come in pairs. In terms, if we have an even number of eigenvalues, the first two are different, if I'm not mistaken. The first two are different, if I'm not mistaken. I meant to write this down in the thing on the slide. And then there's pairs after that. And if it's an odd number, the first one is distinct, and then the rest can be pairs. Okay, so essentially, we're able to characterize the conditioning and get a real good understanding of why there's conditioning on the disk. Okay, so this is kind of a summary there. So as the number of plane waves becomes larger, then the And then, as I said before, the eigenvalues become exponentially small as the number of Playboy waves increases. And then for a fixed omega and h, the quantity of the Bessel function decays exponentially. And so combining these two phenomena as the number of play waves increases, the eigenvalues go to zero very quickly. All right. All right, so this is just another numerical verification of that phenomenon, what we have here. Of that phenomenon, what we have here is the minimum eigenvalue. So, this is a number of plane wave directions on the x-axis and the absolute value or the value. And the y-axis, so the condition number, so the purplish there is the maximum eigenvalue, which is bounded, stays sort of fixed for order one, and then the smaller eigenvalue degenerates, and then you can see the condition number is almost a mirror image because of the relationship between the two. Between the two. And that's the same for the cross matrix here. And in this case, we took Kh to be 10 pi. We took it to be a little bit large. And the right is the, we took a much smaller number to be 1 10th pi. Okay, so on the disk, then we've seen this already. This is just the formula for the entries. Things fall out quite nicely there. On an insided regular polygon. Just insided regular polygon, the formula does not turn out to be so nice as you would expect, right? So at least we can write it down. Not too bad in terms of coming up with this formula, but it is not as nice and easy to work with in there. In particular, it's not circulant, it's not even toplets, and this is for the mass matrix, so we get a similar result for the stiffness matrix or in the cross matrix. Okay, so this is kind of this is we're trying to step into the regular polygons now and see if there's some similarity. Now, and see if there's some similarity. And right off the bat, we don't get the, as not terribly surprising, but you don't get the nice formulas and things to work out so well. It's tiny. Okay, so the matrices are not toplets, but we're thinking of how close they might be to toplets or circulant. And so what we did was we looked at a toplets matrix that's the average of each diagonal. That's the average of each diagonal. And so we got this result from, there's a rather old result, I think, not old, from the 80s, top circulate preconditioners for toplitz matrices, a result by Strang, where he's writing down Toplitz matrix to do preconditioning, but he's building the circulant matrices from that. So we don't even have to circulate, so we're just taking the average of the diagonal in this case. The average of the diagonal in this case. And then these two here, well, I'll talk about them. They're really going to be what we're going to look at in terms of preconditioning. But we looked at two in particular. One was making a circulant matrix by taking the first row of the mass matrix and then using that to define the rest of the circulant matrix. So it seems kind of strange in some sense. I mean, thinking about how things worked on the disk, that property holds in the matrix. Property holds and the matrices are the same. In this case, it's obviously going to be a little bit different, but it's very quick and it's easy to use. And then another one that we had, what we called is the, I called it the best circulant matrix. I didn't put the citation, that's the result by Strang. We first would make the average topic matrix, and then from that, build a circulant matrix from there. So slightly different, takes a little bit longer to do, but it's not too bad. Longer to do, but it's not too bad. And if you're only talking about 30, 40 plane waves or something, even that much, it's not too hard to come up with either of those two matrices. All right, so how close is it to the toplet? So we chose just a pretty straightforward, nice triangle. Actually, my elements get worse instead of better in this case. And on the right, that is tough to see. But what you can see, so this is the difference between the mass matrix on the element. The mass matrix on the element, the topus matrix, which I described earlier, is kind of the relative error. And as the wave number gets bigger, or I'm sorry, smaller, it becomes the norm there gets smaller. And so it is more close to toplitz in that case. It's really anecdotal. We haven't tried to characterize that trend exactly. I'd kind of like to do that eventually. Mainly because, if I'd be quite honest, a lot of the pictures look the same, and I wasn't sure if that was just going to happen. Same, and I wasn't sure if that was just gonna happen, if it was sort of dumb luck that it happened, to be quite honest with you. But because if you do the same thing with the best circulant and then the circulant making just from the row of the mass matrix, you get the same sort of properties. The values are a little smaller. This is around 10 to the 6th, 10 to the 7th, and this is maybe around 10 to the 5th that goes down in terms of being close. So at least from this, we've convinced ourselves that while the matrices on a polygon aren't circular. Polygon aren't circular or even toplets in this case. Maybe they're kind of close, and so it gave us a little bit of a reason to continue on to look at circular preconditioners. So this is going to be more the same. I just tried a non-regular triangle. I'll go through these. The pictures, like I said, mentioned they're very similar. So pentagon, regular pentagon there. Again, you can see us the wave number. The smaller the wave number. The smaller the wave number, the closer that it seems to be to the three matrices, and then an irregular polygon in this case. All right. Okay, so given that we've gone from the disk to the polygon, we've tried to see how close maybe the entries of the mass stiffness and the local matrices are in terms of the regular polygon and the irregular polygons. So we're going to try these preconditioners. So, we're going to try these preconditioners. So, the mass matrix on the disk. So, again, this one actually I didn't mention earlier. This is where we use the actual mass matrix on the disk to do the preconditioning. The circuit, the M sub R then is the one where we choose the row of the mass matrix and then build the circuit from there. And the M sub B, what we called again the best, is where we form the toplitz matrix and then consider building the circuit one from there. And then at the end, One from there. And then at the end, or towards the end, there, I'll show we also have tried to do a left-right preconditioner sticking or going back to the matrix on the disk. We looked at using a left-right preconditioner in this case. All right, so let me show you a few results here. So we started off with the Pentagon, regular Pentagon here, and the two pictures that I have are the conditions. The two pictures that I have are the conditioning of the mass matrix, just the entries, no preconditioning. And then this is the conditioning of the disk. So the values, as we've seen in a few talks already, they get bad very quickly, depending on the wave number. If the wave number is small, the condition number tends to get bad very quickly. As opposed to a bigger wave number, it takes a little bit longer, it seems, for the condition number to degenerate here. So this is just what we're faced with. What we're faced with and without doing any preconditioning. And then so at the top is the same picture as before. So this is the condition number of the mass matrix for the various wave numbers on the pentagon that I had there. And these are the three preconditioners. So this is using the preconditioning of the disk, the mass matrix on the disk. So we just hit the physical element mass matrix. The physical element mass matrix with the one on the disk, and it gets a little bit better. The numbers are hard to see. This is around 10 to the 20, and the conditioning number here is around 10 to the 10 for some of the smaller wave numbers. And then it's around 10 to the fourth. It doesn't have that much of an impact for the larger wave numbers in that case. Okay, and then if we try the mass matrix on the, by just building a circulant matrix from the row, first row of the mass matrix and hit. The row, first row of the mass matrix, and hit it with the preconditioner. That seemed to do much better, which is kind of not surprising because it actually came from the actual matrix instead of just the disk around it. But again, the higher, I'm sorry, the smaller wave numbers seems to have a better impact than the larger wave numbers. And this anomaly here, I'm not really sure about it. It had something to do with the shape, something aligns with it. You see it pop up. With it. You see it pop up every once in a while. But so it seems that the preconditioning from the mass matrix by taking just the row seems to help out a little bit. Not so much of the forming the toplitz matrix and then a circulate matrix from there. I think things get a little bit too convoluted. It's still, it's a little bit better if I had these two side by side. Again, this is around 10 to the 10 and this peaked around 10 to the 20. So it has some impact, but not quite as much as the pick in the first row. The taking the first row. Again, similar results. Don't have to, I don't want to show you all the shapes. And just in case anyone asked or out of curiosity here, we have a few of the shapes. So this is the irregular polygon. Again, the conditioning number on the mass matrix kind of gets bad very quickly in the usual way. And this is the conditioning number on the disk. So this again is the same picture from before. Previous slide, the conditioning number on the mass matrix. Conditioning number on the mass matrix, and then if we hit it with the conditioning, if we pre-condition, sorry, with the mass matrix on the disk, it's still about the same impact as it had before. Again, this is the one making the circular matrix from the first row. Seems to be nice or work out much better. And a similar result, not quite as good as using the first row, the mass matrix, but using the topts. The mass matrix, but using the toplets and making a circular matrix from there, it has an impact, but again, not as much as it does from there. Okay. So, again, there's more shapes, same sort of results. Again, sorry, don't look too quickly. I don't want to go through the same thing over and again, but the irregular triangle or the not irregular, we get, again, similar results. So it seems, or at least it feels like the first row, using the first row to make. Row using the first row to make a circuit matrix is having some sort of an impact. All right, I did try the left-right preconditioner. We did add that in. It is a little bit better. So this is the regular triangle. The conditioning number, again, it still looks like the values get very big. And this is around 10 to the 10. So it's not too bad. The regular pentagon around 10 to the 8th. If I'm not mistaken. Yeah, if I'm not mistaken. So the left-right preconditioner didn't have as much impact in this particular case on the single element, just looking at the condition number. But it actually has a little bit of an impact when we try to use it as a preconditioner for the GM residual method. I'll show you here at the end. All right, so what I'm going to show you here at the end, this is the last part, is that we instead of just looking at Instead of just looking at the individual matrices on an element, we looked at a system. If you essentially go through the formulation of the DG method on the triangle, a lot of stuff goes away because you have a lot of interior faces in the DG formulation, but there are some boundary methods, boundary elements, sorry. And then you do get this system matrix. So we have the mass matrix, the stiffness matrix, and the cross matrix still involved there. So we just programmed this, and then Then try to employ the general GM RES to see what the impact was. And so, this is, as I mentioned at the beginning, this is kind of where we are, what we're looking at. We wanted to see, we know the preconditioning is bad and it kind of stays bad, and there's all kinds, and we decided to stick with just the plane waves, but we wanted to see if there was any impact on the L2 error of the result and the using the first one, which I'll The first one, which I'll explain here in just a second, is no restart, and the second one is using restart. But what we get is the, let's figure this. So no preconditioning in the GM res seems to work almost the best. All the other preconditioners that we tried didn't seem to come out or have that much of an impact, except for the preconditioning six. And this is the preconditioner. I mean, it's. This is the preconditioner. I mean, it performs a little bit better. And this is the preconditioner where we use the first row of the mass matrix to precondition the system. And then the second picture here is, again, this one we used restart. And here is the result of the GM res without a preconditioner. And again, the preconditioner six is the, you can see it up in there a little bit. Is that the first row? And then seven. Is the first row, and then seven is the left-right preconditioner. So that seemed to work better with the restart. And so we really haven't dug that much into it. We sort of set it up, let it run, and took a look at the results as we go. And then where we're headed now, what we're going to try to do is sort of quantify in some way why we're getting better results or different results for the restart. So just a couple of concluding remarks. So, just a couple concluding remarks. Obviously, this is pretty challenging and very interesting aspect. I'm kind of glad Nalima brought this up a few years ago. I found it kind of interesting to work in. We hope to organize our work and then consider the full impact on whole problems, a whole full-blown mesh problem. And as well, as I mentioned, forgot to mention at the beginning, that's why I put it at the end of the slide. So, I really do appreciate being invited and having a chance to come to the workshop. Thank you. All right, let's thank our speaker. Let's thank our speaker. Do we have any questions in the room online? Okay, it seems to me that for having this toplet structure, it is important to. Structure: It is important to follow the natural order of the basis function in terms of the output. And then, then, I do not understand at all what's going on if you go in 3D. Is it possible to go in 3D with this kind of techniques? Because because Topilist matrix, I mean, it's not only the shape of the of omega, but the ordering of the Bayes function, it seems to me, it's lost somehow. So, I don't know, you know. Yeah, I don't know right. I haven't thought that much about it, and I would share your skepticism about it translating it through the yeah, yeah, that's it. Maybe I missed it. You uh you write the general triangle in your in your for for for for the in target how does it depend on the shape of the triangle I imagine that different things happen as you say as the triangle degenerates at the very least but also for other cases right I think that's that's where we sort of are in terms of of of characterizing that as soon as you get away from the regular polygon into a more general triangle it does degenerate it's not the the preconditioning Generate, it's not the preconditioning is not as good in that case. And probably, in some sense, there are, I think what's interesting about it, there's a lot of different directions to take. Perhaps throughout everything that I showed, we were taking evenly spaced in terms of the angular direction of the plane waves. And perhaps if the triangle is maybe considering that a little bit more, which directions to take in terms of the shape of the element might have a little bit might. A little bit might preserve that impact a little bit more so. But it does, you're right, it does from a regular polygon or from a regular triangle to an irregular one. The preconditioning that we tried didn't do as well.