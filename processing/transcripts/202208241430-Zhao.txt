You can see and hear everything, right? Yes. Yeah, you're loud and clear, and we see your slides. Awesome. Well, thanks for yes, the talk before mine was definitely interesting. And I also had maybe something to say, but I will probably restrain myself. I'll try to hurry this up so we can get to the coffee break on time, but I just wanted to thank Layla and the rest of the. On time, but I just wanted to thank Layla and the rest of the organizers. I saw some Instagram pictures of the outing this morning, and I am kind of jealous that I couldn't be there. So, yes, I'm going to talk about surrogate markers and mediation analysis. The reason I'm talking about mediation is because I'm not very familiar with surrogate markers. So I came to it from a slightly different angle. And I thought I would start by telling you sort of where I came to it from. As I work in genomics, I work in genomics, and this is a problem that I looked at during my postdoc. We were looking at human heart failure, and in addition to the clinical outcome, they also had their genotypes as well as gene expression information. And in this case, what they found is that, so there's a gene, PKC alpha. It's well known to be involved in heart failure. They found this particular genetic variant was low. Genetic variant was located close to PKC alpha such that it did not change the structure of the protein, but it instead changed the amount that was produced. So, for example, this is a Western blot, and you can see that for homozygotes here, there's a lot more PKC alpha than for homozygotes here. So, basically, their question, the sort of the doctor's question was: hey, we have all of this three types of information, right? Expression. Types of information, right? Expression, genotype, and clinical outcome. Typically, if we're going to run a GWAS, we are just going to try to associate clinical outcomes with genotype, figure out what genotype, what variants matter. And we know that has low power. And can we then incorporate this additional gene expression information to somehow gain power? So, this is a context that I came from. That I came from. And the solution that I came up with, I think Boris showed this earlier, has basically mediation analysis. And you can kind of see where that came from. We have these pictures about how information flows from DNA to RNA. So you can think of this as an exposure, this is a mediator, and then down here is some eventual outcome. So that's kind of what I started thinking about. Here, this is going. About here, this is going in my context. This was the genotypes, or I guess a single genotype. This was the expression of genes, and then this is heart failure. So that led me to this problem, surrogates, where basically my understanding is that the mediators are kind of the surrogates. And if you have a perfect surrogate, you have no direct effect in the mediation terms. Mediation terms. And if you have an imperfect surrogate, you kind of have a direct effect. So I wanted to tell you about a couple of two findings that I came to from the mediation perspective that might be interesting for the surrogate problem. And I should say that Layla is the one that introduced me to some of these problems. So you can blame her if I don't understand what I'm talking about. Anyway, the first is this question. Anyway, the first is this question of power. In the mediation context, I've told you where that came from, and I'm just wondering if in the surrogate context, increasing power might also be of interest. And the second is high-dimensional surrogates or mediators. I have multiple genes, I mean tens, thousands, you know, 50,000 genes that you might think about as potential surrogates. How do you handle those? So those are the two stories that I wanted to tell you. And the first one has to be a little bit of a test. And the first one has to do with this power gain. And this is the very first thing that I ever looked at. Here, I'm just the notation is all on the left-hand side. I'm assuming a linear model, and nothing that I say today will probably be of immediate use because it's all super parametric. But I think the concepts and the insight that these models give are still kind of interesting. So the question that I hope to gain. The question that I hope to gain power for is this null hypothesis. Basically, is there an effect of X on Y? I'm calling it tau, but basically it's the product of these guys. And this is the indirect effect. In the absence of a direct effect, that's just the total effect of X on Y. And I think if you're thinking about X as a treatment, then this is sort of the treatment effect. So is there a treatment effect or not? And I'll go a little slowly through these slides and then I'll speed up later because I think all. And then I'll speed up later because I think all the intuition is basically here. But the first thing you might think to do is a regression. So ignore the surrogates. If your X's are your genotypes and your Y's are your outcome, this is what you would do, basically what you would do in a genome-wide association study. So this obviously doesn't use surrogates at all. So the second thing we were thinking about is how you would use surrogates. And here's a naive idea. And this imagine you knew alpha s, then according to this model, these models over here, you can sort of like left multiply by alpha s transpose here, and then you would get a regression of something involving alpha s and gamma s, or gamba. So basically, you want to hopefully impute your outcome by using some estimate of alpha s, multiplying by your surrogate, and then doing regression. By your surrogate, and then doing regression on that. So, you can imagine doing this. So, in this, let's say, low-dimensional case, you can estimate your effect of surrogate on outcome just with another regression. And this is the second thing that we study. And so it turns out that if both of these effects are non-zero, I'm sorry, if at least one of these effects is non-zero, they cannot both be zero. But if at least one is non-zero. But if at least one is non-zero, you find that this OLS always has larger asymptotic variance than this guy. And so a couple of comments here. So first, this means that you could use this to gain power. The second comment is that this is highly dependent on all of these assumptions being true. This is the definite downside of this framework. These guys sort of all mention it. These guys sort of all mention it. I think these at least Kenny and Judd had a simulation study that indicated that this power gain was possible, but didn't maybe flesh out the details. And these guys definitely warn that this is a very, it's very dependent on your assumptions. Nevertheless, I think some intuition is still interesting about why this might be true. So I'll just show you really quickly why this will be true. This will be true. So you can take the two models and then your linear regression test statistic, or just yeah, test statistic, and you can just figure this out. And these don't super matter at this point. But what happens with your other test statistic is that out here you have your outcome. And according to the model, you can sort of plug in what this outcome should equal. And you plug this in, you make some substitutions. And if you multiply through. And if you multiply through by this stuff on the left, what happens is that when you get to these S's over here, when you multiply everything out, you get this extra term. And this extra term in univariate exposure, univariate surrogate equals the squared correlation. And the squared correlation is always at most one. And so that's actually why you can gain power. So that was. So that was sort of the first part of the story. We saw that if you have no direct effect, this is possible. And then a natural next question is: what do you do if you have a direct effect? If you have a direct effect, it becomes much more complicated. We're going to try to test the same null hypothesis, which is, again, this sort of treatment effect of X on Y. In this case, it's equal to the indirect effect plus the direct effect. And again, you can think about your ordinary least. And again, you can think about your ordinary least squares. And then we tried for a while to come up with a test statistic that could use the direct effect and the indirect effect. We tried a couple. For various reasons, they don't seem to gain power, except for this one, which is actually the exact same test statistic that I just showed you. And intuitively, the reason why this might still be interesting is that this part right here. Is that this part right here sort of captures the effect of Y through, I'm sorry, it captures the part of the effect through X that goes through S. And as long as this part that I'm highlighting is kind of big enough, you can imagine that it's still going to be more powerful than if you just use ordinary least squares. So I guess what I'm saying is if you capture, if this path has enough of an impact, if this is Has enough of an impact, this is large enough, then by using it, you can still gain power. And so that tells you something about this term. This term basically has to be small, and that's kind of what we found. So we have some conditions. I should say this is right. This is with a graduate student and also David Zucker. And if you want to simplify the conditions, we consider univariate everything. And the first thing we need. And the first thing we need is what I will call consistent mediation, which means that these guys have to be in the same direction. But I think what that also corresponds to is no surrogate paradox. So I'm kind of relying on all of the other talks giving methods for choosing the right surrogate. If you have no surrogate paradox, the last thing you need is this direct effect to be small. And in this case, it just has to converge to zero. And in this case, it just has to converge to zero. And what we're actually doing is kind of a local alternative. So if all of these things are true, then we can get a condition for when this guy's more powerful. And the condition is more complicated, and it depends on the sizes of your indirect effect, sizes of your direct effect, how correlated your surrogate is with your treatment, and also how much this is sort of. This is sort of how much additional variance you can explain by adding s to x when you explain y. And you can sort of plug in some numbers and you can get some idea of how large these effects need to be. So the last piece of this story is, I think I'll skip the proof actually. But anyway, the last piece of this story is: what do you do if it's Is what do you do if it's not a linear association? So, one of the big problems that I think prevents this from being actually useful is that in order to gain power for testing this treatment effect, you have to assume this relationship. So, I wanted to show you this because this is a picture that I think shows a non-parametric version of this, but also kind of gets to the real reason why some of this. To the real reason why some of this power increase is possible, and this just might be interesting for surrogate work in general. So, x-axis is my surrogate, it's continuous, pretending. Y-axis is y, my outcome, but this time my treatment is zero or one. And what I'm plotting is the surrogate outcome scatter plot for both treatment groups. And finally, what I'm plotting. And finally, what I'm plotting is, or what I've simulated, is a common relationship, basically a common expected value of Y given X. So for both the treatment group and the control group, it's the same relationship between Y and S, and that correlates with no direct effect. So, if you have that, you can kind of see why it works because. See why it works because suppose that you want to now estimate this association between Y and S. If you can do that, then you can assess treatment effect better. And you can actually estimate that better because you can use both the blue dots and the red dots. Because they all come from the same data generating process, in this case, it's the same conditional distribution. You can use all of your data and you can get a more accurate estimate of the conditional distribution of y given x. Distribution of y given s, and then taking out your treatment effect, you just plug in different s's for you know treatment or control group, and then you can get a more accurate estimate for your treatment effect that way. So I haven't thought enough about this. I put a lot of question marks here because Layla and I have talked about doing this. And then I realized that I didn't know enough about non-parametric estimation using kernels to actually write this paper. But you can see some of the complexities. So, first of all, the support of S. The support of S has to be the supports in the control group and the treatment group have to overlap. If they don't overlap, you can't gain power from this picture because you can't put, or can't gain as much power anyway, because you can't sort of put both data sets into use. And there's just a couple more issues here. Once this is worked out, then I would be comfortable saying that this is an actual possibility, sort of gaining power. So in the last few So, in the last five minutes, I wanted to tell you about the other story, which is a high-dimensional story. And this comes, so in my context, this comes from all of the genes. You don't know actually which ones might be interesting, but you want to use all of them to gain power. This is a little different from, I think, what, for example, what Boris was saying. The motivation here isn't necessarily to select the gene to then, you know, And assess expression more cheaply or more quickly. I just want to gain power for testing. So I just want to use all of them if I should. So here, I put a dotted line here because what I'm going to tell you works for both. Oh, sorry. So I should say, so the purpose here is to estimate this indirect effect. This is maybe something different from the power gain question, but this is sort of the first step. First step. So, if I want to estimate the indirect effect, but I have a high-dimensional problem, but I have more surrogates than I have samples, what can I do? So, what I'm going to tell you here sort of works if you have a direct or no direct effect. To make it easy, I'll just tell you about the indirect effect only, so complete mediation. And I just want to sort of tell you the strategy, if not the actual results. So, the idea is that you want to do what we kind of did before. You would hope that. Do what we kind of did before, you would hope that you can estimate this. This is now a very high-dimensional parameter. If you could estimate that, you could just then do what we did before, take your surrogates, multiply by that to get an imputed sort of outcome, imputed y, and then regress that imputed thing on your x, which is what you have here. In high dimensions, you can't do it because this thing is not invertible. And there's a lot of recent literature, I guess, not that recent anymore, about de-biasing. Anymore about de-biasing and you actually um sorry you can estimate this but you can't estimate it in a way that makes inference nice. So the de-biasing literature is a way of doing making inference more easy when you have high dimensional parameters. You can't actually use that technique straight up here because this whole thing is necessary. So all P components So, all P components of this thing in red are necessary, and de-biasing only can de-bias one or two or a finite number of them. So, the strategy is instead of de-biasing this thing in red, you want to de-bias this thing, which is a small dimensional object. And the idea is that you, instead of multiplying S transpose Y by this matrix, which doesn't exist anymore, you imagine changing that matrix. You imagine changing that matrix and picking a better one. And in this case, the better one, I'm just going to denote omega hat for now. And what we want to analyze is this is your estimate, and this is the truth. This is what you want to achieve. If you can achieve this, you can estimate this quantity and then you pre-multiply. So if you do this and you subtract out and you replace y by what it's sort of modeled to equal. Of modeled to equal, you find that you get a nice sort of normal term after the central limit theorem, and then an extra term, which is a bias. And the nice thing about this is that if you construct omega hat correctly, and if this guy is sparse, you can estimate both alpha s and you can estimate, or you can make this guy small, which means you can estimate the bias well. So basically, that's what you do. And then you can take this thing. Then you can take this thing, pre-multiply by this thing, and then you have your answer. So you can construct it, and I will skip this part as well. And I just want to show you that it kind of works. This is modulo all of the difficulties with tuning, which I don't think anyone has really figured out well. But if you look at the coverage, this is a nominal 95% coverage. What we're proposing is in black. You can imagine. Black. You can imagine doing something with just naively using Bootstrap for sort of a lasso type estimator, which we know is not great. And if you look at the power, this is a power curve. The black is indeed more powerful than anything else. So I guess that's probably what I'll. Oh no, I have one more thing. Yes, how could I forget? So this is the last maybe application of this high-dimensional problem to a real surrogate. Problem to a real surrogate problem. This is with Layla and a grad student. And in this case, we were looking at a similar problem, high-dimensional S. Here, our treatment was binary. And this setup is a little bit different from the linear model that I just showed you because this is now equivalent to an interaction term. Before, I didn't have an interaction between treatment and everything else. Now there sort of is. Sort of is. So you can set up these models. You can say that your surrogates look like one thing in treatment group or control group, another thing in the treatment group. And then your outcome model looks like one thing in the control and a different thing in the treatment. And this time, we want to know what proportion of the total effect goes through these guys. So this is this proportion of treatment effects explained. And we want to sort of We want to sort of define it this way. And I guess I'll speed up here. But the basic problem is again that this quantity here, this beta, is difficult to estimate if you have too many surrogates. So what we're going to try to do again is use the same kind of idea, use this de-biasing idea to de-bias this whole thing. This fundamentally is a scalar quantity. And even though parts of it are high-dimensional, you can still estimate the scalar well. The scalar well. So basically, you can do that same type of idea. And the result is you can get a joint distribution, joint asymptotic distribution for the estimate of the indirect effect as well as the total effect and do a delta method and get a distribution on your ratio and your proportion. So we tried this. This gets to the data availability issue that we had already discussed. We had already discussed, but it was really hard to find data which had a high-dimensional surrogate that was sort of randomized treatment. And we were able to find one. I really have to thank the first author of this paper who very kindly sent us some of his data. But it only had 13 people in one group and eight in the other. So with that, we were able to. So it was actually a trial for a new supplement and the outcome. And the outcome was the change in fat percentage between 12 weeks and at zero weeks on this supplement. The proportion that proceeded through the 100 most variable genes at 12 weeks was a point estimate of 0.75. But after, even after sort of doing a transformation to make sure this confidence interval is between zero and one, it's super wide. And this is in part due to the small amount of data, but I suppose also because of the nature of this. Also, because of the nature of this PTE coin. So, in any case, those were the two stories I wanted to tell you. I think there's a, like I said, a big gap between what I talked about and what might be useful in practice. Some of these things that I list on this slide might overcome this gap. But in any case, those are things that I was thinking about from a different context, and I sort of hope that they'll be useful in. Be useful in surrogate markets. So, thanks a lot. Thank you for the talk. Really wanted to high dimensions there, which is something we hadn't really done so far. I would open it up for any questions here. All right, Layla. Okay, I just had a comment. First, Dave, I'm sorry. First, Dave, I'm sorry you felt rushed. I tried to text you to say you don't have to rush, but yeah, sorry. I was paying attention. I know, I know. I didn't know how to like let you know, but yeah, thanks. So I did just want to say that Dennis will also be talking about maybe in his talk, like the high-dimensional surrogate setting. So that'll come up again. And then also wanted to give a plug that. Also, I wanted to give a plug that Dave does have an R package that implements this. So, if you have a high-dimensional surrogate and you have more than just eight versus 13, please check it out and let us know how it works. That was my comment. Since I am allowed to go a little bit over then, I just wanted to mention one, or I sort of wanted to pose one question, which is, do people already know this? Because I found that in the Know this because I found that in the at least mediation literature, this power issue wasn't that prominent, I guess. People sort of knew it, but didn't really talk too much about it. But it seems like in the surrogate world, it might be. Or if there's any applications of this idea, one example that I sort of, or one issue that I sort of skipped over is this prediction idea. And what I mean by that is that if you wanted to predict Y using X, but it's hard. X, but it's hard. But you had a bunch of really good circuits, you could develop a prediction model using these guys that depend only on this that's more accurate than a prediction developed not only, not using these guys. Anyway, I was curious if problems like this show up in the surrogate marker literature. Yeah, if I could respond to that, just like usually in surrogate markers, we just take one because we think, oh, this drug lowers blood pressure. Here's another one. Lowers blood pressure. Here's another one that should lower blood pressure, and we understand it all. So, this is idea like another treatment will have an effect on a surrogate that we understand, and then we can have the improvement in blood pressure stand in for an improvement on a clinical endpoint. This, I can understand, would give you more power because, you know, you have sort of more ability to get a better prediction. But then the issue would be, I guess, what would the intervention do? You know, you'd sort of want it to favorably benefit the vast Benefit the vast majority, I guess, of the surrogates. And then also, you'd try and understand. So, this single intervention basically, what would its effect beyond like seven or eight genes or even more? I mean, then you'd have to sort of understand that, I think, to really know the consequences of it. So, more power is good, but I think it's more complex to understand how it would be useful in like short, you know, getting a quicker readout on a new treatment. Sure. You need to understand. On a new treatment, sure, you need to understand it pretty completely. Anyway, we got another question in the room. My question is about using the genomic marker together. Are you using them one by one or together? If you use them together, some of them can be highly correlated. Will that cause like not enough rank problem or some collinearity problem if you separate how to address the multiple testing problem? Uh, multiple testing problem, yes, we definitely uh have that problem, so we want to use them all together, and the way that that comes up. So, the way that the problem um arises then is with this part right here. So, if you have so all of this needs to be true, and what happens here is that this is a so this alpha s is something that needs to be estimated by lasso. That needs to be estimated by lasso or scaled lasso. And if your covariates are too collinear, then this estimate won't be very good. Similarly, you actually need your surrogates to be to have a sparse precision matrix. And that's a little, yeah, that's probably around what you were asking. So in practice, sorry, in theory, yes, we have a problem. In practice, I don't think people check anyway. I don't think people check anyway. So I don't know. And I think an interesting question would be to do some selection. I do have to say that if you do multiple, if you do selection and then sort of do multiple testing, that, as you were hinting, really is an issue because this is another version that kind of does that. It looks at your surrogates. So this is a paper which I can give you a reference to, but this looks at all of your surrogates and then it selects a couple that it likes. Your surrogates, and then it selects a couple that it likes, and then it uses just those to do a low-dimensional problem. And the problem here is to deal with this post-selection inference issue. And I don't know how to do it. I think it probably is doable, but at least in this simulation, just naively doing that without adjusting for multiple testing definitely has some issues, really strange behavior with power, and so on. But if you have any ideas, I think. You have any ideas? Um, I think I don't know how to do it. Yeah, well, that's what this workshop is supposed to foster, I think. I'm thinking, um, I have another question in the room, Boris. Hi, Dave. Thank you for this very interesting talk. Lots of ideas that are super interesting for us. Um, I had one question, might be naive. Um, you showed that in your application, the last application, you showed. Last application, you showed the confidence interval is super wide, but it's still between zero and one, which seems like a very nice feature, though. And so, I was wondering: is that just luck or is it built in the delta method? That's a transformation. Yeah, yeah, exactly. The delta method. Yeah. Okay, great. Thanks. Yeah, I was going to say, you know, it's wide, but it could be wider. Actually, yeah, that's true. If I continue the decimal places, you know. The decimal places, you know. Yeah, it was wider, and then I was like, We can't, we can't, this is this is not gonna work. Um, yeah, I had a, I mean, just to follow up on your question, um, Dave, with like another question with power. I think, um, yeah, I've been struggling with this too. It might not be exactly what you were saying, but there are some settings, both like simulation and application, where And application where I see like more power with the surrogate than with the primary outcome in terms of testing for a treatment effect. And like Lou and I have talked a lot about, well, let's talk more about that, but we haven't because it feels so wrong. Right. And I feel like if I put something out there about that, someone's gonna tear it apart. But that's interesting. But it's just like at the just a very simple case where like. The just a very simple case where, like, you know, S is measured before Y. And let's say S equals Y, but has less variance. Like, yes, exactly. And you get more power testing. Yes. But so much of what we talk about is like, we're trying to find a surrogate that like, like the sort of default assumption is that you're not going to, you're going to lose power with S. So it just feels so wrong to talk about that. So I kind of haven't ever really. Haven't ever really, but maybe others have. I don't know. I haven't seen it. I'll just say really quickly that my ideal, like the ideal situation for me where this works is exactly like you said. S has the same, so sort of the expected value of this is the same as the expected value of this. It just has less noise because it doesn't have this piece added on. And so by doing by, if you can estimate this guy and then you multiply out, you're denoising your outcome. And you can imagine some process that just. And you can imagine some process that just accumulates stochastic noise as time goes on, but like fundamentally, you know, it doesn't drift or whatever, but the noise increases. And if that's the case, if that ever realistically happens, I think it makes sense to test the surrogate and claim treatment effect just based on that. But I mean, what do I know? Right. So I'll call for any questions on the Zoom. The Zoom. And if not, I guess we'll thank our speaker for a thought-provoking talk and wish you the