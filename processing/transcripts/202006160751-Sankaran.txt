So, today I'm going to be going over this targeted proteomics challenge. I'm actually really excited to share some of these ideas. And it's different from usual reasons. So when I think about, I'm a statistician, right? But then in this talk, I'm not going to share anything that's kind of not in an introductory statistics or data mining class. So all the methodology is actually going to be. So, all the methodology is actually going to be quite basic. But the thing that I'm excited about here is the kinds of questions that are being asked. So, what I really hope you can get out of the next few minutes are what are the kind of overall properties about this data that I find make it different from standard kind of bioinformatic analysis that I've seen before? And what are some of the big problems that I see when I just try using the most basic methods? What are their limits? Most basic methods, what are their limitations? And if you want to follow along outside of just slides, I have a GitHub link. It has the code, everything that I'm going to show now, but it also has kind of subset of the data. So like a really tiny, you can just download it and you can just run things right away. That's also on this finder link. If you want to see the visualization, here's the interactive visualization, and this is how you can find the slides. Okay, so let's. Okay, so let's type in. So, what is the problem setting? It says this is the same data that everyone all morning has been speaking about. I'm going to be talking about the Mibitof and Sitoff data. Why is this data interesting? So, these technologies are making it possible to study cancers as ecosystems of interacting cells, rather than just summaries of individual cells with their expression levels. And this is interesting. And this is interesting because interactions have consequences for disease progression. You heard earlier about the importance of tumor heterogeneity for disease progression. And from a very high level, my cartoon view of the difference between these two data sets is going to be something like this. So, mass spec, I'm thinking of as just giving a sense of the compositions of the cell types within any individual, right? So, kind of it's this kind of picture on the top right. You really can't distinguish between two mixtures of cells which are just scrambled around spatially. All you know is the identity and the expression levels of each cell. You don't know how they're linked up with one another, right? MibiToff, on the other hand, is going to give you that spatial interaction patterns. So, that's where things will get interesting. That's where things will get interesting. So, first look at the data, let's try some sort of interactive visualization. Right, so I can show you what it looks like in the original thing. So, what I've done here is I've taken a single patient. This is the kind of Mibitoff spatial map. Here's a U map on just this one patient's cell expressions, and what I can do is. Expressions. And what I can do is, I can highlight all these different cells in the UMAP, just expression map, and I can relate it to the spatial map. I'm not going to just show everything on the interactive. You can play around with it, but I'll tell you what I think were the most interesting things. So the first of all, it's kind of ambiguous whether clusters in the UMAP correspond to clusters spatially. So here are two examples where it does seem to cluster spatially. So I highlighted all these cells. Spatially, right? So I highlighted all these cells in the UMAP. All the corresponding cells are in this red box. Here's another kind of cluster in the UMAP expression space. There's a few cells that are outside of this box, but most of them lie right around here. So in that sense, you can localize spatially using just the expression information. But this is not a universal property. So here I take some other, oops, the red box is unaligned. But then the point is, I And the point is, I've highlighted just a small set of tumor cells, and now they're kind of spread out all over. And here I've highlighted some immune, and they're also spread out all over. Right? So it's kind of no clear case for either way. Okay. So now I'm going to talk about kind of cell level analysis. Right. So thinking of this problem from a very high level, right? From a very high level, right? These systems are both interrogating the same kind of underlying biology, right? But then they're giving you very different portraits. Like I think of it as kind of two different sensors for the same reality, right? On the one hand, they're going to capture a few common phenomena, but on the other hand, the sensors are going to be sensitive to different kinds of variation as well. So that's kind of this cartoon. So that's kind of this cartoon. There's some underlying latent phenomena that are detected by both of these technologies, but there are going to be other phenomena which are detected only by one or the other. And kind of a question that I think is generally interesting is, to what extent can you use a simple assay as a proxy for a more powerful one? You don't think that this will always be the case, but sometimes it might be true. Can you? Can you be able to figure out which situation you're in to know which kind of technology to use? That's another kind of broad question, I think, of interest. Okay, so here's an idea, right? So from just like the diagram I have here, you might think, okay, why don't we write a whole generative model, right? You could have a generative model with a few kind of shared components and then different Kind of shared components and then different components for each table, something like this. I wanted to come up with something simpler, though. I want to see what is the most sophisticated conclusions you can find using some pretty elementary techniques. The reason I think this is useful to think about is because from one set of integromics problem to another, you're going to get kind of some nuances and what people. Some nuances and what people actually ask about, and having to develop a new model for each one seems a little bit too much, right? So, if we can find a few principles that are simple to implement, then that's something at least to try out, right? And kind of why, what am I going to think about? The hack, the kind of opposite of a rigorous latent variable analysis, is going to be, why don't we just learn a model that goes just from expression. That goes just from expression information into some sort of spatial information at the cell level. So the reason you might think this would work is if you imagine like this kind of middle purple cell on the left-hand side, you imagine that since it's surrounded by other purple cells, it causes the expression profile to be like these red bars on the top. But then if it were surrounded, But then, if it were surrounded, if it were in a different configuration, let's say this tumor cell is surrounded by immune cells, then that will have a different configuration of protein expressions. So the idea is if you try to explicitly learn a map between the expression patterns and some of these spatial properties, you might be able to recover patterns like this, right? If you were able to recognize that whenever you had the expression level pattern on the top right, these bars, if you're able to tell that that always meant your tumor cell was. That always meant your tumor cell was surrounded by immune cells? Then, if you just do a purely expression profiling without any kind of spatial analysis, you would be able to recognize that signature and be able to tell that that cell is a tumor cell that's being surrounded by immune cells. Okay, so that's the high-level goal. So, what is the proposal? The first thing I do is I make clusters. The first thing I do is I make clusters from the expression data. So here are centroids of all those clusters. Each bar is a protein. I extract different spatial features, and then I can embed those spatial features. And this is the result of those embeddings. And so each panel here is a different person. Each point is a cell. And these are made using just kind of neighborhood features. It's like the previous picture whether it's surrounded by an immune cell or not. And then using just that, I make predictions. And then, using just that, I make predictions, right? And here's some results. You can see if I'm only using the proteins that overlap between the MIBITOF and the Cytoph, then you get the picture in A. If you use all the proteins in the MIBI-TOF, but not using any spatial information directly, you can get B. So the idea is somehow if you have more overlapping proteins, then you would be able to recover the spatial information well. But then if you only But then, if you only have a small number of overlapping proteins, that's hard. Okay, so that's most of the analysis. There was a last point I want to mention about thinking about things at the sample level. So inverting things at the cell level is tricky, right? As like we just saw in the previous figure. If you only have a couple proteins, that might be hard to do. But ecosystem properties might already be Ecosystem properties might already be visible just by looking at composition. The point is: if you're going to be trying to predict things like how heterogeneous a tumor is, it might be enough to just look at what types of cells you have. So what's the idea here? The first two steps are the same as the previous analysis, but now instead of working at the cell level, I work at the sample level, right? So I've taken here, so each column here is a different person. Column here is a different person, and I'm counting the fraction of cells that belong to the different clusters. And I'm summarizing the person by that kind of mixture over clusters, right? And now I can try to predict the spatial features, kind of like the overall tumor heterogeneity for that person using just expression information from those clusters. And this turns out to be possible. I'm showing in the top. Right, I'm showing in the top is this is the kind of prediction versus truth. Bottom is showing these are kind of, if you have x-axis is different amounts of different clusters, y-axis is the predicted kind of average entropy of the cells. So this is something like the heterogeneity. So certain clusters, if you have a lot of that cluster cell group, then you also have kind of corresponding amount of heterogeneity. And kind of a And kind of a final related idea. So, so far, I've been measuring redundancy between two tables by predicting one from the other, right? You can also think about measuring redundancy by using two different data sets to predict the same thing and seeing how much does the performance increase when you add one new variable. So, it's like if you add orthogonal features in a linear regression, that increases the performance a lot. If you add very correlated features, If you add very correlated features, that would decrease the performance or not increase it much. And this is kind of, you know, just run a very standard kind of random forest on using just spatial, just expression, and both features. And kind of natural, you get an improvement, but it's not the sum of the improvements. So there is redundancy between these tables, and that's why you're able to learn some sort of relationship between them. But I think that. But I think that kind of now, this is the this highlights what I think are kind of the two biggest questions in this analysis for me. So the first thing is that rows and columns of x, what we're used to thinking about in statistics, this is no longer so clear-cut, right? The rows, I showed you two analysis, one where I thought about the rows as being cells, the other one where I thought about the rows as being people or like biopsies. So there's So, there's ambiguity in what the sampling unit should be. That's one challenge. The second is the features are not given to you in advance anymore. We're working with images, or if you want to think about them as graphs, you're working with graphs. We have to extract features either by hand or maybe computationally, right? So, that also complicates the sort of analysis. And then, the final kind of last point, what these last few analyses are. What these last few analyses were getting at is that these different sets of features, there is redundancy, but there's also source-specific signal. I feel like a good integrative method should be able to establish not just kind of a common embedding. I feel like there are a lot of methods that will let us get common embeddings, but there are not that many that will help us measure how redundant are two sets of features and what is actually the unique contribution from any particular data set. Contribution from any particular data set. And so these are the kinds of questions I'm excited to discuss in the brainstorming session later. And I'm happy to answer any questions. Thank you, everyone, for listening. Chris, actually, given the time, can we move the questions onto Slack? Because I think people are probably eager to take a break. So if we can move the questions onto Slack, that would be really good. Click the questions on Slack, that would be really good. And if people could return at 10:30 Eastern time.