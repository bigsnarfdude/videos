Talking today about beta cells, quantifying beta cell responsivity, and this is all joint work with my PhD student, Justine Garrish. And this is sort of a different flavor of modeling for me. I know many of you have more experience with this, so I'm really interested to hear your thoughts about it and about how to best communicate it. I was partially inspired to really focus on the methodology because we have. On methodology, because we had this point that came up in the discussion yesterday, I believe, about trying to think about how we can combine some of these different kinds of modeling techniques. And so for me, this is really combining a couple different flavors of modeling, hopefully in a useful way. So I already introduced this concept of the disposition index. Of the disposition index that defines this relationship between insulin sensitivity and beta cell function. And so, in this example, they're quantifying insulin sensitivity down here, beta cell function here as the acute insulin response, which depending on the protocol that you're using is how much insulin is released over some short time period in response to the glucose challenge. And so you can see this kind of shape that we talked about before, where if your insulin sensitivity decreases but your beta cell function increases, then you stay on this curve and you have this compensation and you're able to control your blood glucose. But if you fall off this curve, then you're no longer able to compensate. And so in some of the other talks, I've focused more on talking about insulin. More on talking about insulin sensitivity. But what I wanted to talk about today was more focused on the other part of this curve, so on the idea of beta cell function. And this concept of responsivity of beta cells was defined as an index, where here we're thinking about the integral. So how our insulin secretion is changing above baseline. Is changing above baseline over time and then normalizing that somehow by how the glucose is changing over time. So that if we have a bigger glucose excursion, and this H is, you can think about it as the basal glucose. It's typically some threshold that's close to basal glucose. And so what we're interested in doing is being able to compute this. And when we think about the insulin secretion rate, so what The insulin secretion rate. So, what I'm going to talk about today is this little bit of background and the differential model and then the way that we've been implementing it in this Bayesian hierarchical model. And so, C peptide is what we're going to be measuring, and it's released one-to-one with insulin from the pancreas. And so, because of various other things about the way that it's handled in the body, it's a better marker of insulin to create. Body, it's a better marker of insulin secretion than insulin itself. So, we're going to focus on C peptide. Typically, for healthy individuals, those insulin levels are going to respond quickly. And so, if we see them responding not as quickly, then that's an indication of something that's not necessarily working properly in the system. And for the data that we're going to be focusing on today, I'm not really. Going to be focusing on today. I'm not really going to show very much data, but we're working on this with Dr. Christine Chan and her data in patients with cystic fibrosis and cystic fibrosis-related diabetes, and trying to understand what's happening there. And I think, as has been mentioned before, typically these people are experiencing some loss of beta cell function that's really contributing to their problems in managing. To their problems in managing their blood glucose. And so here we're thinking about a three-hour oral glucose tolerance test. So you can see, as we've talked about before, after the drink at time zero, the glucose goes up and then comes down. Here, the insulin is also going up and coming down, maybe a little more slowly. And then we can see the C-peptide, which is going to be what we're focusing on with this data. Data. So, for our differential equations-based model, we're using this model that was proposed by Eatim and colleagues. And this is describing how C-peptide, intravascular C-peptide, and extravascular C-peptide interact. So, really just taking this extra compartment to get our C-peptide dynamics properly. And when we think about what's coming into the system here, What's coming into the system here? Essentially, we have this secretion denoted by our S of T, which is the main thing that we're interested in, and then some general uptake and some exchange between the compartments. And the insulin secretion is the thing that we really want to know, but it's also the thing that we don't have a good way to measure. So actually, being able to measure insulin secretion, very invasive. Secretion, very invasive, not something that you can do on humans. So that's something that we need a way to estimate. And so if you notice in this system, this is basically a linear system, except for this S of T term. And so we can rewrite the system here in matrix form and then write down what the general solution to the system would be as an integral. Would be as an integral equation involving this s of t term. And then that model using an approach that has been previously published can be discretized and basically you know we can kind of convert all of this over so that we're then trying to estimate our above basal insulin secretion rate on some kind of fine time grid. And so now for working with this, the goal that we were taking The goal that we were taking was to get a statistical model that could include some of this physiological knowledge, right? So, this is the idea that came up yesterday where we know something about the physiology. We don't want to just assume completely general model, but we want to leverage what we know about the physiology and then find a way to go through and infer this underlying insulin secretion rate, which then we can use as an index for beta. We can use as an index for beta cell responsivity. And one goal that we had for our methodology in this is that we wanted to be able to quantify the uncertainty of our estimations. So because we're going to be estimating these different insulin secretion rates, we know that there's going to be uncertainty that's associated with that. And then we want to think about how can we propagate that uncertainty through to what we're estimating about beta cell function. And so we're developing this Bayesian hierarchical model. We're developing this Bayesian hierarchical model to do this. So, here, when we think about the general mixed effects model, so here I'm going to take this C tilde to be my observed above basal C peptide and assume that this is coming from my insulin secretion rate here with some measurement error on it. And then I'm going to take this S, insulin secretion rate, and think about this. And think about this as this linear piece plus the zero-mean Gaussian process. And so that's sort of the general approach. It feels a little bit funny because we don't really think the insulin secretion rate is going to be linear, but we're going to basically make the gasting process do most of the work in capturing the fine detail of that. So then we need to determine the covariances. To determine the covariances of our different processes. And so here we're going to assume this process variance for y of sigma squared and define the kernel function here. We'll use just a radial kernel, but we're interested in thinking about other possibilities here. And then thinking about our covariance of beta here, which we can enforce here, our steady state. Here, our steady state condition. So, we know that our system wants to be a steady state at t equals zero. So, we set everything equal to zero, which then allows us to find our negative alpha one, go through sort of machinery of this, and then eventually get down to compute our conditional mean of y and conditional covariances. Okay, so within this model, we have these general parameters. The sigma squared is our process variance, and the theta is our time range. And we'd like to identify these values empirically, but this is challenging partially because of the sparsity of data that we've talked about. You know, we only have a few data points for every individual. But one thing that we were able to leverage in this is the fact that all of those individuals are The fact that all of those individuals are independent. And so we could actually use the entire cohort of data that we're working with to get cohort hyperparameter values. And so to do this, we're going to do generalized least squares. We're thinking, so here, this is just to remind you of where that sigma squared and theta is appearing in our estimated alpha. And we get this log likelihood for an individual. For an individual that depends on these different things. And then we get a log likelihood for the entire cohort here just by summing up all of those log likelihoods for each of the individuals. How do you deal with the fact that none of these people don't have a uniform disease? They're not CFRD at some point. They are all in different parts of the progression, and they're not, like, the population. And they're not like the population isn't stationary. Exactly. So, so, right now, we're just going to push all of that into the gas-time process. So, for different individuals, that goes in there. These hyperparameters are going to be fixed for the whole cohort. I mean, so it's a great question, and it does seem like something that you could refine further, but we wanted to sort of leverage the largest group. We have looked at it by groups as well. By groups as well, by people with CFRD and controls without CFRD. And we see some slight differences in the estimates of the parameters that we get there, but we're actually able to do well when we just use all of them. So using all of them has been the approach that we're taking here. Alright, so we maximize this, and so this just emphasizes what the Emphasizes what the structure of our Bayesian model is, where we have our data level of our observed C peptide, the process level of this Gaussian process, and then the priors that we're taking based on these different parameters that we've estimated. And so for our inference here, as I said, we're going to estimate those hyperparameters by maximum likelihood. Then we can estimate alpha by generalized least squares. And then we're going to estimate. And then we're going to estimate our y by sort of going through the machinery of what we have in terms of where we expect it to be based on what our observed C peptide is. And doing this process, so I'm showing you here, we did this with some simulated data. So this was the actual secretion rate that we simulated. And then from that actual secretion rate, we sampled. Secretion rate. We sampled a few points at the time points of our HTT to represent the true time points that this is happening. Then we added some noise onto that to represent the measurement noise. So we have what we're actually observing, which is those orange dots. And then we do the reconstruction method. And so you can see our inferred insulin secretion rate is this black line. And then we have these 95%. And then we have these 95% confidence intervals around the black line. And we're basically doing a nice job of capturing what the true insulin secretion rate was with this method. So it's nice to do this on some... Yeah, Kendra. I'm just kidding. So how are you measuring that secretion rate? So this is synthetic data. So we generated the secretion rate here. Yeah, so because it's not possible to easily measure the secretion rate, Easily measure the secretion rate, we wanted to sort of do a sanity check and make sure that what we were reconstructing really was meaningful. So, this is what we would be reconstructing, or this is what we simulated as a starting point, and then we wanted to try to recover what we simulated. And then, using that insulin secretion rate, you can see and putting that into the ETIN model as our. Putting that into the ETIM model as our desired secretion rate, then we get this nice fit to our C peptide data. And so I'll give you just a teaser, a quick proof of concept of this on some clinical data. So these are just preliminary results, but here, these were the measured C-peptide observations. And then this is the reconstruction of the insulin secretion rate with the confidence. Of the insulin secretion rate with the confidence interval that we get from those C peptide observations, and then putting those back into the model and propagating things forward, we get to this reconstruction of C-peptide over time. So this modeling framework is kind of an interesting way to bring together some of what we know from the differential equations, formalism side. Side, or I guess what we know from the physiology side that we can formulate in the differential equations, and then putting that together with some statistics and allows us to recover this profile with some confidence. And the nice thing about this is that this is all completely straightforward. Once we've specified all of this, getting all of these confidence bounds is immediate. So you don't have to do MCMC or something else like this to try to approximate your distribution. Like this, to try to approximate your distribution, you know where that needs to be, and so then that's something that we can propagate forward into the way that we're quantifying beta cell functions. And so if you're interested in seeing how this shakes out on the CFRD, my student Justin is going to be talking about this work at the SIM Life Sciences Conference this summer. So he'll present the data from all of our actual patients. So with that, I'd like to acknowledge Justin, who really Acknowledge Justin, who really led this work and has been really instrumental in developing this approach, and Christine Chen, whose experimental data we are working with, and Doug Nichka, a statistician at Mines, who's also been very involved with this project. So, thanks, everyone. I'm happy to take questions. What happens if you swap out the model? If you swap out the model mechanistic model or different one? I don't know. Yeah, we haven't tried that yet. In general, we're thinking that this kind of methodology could be really useful for applying to all kinds of reconstruction of some unknown process that you're observing some kind of output on. And so we've been thinking about it more in the kind We've been thinking about it more in the context of the OGTTs, where we were talking about that rate of appearance the other day and thinking about, you know, can we use this kind of approach to estimate the rate of appearance in a nice way? That would be really interesting also for being able to really see where some of the differences come in with some of the other methods that people have used for estimating rate of appearance. But yeah, we haven't looked at it yet with any other itself. Do people use C-peptide as just about this model, as just a basic substitute for insulin? Like how else? Because I'm just wondering, you know, because obviously what you're modeling is that they get produced together, then they diverge, because insulin gets processed another way, C-peptide, you have to remodel for C-peptide. So it seems that you could tell when and how they would diverge from each other. So if people are using C-peptide for other purposes, you could predict how far off they should normally be because you can prepare. They should normally be because you can compare them to the insulin model to the C-peptide model. I don't know how do people use C-peptide normally? Yeah, I don't know. That's an interesting idea. The main way that I've seen C-peptide used is this idea of getting at insulin secretion. Because, of course, the role of insulin does depend more directly on insulin. So that's sort of used more directly there. But because it's released with insulin, then you can see it as this marker of insulin secretion. See it as this marker of insulin secretion, but. So they're not using as good a model, but they're basically doing the same, trying to accomplish the same goal. Okay. Yeah, but it's an interesting idea to think about where the C-peptide and the insulin diverge and that's different in different people or how that's different. 