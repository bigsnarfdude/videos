organized this great meeting and having so many wonderful people talk about science for whole weeks. So we work on single cell genomics and today I'm going to talk to you about some of the work I did during my postdoc and it's going to be about models, statistical models mostly about how to infer gene regulation principles from single cell data. So a broad question that I'm interested in is asking you to do that. A broad question that I'm interested in is asking how do cells coordinate different gene regulatory layers to make self-repecions? And from a single-cell genomics point of view, one way you can do this is you can take maybe one or two of these regulatory layers, for example, mRNA or TAC-seq, and you sequence it, you profile genome-wide in a heterogeneous sample with many different cell types. So, with many different cell types. So, then once you can do that, Cell types. So then, once you can do that, you can look at the data and ask: maybe there's a you can explain how these regulatory layers are changing to explain different cell type functions. And at the moment, the community is very good at profiling certain regulatory layers more than others. So at the moment, single-cell RNA-seq, for example, is the most popular one. And that's looking at mRNA accumulations across single cells. But if you look at the life of these mRNAs, actually the chromatin regulator. Actually, the chromatin regulation is very important because that's kind of the birthplace of a lot of these mRNAs. And understanding how this chromatin regulation occurs in a single cell could give you some information about how gene expression gets regulated. So today I'm going to talk a lot about histone modifications specifically. So the acoumatin regulation is important because it allows these DNA to be packaged inside the cell in some kind of regulated way and it can be modified to And I can modify to modify the accessibility of the genetic code to different cell types. So, you know, one genome, different cell types could have different access to different parts of the genetic code. And really, one of the main players at the molecular level are these histones and specifically these post-translational modifications, which kind of work together somehow to close the chromatin, open the chromatin, and regulate gene expression. So these different So, these different histome modifications really work together somehow, and there's a hypothesis that constitutes some sort of a histome code. And the hope is that understanding how these histome modifications work together will give you some insight into how regulation can occur to get different cell types to remain their own cell type, or they can change different cell types and also maintain cell type function. So, the main player is really you have at chromosome scale, but then chromosome scale, but then at a gene scale you have these kind of inactive regions that are inaccessible to certain machinery. And then for active regions we have regions that are accessible for transcription to occur. And then there's many different histomodifications that people experimentally from biochemical assays to verify and kind of study different histomodifications and how they function. And all these often are kind of done in biochemical assets. But at the moment, really thinking about the whole histone code across different cell types is still quite difficult because we're still not really sure how these histone code kind of work together to work in many different cell types and just kind of thinking about both if you think about experimental and theoretical approaches. On the experimental side, at the moment there's really no good technologies that can map the entire histone code in single cells. And one of the reasons, of course, is the histone code, there's Of course, the system of code there's a lot of different components, and we're not really sure which ones are important. On a theoretical side, of course, you don't really have all the components because there's many histor modifications, but importantly, you don't know how they interact. Are they kind of repressing each other? Are they activating each other? And hopefully, I can show you some examples today where some of the progress can come from integrating some of these new technologies that are coming out with new models, and then hopefully also creating an iterative. Creating an iterative feedback loop where you also have new models that can inspire new experimental technologies and new experimental designs. So, just to give you a little bit of overview of what we're trying to do in terms of mapping simple cell histomications, so usually what happens is you have this kind of heterogeneous sample with many different cell types, and then what you're at at priori, you don't know which cell comes from which cell type, but you hopefully you can do some sort of an assay where you can profile. Some sort of an assay where you can profile the patterns of the histone applications in each of these cells. And then hopefully you can see, for example, in this toy example, cell 1 and 2 look very similar, whereas cell 3 and 4 are different from cell 1 and 2. And that type of information might help you understand how the gene expression is regulated for different cells. And one of the ways to do this is using technologies like cut and run and pen and tag. Like cut and run and pin and tag. And so in Ben Arnhard's lab, so we had this kind of a method called sort chick. But the idea really conceptually is you're adding a DNA cutter that allows an enzyme to walk along the genome. You cut DNA specifically into the histomodifications of interest. So for example, schematically, this DNA cutter specifically, it's a protein A, MNA, suffusion protein, and it walks along this genome and associates to regions. Genome and associates to regions that have histome modifications. And then you would activate the MNAs and it would generate a cut. So for example, this cartoon, you might generate two cuts, one on the left, one on the right. And then for another cell, it might happen to generate also two cuts, but not exactly in the same position. And in cells three and four, they tend to generate cuts in the middle. So although you get this kind of data where it's Data where it's kind of cuts along the genome. What you really want is kind of a whole pattern of histone replication. So it kind of presents a bit of a challenge on the analysis side because what you have is you have these fragments that are cut by the MNAs. And you don't cut every single fragment in the genome, so you're cutting some small fraction of it. And you get to map it onto the genome. So in this example, for cell one, this cut maps on the left, and the L1 maps on the right. And the other one maps to the right. And then, for another cell, it might also map to the left and right, but just in slightly different positions, and so on. But what you really want is not this kind of sparse noisy counts along the genome. What you actually wanted before was this kind of whole pattern of histomications. So, really, one of the challenges is that a lot of these single-cell genomics assays is, you know, you observe these cuts and then you want to infer something about the real biology that you care. Something about the real biology that you care about. And hopefully, the hope is that you have some sort of information between cell types and across genomic regions so that you can infer some sort of a lower-dimensional link space that can reveal relationships between cells and between regions. And so, today I'm going to talk about one specific method called the link figure sheet allocation. And people who are like population geneticists, they might notice from the algorithm. From the algorithm structure. That's also independently developed back in the 2000s. But really, this LDA model is a probabilistic model which generates count data from low-dimensional inputs. So really, fundamentally, it's really just a hierarchical multinomial model. So if you want to generate a cut in some location, in some cell, what you would do is you would, for a sample, What you would do is you would, for example, from a multinomial distribution to choose a latent variable. Sometimes in the literature, they call it topic. In this case, you can imagine the latent variable to be something like an archetypical cell type. So a really defined cell type of a B cell. Here's a really defined red blood cell. And then you would choose one of these. So each cell would have some parameter vector of big data, which tells you if it's. Of the thetas, which tells you if it's very likely to be one cell type of another. So you would choose one of the factors, let's say you chose one, and then after that, you would choose another genomic region given the latent variable. So then you would choose another multinomial, but this time it's parameters by a vector of p's, which tells you where the histomodifications are of the genomes. In this case, if you chose p1, you would generate a cut sampling from this distribution, which means your likelihood samples would collect. Which means you're likely to examine from the left or from the right. And then the only thing, the derisiative part of this algorithm just comes from adding priors to the multinomial, which gives you ability to prevent overfitting. And then finally, so that's a generative story, but you're actually given the data, so you have to confer these f thetas and t's, and that's the sample. So now, next slide, I'll show you kind of applying this kind of model. I'll show you kind of applying this kind of model and see what kind of information you get. So you can apply, so you can, we used the bone marrow as an example, and we applied the experimental technique of Sorchik. And then... So in this analysis, are you assuming the number K is fixed? Yeah, so here the number K is fixed. So it would be something like a PCA, you would choose some number of principal components to take in the end. To take at the end. So usually we take something like 30 to 100. But empirically, it didn't really matter so much. But if you wanted to kind of make the k's as also a parameter, you can also do that. Then it would be some sort of non-parametric version. But that also exists. So, just to show you what the data would look like in the analysis, show you. Like in the analysis, showed you an example of bone marrow. And today I'm going to show you mostly on active histone modifications. And here we chose bone marrow specifically because it's actually quite difficult to get some very rare cell types from these bone marrow, like hematopoietic stem cells. They're very rare. So that's why I showed this technique called sort chip, because we're combining this with fact sorting to get really rare hematopoietic stem cells and also the abundance cell type. So then we can apply, we get this kind of noise account. Can apply, we get this kind of noisy count data using this experimental method of sort chick, and then we apply LDA. And this allows us to infer this theta matrix, which the k's are these latent variables, and then the n is the different cells. And then, so this is usually larger than 2, usually in this case is 30. You want to visualize this in two dimensions, so usually people do UMAPs or T-SNES, but the idea is you're just summarizing this matrix that's kind of This matrix that's kind of k-dimensional into two-dimensions, and for each of these dots are individual cells. And you can see that just kind of qualitatively, some of these cells cluster in each other into little islands. And the idea is that those are kind of related cells. This is kind of an unsupervised method, and you still have to kind of go through these latent variables and kind of figure out what they are. And then you can do something, and then you can color these little islands to different cell types. In this case, we kind of broad. Different cell types. In this case, we kind of broadly just annotated each cell types. Importantly, we have these chematoquitic stem cells that are in the middle, and that's relevant because if you just normally, if you didn't enrich for the rare cell types, you wouldn't get this at all. And just to give you an example of what one of these cells look like on the genome browser, you can plot the data like this, where here on each of these rows, you have individual cells. And then these little rectangles here is where the enzyme cut on the genome. Here is where the enzyme cut in the genome. And then I've colored the identity of the identity of B cells. So here are the B cells. So, what you see, you have a lot of cuts in these B cell-specific regions. It's called early B cell fracture. And then the other cell types like lithioblasts, you almost see no cuts at all. And then interestingly, you also have these in the hematopoietic stem cells, and you have this kind of intermediate state. So what we find is actually these hematopoietic stem cells have this kind of primed comatin state, and then the expression in. State, and then the expression, the dynamics go up or down depending on whether it's going into a different cell type specific regions. So, that was what I showed you so far is just how do you get these sparse counts into these kind of histomodification patterns that you care about. But what you actually want is maybe you get something mechanistic insight or some kind of regulation insight. And specifically, we like to be interested in looking at protein regulators that can explain the different histomops. So, specifically, we would like to be able to predict, for example, why these patterns come about. So, in this example, you would have, in this cartoon example, you might have cell 1 and 2 have high activity for transcription factor 1, and it's binding to the regions left and right of the genome. And in cells at the bottom, the activities are different, so then you have a very different histomophagy pattern. But the idea is to be able to explain how these patterns come about. Explain how these patterns come about in terms of regulators. The way we do this is using a range regression model, and that allows us to model these transcription factor activities to explain the patterns. So just to show you how you set this kind of analysis up, so what you have is this kind of Y matrix, this observed matrix of where these histone modification patterns are coming about. And then you have these covariates here, which tells you where the transcription factor binding sites are. Where the transcript factor binding sites are. So, for example, you can scan the genome and try to infer where different transcript factor binding sites come about. So, this is independent of cells, so because all the cells have the same genome, so all you care about is which region you're in, and then you can get a probability vector of where what kind of transcript effects are coming from. And finally, you have these inferred variables, these betas, and that gives you for each cell how active certain transcript effective motifs are. So, for example, in this card. So, for example, in this cartoon, these first two cells have very high activity for transferctor 1 because you observe histomodification patterns on the left and the right, and you also observe that there's a binding site on the left and the right. So that's kind of how the powder model works. And so to fit this model, the only additional thing you want to add is that there's this kind of kinetization term because we assume that a lot of these transcription crafting activities are small. Crafting activities are smaller and also helps prevent overflowing as well. So, just to show you what kind of data you can get, you can actually plot kind of the most statistically interesting motifs and you can get kind of, you can kind of sort them by how much they explain the data. So, for example, so these are kind of real transcription factor motifs. So, for example, Erg, you're saying that there's this motif here in the Genoese very important in explaining a lot of this data. Explaining a lot of this data. So you can also plot this back onto the UMAP. So because you have this vector of betas across cells, you can take a slice of this matrix, and then for each of these cells, you can plot the transcription factor activities, which we infer from the model, back onto the UMAP. And here, for example, this erg is a hematopoietic stem cell regulator. So you can see actually it's very high in activity in the center of the UMAP where the stem cells are. And it has a differentiates into other. Differentiates into other cell types, the activity goes lower. And finally, you can also, just to summarize all of many transcription factors, you can take this beta matrix and show it in the heat map. And here I'm showing you every column here is a cell. And then every row is a transcription factor. And then you can see that, for example, tau1, you have very high activity in red blood cells. And then you'll have a region here where they have high activity for the hematoid stem cells, and so on. Myocoid stem cells, and so on. So, I finished kind of the first part of the talk, and it's really the point here is really you can try to actually infer regulation that's underlying single-cell genomics data and how to use these models to explain gene expression patterns. So, the first part really is that the single-cell data that you observe is usually very sparse, and there's usually some sort of modeling, which is just to get the real Modeling was just to get the real patterns that you care about. And the second part: once you have these patterns, you can actually model transcription traffic activities to infer, for example, which regulators are important in the data. And this is just a very small slice of the story. So you can check out the preprint. And really, that shows four different histomifications for factive and pressive and kind of how they work with each other. So, I'm going to the second part of the talk. And really, the second part is really trying to see where the current frontier is and how do we go to the next step. And at the moment, a lot of these studies, although it's single-cell, you're still profiling one histome modification at a time. Meaning that if you want to study two histome modifications, like an active and a repressive histomodification, experimentally, what you would do is Experimentally, what you would do is you would take your heterogeneous sample, you split it into two different technical batches, and then for one of these batches, you would profile the active histone marks. Then you'll get kind of cuts along these kind of active regions. And then for your second technical batch, you would apply your repressive histo marks. So then, afterwards, you have data for your active and repressive and single cells, and we kind of play around with. Our cells, and we kind of play around with trying to match them. But it's never really one cell getting two different histone modifications. But if you actually look at it, there's already a lot of information that's coming from the active and the impressive about different relationships. And then the question we had is really, can you maybe do one extra experiment, maybe design in a clever way, coupled with modeling that can give you the coupling between the active histo modifications and the Between the active histomifications and the repressive histomifications. And this is just to show you that there's actually a lot of people doing very similar stuff, but it's always kind of one histomodification at a time. And the solution that we had is really looking at multiplexing two histomodifications together, and then you rely on statistical inference to deconvolve the signal. So the experiment is really you take a third technical Experiment is really: you take a third technical batch, and then you would add, you would stain your cells with two antibodies together. So now your enzyme is walking around and it associates with either the active histomification or the regressive histomodification. So then you generate cuts here, here, and also on the right. But then the problem here is now you have these cuts that you don't know if it's from an active histomodification or depressive histomodification. And also another complication is that you're doing this in a heterogeneous That you're doing this in a heterogeneous doctor cell, so you also don't know the identity of the cell types. So you're generating another cell for a cell might kind of observe two cuts here. But actually, you think about it, we actually, with the first two technical batches that I showed you, you actually have training data of what you expect different active histome modifications to look like in single cells, and also what different repressive histomodifications look like in single cells. So then you can actually use that information. So then you can actually use that information to deconvolve the signals, meaning that you take every one of these models where you take these cuts and you say, oh, it's most likely coming from an active here, and then you assign it to red. And here you see that in the training data, it's most likely a repressive, and then you would assign it to blue. And that's how you would get one cell with multiple historical locations. On the modeling part, this convolved signal, we can model it as a linear combination. We can model it as a linear combination of two multinomials. So, before I showed you kind of one multinomial, and now what we say is that these cuts are coming from a distribution where you have, it's parameterized by not just P, but a combination of P1 and PA. So the P1 would be like an active histor multiplication, the PA would be repressive, and then the W would be the linear combination. Would be the linear combination. And the idea here is then you can do that for every cell you want to be able to infer that. And once you have P1 and PA that you know, then you can kind of look into your each of these cuts and give it a probabilistically assign each of these cuts into red or into blue. That for every cell. And then you would get actually the information about both histomodifications in one cell. Complications in one set. So then it's really the problem is really figuring out which multinomials were mixed together to generate sort of calculus. P1s and P2s, they come from different cell types with different kind of trajectories. And the idea is just figuring out which P's they come from. I'm going to show you just an application of what this algorithm and also experimental idea would look like. So we chose, I'm showing Like. So we chose, I'm showing you today, I'm showing you an in vitro macrophage differentiation system. And then we're going to choose also two active histal marks. So these are highly overlapping, but perhaps there's some sort of information about which comes first and then activates the other. And the experiment is you take these progenitor cells from the bone marrow and you add a macrophage, a simulating factor. And over seven days you collect these cells, so then you have a trajectory from progenitors to macrophage. From genitors to macrophages, and then we want to study two different histone marks: ketpholomonomethyl and ketflic trimethylation. And then we do a third technical batch, which is this kind of double incubation to get both information together. So just to give you a little idea of what this looks like on the genome browser level, I'm just averaging across different days. And what you see is that the K36, there's not much signal at the beginning. There's not much signal at the beginning, but it increases kind of later and rapidly. Whereas the K4 model method, it increases kind of in a more monotonic way. So this is kind of still kind of bulk, but then because now we have single cell resolution, we can actually look at the data in kind of UMAP space. And here I'm going to show you just kind of two different UMAPs. On the left is the K4 monomethyl, and on the right is the K36. And each of these dots are single cells, and then they're colored by which they... Cells, and then they're colored by which day they were collected. And then now, importantly, we can actually connect the two UMAPs together, two spaces together, because we have some cells that have been incubated with both histomodifications. So once you've deconvolved it, you know where each UMAP location corresponds to the other. And the idea is hopefully you can get this, using this information, you can systematically compare how fast K4 monomethyl progresses relative to K36. Relative to P36, for example. So, to do this quantitatively, what you really want is to be able to take every one of these cells and assign it two real numbers. One is a T and another is a tau. So, for example, the T would be where it is along the differentiation trajectory for K36 trimethylation, and then the tau would be where the differentiation trajectory is for K4 monomethylation. And then you would assign it for every single cell, and then you would Sign it for every single cell, and then you would be able to understand how the t's and taus are related to each other. The way you would do this is you would maximize a multinomial likelihood, and in this case you have these t's and taus where the different t's will give you generate different vectors of p's, of vector probabilities from the histo modification patterns. And then q here would be the histo modification patterns like other. So you would Got up. So you would try to figure out which t's and taus maximize likelihood. And then when you do that, you can get the maximum likelihood estimates and also error bars. But the point here is that you can see that the tau here, initially the K4 monomethyl progresses first and then the K36 rapidly catches up and eventually reaches this terminal state of macrophages. So, what we see is from the single cell data, we can actually model how this K4 model methylation is increasing progressively, and then the K36 catches up later. And then finally, you can actually model these dynamics using just simple ordinary differential equations because we have this kind of time course and trajectories. And you can use this to infer kind of Kommats and velocity or basically adding. Basically, adding kind of a direction to these new maps and PCAs that I showed you. So, what I'm showing you here is one gene here. Each of these dots are individual cells. And then there's a fit from the exponential fit from the solution of the ODE. And then the tip of the arrow is really taking these gamma estimates that you get from this fit, and then you can infer at some time t plus 1 where this cell. Where this cell might be going in the next time point. And then you can do this for activating genes, but also you can also do this for repressive genes that go down over time. And then finally, you can do this for many genes. You can summarize this in a PCA plot where these vectors for each gene are kind of projected onto this low-dimensional space. So in PCA, it's fairly simple, because it's just a linear manifold. But what you see is But what you see is that you have these cells that go from progenitors to macrophages, and then now we can also plot this kind of a vector field which tells you where the chromatin is going at each of these points in the space. Your ODE is the T pseudo-time or real time? Yeah, it's pseudo-time here. Because in real time we only have like zero, one, two, it's kind of discrete. So what we did is, yeah, so what we do is we plot we plot it across the whole zero to one basically. 0 to 1 basically, and the colors here are the days. The colors are really just for us to verify that things are making sense. So it's kind of like a validation. But within one day, it can be kind of anywhere for reasons that are biological or experimental. But things are done on the on the pseudo time. So even on the when we were inferring this stuff, it's all kind of pseudo-time because we wanted everything kind of a continuous trajectory. Continuous trajectory. So that's all I have. And just to wrap up, I showed you some integrated experimental and computational frameworks. And the goal of that is to infer gene regulatory principles. And the first part I showed you, you can combine these kind of machine learning and then just simple systems biology models to infer regulation from single cell data. And then the second part I showed you was really looking at how do you get new statistical models to inform. Get new statistical models to inform new experimental designs. And I chose one where you can start to map multiple histomatications in single cells. And then finally, you can use that to model dynamic relationships between histomarks. So thanks very much. Do you mind hitting the button? Sure. And are there any questions?