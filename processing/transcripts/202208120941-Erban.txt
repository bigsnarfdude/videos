This is the my talk is on the last day of this workshop. So that's which is a good thing that I can kind of react and reflect on the talks which I have seen here. So there are some talks which lot of interesting talks I just highlighted here a couple of them. So Chris was talking about predicting a function of a Was talking about predicting a function of a biomolecule from sequence alone. One thing which he started his talk with, he was kind of giving an overview of the standard tools. And the conclusion which he mentioned is that molecule dynamic simulations are computational intensive for these tasks. On Monday, we had another talk by studying ligand receptor binding and again concluding that standard Brownian dynamics emotions are computationally intensive. Computational intensive. So, in my talk, I'll be discussing grounding dynamics and molecular dynamics, and I would like to discuss various methods how to make them less computational intensive. Now, I understand that there are people with different expertise in the audience. Some people are experts in these topics. So, I can introduce what these methods means, what Brownian dynamics means for the others. I only have 30 minutes, so it will be a very quick introduction. So, if you Introduction. So, if you get lost and if you are interested in these topics, we have written most recently a textbook with John Chapman and the Spanish Recommenders Depressed. It's a textbook which we have used in Oxford for teaching both undergraduates and graduate students. And during pandemic we also posted our videos online on YouTube, so that you can use it also for self-study. And also you can also find all the supporting computer codes. Or the supporting computer codes online. So, if you get lost, and if you think that rounding dynamics, monochromatics, or other methods which I'll be discussing by compiler-based model dynamics, are of interest to your research. I'll be discussing how to make Brownian dynamics, more condemns more efficient by using market resolution modeling. So, this is kind of a motivation slide for market resolution modeling. Market resolution modeling. We have seen similar pictures before during this workshop. So, this is just a text-to-picture of a eukaryotic cell, which highlights how complicated the cell is, but also how much data we couldn't know about in a cell biology. If we zoom in in any particle region, we can get more and more data. If we put try to put all this data into a computer toggle, then make a computational model of the whole cell and you can't simulate it. So, you can't simulate it. It's computationally impossible. So, it's not possible to use detailed microscopic model over the whole simulation domain in this particular example. But I'll be discussing application where microscopic detail is only required in a relatively small region. It's actually close to a sun and kind of particular dynamic. And then there is a a proportion to use some sort of partial resolution methods to basically use models with different levels of detail at different parts of the computation. Of detail different parts of the composition of itself. So I just started with an example from cell biology, trying to model host cell dynamics. So I'll just kind of briefly on one slide introduce these methods. Particle-based and compartment-based type simulations. So the ground line dynamics, which I chose for this talk is, I was talking about In this talk, so I can just try to introduce in very basic terms. So, in Bermuda dynamics, I'll be just calling individual molecules, which we also call particle-based modeling. So, in this video, you can see just a molecule, let's say protein, which is described by its position, x, y, z. And I'm just calculating the position of the protein at time t plus delta t. Well, delta t is my computational time step from the previous position by adding some random displacements. Which is Which is scaled, which is not waste, that's calculated diffusion constant, it's a physical parameter of this module. And if I repeat this and iterate this over many times, the target typical behavioral emotion. Now, prominent dynamics, that's interaction, excuse me, such modeling. So I simulate all the proteins, all the important biomolecules using the evolution rule, but also introduce another processes that if these biomotives are close enough, then they can react. Groups are close enough that they can react or function. Now, in the area, there's also another approach on how to model similar reaction diffusion processes stochastically, which is compartment-based modeling. So, if I'm looking at the level of the individual molecule, if I'm looking something which will be analogical there, it is just a jumping or a particle in a lattice. So I divide my domain into some compartments and boxes, which are some lattice size. We just have a lattice size h, and I will just let mole jump with rate d over h squared, where d is a diffusion constant, and I get a lattice-based random work, which is equivalent to ramming a motion. But the big advantage of this model is that I'm not simulating really individual molecules with it, but in practice you only simulate numbers of molecules in each compartment. So state vector in the computer is not seven individual molecules. Not seven individual molecules in their positions, but just number seven in this box. And this is a state of a given time, which is at all exclusives. Because we only simulate the time evolution, numbers of molecules in which compartments makes the compartment-based model much more efficient than Brownian dynamics. It's the simulation of the speed space on Stein Markov chain. It's so efficient that the applications took also a model in the recent. Also, a model in the recent years software packages when this type of stochastic reaction diffusion metrology is having implemented. Having kind of introduced these kind of quickly these two types of models, I'm not going to discuss resolution modeling, why is it interesting, why is it interesting for mathematicians, why it should be so interesting to people in applications. So think about using models for different parts of the computation domain. Different parts of the computation domain. So, it's of interest to mathematicians that there are well-defined mathematical problems. So, we can just introduce it on the simplest possible example. So, I just take a domain here, and I divide it in two halves. So, in the left part of the domain, I'll be using this compartment-based mode, which is just lattice-based random mode. In the right part of the model, I'll be using LM dynamics. And I would like just to blue these models together. I would like to blue these models together with one goal. I would like in this part of the domain. I would like in this particular domain, it's like a detailed domain, where I'm using individual model I post, get the same results as I would get if I was using this detailed model everywhere. So that's ultimate goal. You can just think about it, that this is kind of relatively easy. So if I simulated this Brownian dynamics particle, I know what is the rate jumping to each of the four directions or six directions. If I'm 3D, there's a rate D over H squared, where D is the. Rate D over H squared, where D is the diffusion constant and H is the size of the compartment. So I can just simulate it. I mean, I end up in this boundary compartment, artificial numerical boundary. I could just say there is also a rate of jumping out. So I could say that the rate of jumping is again V over H square, the same rate, like jumping into a compartment, and I could just say, well, I have to cut additional information here because this is a more detailed model. So I have to initialize this particle. So if there's a six particle. So if there's a six particles here, there will be five here, but you have to keep its initial position. So I could just say, well, let's initialize it at a half of this compartment size from the boundary. You can just quickly design some rules and put it to the computer and simulate. On the problem is that if you do it that way, you will end up with big numerical errors on these boundaries. To illustrate it, I will just use exactly the scheme which I just described. So the ionic particles jumping with a uh rate here and a grammar particle one was the produced domain. So it was a seven molecule here, I'll just change grays. 7 mole equals 0 just change grays. It's a very quick scheme how to write it with a computer code. And I will just test it on a simulation of diffusion and equilibrium. So, diffusion and equilibrium means that I should have a constant number of molecules in the whole domain. And this would be a kind of typical result which you get if you do it that way. So I can simulate a bunch of molecules and I introduce these like a lattice-based random mode here with the same diffusion constant as Brownian motion here. Here I ended up the molecules, so I kind of summed them up and created a histogram. them up and created a histogram. You can see that it's constant here, it's constant here. That's what diffusion does. There's no other process in the simulation. You can previously see that there are more particles transferred from the right to the left than from left to the right. So that's undesirable. If I was using it in some big, big computational scheme, I would not have as many molecules here as I should have. So now first I should explain why there are such errors. There are such errors. And the second I will explain how we can what type of methodologies are used to correct such errors. So let me first discuss quickly why there are such errors. I do this way. So it's going to always look at some details what is actually happening with these processes. So I said my only process which I have on the right is a stochastic model of diffusion based by the stochastic Gaussian motion. So I have a position of the molecule. Of the molecule, one dimension is with a position at time t plus delta t is position of time t plus some random displacement. What I'm kind of plotting here is this is a position, this is time, and this is what my computer gives me. So if I go to the simulation of one time step, I have position molecule x is here and position at time t plus delta t so. This is my boundary. So you can see that if I simulate this. This brownier particle, and just have some condition in the code that whenever this particle crosses this interface, let's just remove it from the simulation and increase the number of particles in this boundary compartment by one. Then actually, that would not happen by simulation. On the other hand, if I now use a smaller time step, I just try to more accurate results, then the trajectory between these two time points is not straight. It's down in. Some trajectories actually cross this interface. Some trajectory is actually across this interface, or the petroleumization or the mineralization are actually interacting with this compartment-based model, and I should have transferred them, but the other ones are not interacting. So we can see that that is, if this calculated position is inside my molecule-based subdomain, then the molecule actually could cross-interface with some compound. So then at this point, So then this probably depends on my time steps. So the conclusion is that if I want to couple modules, computer codes which are written for grounding dynamics emergency compartment-based simulations, this coupling must also depend on internal parameters of these networks, which in this case was just a time step here or the compartment size H. And to correct it, you have to kind of introduce these these transition rates into into Into schemes. So I just put here one possible scheme. So what is the scheme doing? So it's a simple, basic. For example, and I'm saying that if particle is on this, then it has some default rate to jump d over h squared to all other compartments, but I change it and I send this extra parameter phi, which is a jump rate from here to here. I would like to calculate what it actually is. Now, if I'm going. This. Now, if I'm going from course description to detail description, I have to add extra information. Again, I chose it before somehow adhoc, say if I put it here. I would just not say it al-Haroka, I'll just say there is a whole distribution. So I sample my initial distance from the boundary from some distribution. Now the question is how do we kind of realize these new parameters with my experimental data, which in this case is only diffusion constant, and algorithm parameters such as the size of the compartment or the time step used to be in this domain. In this domain. So, to do it, write some underlying equations between the more interested people who work in this area. So, obviously, just a clarification version. So, the modifications that you're making are modifications of when you're going from the compartment into the Brownian. And that's the key to fixing this error. In terms of the coupling from the Brownian into the compartment, that's going to remain simple. Well, you have kind of a lot of freedom here, so we could introduce extra constants here. Introduce extra constants here. You can maybe introduce some rejection probability that some particles are actually bounced back. They don't absolutely oson, but it works just with these two. So that's kind of, you know, one doesn't need to complicate it further, at least in this particular case. You're right. This is kind of like a time to correct the fluxes and also correcting the other flux. So, Manasko writes something. So, I want us to write something like a Gamma equation, so which will help for this combined process. So, those who can work in this level see that there is some like a master equation actually, which is like a probability of being in the compartment, with some jump rates, there's also some continuous down-end motion in it. And these equations will also have these parameters, which I'm just analyzing. Now, if these parameters were chosen one and this fx was just this like introducing the particle at distance, well done. Introducing the particle at distance, the compartment size over 2 on the boundary, then solving these equations together introduces some boundary layers, some errors. So for main mathematical questions, choose these parameters so there is no error on the boundary. So I'm not kind of showing the analysis, I'll just show the answer for this particular thing. So you can do some boundary line analysis to ask the question, can I choose these parameters if there is no error on? Choose these parameters that there is no error on the boundary. And you obtain that phi is subratio, which inputs the diffusion cost about solving components as delta t. So for specific choices, H and delta T, this could be one, and this could work. But for the choices which I use in my earstructive simulation, this was not one, and there are incorrect fluxes. And then you can see that it could be greater or less than once. Uh my my nice picture showed there is a more molecules in compartments, but I could go for different choices of the uh discretization parameters. Disconnection parameters that you picture. Now, of course, it will be more or less compartments. I have to choose it according to these results and just show you how it kind of works. This is just kind of an illustrative example. And I'm showing results of four simulations. So we're going to loop. Stop it here. So what do you see here? This is just a trendline weight problem. Technically some reactions, a tissue weight. There's some reactions, some tissue-based, so there's some reactions and diffusion. What I'm going to show you here is the self-force simulation. So, the blue one are the molecules, the molecule-based simulation, which is using integral molecules everywhere, the nitrogen creates some histogram. Now, red ones are purely compartment-based. I'm modelling blue, what I didn't talk about some microscopic partial differential equation for this model. And this is my combined model. This is like a combined model. So basically, the ground through in this simulation are just molecule-based, particle-based, chromium dynamic simulation. So that's what I would like to replicate, and I'm going to replicate it by replacing it by with compartments behind the wave. So only, because in this particular example, what is struggling with this detailed interaction between molecules are only needed in the front of the wave and there is only few of them. I can obtain the same. Of them, I can obtain the same results between these two simulations by replacing most of it behind the front of the wave by compartments. You can see the computation. The wave speed speed of the wave is the same for my couples or molecule-based model, but if I use, if I correspond everywhere, which would be the bottom picture, the components are actually faster. Don't accrue by picture, but by the video that is from us, work not just for diffusion. Not just for diffusion at equilibrium, but also with reaction processes. The fact that the PDE goes ahead of the simulation is because you have small particle numbers, so stochastic effects are important. Stochastic effects are important in the framework, just basically no molecules and one or two, and it's very important how you implement your reaction scheme. So I have to implement my scheme to cement reactions using the same scheme which I use for my grants. But behind it is But behind it, it's not important as a water molecule, so even the compartment-based model, which is a stochastic reaction diffusion model, is going to do a good job. Anyway, so just kind of briefly show some application areas which we had. So one of the application areas which we was in calcium dynamics. So this is an application where we are discussing calcium concentration inside cells, which varies in time and space. So this is a time, this is a concentration of calcium inside cells. Inside cells, you can see there's almost no calcium, there's a big spike, but there's almost no calcium spikes. So, our collaborators were interested in the statistics of these spikes. The problem is that when this we wanted to select Brownian dynamics because individual ions are kind of regulating whether these channels were open or close. So, close to the channels, we definitely wanted to needed to use Brownian dynamics to resolve our model. But if we simulate it using Brownian dynamics up to the point when the channels open. Days after the point when the channels open, there was a lot of calcium in the system. It was fired, but then we couldn't continue because we had so many individual ions to simulate. So the way how to get beyond this is actually simulators. So statistics, so these peaks is that you only use brownie-dead and extra-minis channels, and in the vast intrusible space, use the compartments and next channels next. So that's kind of like a word. This can kind of This can kind of produce some sort of a long time series from which we could estimate, for example, frequency to these calcium events. So, another application for active dynamics and flow coding when we use the detailed grammar dynamics model and the tip of the flow code and coupled it, but compartment-based model and the rest of it. Now, and these applications can be the most detailed models for it in terms of rounding dynamics of points or balls. Second part of my talk, I'll discuss what Dana Twenty should introduce in more detail to the model. For these applications, it was a whole biological process which can transfer molecules between different parts of the cell and microscopy details quite much with small regions. So we use these multi-resolution methods for many components of the cell. For many components of the system, we also know the molecule structure and functions. Main question is whether we can add these extra influence into molecular resolution simulations. So that's true. The problem is that the actin in that actin application was simulated as a ball, some excluded ball methods, it was just a hard ball. But one of what we would like to start considering is all atoms simulations of activity, which would be like 2800 atoms, with a big, big change in scale. If you try to go. If you try to go in that level of detail, and there's some sort of intermediate descriptions in between the concept. So, just to kind of introduce what we do in this area, I get to just kind of introduce all the molecule dynamics. So, the molecule dynamics are usually the simulations that's done in water. So, this high this actin, like carbon, so a lot of description is also emerging in the water molecules. As also MRES and the water molecules, and all these emitting models simulate positions and velocities of all atoms in the system by solving mutants equations. They also ask what type of inverse integrators, boundary recognition terms that we use. The result is that we have to use very small time steps. Typical time standard MD simulations are about 10 to minus 15 seconds. Molecular dynamic simulations are limited to very small domains. To very small domains, if you kind of think about wholesale dynamics, there's a huge scale to overcome. So, I'm not advocating here to use all atomic simulations for whole cell dynamics. I'm going to dynamite just to illustrate how we can coarse main parts of the simulation. So, I would like to introduce an even more simple example than is acting first. So, simple, so I would just show you a simulation of diffusion of ions in waters. Of diffusion of ions in waters. What I did here, I have put a bunch of water molecules. So these are water molecules, red is oxygen, white is hydrogen. There are some ions in the system, so this will be kind of my initial condition, which I'm kind of rotating here that you can see it. You could see there are some ions which I'm going to put that light green color inside my water box. And I would like just to use this, which I'll choose some description of water, choose some other way. Of water, which is a way of simulating the constant temperature, and I just simulate it. Let's look at the corresponding video. Here, what I did here, I actually decreased the sizes in the water molecules with tiny because I would like you to make them smaller so that you can see some ions. We have focusing on one ion, which is this green particle. What you can see is that it's moving, yeah, it's a chaotic system, it's the last system of all these. All these, so and it's undergoing some stochastic process. So it looks, it kind of reminds me of the Brownian dynamics material which I showed you at the beginning. So if it was Brownian dynamics, so if it was some stochastic process which I understand, I could start thinking that I could maybe remove all these water molecules from the simulations and it was just a stochastic process for that atom I'm interested. That's kind of my restarted review. The myrostative video showed that this ion is can be used as a stochastic position trajectory and like to maybe describe it in a few parameters. But we also have this is a station from mathematics research, so I'm also in the math department, also asking the question whether we can do something analytic to get some insights into these models in this area. So I can just briefly show you that it's possible, that it's not just computation. That is not just computation. So, if you think about all atomic simulations, which I showed you before, the forces animated from short-range or long-range forces. But if you just focus on one particle type of forces, then you can get some constructable electrodynamics models. And you can just look at both of them, you can show very short-range forces, then you can do some analysis of the long-range forces. So, I'll just show you an example of a model with very short-range forces. Short-range forces. So, this is kind of a theoretical MD model with just short-range interaction. So, we can see here, I think, putting a perspective in my video of iron and water. So, here are just like some blue point particles which are all going straight. One time step is the description is the position of next time step is just the position periods plus thousands of times delta t. And big particle is also all going straight. They go all going straight until. They grow going straight until they collide, and they collide and just result in the collision like they are bores using conservation of momentum and energy. We can see that some distribution of these particles correctly, but if you look at a trajectory of this particle, it looks like the wave option. A nice thing for this model is one can improve a few table limit of masses of these particles. One can actually find some analytical results that large particle follows the. Particle follows the Banjoi dynamics, which then can be shown to be following Brownian dynamics. So, if I have such analytic results, then I can go from theoretical and molecule dynamics all the way to Brownian dynamics, I can some theorems. I can find how the parameters, which are diffusion constant and friction, depend on the parameters of my microscopic model. And in this case, these types of models can ask all the questions about. Questions about different software implementation of multi-resolution models in all atom molecular dynamics. For example, ask the questions in this specific model if you have a particle, you want to resolve part of the domain using detailed molecule dynamics, modular particles using Damned dynamics, then these particles have to be kind of crossing between regions with the blue particles and the double particles. We could ask the question, what type of What type of stochastic differential equation this part satisfies? So that's kind of what can be done for the theoretical, and you can ask analyze other multi-resolution schemes. So this one is just showing that system like caricature of biomolecule. This caricature is just a diagonal. You can ask the questions in a couple of couple, you can either coarse brain or solve far from the Grain solvent far from the molecule, you can also just coarse grain part of the biomolecule, or you can do what I was just showing before, your region with detailed model is fixed in space. So there are different situations in different applications used and you can use such models to write papers when you can reasonably fully analyze the results. Now if I now written back to I've now written back to the real all-attemmand simulations used by in computational chemistry. Then these Langevin dynamics at this machine, one cannot prove it, but one can still write generalized Langevin equation or some equivalent equation, which few extra parameters which will be kind of fit for molecular dynamics. So follow a similar thing, but they have some intermediate descriptions in which these parameters they want. In which these parameters, they were interference, therefore are fitted from molecular dynamics and they are a new scheme can be then used to design multi-resolution schemes. Just want to kind of come to conclusion? I don't know, because it started late. How much time do I have? Wait, two minutes. Two minutes, that's exactly. I just want to kind of conclude that. So far, I discussed theoretical ending models, which are easier to understand. Theoretical MD models, which are easier to analyze, and also bramble dynamics of ions, when Brami dynamics particles for an MD particle. We also work, and I'm happy to discuss during work on bigger particles. It's the collection of LD particles like for acting those of two thousand eight hundred atoms. So there are intermediate modes that actually are not described by all by the collections of modes collected by springs. By springs. Results when we work on multiple resolution B spring models with applications to DNA dynamics. And if DNA is of interest, you'll have to discuss during the break. This whole area is interested to, then we organize a Xenotype lecture by focus lecture on just on math resolution modeling in 2018. There was a special issue of our society interface. We gave you a snapshot of the field in 2019, it's about four years ago. 2019, it's quite a few years ago. I'm still working on it. So, my most recent work is remote resolution acting developments only. Coupling monomer-based description of acting, we describe each acting monomers, with customer-ross-based quantum mechanics model with the rest of the filaments, which is kind of a coupling. This is type of mathization model because when you are interested in a detailed model in a specific part of the biomolec, active science or somewhere. Part of science or some part of what I'm going to do which does something interesting. Anyway, so summarize it, so I've introduced these mathematical computational methods which we are using in our research, going from molecular dynamics to Mammy Dynamics and compartment-based models, and I'm going to focus on the multi-resolution methods, which use details of MD and MDD simulations in low-grass regions of particular interest. If you're kind of new to this, then you can just have another textbook. My last thing is that. Textbook by last thing is that since last day, we have only one coffee break now. So, if you want to discuss these topics further, we have a number of these clips and options for collaborative business. It's very difficult. You guys can just talk to me and we can discuss this research or start some apartment. Thank you.