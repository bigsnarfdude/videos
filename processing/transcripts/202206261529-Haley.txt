Is this full screen? No, just a moment. All right. Is that full stream? No. Okay. Stream. No. No, it's still just showing the window. Let me see. Okay. Okay, good to go? Okay, good to go? All right. So I think everybody thus far has been, you know, saying thanks to Dave and thank you to Dave from me as well. It's nice to be an organizer. But I'd also like to thank Alan Ch for some very interesting work that he did prior to the work that actually you just heard about in missing data. In missing data slopian sequences. So I'm just building a little bit on that in this talk. First of all, a shameless plug for some software that I wrote if you happen to be using Julia, which I think some of you might come across it in the future or in your studies or what have you. I've written a package and I think that we've heard a little bit about people who use MATLAB in this conference. In this conference. And if you're looking for a sort of an open source version, Julia or Python or any of these packages offer a sort of an interesting alternative. Okay, so not too long ago, Alan Chave took a very close look at a paper of Bronez from 1988, which was on the development of Which was on the development of unequally spaced Slopian sequences. And so these unequally spaced times basically defined a place where you could do concentration problems and band limiting. So if you look very closely at that eigenvalue problem, you realize that a simplification occurs when Simplification occurs when the observation times are integers and they just have gaps. So when that happens, the eigenvalue problem breaks down quite nicely into something that's actually quite tractable. The concentration eigenvalue problem, I've just written it here. It's sort of deceptively simple. And I've shown an example above where time is on the left. Where time is on the left, frequency is on the right. And these are related via sort of a non-uniform Fourier transform. And I'm showing the power here on the right. So this is a sequence of observing times that goes up to 453, 50 missing data points in the very middle of the sequence. So using similar notation to David, you know, we'll just call the case missing data sloping. Call the kth missing data slapian sequence v and lambda is the eigenvalues. So there's the reference for the paper from GJI. So as you can imagine, Alan then went on to construct a multi-taper spectrum estimate using these missing data sloping sequences. And we've seen this a couple of times already today. Couple of times already today, but this is just a multi-taper across spectrum estimator. You know, this averaging reduces the variance, and the tapering here reduces the bias. So this is an eigen coefficient here, you know, x, the k-th eigen coefficient, xk. So when we have this missing data cross-spectrum, it's easy to imagine just sort of jack knifeing up your own estimation. Jackknifing up your own estimation of the coherence. And so leaving out the details of jackknifing, effectively, you just leave out one of the eigen coefficients in sort of a sequence and then average those guys. So there are a number of advantages to using this approach. And one of them is that in the most general case, you have two times. Case, you know, you have two time series with missing data, but they can have different sequences of missing data. So there might be, you know, several large gaps in one of the time series, and there might be a large gap in the other time series, but it doesn't have to occur at the same times. It's interesting regarding the statistical properties because these guys aren't necessarily jointly orthogonal, but that's another thing. But that's another thing to think about. So, moving forward with this estimate for coherence, I'm actually going to take a sort of a cute example from Shumway and Stauffer text. So, it has 453 samples. On the left-hand side, it shows the two time series that we're dealing with here. Southern Oscillation Index is a sort of a measure of climate activity. Recruitment is the fish population. Is the fish population from a model? And actually, if you look closely at these two series, they're approximately out of phase, just about they're about five months out of phase, actually. So the fish population from the model follows the southern oscillation index. On the right-hand side, I've shown the magnitudes squared coherence and the phase on the bottom. And I've said phase factor here because Factor here because I'm just wrapping them into 360 degrees. And also, I've removed the lag. So there's this obvious lead-lag relationship between the two time series, which is linear, right? So there's a straight line that I've taken out because I really want to look at the residual. So the residual, all three of these estimates track. Now, what are these estimates? Well, the blue line is the multi-taper code. The multi-taper coherence computed without any gaps at all using all of the data. Same thing for the phase. This red estimate is the sort of vanilla Shumway and Staffer coherence estimate. And it's actually computed using, it uses this smoothing across frequency. So this increases the sort of width of any feature that you might see. Width of any feature that you might see. And it actually sort of reverts most of the coherence to a sort of a mean value. So the main feature of the coherence is that, you know, there's this high coherence at one cycle per year. And you see that in all of the estimates, but it's sort of suppressed in the red line, which is the vanilla Chemland Stoper. The missing data multi-gaper spectrum estimate is this. Spectrum estimate is this dashed black line, which actually surprisingly well is tracking the multi-taper without gaps. Now, this is approximately 11% of the data is missing, but this is a good sanity check to see sort of how well our tapers are doing. The yellow band here actually shows the Elino sort of range and frequency. Of range and frequency. So I think it's two and a half or something to seven years. And there is actually fairly low coherence in this Shamloyan-Sophar estimate, but multi-deeper remains quite high. So I think what's clear is that this averaging in frequency, even when you don't have any missing data at all, is doing more poorly than our More poorly than our missing data multi-taper coherence, which I think is sort of interesting. So moving forward, I think we'd like to do something a little bit more ambitious than this sort of toy example that I've shown. So the stable boundary layer is a regime of the atmospheric conditions that happens. Conditions that happen during the night time. So, stable boundary layer is characterized, it's characterized by mainly laminar sort of flows, but there are two regions of frequency that are occupied by sort of semi-turbulent waves. So, this is an example from this paper down here of, let's see, 1981. Let's see, 1981, where observations were obtained from an anemometer. So, a 300-meter structure that has these individual gates that are sort of vertical in the atmosphere, and it's measuring the vertical wind speeds. And so the gravity mode forcing of the stable boundary layer is effectively, these gravity modes are mesoscale variations. Gravity modes are mesoscale variations of the free atmosphere. And they come and they hit the atmospheric boundary layer, and they can produce these actually very large variations in the vertical wind speed. And so that's kind of what's going on here, actually. So you can see at the top of the plot, you'll have this kind of propagation towards the bottom, where the largest oscillations actually happen closest to the top of the boundary layer. Of the boundary layer. And what is interesting about this top plot here is that if you went even higher in the atmosphere, you might be able to get even more information. So this sort of periodogram down here shows us kind of an unmistakable wave frequency, sort of somewhere in the three to six minute range. So if this is what we can determine in 1981, Determine in 1981. Imagine what we can do with a Doppler LiDAR measurement data product that has approximately 1.2 second sampling. Can we do something to determine where these gravity wave oscillations live and what are the properties of their coherence? So we got interested in Doppler LiDAR data. In Doppler LiDAR data, because of a number of things, mainly due to power grid applications, but the analysis of these data go into a sort of a larger model. In any case, the vertical wind speed data has gaps every 15 minutes of approximately 50 seconds. So that's kind of non-negotiable. That's kind of non-negotiable because the LIDAR does a sweep of the atmosphere so that it can produce a horizontal wind speed product. So, if it doesn't do that, you don't get any information about the horizontal wind speed. And that's actually extremely important. And some of my colleagues have been taking the 15-minute wind speed data and using physics, you know, the governing sort of fluid dynamic equations to infer. Equations to infer realizations of a much finer version of the horizontal wind speed. And so our vertical wind speed has very fine sampling and is a really good wind speed data product. But during the daytime, it mostly reflects just convection, just heating of the ground. But if we are interested in But if we are interested in the nighttime regime in the stable boundary layer, we see a couple of different things. So combining the missing data multi-taper with the gaps that we have from our Doppler LiDAR, we can produce these spectrum estimates and note the log-log scale. So the So, the logarithmic scale on both axis allows us to show the predicted double energy cascade. So, the two ranges and frequency over which the energy transport is defined. And in this gap between the two inertial ranges, we have a spot for the gravity modes to live. To live. And I think it will be kind of difficult to do this analysis without the missing data multi-taper, because, see, this is an hour of data. So we've knitted together four 15-minute data segments. And this has four times more resolution than we would have if we had just taken the sort of 14-minute segments and done. minute segments and done done a spectrum analysis on its own um and also we can go to lower much lower frequencies so you know we have at least three or four data points here that um that are low enough for us to see some some uh very large eddies so uh i think that this is this is a sort of a a very useful application of um you know a missing data multi-taper Multi-taper. And of course, you can start looking at all of the various heights in the atmosphere. The Doppler LiDAR is actually capable of looking up to a kilometer in the atmosphere with varying quality levels, right? So it also produces an estimate of the quality, you know, during rainstorms and things like that, it doesn't produce quality data. And so you can have additional gaps. You can have additional gaps as a result of poor quality. So that's another thing to keep in mind. So on the left-hand side, I have kept the spectra. On the right-hand side, I've computed the coherences. And if we're looking in the range and frequency in which the gravity modes are supposed to live, we see a couple of little bumps here, like near this vertical line. Like near this vertical line. They're a little bit wide. So you can see that we started at 90 meters and so forth. And the corresponding coherences, this blue line would be 90 meters and 180 meters, red line would be 180 meters and 200. So these are separated by 30 meters. And I think it's a little bit surprising, actually, just how coherent they are. Coherent they are in, you know, as far as very large eddies are concerned, or the largest eddies that we can see. But these into the very high frequency, even we can see like coherences that exceed 99.99 significance. So that is assuming zero coherence. So that's about it for the Doppler. That's about it for the Doppler LiDAR example. I wanted to show an example of this AR2 spectrum. I think there was some discussion of processes that contain oscillations that are actually stationary. And here's just a sort of a theoretical example, right? So I have given the theoretical spectrum for the autogressive process right up here. Autogressive process right up here. That's the green line on the right-hand side. And I've given it two patterns of gaps. So one of them is a single gap and the other one is sorry, two gaps and four gaps. So I've removed a quarter of the data. So I actually haven't shown the two gaps, but they're centered around 250 and 750 at time-like. At those time likes. So the theoretical spectrum has an oscillation at frequency one over 12. And the blue line here is an ordinary multi-taper estimator taken when there are no gaps in the data. NW equals four. And also the gray line here just shows an ordinary periodic. Just shows an ordinary periodogram, you know, with no missing data as well. So the red line here is a missing data auto spectrum, which just means that I've effectively computed a co it's like a it's like a cross spectrum between uh two series which have two different you know sets of missing uh observations and uh i'm not And I'm actually quite happy with the result. It's slightly more variable than one would want, but it's staying within the sort of 95% confidence interval of the ordinary multi-taper quite nicely. So I think that there's some potential for something like this as well. In any case, I'll just wrap up. So we've shown that you can use orthogonal tapers with Orthogonal tapers with missing data or gaps to estimate the spectrum and the coherence. We were able to glue together some Doppler LiDAR data to see more clearly some of the features of the stable boundary layer. And the method can be extended to data where the missing data pattern is different amongst varies. And I'll leave open the question of what to do in multiple dimensions. But yes, that's it for me.