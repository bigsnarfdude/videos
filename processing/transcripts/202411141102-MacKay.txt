I want to first of all thank the organizers for a great workshop. I'm very happy to be here and I'm very happy to share this work with you. The title is very long and when I wrote it I was a bit ambitious. I wanted to combine three papers that I wrote with, co-wrote with my PhD student, Mathemat. And it turns out that I would put the first part in parentheses, so I'm mostly going to be talking about the optimal solving problem with the discussion. The optimal solving problem with the discontinuous reward function, and I'm going to keep the application so where we use the CTMC approximations for comments at the end. The general idea is as follows. We're looking into a financial derivative that has a, so this reward function. The financial derivative allows early exercise, so it's similar to an American option, but the reward function has some particularities that make Some particularities that make it different from an American option. First of all, the reward function is time-dependent, and we'll see why in a minute. And it presents a time discontinuity with non-zero probability at capital T. So here, capital T will be just a fixed time. It's the maturity of our contract. And here I have the comment that says that these differences are often overlooked in the literature. And I'll explain what I mean by the literature. What I mean by the literature in a minute. I'll do it now, actually. So, the motivation for this problem comes from the literature on variable annuities. This is something that I worked on during my PhD already a while ago now, and I keep trying to get away from the problem, and it keeps coming back, keeps pulling me back in. And I think it's because it's actually an interesting problem, and the reason why. And the reason why I said the differences are often overlooked in the literature is that this kind of problem with the early exercise has been looked into, but mostly from a numerical perspective, so using numerical methods. And typically, what authors do, and when I say authors, I often mean me. What often has been done is just using numerical methods that have been developed for American options and applying them directly to the problem, but without checking that. But without checking, that we're actually allowed to do so. So, for example, that the optimal stopping time actually exists, that it's defined the same way as for an American option, that the value function actually solves every boundary problem. So, here in this work, I wanted to fill this gap and show that thankfully what was done before was correct, we were allowed to do it, but still, it wasn't shown. It wasn't shown. So, the setting is as follows: We have a variable annuity. So, variable annuity is a hybrid insurance investment product that includes financial guarantees and life insurance guarantees. We're just going to focus on the financial guarantees in this talk. The policyholder, this is a very simplified setting. We assume that the policyholder invests an initial amount in an investment account. So, this is the notation here for the investment. This is the notation here for the investment account. This investment account will be invested in a risky asset, or sometimes it can be a mix of assets, but it ends up being risky and random. And at maturity of the contract, the policyholder will receive what's been accumulated in the investment account. But they're also guaranteed to receive a minimal amount that I denote by capital G here. And for example, this could be just the For example, this could be just the initial investment. So the policyholder is certain not to receive less than the initial investment. The policy holder is also allowed to surrender or lapse the contract before maturity. And in that case, they will receive whatever amount is accumulated in the investment account. The guarantee will not apply. So we don't talk about exercising an option at that point. It's really surrendering the contract. And they will also be charged a penalty for surrendering. Penalty for surrendering early. And typically, this penalty will decrease through time. So it will be a percentage of the account, of the amount accumulated, and it will decrease through time. So that's why on surrender, the benefit that's received depends on the value in the account, on FD, but also on time. So if it's surrendered early, the policyholder will receive less, a smaller proportion of the account than it was surrendered late. Another Another difference, another important difference with this type of problem is that the guarantee is financed via a fee that's being paid regularly. Here, we assume continuously, directly out of the investment account, so it affects the overall return. And it can make it optimal. That's really why it may be optimal to surrender the contract before maturity. And the reason is that basically, if the value of the investment account is The value of the investment account is very high. The guarantee is almost certain not to be triggered at maturity, but the policyholder is still paying through this fee here for this guarantee. So if they're paying for a guarantee that they're not going to be using at maturity, it might be better for them to surrender the account and just surrender the contract and just invest elsewhere. So, this is the framework that we are looking at. And what we found as we were working on that is that a very similar framework can also apply, also applies to, now here I have convertible bonds, but it's actually puttable and callable bonds, not quite convertible. But the same framework can be applied to it, so we ended up writing a paper using that. I'll talk about it at the end. At the end. So, this is just an example of the trajectories of the reward process. So, we see in blue, this is a simulated trajectory when the investment account does well. The initial amount here is 100, and we assume that the guaranteed amount is 100. So, if the value invested in the account at maturity is much is higher than 100, then there's no discontinuity in the reward process. And at maturity, the amount that the policyholder will receive. Amount that the policyholder would receive is equal to the investment, the value in the investment account. However, if the performance of the investment is poor and if the value of the investment account goes down and just before maturity is under the guaranteed amount, then the reward process has a jump here, has a discontinuity at maturity. And this is really what causes a lot of problems again in the analysis of. A lot of problems in the analysis of the problem. So, just a few examples from the literature. This is mostly where we looked into this problem and we solved it using, for example, an integral representation. We looked at it from a free boundary value problem under Black Scholz. We solved the problem, but without necessarily showing that what we obtained was really the solution to the problem. And we also looked at it in a recent paper here. I read this paper here in a more general setting, so under a general stochastic volatility model. And we use again numerical methods, but we don't really have a in this case, we still don't really have all the theoretical work behind. I just want to comment, though, that this is not the end of the world. This is really what's done, what's been done a lot for American options in American options in general stochastic volatility models. There are still a lot of questions that are open, and a lot of work has been done very recently to kind of tidy up a bit what's been done behind or to confirm or to check that what's been done numerically is correct theoretically. Is correct theoretically. And so I say that I've done it, but other authors also have used numerical methods to look into this problem. And now I just want to step back a bit and look at it theoretically. And I'll give you a spoiler alert for the end of the talk. Everyone was correct. It was fine. All the numerical results that were obtained there are still valid. So we confirm that this is correct. And this is also to just this. And this is also to just this this figure is to justify what what we were looking into. So when I this is a figure that comes from a paper from 2017 that I wrote with Carol and co-authors and it shows the optimal surrender region in gray but for different types of fee functions. So I said that there's a fee that's being paid out of the account regularly if the fee rate Account regularly, if the fee rate is constant, we say, for example, 2% fee, then the surrender region can be like this very nice, similar in this case, it looks a bit like the surrender region for call options. But we looked at other fees and we looked at a fee which would be paid only when the value of the account is above or below a certain level. So we say above a certain level, the guarantee is not going to be applied or most likely not going to be applied. Going to be applied, or most likely not going to be applied, so we stop paying the fee. And what we find is that we can obtain some weird-looking surrender regions like this. And you notice that here, above 150, it's white, and that's not a numerical issue. It's not because we stopped plotting it at 150, it's because really the surrender region stops here such that if, for example, the investment fund performs very well and goes above this, then the contract is not completely. This, then the contract is not going to be surrendered. So we have these weirder shapes for the surrender region, and it's interesting, but it's also a bit more challenging when you want to use numerical algorithms to price these kind of contracts. Because if you know that the surrender region is like this, so you have a value, and above this value, any stock price or any equity price will be in. Or any equity price will be in the surrender region, then it's much easier than if you have something or a shape like this where you don't know if above this value everything is going to be in the surrender region. It might not be. So it's interesting to get a bit of an insight on the shape of the surrender region in order to speed up maybe numerical algorithms to price these kind of guarantees. So quickly, this is what I want to look into. Quickly, this is what I want to look into. I want to, well, yeah, I'll talk about the existence of the stopping time, some properties of the value function, how, and also how we find these properties. I'll discuss a bit about the optimal exercise region, and if I have time, what applications we can use. So, just to give you a clearer view of what we're working with, for this paper, we're staying in the Black Show setting. And the two differences with the Black School. The two differences with the Black School setting is this fee function here, and this fee function is not necessarily a constant. So it's not necessarily a constant rate that's being paid out of the account. So the fee can depend on time, can depend on the value of the underlying, of the investment. And this is the price of the contract at time zero, so we assume that the contract will be surrendered optimally. If you don't agree with If you don't agree with that, I understand. We can discuss later. But in this case, that's the kind of problem we're looking into. We're looking at optimal surrender from a risk-neutral perspective. And you see that this here is the reward function. And it is if this contract is surrendered before maturity, then we receive the value of the underlying multiplied by some kind of a penalty factor. So this function. T-factor, so this function gts here will return something between 0 and 1, typically closest to 1. So you could, for example, be penalized by 5% of the value of the account or something like that. So a bit more on the fee and the surrender charge function. So the fee here includes the constant fee, the state-dependent fee. So this is what I was telling you before. We can have a fee which is paid only for certain values of the underlying. For certain values of the underlying. So, this has been studied in the literature. We could also have just a time-dependent fee, which was studied by Carol Bernard and Thossen RÃ¶ening in a recent paper. The surrender penalty here, we also have certain assumptions on the surrender penalty, but what's important to remember is that the surrender penalty will be non-increasing in time. So, typically, it will be decreasing in time. The penalty will be decreasing in time and reach zero at maturity, so that the function g, which represents the value that's that, or the proportion of the account that the policyholder will receive, it increases to one. On that weird example that you had before, of what tends to cause that, is it the fee or the penalties? It's really the fee. Because the penalties were pretty standard. And then there's And then there's some technical conditions on this surrender penalty, but nothing outrageous. Just a few definitions and notations. So we're looking at the reward processor, the discounted reward process, and the value function here that we're looking into in this problem is really just the price of the contract, the value of the contract at a certain time for a certain value of the underlying account. And we say, Account, and we say that a stopping time is optimal for this value function if when we assess, when we calculate, when we take the expectation at this stopping time of the discounting reward process, we obtain the value function. So, this is the time that will make that will maximize the value function. Here I have some literature on optimal stopping and Optimal stopping, and I'm not going to go through it very quickly, actually. But what I want to point out here is that most of what's been done in the past, I would say, 30, 40 years could not necessarily be applied directly to our problem because often to obtain results on the value function, a lot of the analysis of the value function assumes continuity, quasi-continuity, or boundedness. Or boundedness of the reward process. And our reward process is neither bounded nor continuous. And so we had to go back and use previous results. Actually, what we ended up using was an older result by Eric Apmui, which shows the existence of an optimal stopping time in a very general framework. And ours could apply, our rework. Our reward process is included in this framework. So that's what helped first. And so that's why I want to talk about the existence of a stopping time, how we use this. First of all, before using any of the literature, what we were able to show is that we have this inequality here, which really depends on the fee function and the surrender penalty function. And when this inequality is satisfied, then maturity. Then maturity is an optimal stopping. So, waiting until maturity is an optimal stopping strategy for this kind of contract. And the reason is very simple. When this is satisfied, we can show that the discounted reward process is a sub-martingale. On average, it increases. We want to keep it until maturity, and this is exactly what happens in the case of an American call option without dividends. So, this is, looks tricky. This looks tricky, it looks complicated, but it's really just the same situation, same kind of proof. And we can show that, so we show here that it is one of the optimal stopping parts. We don't know if it's unique yet, but later in the paper we can show that it's unique. Now, when we're not in this trivial case, what happens? Well, we can show that an optimal stopping time exists because using this paper here, we can show that our optimal Our optimal discounted reward process fits the very general conditions in the paper of ACATWI. And then our optimal stopping time is simply the first time that the value process hits the reward process. And this is exactly what we have in the case of classical American options. So our stopping time, our optimal stopping time is the one that we were expecting. So now that's the first good result. Now that's a first good result for us because what we were doing was correct. However, the discontinuity of the reward function complicates the analysis of the value function. A lot of the results that exist, we weren't able to apply directly. And we wanted to know a bit more also about the exercise region. So we kept looking. And what really helped us, so that the trick to analyze the value function was to consider this modified continuous. Modified continuous discounted reward process. So instead of just looking here at the surrender benefit, we looked at a reward process that gives on surrender the maximum between the surrender benefit and this value here. And this value, what is it? It's really just the expected discounted value of the maturity benefit. You could call it the European value of the contract. So it's the value. So it's the value of the contract if you disregard the possibility to surrender early. And why this is nice is that, well, the value function associated with the problem with this continuous reward function coincides with the value function of the original problem. So we can show that it's always the same. But now we have the value function and we have a representation using. function and we have a representation using a continuous reword process and now we can apply a lot of the results from the literature. We can get continuity of the value function for example. What we were wondering though is do the optimal stopping times for both representations do they coincide? And we can show that they don't always coincide. Yes? You have two minutes just to give me an intuition about the fact why would the option value the Option value, the European option value will be above the exercise barrier, ID. Yeah, so why we're expecting that sometimes. It's very rare that you would hit the H here instead of the surrender. But basically, you hit it when it's never optimal to surrender the ponyturn. You hit it, but it's equal, it's not dominant, right? No, it's equal. So if you're at time zero, for example. So if you're at time zero, for example, and for some reason it's never, so maybe because the condition is satisfied, the inequality there is satisfied, then the value of your contract with surrender is the same as the value without surrender. And then you hit the street. And this is actually what we show with the stopping times. So we can construct examples where the stopping times are. examples where the stopping times are not the same and that's that's the the example so if if optimal stopping is never optimal if surrendering before maturity is never optimal with the continuous reward process you'll surrender right away and with the other one with the discontinuous you'll wait until maturity so this is a case where they're different so yeah so we can show that the stopping time for the continuous problem The stopping time for the continuous problem is always less than or equal to the stopping time for our original problem. And now we want to see in which case, when do they coincide? And it's really when the surrender regions coincide. This here is the definition of the surrender regions. They're defined just like for an American option. And under which conditions do they coincide? And what can we say about the surrender, the optimal surrender region for our option? For our original problem. That's what kept us going. That's why we continued looking into this problem. First of all, using the continuous representation, continuous reward process representation, we were able to say that our value function is continuous. Under mild continuity assumption, we can also confirm that the value function solves a free boundary value problem, which is the one that we were expecting. The one that we were expecting. So, again, the papers that use this free boundary value reference setting were correct. And here, so if we restrict ourselves to the case where the fee function and the penalty function just depend on time, we can also show that a variational inequality, which is very similar to the case of the American option. And now, just a quick. Yeah, just some quick words about the optimal exercise region. First of all, this is the main tool that we use to analyze the optimal exercise region. So we express the value function in terms of this integral representation. So this integral representation is similar again to the one that we have for American option. It's the value of the European contract plus the early surrender premium or early exercise premium, which is given here. Which is given here. And the continuation premium representation, so this is something new that we came up with. It turned out to be a good tool to assess the, to work or to obtain results on the optimal surrender region. And it's also useful when we want to develop algorithms to price this kind of contract. And what we have is a decomposition decision in terms of the surrender benefit plus some additional value. Some additional value which is expressed in terms of an integral here. These two representations have been used in another paper to obtain prices on numerical values for the value of the contract. Now, what can we say? The important results that we have on the optimal exercise region are on this slide. And the reason why for us they were important is that they allow. For us, they were important is that they allow us to, well, in certain cases, to speed up some pricing algorithms. So, if we look at the optimal surrender region S and we look at the T section, so just taking a time t and looking at the underlying values for which it's optimal to surrender, what we get is that, first of all, if this inequality here is satisfied for all t, then this Then the surrender region is not empty, and the continuation region is not empty, which means that it is optimal, it can be optimal to surrender before maturity. Also, so this is in the case where, again, we restrict ourselves to the case where the fee function and the surrender penalty function don't depend on the underlying. Don't depend on the underlying. In this case, we can show that when this inequality is satisfied, we have the nice surrender region that I had on the left here before, in the three surrender region. So we really have that, there is a boundary. Above this boundary, it's optimal to surrender. You'll notice, though, that this boundary here could be infinity. So for if we can, in certain cases, we could. In certain cases, we could have a boundary at some place, and then at certain times it would not be optimal to surrender. Because we can make the phi function here vary with time, and that would make it so that in certain cases it's not optimal to surrender. And when, again, when this is satisfied, the two regions will correspond. So the optimal stopping for surrender region. Stopping for surrender region for our original problem and the one for our problem with the continuous reward function. And what we have also is that now in the other case, and this is a more local result, so if we fix a time and we look at what happens exactly at that time with this with this expression, if it's positive, then the the the T section of the surrender region is empty. The surrender region is empty at that time. And so this can be extended, of course, to the whole interval between 0 and capital T, but we can also look at it locally like this. I want to stop here. So this is, there are some comments on some papers where we used this problem, we applied this problem, but I think what's interesting is really looking at the the optimal surrender problem for now. The optimal surrender problem for now, and if you have questions on applications, I'm happy to talk about them later. A few open questions left. I don't have all the results on the properties of this optimal stopping boundary. I know that it's not monotone. And I would like to, there's a typo here, but of course, the next step would be generalizing it to at least a classical altitude. Thank you for your attention. Any equation? Yes, maybe I can. So if you if you're given, so can you take the problem the other way? You're given the solar region, can you find the phi that the optimum is the solon origin? That's a good question. I have not done that. Have not done that. No, I, but I could, you know, don't have any mathematical results. I do have a bit of intuition. We do have a bit of intuition on this. But we do have some results on, for example, if the surrender, if at a certain time the t section of the surrender region is empty, then that means this in terms of we don't have directly what the phi is and what. Have directly what the phi is and what the both functions are, but we do have an inequality. So, what I mean is that this kind of results here, now here I have them on one, I have them one way, right? If this condition is satisfied in terms of the P and the penalty, then this is true about the surrender region. But we also have the reverse result. If this is true about the surrender region, then Surrounded region, then this would be true about the peace. Yes? What kind of stock has we paused for you to that's a good question? So I would maybe start with something similar like Hessen, but our so our paper here where we use stochastic volatility, it's done in a setting of In a bit more general setting. Do you have any specific goals that we want to achieve via still classic portality model? So for example, in this case, we wanted to link the fee that's being paid out to the VIX index so that when the VIX is higher, So, that when the fix is higher, you pay a higher fee because the value of your guarantee would be higher. And then we were wondering if this link affected in any way the surrender incentives. So, that's why we solved it numerically there. But we'd like to know what we did, what I think it's correct, but we wanted to know. But what is the importance of having you ask for questions? Yeah, so you're thanks, John. So, you look in. Thanks, Anne. So, you're looking at a risk-you do policyholder, right? So, could you think about a risk-averse or risk-seeking policyholder and how that would differ? Yeah, we or what would be the challenges of looking at something more risky? Yeah, it's a different question. I haven't, honestly, I've always focused almost always. Focused, almost always focused on the risk-neutral one. It would be a different setting, and I'm not too familiar with the literature on this, but would be very happy to look into it. The reason why we look at risk-neutral here is it represents a worst-case scenario, but also it represents, because we're in a lack of society market, it represents, it's linked to the health strategy. It's linked to the hedging strategy. So, in terms of hedging, if we can show that in a risk-neutral setting, we remove, that was our, at some point that was our argument for doing that, if we remove the optimal or the incentive to surrender optimally, then we just had to hedge the European contract, and we were always hedged against any kind of surrenders. No, just along the same lines of different markets. So, can you do stochastic interest rates? Because that might be even more applicable to each other. Good point. Yes, well, so that's the next step. I've had a few discussions about what we can do for stochastic volatility, not for stochastic interest rates, but indeed it might be more useful to do it. In that perspective, because you do mostly pricing, right? It's edgy, but it's also pricing. I think the only thing that matters in your drift term is your excess return over your fees. And so even you have stochastic interest rate, but if your fees relate to the interest rate, then you can back out. So I think the risk value you have is the excess return over your fees. For sure. Yeah, it's always the. For sure. Yeah, it's always the excess over in this case. But you don't have to have a full model of the interest rate and the fees, then what you need to model is the gap between the two. That's true. And if they're linked, might be still hard. Thank you, Mary. Thank you.