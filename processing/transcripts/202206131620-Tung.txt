Hi, everyone. First of all, I kind of wanted to apologize. I won't be talking about any of my own stuff today, mostly because I haven't done too much epidemic stuff recently, and the stuff that I have done recently, Rick is presenting in like two days. So there's that. Most of the work today will be from paper from both Britton and Trapman, as well as some of Rick Durrett's own notes and his ideas. So, herd immunity, I think we've heard some about it today, and we'll probably continue here. It today, and we'll probably continue hearing about it more in the upcoming days. What is the percentage of the population that needs immunity to stop the spread of a pandemic? And so in homogeneous well-mixing models, this question makes a lot of sense. So for example, with the SIR model, you can reach herd immunity at one minus one over R0. And we can sum that up as a number because everyone's the same. It doesn't really matter which people you pick to be immune. matter which people you pick to be immune at all. But that raises the question, what exactly do we do when the population has heterogeneity? And so we jump straight at first into Walbritten and Trapman's talk, I'm sorry, paper. Their model, they consider two types of models. The first one, they split up the population by age group. And so you can see the six age groups up there, zero through five, six through 12. 0 through 5, 6 through 12, etc., etc. A sub j k is the contact intensity from one person in group J to one person in group K. Pi sub J, just the portion of the population that's in group J. And so if you multiply the two together, then you get the sort of contact intensity from one person onto an entire group. And you can see the values they used over there with. With phi over there and the giant six by six matrix. And so you can work that out. Moving on from the age model, they also had an activity level model. So in the activity level model, some people are more social than others. They split into three groups, the lows, normal, and high. People who are in the low category are going to be half as social as people in the normal. In the normal, and then for people on high, it's double, and they fairly arbitrarily assigned fractions of the population to who's antisocial and who's not. So a quarter of the population is not very social and a quarter of the population is very social. And so that modifies the original A sub JK values that we had before on the previous slide. And so one example below. And so, one example below over here, if we're looking at how much infectiousness one person in group J that's not very social applies onto the very social people in group K. We start out with our usual a sub JK. And then after that, the 0.25 and 2 come from how social they are. So the low social contributes to half. The very social in group K. The very social group k contributes the two. And then after that, instead of multiplying by pi sub k, as before, only a quarter of the population in group k is very social. So multiply that by a quarter. And he does a, sorry, they consider these two models separately, but you can also combine them into making a giant 18 by 18 matrix. And at this point, you're probably wondering what exactly they did with these models. So, for the next slide, they have the certain parameter alpha. This is some sort of reduction factor within the infectiousness of everyone. So, the original matrices are being modified by just multiplying alpha to every single entry. They represent sort of preventative measures, which they remove. Which they remove at some time point, say day 130. And so you can see from their graph, they have different colors for the different values of alpha. And if you have high values of alpha, so like alpha equals one, they don't do any preventative measures at all. You're going to get really high peaks, which is probably not good. At the same time, if you go very strict on your preventative measures, so like with the purple. Measures. So, like with the purple line, alpha equals 8 over 15, not enough people get infected by the first wave, which allows people to start getting infected again once the preventative measures are lifted. So, in this case, for herd immunity, they take the smallest alpha that doesn't have a second wave and then see how many people are infected. And so here's a table of their results for different R0s. H sub C is part immunity classical, so one over one minus R naught. And for H sub D, you can see the different values. Homogeneous, again, is the same as classical. It's always going to match up with H sub C. And then we have the age structure model, the activity model, and then both of them combined. And then both of them combined. You can see that heterogeneity always decreases the amount of herd immunity. Sorry, decreases the amount of herd immunity. And it seems like for their model, the activity structure makes a bigger difference compared to the H groupings. Although that may be because the activity level numbers are fairly arbitrary, whereas the H group ones were pulled from a paper from before. And so, on the previous slide, these herd immunities are achieved based on some certain distribution of immunity among the different population groups. So over in table two, I guess, you can see the percentages of every group that got infected. Not surprisingly, that people with high infect, sorry, high activity got infected more. And since we have that distribution, it does also beg the question: what exactly happens if we play God and somehow we're able to change that up? And so for that, we decided to look at some simpler models where we can actually compute herd immunity by hand. So, one simple model: if we look back at the age group model and we only take two groups. And we only take two groups, then we get this very nice small matrix up at the top. And if we wanted to find R0, then we need to solve for the maximum eigenvalue. So we can write down the characteristic polynomial, write down what the largest eigenvalue is, setting that equal to one. We end up with these two conditions. And if we maximize what pi word is, And if we maximize what pi1 plus pi2 is, then we can figure out what herd immunity is. This is somewhat tedious even in the two-group case. This is very annoying in the three-people case, and it's basically impossible by hand or after that. Pi one plus pi two is the, okay, pi one is the number of people that are susceptible in group one, and then pi two for group two. And Pi2 for group two. So we want as many people that don't have immunity as possible and yet still achieve herd immunity. If we want to plug a number out of that, if we want to keep it as a vector, then that's totally fine too. And we don't need to maximize. Thanks for asking. And yeah, part of the nuisance with moving up isn't just solving polynomials, but also that we need to find the maximum eigenvalue, and there's going to be more and more of them. And there's going to be more and more of them as we increase the size of the matrix. So, thankfully, if we look at model two, that solves a lot of the computational issues. So, if we let alpha sub k be the activity level for someone in group k, then we can write down this expression here that will become the basis for our contact matrix. So you can see the A sub J times A sub K, that's similar to in the old examples where we multiply how social people were together. The B sub J and C sub K, let's see, B sub J you can think of as how infectious a person in group J can be. So like maybe people in group J cough more than group K, for example. And then for C sub K, you can think of it as how much more susceptible. Can think of it as how much more susceptible a certain group is. So I don't know, maybe people in group K have less mucos aligning than people in group J or something. And if we set V and W as these two vectors over there, then our contact matrix is actually just the product of these two vectors. And the reason why that's nice is because the matrix is rank one, so we only have one non-zero eigenvalue. We don't need to worry. Zero eigenvalue. We don't need to worry about finding the maximum one because if it's not zero, we found it. And if we wanted to find the eigenvalue in eigenvectors, if we multiply w on the left to vw, then associative property, move the parentheses over, we have basically a dot product between the two vectors, w dot v. So that gives a number. And so very quickly, we can see that the eigenvalue is w dot v. That the eigenvalue is w dot v and the left eigenvector is w. Similar, if you want to find the right eigenvector, you can multiply v to the right-hand side, move the parentheses over to the right, and you'll get the same stuff. So, running through a quick example of how the activity level model could be useful. Once again, I've recopied the Once again, I've recopied the various values that Bolbert and Tratman used. So again, three activity levels: low, medium, high, alphas being one half, one or two, and pi being a quarter, half and a quarter. We can write down the v and w vectors that we found on before. I'm keeping v as a function of pi, even though I didn't write out the values of pi on the right-hand side, just to indicate that those are the Just to indicate that those are the pi values: the one-quarter, one-half, and one-quarter, and before. And if we want to set the eigenvalue to 2.5, which seems to be a fairly standard value to use for R0 for COVID, then we just set W.v equal to 2.5. Let's say we take gamma equals 0.2, so roughly five days of infectiousness before recovery. Of infectiousness before recovery, then the only variable left is beta, so we can recover beta equals 0.32. And then if we wanted to find out stuff about herd immunity, immunity in group J will decrease pi sub J. So to find herd immunity, set R0 equal to 1. So we have 1 equals W dot V and then pi with a bar on top of it. With a bar on top of it for a different distribution of pi. And we end up getting this expression on the right: 0.32 being from the beta, 0.2 being from the gamma. And then the values being squared are the values in alpha, because you're taking the dot product. And this is very easy to minimize and solve. You just have to start decreasing the pies from the ones with the biggest exponent. Sorry, the biggest. Biggest exponent, sorry, the biggest coefficient. So, in this case, pi 3 has the biggest coefficient of 4. So, we want to shrink pi 3 first. And it turns out that if you set pi bar equal to a quarter, a half, and 1 over 64, then you can achieve herd immunity. And if we want to get a number of people who get who need immunity from that, do one. If you need immunity from that, do one minus the sum of those values. Yes, if we were somehow able to play God and pick. And so this is lower than Bahlburn and Trapman's herd immunity value, which is not too surprising given that we are playing God in the second example. I don't know of any vaccination strategies that let you. Vaccination strategies that let you pick out who gets vaccinated that precisely. But it's fun to pretend sometimes. And then the other thing is that with the activity model, it being rank one makes it very easy to compute. I'm not that sure how realistic it is. There are some notable differences in structures with what I'm used to seeing, like. For example, with these H matrices, the diagonals tend to be the largest values along a given line, and then the other ones are smaller because you might interact with more people in your own group. That's not true for activity level, but the activity level model is easy to compute, and that gives it brownie points in my book. So.