And today I'm going to introduce edge-based interface tracking, which is a kind of variant of the volume of fluid method. And I hope you find it interesting. So we do this mostly for the purpose of doing very complex multi-phase flow simulations. So I will start by showing these multi-phase flow simulations and then I will go on to the And then I will go on to the EBIT method. So, why do we do multi-phase flow simulations? Well, for example, this is the type of things that you see on the ocean. And in this flow, you see here, you have these droplets being formed. This is a very strong atomizing flow. This is another view, more like a theoretical view of what's going on from the review article of Veron, Ocean Spray. Of their own ocean spray. And so this atomization that you see here produces spum drops. You have also droplet impacts, bursting bubbles that produce all these types of drops. All of this is extremely important to analyze the ocean-atmosphere interaction, how much heat and how much chemical components you exchange between the sea. Exchange between the sea and the atmosphere. And many people work in great detail on all these phenomena. I'm going to concentrate on atomization in the first part of this talk. So atomization is remarkable in how much it has progressed over the past 20 or 40 years. Here is the view of Here is the view of maybe our first 3D simulation of atomization 20 years ago in 2004 with Professor Bianchi from Bologna. And at about the same time, Berlémont, Le Chenadec and Pitch, Ashbreed, Siberiano, Rainberg started some atomization simulations. In 2010, Shinju and Umemuru. Shinju and Umemurab did a fantastic simulation, much more detailed, and you can see how things look different. And you see, you gain basically three orders of magnitude, a factor of 10 to the 3 in the number of grid points. Six years later, we only gain a factor of 10, but we do this much faster in 10,000 CPU hours instead of 2 million CPU hours. CPURS. And yes, yet five years later, my students, Jash Kulkarny and Raphael Villier, made the equivalent again of 4 trillion grid points. So that's the equivalent. That's the number of grid points you had if the grid was refined at the same level everywhere. We don't have actually that many grid points. That's an equivalent number. But it gives you an idea of the precision of the Precision of the computation. So, this flow is a quite standard flow that I will describe in more detail. It was all these two these two computations were made possible by Stefan Popinet, who developed the fantastic Basilisk code, which is an extremely powerful Octric code. I will say a few words about it. So here I have plotted all the simulations since the original simulation around 2005 up to the current simulations which are here. There are two simulations at two different grid sizes. This is the year, of course, and this is the number of grid points in the diameter of the jet. So we go from 10 grid points to maybe several thousand grid points in the diameter of the jet. In the diameter of the jet, this thing is the vapor number based on the grid size. The vapor number is what control the droplet sizes. So as the vapor number based on the grid size becomes larger, it means that typically you have more grid points in each of the small droplets. So you have a better resolution and better precision for your computations as this increases. So, sorry, as this increases, because. Decreases because so the fact that the Weber number based on the grid size decreases means that the simulation is more precise. So you see the color goes from blue to red. So this means that not only you gain in number of grid points in the diameter, but you also gain in the number of grid points in the droplets. So this curve corresponds to doubling of the drop. Corresponds to doubling of this number of grid points every 2.5 years. This is an amazing rate because to double the number of grid points D over delta, you need to multiply by 16 approximately the total number of grid points and the total CPU time. You need to multiply by eight the number of grid points. So this is an extremely fast rise, and it's due not only to the increase in the power of computers, but it's also due to the OC3. Computers, but it's also due to the OC3 refinement and to the better properties of parallelization of the codes. So, all three factors are concurrent. So, this is the actual simulation. We inject a dense pulsating liquid jet into ambient lighter fluid. So, it's pulsating because the initial velocity has these oscillatory properties. We do this to have the We do this to have a deterministic entry condition. Some other similar computations are made with an inflow which is turbulent or irregular to mimic the upstream turbulence. Here, we don't mimic the upstream turbulence, we use a deterministic flow to have a more well-defined initial condition. And the relevant parameters are here: the Weber number. Parameters are here. The Weber number measures the ratio of inertia to surface tension. It is a Weber number 200, which is intermediate. It's not very large, it's not very small either. The Reynolds number is 5,000. By today's standards, it's not very large, but maybe by the standards of 20 years ago, it was large. And the rho star and mu star is the density and viscosity ratio. Rho star. Ratio. Rho star would be about 800 in air and water, but our simulations are more stable with smaller values of rho star. So we use rho star equals 30. It turns out this corresponds to the high pressure gas situation in a diesel engine injector. But we do this because the simulations are easier. μ star is the ratio of viscosities. It would be 50. It would be 50 in again in an air water situation. So it's smaller here. And so rho star is equal to mu star, which means that the kinematic viscosities are equal, which means that the Reynolds number of the gas and the liquid are the same. So this is also the Reynolds number of the gas. It's both the Reynolds number of the gas and the liquid. So this is a relatively small Reynolds number also. Small Reynolds number also for the gas, which also makes the simulation easier. If you have Reynolds number of the gas of the order of 10 to the 5, as you have in some realistic flows, it is difficult to really resolve the turbulence in the gas. So we use these easier parameters to be able to do this simulation. So this is a first view of the simulation. What you plot here is the vorticity. What you plot here is the... What you plot here is the axial velocity, the velocity in the x direction. And the color on the interface is also the x velocity. So you see this is blue because this goes backwards in the flow. And this is very red because it moves rapidly forward. You see, there is not a lot of vorticity here. If you had a really highly turbulent gas, you would have a lot of vortical structures here. So, this is a static view of the jet. It has required a lot of millions of CPU hours. This is 9 million for one of the most resolved simulations, but we did it several times, so it really cost a lot. You see here the periodic character coming from the periodic injection. You see here relatively large droplets being created. How these droplets are created is of great interest. These droplets are created is of great interest to physicists. One of the mechanisms is this formation of these holes here, which I will discuss in more detail. Then you have these ligaments, these thin structures that appear, and these thin structures destabilize, like maybe here, they break into droplets. So let's see this in more detail. How are the holes formed? The holes are formed through so-called weak spots. Basically, you have the thin. Spots. Basically, you have the thin sheets, and somewhere these thin sheets break. In a way, we can say they die. And I will explain why. So, why do the thin sheets break? One of the well-known effects is that you have these droplets. These are very red. It means that they move very fast in the UX direction. And this sheet is pink, which means it doesn't move very fast. So there's a large relative velocity between this droplet and the sheet. Velocity between this droplet and the sheet. These droplets impact the sheet and then they make a hole. We have another one here that makes a hole. But this is not the only way of making holes. Actually, this image was selected because it shows a lot of droplet impact events. The droplet impact events are, in fact, rare. And what you see more frequently is more something I will show later. You also You also can look through the axis of the jet. So, here the color is the curvature. So, the red curvature is positive curvature, which is the curvature of droplets. The blue curvature here is negative curvature. This means that you have bubbles instead of droplets. You have gas inside the liquid. So, this simulation also shows how gas bubbles are created. This is the same, but with actual velocity. So, actually, the bubbles we saw here was a surprise. We had no idea there were so many bubbles in the axis of the jets. And the bubbles have some importance for the discussion of the physics that follows. So, I said there was another mechanism for a hole formation, which was not droplet impact. The previous figure that had a few slides. Figure that I had a few slides ago. I can show it again. This figure and this one shows a lot of droplet impacts by leading to hole formation. And by the way, since I'm here here, you see a successful hole formation here, also successful hole formation here also. But this event is quite remarkable because the droplet impacts, but eventually a hole doesn't appear here. Eventually, a hole doesn't appear here. There's a hole appearing here, but not here. So sometimes droplet impact is not successful, and you don't make a hole. The most frequent manner to making a hole is this. So what do you see here? You see these oscillations by red and blue fields. These are oscillations of curvature. The color here is not the velocity but the curvature. So the most of the field is gray because the curvature is not. Is gray because the curvature is not very large, except in these regions you have very high alternating sine curvature. And if you look, this is exactly the same, more or less the same time, but with the actual velocity, you see this crumpled character. I call this an orange skin. This crumpled character comes from the oscillations of curvature. The interface is destabilized. This is due to some peculiarities of our method. Of our method. In the volume of fluid method, when the interface becomes very thin, the computation of curvature fails. And when the computer curvature fails, the curvature is oscillating rapidly. You could use a different method. You could use, for example, level sets. If you use level sets, you don't have the same effect on curvature, but the interface evaporates. Very thin threads in level sets evaporate. So you would get a rapid formation of a big hole. Of a big hole, but you would lose mass. As a result, your simulation also will be in trouble because you would lose a lot of mass in the level sets in that situation. Here, we are trying not to lose mass, but we in exchange we get these oscillations of curvature. After the hole is formed, we get these ligament networks, and these ligament networks then give us very small droplets. So, this is a A movie of what happens. You can see here the grid, these big squares which develop into smaller squares, etc. So you see the octary grid, or as a projection, it looks like a quadrig grid. And you see hole formation, you see a lot of things in this image. You see the ligament formation, you see ligaments here. Well, there are many things to see in this simulation. There are many things to see in these simulations. And this is another view of the jet, maybe more smooth. And this is another view. So for the moment you see nothing, but it's going to arise. So this is colored by curvature. So this gray zone is a not very large curvature, moderate curvature. Now you can see the oscillations of curvature. Curvature. And you see the hole formation mechanism. Sometimes you see here there's a droplet impact from the other side, which doesn't lead it to a hole. And sometimes you see some droplet impacts here or there. Now you see all these things colored by curvature. So these are large droplets, they're not very high curvature. And then some small droplets are very red, very large curvature. Again, you have whole formation. And you see these very long ligaments. And you see these very long ligaments like here, which eventually drop break into droplets. So this is again, this is a zoom of the previous type, so you can see the whole formation in more detail and the formation of small droplets. They also have some very thin ligaments. And so we are. And so we are in trouble because this whole formation, this numerical whole formation, is not physical. This very high-speed oscillations of curvature are not physical. And we don't know how to fix it. If we fix it with level sets, we'll have too much evaporation, we'll lose too much mass. So we would like to have a localized hole formation, but without the oscillations. So for this, we have invented something called manifold death. So when we submitted the review, So, when we submitted the review, the paper, the reviewer said, why do you call this death? I mean, it's not a mathematical term, death. Okay, so, well, my excuse is that this word was used by the French Nobel Prize winner Pierre-Gilles degene, and he spoke about the death of bubbles. The death of bubbles occurs because you have these thin sheets, and a hole forms in the thin sheets, and then the bubble bursts. So, I mean, it is admitted in the physical. It is admitted in the physical literature or the fluid mechanical literature to talk about death, but we also have a mathematical problem. We have this thin sheets or hypersurfaces, manifolds, and we want to know how to transition from a manifold of some dimensions to a small dimension. So that's why we talk about manifolds. And of course, you know that in Of course, you know that in quantum gravity you have a hypothesis that the universe starts with 14 dimensions. And this hypothesis was developed by this Chinese writer in his book, Remembrance of Earth's Past. This is in Chinese. You can read that. I cannot. And so he is a wonderful author. He is a wonderful author, a very optimistic. I really know a lot of fluid mechanics and physics. And he says in his book that you start and the universe started dimension 14, and then there is war between civilizations, and you have a weapon to go from dimension D to dimension D minus one. So our manifold death technique is like a weapon to go from dimension D to D minus one. If you want to go from D to D minus one, want to go from d to d minus one you you cannot uh use an object of dimension d minus two for example the this the sheet that we want to break is dimension two you cannot just make a point hole which is dimension zero you have to use a dimension one object like a circle and so so you have to make a hole which is sufficiently big and so d equal two is destroyed by the expanding annular ring d equal Expanding annular ring vector one and not by a tiny point hole. Maybe I can show this in one of the previous slides. And I have to go all the way back. No, here. Okay, you see this hole. You can see maybe there is a thin, thick object here on the side. So this is called the teleculic rim. So that is what is killing the sheet. Okay, so you have to initialize something like that. Something like that. So, there is also some literature in physics on the destruction of thin sheets by G.I. Taylor and D.H. Mikhail. So, they describe that you have the initial hole that you make has to be sufficiently large for energetic considerations. So, this confirms that you cannot just. So, this confirms that you cannot just kill the manifold with a point. So, this is how we do it. In this diagram, I show a lot of things. On the left, I show the level set. When the sheet comes of the size of the grid, it evaporates. You eliminate the entire sheet. In the volume of fluid method, when you eliminate this sheet, because volume is conserved, it breaks into a lot of big droplets. Big droplets. So if you have a simulation someone is showing you, and he's not telling you whether he uses level sets of volume or fluid, you can guess because if you see big droplets or big cylinders where the sheet breaks, you know it's volume of fluid. If it evaporates, you know it's its level sets. In front tracking, you can arrange it so it never breaks. Very powerful. Front tracking is very Very powerful. Front tracking is very powerful from that point of view. And then we'll come back to this. In manifold death, we have this technique which computes a quadratic form, then computes the signature S of this quadratic form. And the signature tells you what type of point you have. Plus, plus minus is the signature of the thin sheet. So when we detect the thin sheet, we break even before we reach the grid size. So we will make a number of holes at random. Holes at random. There are many hidden parameters, but eventually it works. So this works, and today I didn't want to speak only about volume of fluid and manifold deaths. I wanted to tell you about this neat technique, the Ebbit method. And so I just conclude here on the manifold death. It works. We have some results, but it's extremely expensive in CPU time. One of the reasons you have to keep many grid points inside the sheet. Keep many grid points inside the sheet. So the sheets are physically very small, of the order of microns. We have to have a sub-micron grid size, which is extremely expensive. And for example, we are unable to do physical flows, not without these diesel engine characteristics. We have real air water, it's too expensive at the moment. And so we need to improve a bit on the methods. And so we need We need maybe to use front tracking because, in the front tracking, the thin sheets can survive longer. But front tracking is very difficult to perform in massively parallel and processor balance form. And so, we need a new method. So, I conclude here on the atomization, and this is a list of my students and postdocs. Usually, you have this slide at the end of the talk, but because it's maybe two separate talks, I should Maybe two separate talks. I show it here. These are my collaborators on this new method. And these are my students. So, if there are some young people here who want to come to Paris, we have good beer. And so, let's go back to the fundamentals of methods for tracking interfaces. You know, there are many methods. So, we have some experts here, volume of fluid, and where I didn't put here this on the list, but we have also. Here, this is on the list, but we have also diffuse interface methods, and all these methods are local. And then we have some global methods like local front tracking and also spline-based front tracking. It's not very popular, but some people use it. And you see, front tracking has advantages. You can track very small scale, it's multi-scale, but it's difficult to handle. Scale, but it's difficult to handle topologic changes and massively parallel computing is difficult. Volume of fluid has locality, which yields to robustness and speed, but it has disadvantages. Thin structures are difficult to track. So we need some method that combines the advantages of the two methods. So that's why I introduced edge-based interface tracking. In edge-based interface tracking, you have markers such as Interface tracking, you have markers, such as in the front tracking method, but the markers are limited to the edges of the grid. So you have a 3D grid here, and the markers are on the edges. For example, on a quad tree, you can also put the markers on each edge of the quad tree. This is based on an idea by the regretted Sergei Semoshin from the Keldysh Institute. So we sometimes call it the Semushin. So, we call sometimes call it the same machine method. Semushine was actually sharing an office with Stéphane Popinet in the 1990s when Stéphane Popinet was a PhD student. And they exchanged a lot of ideas. Samushin told Popinet about the quad tree method and told him also about his Ebbit method. And for a while, Popinet hesitated whether to use volume of fluid or front tracking or the Ebbit method. But Sergei Semushi never published his paper. It was a preprint from the Kelvin Institute. So we translated the paper and we published it as an annex, an appendix to this paper. And we obtained with some difficulty the authorization from the Keldish Institute. But I never was able to obtain the authorization of Semushin because he disappeared. I don't know where he is. But I got on the phone with his PhD advisor. With his PhD advisor, I was very happy. And I told him, you know, I don't know where Semushin is, and there is this paper of Semushin, which was never published. So I hesitate to say that, but his PhD advisor said, it's my paper. I wrote it, but I put his name on it. So I was very surprised. And now I'm worried because I didn't ask him the authorization to publish the paper. But well, in the end, I hope everything will go well anyway. Everything will go well. Anyway, I don't have any lawsuits or anything. So it's a really interesting story. I have too many anecdotes to say about this. I will stop here. So there are similar methods to our EBIT method. The idea of the L C R M and the L F R M level contour reconstruction method, the local front. Reconstruction method, the local front reconstruction method. So, this is like ours. You see, these points are a bit like the Ebit markers, but they also have a central point and they have additional face points. So, this is more complex than our method. So, going back to this method, we discretize it like this in 2D and also in 3D. This is all clear. We move it in two steps. We move it in two steps. So, first we move this, we move these markers, these blue markers on the green lines, and then we move these red markers, which don't move along the green lines. This is split in X and Y. Then this is another view of how we move the red markers. We actually use a circle fit. If you don't use a circle fit, you lose too much mass. This doesn't ensure mass conservation. So, but with the circle fit, the mass conservation is. With the circle feed, the mass conservation is acceptable. We have an ambiguous case. So, in the ambiguous case, we have to decide whether it's the left configuration of the right one. We decide it by what we add an additional variable, which is a additional color, which defines the color of the central area. And with this additional variable, we resolve the ambiguity. There is an automatic topology change. We have not allowed more than two markers on the line. Don't allow more than two markers on the line. So, if we end up with a situation like that, we merge the two phases and we use this situation. So, we have automatic reconnection, automatic topology change. Then we couple the Navier-Stokes equation. For the moment, we're using a naive way. We go back to the volume of fluid and we use the dynamics of the volume of fluid. We hope to have something more self-contained where we don't have to go back to the volume of fluid. Where we don't have to go back to the volume of fluid, but that's the case at the moment. So, this is the typical radio Taylor instability comparing Ebit and Wof. They are very closed. This is the capillary wave comparing Ebit-Wof and the Prosperity solution. It's within the thickness of the graphics, so it's very good. It is a bit more A bit more imprecise than volume of fluid, but it converges fast, even at the smallest grid sizes. We have the famous rising bubble test case. So this is the so-called case one of Geising here in axisymmetric and in 2D. This is the case two of Geising. And we resolve this curve. And we resolve the skirt. Some people think it's impossible to resolve the skirt, but I mentioned this paper of Dominique Legendre, who has shown that a theory that gives you the thickness of the skirt. So it's quite possible to resolve the skirt. It has a finite thickness. And if you go to sufficiently many grid points in the bubble, you can resolve the skirt. And this is a view of the rising bubble. See, you can see here we also have quite three adaptation. Quite tree adaptation, and so this works. We go to 3D so we can see objects moving in 3D. We can have a typical motion in 3D out of time, so I have to go a bit faster. We have again capillary waves in 3D on the top of a droplet, so it is quite difficult case to do with front tracking. So we are quite happy it's accurate. So we are quite happy it's accurate in the case of front tracking, of EBIT-based front tracking. The convergence is not so good for these oscillations, but it still converges a little. And well, the 3D rising bubble, again, is the same case as before, the Heising test case. This is case one. Case one and it works nicely. This is case two. We have the skirts, but we don't resolve the skirt here. We have these oscillations and again it converges. And I want to finish with some perspectives. With this Ebbit method, we can encode complex topological information. What do I mean by this? The topological information, the discrete topological information to me is defined by the color of the grid points. It's one or zero. The grid points. So one or zero, whether in one phase or the other. So this distribution of colors corresponds to these colors of the vertices and corresponds to this topology. Then on a square with these definitions, you can encode three possible topologies, up to symmetries, etc. So this is the complexity on a single cell. Now, if you go at a higher level, you can At the higher level, you can have more complicated topologies. For example, you can have this with so many phase boundaries. You can define a dictionary of all the possible topologies on this case. And then you can encode them as a code for each cell. And then you don't need to describe the topology. You just have the code. Okay. So you can have a hierarchical description of the topology as you go higher and higher up the scales. Higher up the scales, you can have more and more complicated topologies. You can have retrodictionaries, for example, of three-phase situations. But these are all perspective. This is not done yet. You can resolve thin sheets. You can have three-phase structures with maybe thin you can have these triple points and you can have resolved thin films. Resolved thin films, three-phase structures. So, this is equivalent to the triple point, but with a different type of line here, encapsulating a blue line. And this corresponds each time to a more complex dictionary. This is very useful, for example, to improve what happens with the volume of fluid method near a triple point. We have a lot of errors near the triple point. So, we hope to have much better triple points with this method. With this method, and like to conclude on the local global alternative, often in physics it's impossible to distinguish between two globally distinct situations from local symmetries. And so when it's impossible to distinguish between two global situations, there is a local symmetry that implies equivalence of local and global methods. What you can do with a global method can equivalently be done with a local method. Method can equivalently be done with a local method, and that's the lesson of this Ebbit method: that you can try to do everything locally. So, the perspective of this to have a general 3D theory of discrete topological complexities on Oxfords. As you look at how the dictionaries become more and more complex, especially in 3D, you can have a theory of the complexity of your topology. And in fact, it is It is important for the physics because some topologies are physically unrealistic. So, the idea is also to prune the complexity of the topologies if you really want to do something which will be practically possible for complex flows like this. And once you achieve this theory of complexity, you will be able to do a full decomposition of the multi-phase flow prime into thin film, ligaments, droplets. Into thin fium, ligaments, droplets, scrolls, etc., as by a topological description. So this is the end.