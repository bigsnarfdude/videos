So, first of all, I guess I have to say that so it did not work as originally planned regarding the subject. So, well, a year ago I wanted to do something related to the workshop. So, now I have to stick with the things which I have. So, and for some of you, it will be a dream. A general overview of the subject, which you have already seen, but like a closing up to the final goal, let's say. So first I have to say that this is work in collaboration, so with a number of people and especially with a group of physicists from the medical university. This is from the Medical University of Vienna. So you see two names here. So this is a PhD student, Lisa Kreinz, who is doing experimental work for us and her boss, Professor Wolfgang Drexler. And there are some other people also involved in this project from the medical university. And of course, from our side. From our side, so we are working for Otmoszetza, so people from Piena and from Linz, so on this subject, and within the project which is called SLB tomography across the scales. So the subject is quantitative optical coherence elastography and oops okay. And I will talk in general of three things. So as shown, written in my outline. So first of all, I say what is quantitative elastography in general. So and why does one need this thing? And why does one try to work something out? Work something out in the subject. So, second thing, second topic here is devoted to the so-called displacement field estimation, and I will explain why. And the third, and so this is the main part of this quantitative elastography in overall is solving the inverse elasticity problem of certain kinds, so which fits. Certain kinds, so which fits to particular application here. So let's start with quantitative elastography. So as so as you know, so when one goes to the doctor and complains about something, I don't know, unknown, but like from the feeling. Like from the feeling, finding something stiff in the hand or any other place, the doctor would usually start to touch this place and like examine. So what could it be? So and so to give a application. Okay, strange. So and cancer is often can be accompanied by significant Accompanied by significant increase of stiffnesses of the tissues. So, as we can see on the picture below here, so this is from some publication from the breast cancer research. So, if there is some inclusion inside of the tissue, so one can characterize it somehow. So, either it is a soft mass or a hard mass. Soft mass or hard mass, and depending on how it deforms when some compression is applied. So, and this one can see in the strain, so which I will comment also later, or in the stiffness. Yes, so and there is always difference in the motion which happens, so with a soft mass and with a hard mass, so and uh. So, and speaking in a micrometer scale, if one can get the shape of any of such cancerous tissues, so it has a diagnostic values. And for our physics collaborators, so they are interested in the skin cancer and any anomalies which happens to the eye. To the eye, so to examine this crystal inside of the eye, so while doing some surgeries. And they are also interested in examining the biopsies, so cuts out of tissues which go into the lab. And one can try to evaluate somehow quantitatively the values of this stiffness. So and distinguish between So and distinguish between like part which is supposed to cut out, to be cut out by the surgeon and removed, yes, so the stiff parts which is cancerous or left in so without further intervening in the body. So and to the right one can see a couple of pictures from another. Couple of pictures from another biomedical paper where they also try to kind of classify the cancer from the colour gens stiffness inside. So and so this would be also a way, like a direction of interest for them that different grades of cancer shows different stiffness values. Values, so okay. Oops. Oh, no, yeah, okay, it's moving. So, usually one need to employ some type of imaging modality or has an imaging modality, and one can try to combine it with this elastography and then find an additional information. Additional information. So, in our case, we would be speaking of the optical coherence tomography, three-dimensional one, and we would like to find this additional information with the help of elastography. And if one is able to quantify this information, so then one can get a useful output. So, and one would have to get access to certain data to do anything. um so now as i already mentioned so the this subject um can be approached differently so the elasto quantitative elastography itself so is a more general subject so and what people typically do so would be so to take some sample and And they try to examine it with the help of elastography part. So, this would be to place it into some machine and apply external forces to the sample so they can be induced different ways and also the sample can be imaged. Be imaged by different techniques like X-ray, ultrasound, magnetic resonance, or optical coherence tomography. So, and then one would like to find the elastic parameters, so this elastic material properties from the measurements, so by some inversion technique. And one would need to rely on a suitable material model which Material model which somehow fits to the examined sample. So, and there exists a wide range of models for this linear, elastic, different viscoelastic ones, plastic, hyperplastic, and so on. And in different combinations of, and for each of such models, would be also different variants of which parameters one is. Variance of which parameters one is searching for. So, okay, so this was in general. So, and now let's move to the optical coherence elastography. So, what we do here. So, we have OCT system and it is added with the elastic, like elasticity module. Plasticity module. And our approach was to look into the problem of finding these parameters in two steps. So first would be, so we have this sample placed and then deformed. And with using OCT, we would record images of that temple. And then we would deal with And then we would deal with the so-called motion estimation problem. So we would like to estimate the displacement field inside a sample from the scans, or in our terms, it's images of the sample before and after applying the external force. So and external force in our case would be static. So this is just a shift. So up, down. And then if one has the motion. If one has the motion found inside, one can attempt to find the material parameters of this sample. So such as for example the Lame parameters lambda and mu. So this is like known formulation in mathematics or for physics people more relevant ones would be the Young modulus E and the Poisson ratio. modulus E and the Poisson ratio nu. So they can be converted from this lambda mu by formulas but it's not that convenient to work with the Poisson ratio in the equation itself because you actually divide by it and you would prefer to have everything on top. So that's why one goes with the lambda mu. So and the So, and the parameters now we want to find from these external forces and the displacement which we got from the previous step. So, and in overall, this problem is a quantitative elastography problem. So, and as we see as this schematic depiction below, so it would go like so we apply a lot to the sample, make To the sample, make OCT images, determine the displacement, solve the news problem, and get the quantitative parameters. So, okay. It's a bit slow. Now let's look at the system which we work with. This is a swept source OCT system. Source OCT system depicted schematically over here. So with this split light 75 to 25 going part of it to the sample, the other part going to the mirror. So this is the mirror part. So here it goes to the sample part and recombines back 50-50 and goes to the controller. So which then would transform this into Then would transform this into OCT 3D volumes, volume images. So from the OCT here, we see only the lens on top. And then we have such elastography add-on, which is a compression module supplied with force reader going to the computer. Reader going to the computer, and over here, a small, tiny thing, so which is marked in yellow on the scheme, would be the sample. And so our physics collaborators tried working with different samples. So here is a schematic depiction of such samples. So this would be a small, tiny prism, like usually. like usually centimeter by centimeter size with a tiny inclusion inside so with different radio and those samples are prepared from rubber silicone which is called this dragon skin used in making like used in movies to make different scary masks. In movies to make different scary masks. And this dragon skin is mixed in such a way that one gets different stiffness of the inclusion and the background. And in order for that mixture to be visible in OCT, which is scattering modality, so the light reflects from anything that is inside. So we had to mix in special titanium dioxide powder particles. Dioxide powder particles, so powder, which is resulting into small shiny particles inside. So, and makes this sample visible to the OCT model, like in OCT modality. So, now let's look at data acquisition process and post-processing just slightly, so because there's many. Slightly, so because there's many things to do, and I just point out so that one gets these 3D volumes recorded of the sample, so which one would have to rotate, cut out, and bring the intensities, so the image intensities, the brightness of such samples in order. So like that they are. Like that, they are this remains constant despite the sample shifting out of the focus of this OCT system and the like refractive properties of this sample also changes with respect to the focus. So that it doesn't look the same. So then one has to compensate for it. So make adjust all this intensity in brightness and one gets such Such images as you see below, so which are ready for the next step, which is displacement detection. So and so one thing to mention more, that the experiment is done as follows. So it's not just a compression, a single one. So just first one is to place a sample, then slightly pre-compress it and Compress it and keep it until it reaches equilibrium. And then one goes in 10 steps. So doing this compression, so like with a few with this micrometer shift. Okay, so this is the information. So now if my computer wakes up, let's go. Let's go to the first problem which we need to solve. So, this is the displacement field estimation. So, we got the OCT imaging data. So, now here you see a small depiction of the sample once again. So, and so the light is sent from above here. So, the force is applied from below. And if we look at And if we look at it from the side, so we see a uniform background with a circle inside. So if we change our point of view, so this would be a rectangle inside. And one has to say that one cannot work with the free data as it is because there's not much information specially inside. Specially inside because the object is quite transparent, one doesn't see much in it. That's why one has to do so-called maximum intensity projections. So, this is what exactly you see on top here, compressed from this rectangle in red. So, and one has to rely on certain symmetry. So, in So, in physical sense and in mathematical sense, to get this proper, and then one have to work with the 2D data instead of the complete 3D. So the sample after compression, this is a very small shifting here depicted, looks like here. The motion is very tiny, it's like 50 to 150 microns. 50 to 150 microns, and one can use. So, we made a special algorithm which detects the motion of these titanium dioxide particles inside, which one can use as additional information. So, and they are depicted with red arrows in here. Okay, so this is a problem in general. So, we get a pair of pictures. So, now let's try to estimate the displacement. Let's try to estimate the displacement field inside this sample. So we went with one of the classical ways. So this was the optical, so different optical flow methods. So we just took the basic formulation for this displacement field estimation. So come and So, coming from the classical optical flow equation. So, where we have the image intensity is i and it depends actually on time, but here we only have two like two frames. And so, the change of this image in time connected by is connected by connected by is connected by the via this displacement so or otherwise called motion of law so u and a typical way of estimating this displacement u would be finding finding a minimum of the functional ju over here where one has to add a regularization term Term for smoothness. So, this method is known as the Hornschunk method. So, it's already since 1981. Okay. So, we tried to run this optical flow on our data. So, this is what usually happens in different biomedical, physical. Biomedical, physical publications, that optical law is applied, and then the results are interpreted from experiments. So, however, when we tried on our data, we found that unfortunately, we get completely different physical meaning from what we should see and what we do see with this optical flow. So, above, there are two. Above, there are two images, two components of the displacement found by the standard optical flow algorithm. So, this is in Pixel. So, the first component is expansion sideways, and the second component is like expansion or motion vertically, vertical motion. So, we if we look at At linear elastic model for such a sample. So, even in 2D version, so we find completely different field inside. So, which doesn't look at all similar to what we see at the image above. So, and so we found it questionable if one can really use the optical flow without additional assumptions on the data. On the data. And one more thing that one should look at is the so-called strain. This is what physics people usually take and then try to invert their own way to find the elastic parameters. So this is basically a gradient of the field from the previous slide. And if I'm Slide. And if one looks at the diagonal component of this tensor, then we also see a completely different image from found by the standard optical flow from the assumed elastic model for such a sample. So we moved in the direction of first finding a way to make a plausible estimation of the motion. Of the motion for physical samples, so from a pair of images taken. So we came up with the following ideas, so which I go one by one. So we decided to take into account additional experimental and physical side constraints with which we then arrive at a different minimization problem. Minimization problem. So, first we started with the idea that we can find this speckle, the so-called particle movement inside. So, it was in one of the images, so marked with red arrows. So, this is a very sparse information, however, rather reliable. So, one can give this optical flow an idea of how much anything moves inside. So, this we include in our formulation by In our formulation, by writing this difference term with some Gaussian function, so to fit the displacement at such points with some given freedom. Okay, then the next thing would be to use some physically plausible boundary conditions. So if one looks at the formulation of this Horn-Schump method and when one And when one minimizes it, then actually, without any additional restriction, the method has natural boundary conditions built in, so which we have derived there. So, and it was proven in one of the older papers, but then never mentioned again somehow. And so, we fixed this thing with so we have a fixed surface, so the side when the Side when the sample is attached to this microscope slide, and another boundary condition is also a particular uniaxial shift displacement. So then we just made a Diego boundary condition there, and of course this is so between Neumann and Diego, he is a completely different meaning. So and to enforce such conditions, so we just So we just added another penalty term or fixed it to the so to zero. So there would be another formulation coming up in the next slide. Or one could also use this speckle information. If one gets anything near the boundary, one can emphasize these terms. Okay, so then another thing was that one can actually, since we know, so the We know the size of this displacement in general, but we don't know what happens inside. Then one can make an assumption and just split our displacement onto a background part and the update part, which would amend this background field into the actual one. And with such splitting of the terms, one can then reformulate the problem into a problem of determining the determining the date with from the bounded okay from the h1 space with the boundary applied so this is top and bottom and solve here the following peak functional so okay um this this can be done so it has a so all So all the properties were studied of such a function also. We have a unique solution here also. And then one can try apply this on the simulated data at first and test it with a different amount of noise and different choice of these recognization parameters since we have accumulated quite some by now because we placed too many terms inside. So what we did is So, what we did is to make a fake sample with a similar location of inclusion and some of these randomly distributed particles, but of course, it's not exactly the same as the actual sample because they just placed a uniform background in there. But nonetheless, we tried to find proper values of the parameters and how this algorithm works and if it works. And if it works. So here we see the table of relative errors. So of the estimated fields. And the first one was the baseline test, which is optical flow simply taken with this particle tracking. So this was one of the first papers we did in this direction. And then we added this background information. So this is test two to five. And with combining. Five and with combining different choices of these parameters, one can go actually down to seven percent error on overall displacement. Now, let's look what the results are. So, this is our baseline test. So, this is the displacement field. So, the lateral component, so this is a sideways motion, yes, and the axial component, so this is vertical motion. So, below, you see the error. So below you see the error. So here we have 20% result in relative error. So there was a noise added also to this particle tracker and to the images, so itself. So then we do a version with the taken background inside, but without the tracking part, particles. So this is also. Particles, so this is also again 20% 21. And now let's do include this particle motion inside. So the error drops to 7%. So which looks not so bad considering that, in fact, this is sub-pixel motion then. Yes? Okay. So then we try to apply this to our experimental data, so with the same parameters, but on this pair of images which were at the beginning. Which were at the beginning, so and below. So, the first, so this is the found field, it's not very eventful, let's say, because the motion is so small. However, one can see that the general error in two components is indeed small, and we are speaking of less than a pixel error in the motion. So, with overall compression, it's six pixels, the shift. Six pixel the shift. So, certainly, so this field is more physical than just applying the standard optical flow without taking into account the physical part of this problem. Okay. So, next step, we had many different samples prepared by our physics collaborators. So, here you So here you see 12 variations. So we have once again this rubber silicon, which is like a prism. And inside there would be a cylindrical inclusion of three sizes. So small inclusion, so it's very tiny in here, then the medium size and the large one. Large one. So the view here, we are again, so looking at this maximum intensity, so basically along the inclusion and chosen part of this sample such that we preserve symmetricity, that our assumptions on this linear elasticity, which we would work with, are fulfilled. So this is the samples. This is the samples. So on top you see the red arrows. So this is from the tracking on the real data. So some of these samples have much information, the others have little. So this is very random. It depends on how much this titanium dioxide mixture entered this silicon, so how well it was distributed. Well, it was distributed, so one cannot control this process, and one has to work with what is available. Okay, since the displacement plots are not very representative in this case, so you have seen a pair of them, so one cannot distinguish much inside. So, we look, so we found first the specimen plots and then calculated the strain components. So, the strain, it was this. So the strain, it was this gradient plus gradient transposed term, which I showed earlier. So the physics people, they are interested in the strain and all these biomedical physical papers, they usually deal with strain in a lastography subject. So we look at the so that the samples are, as you noticed at the previous image, they are Noticed at the previous image they are of different size. This is because of the general stiffness of samples that they have so they have to undergo same force pre-compression before actual experiment. And they squeeze differently, so that's why they look different on these images. And so here they are cut out only to the part for the same part for comparison to make them To make them and also made in the same scale for strain values, so the oh, I forgot to comment that okay, except this apart from different occlusion size, so which goes from small to large, the mixture of this stiffness silicon stiffness was changed also to have included the soft. The soft material inside of the hard one, so this is what is decrypted in this S10 in S20, so means the inclusion was like one and the background was a double S stiff. So this is the first row, the second row, so one to three ratio of stiffness, so soft inclusion instead of hard. And then reversed, so we have a stiff inclusion. So we have a stiff inclusion S20 in S10, so 2 to 1 ratio, and then here 3 to 1 ratio. Okay, so this is the first tensor component. So this is this XX strain and second one, YY strain, which we have would have in the formula. So good. So far, so good. So we found the Far so good, so we found the motion inside. So, however, so now we need to move to the inverse problem, and probably I should be now short faster. Okay, so now we found the displacement and our goal is to estimate a pair of parameters. So, we look at the lame parameters, lambda and mu. And formulate the problem as the following equation. So, given that this displacement is noisy, so first thing we would need to do is to characterize this operator F inside. So, since our silicon is assumed to be linear elastic, so we went with the linearized elasticity equations with mixed boundary condition fixing. These mixed boundary conditions fit into the type of experiment we have. So let's look at the terms here. So we connect inside of these equations, we connect the mechanical stress sigma u with the mechanical strain, this Eu. So the U would be our displacement. And inside of the stress, we find two Two parameters lambda and mu which would characterize the object. So, given that we do not have any internal force, so this F is zero, so we look at this equation with the compression traction boundary conditions. Compression, so means the object is fixed. So means the object is fixed, so this is a Tirichle boundary condition zero, then it moves uniaxially downwards and so sideways it can expand freely. So this gt is equals zero and the object can just move. Okay, so now I want lambda and mu. So one can of course try different models in there. Okay, so we formulate the parameter to solution. We formulate the parameter to solution. So, we go the parameter to solution map. So, from lambda mu to u, we have to do some smoothness assumptions of the parameters in order to perform the analysis here. So, for the dimension two, we would need to take a sober lif space with s greater, bigger than one, so and so one plus sum epsilon. So one plus sum epsilon, so the the fractional order so plex space or just go with s equals two in here. So the parameters in order for that to be physical, they have to be bigger than zero and also the mu have to be bounded from below. So we can use the variational formulation of these equations to express Equations to express our operator F specific way in which we prove different properties, as is continuity, the Freshet differentiability we do. And then, so we go classical way, so just apply Landweber type iteration. So, in fact, we did some nested of acceleration on it, so it looks very similar, but so here is just So here is just the land weber. So, and this is the derivation which we had to do inside. I want to expand on this. So, and one interesting fact about that problem that one actually can prove the strong nonlinearity condition under certain assumptions. So, namely, so we have to choose a space. So namely, so we have to choose the spaces properly and actually know the value of the parameters in a small vicinity near the boundary. Then the condition works. So, and this also can be applied when solving the problem. So, next thing, of course, to try testing this on simulated data. So, if you looking at the left, so we have two parameters: lambda. Lambda and mu. So, this is some values related, so by this conversion formula. And we apply like 10% displacement to the sample, create the synthetic data at about 5% noise, if I remember correctly. So, and then try to reconstruct the sync from one displacement field. So, this is what we do throughout. Throughout, and what one can get here is actually only one parameter of two. So, from one displacement, unfortunately, one cannot find both of them unless there is a particular ratio between this lambda mu. If the contrast of the material is too high, then the lambda is just lost. One has to look at this mu. Mu. So, or so, if one uses these conversion formulas, so this would give the Young's modulus E, which is what the physics people are interested in. And the analog parameter to the lambda would be the so-called Poisson ratio. So, this is responsible for this sideways tension expansion of the object. So, and one more note on this is that uniqueness is only Is only guaranteed in this problem with one displacement under additional a priori assumptions. So one would have to know actually this information along the boundary of the object in order for this to work. Okay, this is a bit unfortunate. So now let's look at the experimental strain data once again. So we can see the Okay, we can see the object inside, but also we note that the values of this strain are very small. So we can try to reconstruct something, but we face a problem in here. So namely, if we look at this particle tracking, which is kind of more precise information. More precise information which one can get out of these samples. Then the motion inside, so between for such type of experiments which our people, physics people did, motion of these tracked particles one can compare to the simulation. So to take this linear elastic model and see what happens if we get the ground truth. Get the ground truth. So, the ground truth our physics people can empirically estimate, but it's also kind of slightly uncertain because this is also highly sensitive to any changes in the experiment. So, we can take these ground truth values and simulate the motion inside and plot it. And also, assume that, let's say, nothing is inside this sample. Sample is uniform, so means homogeneous material. So let's take the ground truth of the background only and also simulate this. And now, if we look at these three enclosed zoomed-in areas, we see that unfortunately between the homogeneous and non-homogeneous material in different parts of this body, there's not much of a difference. It's like pixel-sub-pixel motion only visible. Pixel sub-pixel motion only visible. So we are in trouble that if we have noise in the data, which is unfortunately true, we cannot do the full inversion on such data as we did in the simulated case. So even though this method for finding the strains of the displacement is very precise in our PDF. Precise in our opinion, then without a corresponding stress map, so like a force reading throughout this sample, which would end in the equation, then differently in the boundary conditions. So we cannot really correctly estimate this Young's modulus of the inclusion. So only if we run our algorithm on such data, we get the background. Mostly answer kind of guess for the inclusion, but it's very smeared because it's also. But it's very smeared because it's also H2 spacing there. So then it is not nicely working only if the experiment is done differently. So and our physics people also do not want to do more than one compression like this, which is unfortunate because given we have more of such experiments with different ways, it would have given to the inverse problem much more data. So though we can So now we can try to estimate this Young modulus of the inclusion and background if we use a uniform stress assumption. So this we see in the plot which my colleague did for the inclusion, Young's modulus of the inclusion in comparison to the ground truth and of the background. So this is basically dividing the data. So not very smart, but well. Well, one can get some guess from this. So, the background one can approximate. However, the inclusion, one cannot find the values from it. So, then we had to come up with some different idea and try to reuse the available derivations from the land web iteration, which we did for the operator. And one thing. And one thing which makes most trouble that we have, so we have this divergence inside. So we have to differentiate the data. And one way to do it, would be to avoid differentiating the data, to avoid making errors inside. So we looked at a bit different functional which we minimized. Functional, which we minimized then. So since we have, so we know this motion inside, so and we have this pair of images recorded, so before and after compression. And then one can try to find this lambda and mu by differentiating only the model, so this u comes from the model, not from the data directly, but then Data directly, but then to deform the image and compare it to the actual one. So, and additionally, one can avoid doing the spatial reconstruction, but just stick to the like to two, only two unknown parameters for the whole areas. So while our physics people did this processing, they found segmentation, they segmented. Segmentation desegmented the object such that one can actually see the inclusion and the background separately. So then one can write down these unknown parameters just for two areas and search for only two values. Okay, so we minimize this functional with some small alpha and do not differentiate the data here. So but So, but find, so we do find the now only two numbers here, the young modulus of the inclusion and the background. So, here is an example of one of this table for, this is a table for medium inclusion samples. So, with a Young's model of inclusion background, and below is the ground truth here in the gray. Ground truth here in the gray colour. So, and the problem also was rewritten such a way that one can estimate the Poisson ratio. So, to give an idea of the sideways expansion also. So, which one can identify as well? And it's done in alternating direction search type of thing. So, and to the right, so the YAM modulus found by this. Bound by this from this functional. So, versus the background. So, above, this is for inclusion and below for the background. So, which is good in comparison to the previous inversions which we did, since we really hit near the ground truth, which our physics people, of course, want to see. So, and there is one trend which one observes. Which one observes in these experiments that the stiffness of the inclusion inside is affected by the size. So the larger the inclusion is, so we are kind of moving away from the ground truth in this method. Okay. Okay, so also one, so since what I thought about uniqueness of the problem, so one can reconstruct this Young's modulus only relative one, so not the absolute one. One would need to know the background material for absolute reconstruction. And so we basically need to look at So we basically need to look at the ratio and here's the comparison of this different size inclusions results and the ground truth results. So how it works. And also one can look at the cross section to see how far we are with these models from each other. So and optical flow result. So inside. So the models calculated with the values which we got in. In from our reconstruction. So, and with some accuracy interval estimated, so given that there is a sub-pixel error in such during the processing. Okay. So, one can solve such a problem, but in counting, so facing So, facing many difficulties, so and has to go a bit different ways and applying a nice mathematical method as originally planned to what happens. Okay, so and with this, I guess, end my talk, and thank you very much for your attention.