Before I start, I want to thank the organizers for putting together such a wonderful workshop program. I already learned a lot from yesterday and today's presentations. And my group is mainly interested in developing statistical and computational methods for analyzing functional genomic data and single-cell genomic data. So today, I'm happy to talk about one of our ongoing projects on cross-modality imputation and prediction. Imputation and prediction on single cells. And this is a joint work with my group members, Yimin Zhao, Wei Chiangzhou, Wei Xiangfang, and Ru Zhang Zhao. As you have heard from many previous presentations, single-cell genomic technologies are rapidly transforming biomedical research. And today, a variety of functional genomic data modalities actually can be measured at a single cell resolution. Cell resolution. And more recently, a number of technologies have been developed to measure multiple data modalities from the same cell, allowing you to analyze the same cell from many different perspectives. And these single-cell multi-omic technologies really provide unprecedented power for you to study cellular processes at the systems level. And indeed, Nature Methods has named single-cell model omic. Single-cell model omics as the method of the year for 2019. Obviously, there are many challenges in utilizing single-cell multi-omic data. And one important challenge is that the data from these technologies usually are very sparse and very noisy. And take chromatin accessibility as an example. For open chromatin, usually you can use technologies like single-cell ataxic or similar technologies to measure them. Technologies to measure them. And in this data, including in multi-omic data that try to measure open chromatin, usually what you get is for each cell, you get around thousands to tens of thousands of reads. And then you are trying to use these reads to measure activities of regulatory elements. However, when you look at the genome, you know that in the human genome, there are millions of regulatory elements, meaning that with the data available to you, you probably can only match. You, you probably can only measure activities of a subset of regulator elements, and you are going to miss the activities of a large fraction of other regulatory elements. So that's obviously a challenge for you to use this type of data to study the gene regulation. And also, open chromatin data in single cells usually have very narrow dynamic range. And if you have a look at this data, you know that at each genomic This data, you know, that at each genomic location, the readout usually is just a zero, one, or two, because within each cell, you only have two copies of chromosome. And with this narrow signal dynamic range, it's very challenging for you to distinguish true signals from random noises. And therefore, a critical question in analyzing this data or utilizing this data is that how can one accurately measure functional genomic activities using this data? Genomic activities using this sparse and noisy data. And for single-modality single-cell data, actually, people have developed various imputation methods to denoise the sparse and noisy data. And many of these methods are developed by participants in this workshop. For single-cell analysis, for example, we have methods like Saver, Magic, SCVI, KNSmooth, SE Impued, et cetera, et cetera. And recently, we have also systems. And recently, we have also systematically benchmarked many of these methods. And for single-cell ataxic, we have methods, for example, like scale, scale, and peak VI, et cetera, et cetera. And for all these single-modality, single-cell imputation methods, they have a common feature that is all these methods just use one data type trying to impute itself, right? You try to denoise that data type. And they do not try to use information across. To use information across data modalities. However, we know that different genomic data types are intrinsically correlated. For example, gene expression is correlated with chromatin accessibility. Therefore, there's rich information that may be utilized for you to infer one data modality from another data modality. And for example, multiple authors, including us, have shown previously that it is feasible to use single Feasible to use single-cell RNA-seq data to infer single-cell open chromatin. Just as one example, a few years ago, our group has developed a BERT algorithm that tries to use ENCODE data, ENCODE RNA-SIC and chromatin accessibility data to train machine learning models so that after you train the model, when you apply these models to single-cell RNA-seq data, you can predict single-cell ataxic. Toxic. And interestingly, in that study, we have found that if your single-cell chromatin accessibility measurement is highly sparse, the chromatin accessibility predicted from single-cell RNA-seq actually can outperform the experimental measurement offered by single-cell ATAC-SIG, meaning that using the prediction, you can actually more accurately reconstruct the single-cell chromatin excess. The single-cell chromatin accessibility conditional on the same number of cells compared to the experimental technologies. So after we have all this prediction experience, naturally when we have the single-cell multimodal data, we are interested in asking whether we can actually utilize information across all data modalities to help us improve the imputation. And here, the prediction. Here, the prediction and the imputation actually are not the same problem. They are two slightly different problems. When I talk about prediction, what I mean is you use one data modality to predict another. Say, for example, you have single-cell RNA-seq as input, and you are trying to predict single-cell ATAX-SIC as the output. Whereas when I say imputation, what I imply is you want to use all data modalities to re-export. Use all data modalities to reconstruct another data modality. For example, if you want to impute single-cell ataxic in single-cell multi-ohm data, you are trying to use information both in single-cell RNA-seq and the single-cell ataxic. Of course, the input version of the single-cell atoxig is a noisy version, and you are trying to get a cleaner version at the output. So that is what I mean by imputation. And many of these existing methods for single-cell level. Methods for single cell level prediction do not tackle the imputation problem. They're just trying to use one data modality to predict the other. So that motivated us to explore different ways to do single-cell multi-ohm imputation. And we tried different, we explored different potential solutions. And at the end of the day, we found that a relatively simple solution actually did a good job. So that's the solution I'm going to present today. Going to present today, and the name is CrossMoCell, representing cross-modality imputation and prediction on single cells. CrossMoCell is based on a deep generative model. And here we assume that cells can be embedded into a latent low-dimensional space, and the data are somehow generated from this low-dimensional space. And then we use a variational auto-encoder framework that consists of encoders and decoders. And the encoder. And the encoders try to transform the input data for each modality into low-dimensional parameters that characterize the distribution of the latent cell states. And the low-dimensional parameters from different data modalities will be combined through a product of expert approach to generate a joint, a final distribution. Joint a final distribution to describe the distribution of the latent variable which characterizes the latent cell states. And then for the decoder, we are trying to introduce different data generative models to describe the data conditional on the latent space. For example, for the single-cell analysis data, we assume that the data conditional on the latent space follow a negative binomial model, which involves parameters. Which involves parameters that characterize the true gene expression levels, alpha GN, which models the gene expression activity for gene G in cell N. And it also involves parameters, cell-specific parameters that try to capture effects like library size of a cell. And it also contains parameters, gene-specific parameters, beta G, that try to model gene-specific dispersion. And for single-cell. And for single-cell ataxic, for example, we try to model the open chromatin state for each peak region using a Bernoulli distribution. Again, involving different parameters here, rho, PN is the probability of the true chromatin accessibility for peak region P and cell N. And then we have a peak-specific parameter trying to capture peak-specific behaviors, and then we have a cell-specific. And we have a cell-specific factor SN trying to account for cell-specific factors like library size. So after you specify this model, you can train this model using your single-cell multi-ohm data. And after you train this model, you actually can use this model for both imputation and prediction. Say, if you have a cell that has noisy single-cell only and single-cell ataxic data. And the single cell ataxic data, after you input the data and let it go through encoder decoder, you are going to get a denoised version of our single cell RNA and single cell ATAC. And then for prediction, for example, if you have a cell that only has single-cell RNA-seq data, you can use the trend model to infer the chromatin accessibility for that same cell. So that will give you a prediction. So, we initially implement this model just using a single-cell only and a single-cell ATAC. So, today I'm mainly going to illustrate this model using these two data modalities. But generalization of this model to more data modalities is ongoing. Okay, so to illustrate this model, I'm going to use a few benchmark data sets. And then, in the first data set, we try to apply this model. We try to apply this model to do imputation for shared SIG data. And since RNA-seq imputation is a well-studied problem, here I mainly focus on imputation of single-cell ATAC-SIG because this for single-cell ATAX-SIG imputation, relatively few methods are available. And here we consider a mouse-brain share-SIG data set. And after you do data pre-processing and cleaning the data and get matched ATAC and RNA-SIG. Matched ATAC and RNA-seq data for each cell, you end up with around 3,000 cells. And for RNA-seq, you have measurement for about 20,000 genes. And for atax-seek, you have measurement for about 400,000 peak regions. And then we run our method CrossMo cell on this data. And as a comparison, we have also run several other single-cell ATAX-seq denoising methods to this data set. method to this data set. And then the method we compared includes SCADE, which is a method we developed before. It's a simple method that tries to denoise data by borrowing information from similar cells and similar and co-activated genomic regions. And also it borrows information from public available DNA-seq data. And then we also compared scale and peak VI, and these are two deep learning-based approaches. Are two deep learning-based approaches for denoising this type of data. And then SCADE, since it's a simple model, it just requires CPU. So we have run SCADE on CPU. And then for these other three deep learning-based approach, we run them on GPU and we use the same GPU. And before we look at the accuracy, let's first look at the computation time. And for STADE, it took about one day. It took about one day to finish this analysis, and then this time is on a different scale compared to the other three methods because this is based on CPU. And for the other three methods, they are all run on the same GPU. And then it's meaningful to compare their computation time. And you can see that the scale actually take about three hours to finish this analysis, whereas peak VI and the cross-mode cell, they only require They only require a few minutes, so they are really fast compared to scale. And then, in terms of the performance, we first look at the low-dimensional embedding of these cells. And then, for these cells, we know the cell labels from the original publication. So we try to see whether in the latent space we can separate different cell types. And this shows the low-dimensional space representation of the cells. Representation of the cells for each method. You can see in the cross-mode cell, cells are well separated in the latent space based on cell type. And here, different colors represent a different cell type. For example, exciterine neurons, inhibitory neurons, and oligodendrocytes. Whereas for the other three methods, the separation is less clear. So this indicated that a cross-mode cell, actually, by incorporating information from both modalities. Information from both modalities can help us better separate cells in the latent space. And if you want to see what it means for the downstream clustering analysis, this is what it means. When you try to cluster the cells in this low-dimensional space, you find that cross-mode cell actually can give you better clusters as measured by higher adjusted rent index. And here we try to cluster cells using different algorithms, including Lovain, Class Ring, or Canin. Including Louvain clustering or K-means clustering. And for each algorithm and for each method, after we cluster cells using by setting cluster number to the true cell type number, and we evaluated the clustering performance using the ARI, I just random index, and the CrossMode cell gives you the best performance regardless of what method you use for clustering. And since our purpose is to do imputation, and we are obviously interested in evaluating. Are obviously interested in evaluating the signal reconstruction accuracy for our method. And for this, we have collected a bulk atypexic data from the corresponding cell types from an independent published study. And we use that bulk data as the gold standard. And we ask for each single cell, after you reconstruct the signals, how well is the imputed signal correlate with the Correlate with the bulk gold standard from the corresponding cell type. And here is the result. And here, original means what if you just use the raw data, the raw read count, and then here the result for the remaining method. And I'm showing you the result for three representative cell types: excitatory neurons, inhibitory neurons, and oligodendrocytes. And then y-axis shows. And then the y-axis shows the Piercing correlation between the bulk gold standard and the imputed signals from the single cells. And you can see in this evaluation, CrossModel cell performed really well, and it often ranks either on the top or second to the top. And in this analysis, SCADE, which is the method we have developed before, actually performed really well. And then And then in this data set, you can see the correlation is the highest, which is not surprising because in SCATE, we incorporated large amounts of publicly available DNA-seq data to model the baseline behaviors of this data type. And then that really gives you power to capture the locus-to-locus variability within one sample. And for the other two methods, it performed. Two methods it performed slightly worse or relatively worse compared to cross-mo cell and scale. And we were trying to pull different numbers of cells, say 25 cells, pool 50 cells, 75 cells, 100 cells, and repeated this analysis. And the message is about the same, SCADE and cross-mode cell performed on the top for this evaluation. But then we are most interested in studying cell heterogeneity. In studying cell heterogeneity. Therefore, we ask whether the imputation can retain the cell differences. In that regard, we evaluated the reconstruction accuracy of differential signals. So for this, we pick up pairs of cell types. We pick up two cell types and we ask what are the differential signals between these two cell types. As gold standard, we collected bulk. Standard, we collected bulk atoxic data from the corresponding cell type, and we computed the difference between the bulk atoxic. So, this gives you the ground truth. And then for each cell type, we can pick up a single cell and use the imputed data. We can also compute a difference at the single cell level. So, that's the imputed single cell level difference. And we ask how well is the single cell level difference correlated with the bulk level difference? Bulk level difference. And then this is the result. And then when you look at the differences, you can see now SCADE performs worse. And then actually CrossMode Cell performs the best and it substantially outperforms the other competing methods. And then this slide shows one example. And here we pick up one excitory neuron and one inhibitory neuron. And on the X. And on the X, each dot in this plot represents a peak region. And on the X axis, what I'm showing you are the bulk difference. You can view it as ground truth. And on the y-axis, what I'm showing you are the difference computed using the imputed data or original data. You can see if you use original data to characterize difference, it does not provide you the dynamic range to accurately capture the bulk difference. Really capture the bulk difference. Whereas, if you use cross-mode cell, the imputed difference correlates with the bulk difference very well. And for these other three methods, the correlation is relatively weak and definitely much weaker compared to Crosmo cell. And we also try to pull different number of cells. For example, we pull 25 cells from each cell type and compute the difference, or we pull 50 cells, 75 cells, 100 cells, and repeat this analysis. The cells and repeat this analysis. And in all this analysis, you can see that cross-mode cells imputed difference actually correlate with the bulk difference best. Okay, so similarly, we have benchmarked these different methods using a different platform. And previously, we in the example, in the first example, we used the share seek. Now we used a 10x multi-ohm data where you have. Own data where you have both single-cell RNA and single-cell ATAC for the same cell. And here we used a PBMC data from the tank's website. Again, after you do data pre-processing, cleaning noises, cleaning the bad quality cells, and after you match both RNA and ATAC, you end up with around 3,000 cells with both RNA and ATAC measurement. Both RNA and ATAC measurement. And for RNA-seq, you have about 30,000 genes. For ATAC-SIG, you have about 150,000 peak regions. And then in terms of the within each cell, when you ask how the imputed signal correlate with the corresponding bulk ataxic gold standard, you can see again CrossMode cell performed among the best. Actually, in this example, three deep learning-based methods performed similar. Learning-based method performed similarly, whereas SCADE performed slightly worse. And however, when you look at the differential signals, when you try to recover the differential signals between two cell types, you can see cross-mode cell substantially outperformed all the other method. Okay, so in the next example, we are trying to evaluate the ability of The ability of cross-mode cells to do prediction. Here we assume that you have a cell, and for that cell, you only have single-cell RNA-seq, and then you are trying to predict single-cell atoxic from that cell. And again, we first use tags genomics PBMC data, the same data set we used before. And then each time we reserve some cells as test, and for these cells, we know we have both single-cell RNA and single-cell ATAC data. Cell RNA and single-cell ATAC data, but we pretend that the single-cell ATAC data is not available to you. And assume you only have single-cell RNA. And then for these test cells, we are going to predict single-cell ATAC. And then we are going to evaluate the prediction using the real single-cell ATAC-seq data measured from the same cell. Okay, so that's how we evaluate different algorithms. Again, here we compared cross-mode cell with two existing algorithms that can be used to Existing algorithms that can be used to predict single-cell ATAC from single-cell RNA. And one algorithm is BERT that we developed before. And BERT uses a regression-based approach and it's run using CPU because it does not require GPU. And then another method is Babel. And Babel is a deep learning based method. So we run it using GPU. And both Babel and the CrossMode cell are run using the same GPU. Run using the same GPU. And again, before we look at the result, we first look at the computation time. And you can see for CrossMode Cell, it actually can finish the computation less than half an hour. And whereas for Babel, it does require, for most of the cell types, it actually require more than one day to finish the computation using the same computational resource. And for birds, Computational resource. And for BERT, it uses CPU and it requires about one hour between the Babel and Cross Mocelle. So Cross Mocelle is really much faster compared to Babel. So in terms of performance, here again, we used bulk ataxic from the corresponding cell type as the gold standard. Here we use the single cell ATAC measured from the multi-OM. Cell ATAC measured from the multi-ohm data as the gold standard and compared to our predicted single-cell ATAC. And you can see, in terms of the AUPRC area and the precision recall curve, birth performs slightly worse than the two deep learning-based approach. And for this data set, actually, Babel and Multi-OM, here Multi-Mo is our cross-mocel approach. Our approach and Babel perform similar. approach and babo performed similarly but babo slightly outperformed us at the cost of more computational time and then we similarly did a similar evaluation using share sig data and um and here again computational time wise babo is much slower compared to us it takes uh one to two days to finish computation whereas cross mod cell finished the computation uh within 10 Computation within 10 minutes. And in this data, Crossmore Cell actually offered a higher prediction, slightly higher prediction accuracy compared to Babel. So that shows that Crossmore Cell actually performs comparably to Babel and is sometimes a little bit worse, sometimes a little bit better. But in terms of computation, it actually is much faster compared to Babel. So I see my time is almost up. So it's my time to conclude. Up so it's right time to conclude. And as in summary, to summarize, we have developed CrossMode Cell, which offers a new tool for analyzing paired single-cell RNA and atoxic data. And this framework allows you to do imputation by borrowing information across data modalities. And it also allows you to predict one data modality from another if you only have one data type for a cell. And I've shown that in a lot of I've shown that in a lot of when compared with other existing methods, it often gives you comparable or better performance. And but computationally, it actually is more efficient compared to many competitors. And next step, and we are sort of still extending this framework and then in multiple directions. First, we are trying to integrate information from public available data. As I have shown you, that in one of our tests. Have shown you that in one of our tests, SCADE actually previous methods performed better. That's because we used a lot of information from public data. And in our current CrossMode cell framework, we haven't used that information yet. So our next step is try to incorporate public available data into our framework as well. And then we are going to extend our current framework to account for multiple data sets when you have training data from, say, both single-cell or bulk data. Single cell or bulk data, how are you going to combine them to have a better model? And also, we are trying to extend to other data modalities other than single-cell only, single-cell ATAC. There are many other modalities like protein in CIT-SIG and others. And then we are trying to extend that as well. And finally, another future direction is to couple this framework with various downstream analysis tasks, like using both transcriptomed and Both transcriptome and chromatin data to infer gene regulatory networks. With that, I'm going to conclude my presentation.