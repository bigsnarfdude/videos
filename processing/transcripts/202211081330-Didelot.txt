My name is Xavi Ditlo. I work at the University of Warwick, and today I will be talking about how when we are given a genomic sample from an infectious disease, whether it's a bacteria or a virus, from a limited geographical area, say a country or a location, a region within a country, we can try to detect imports. Detects into that region as opposed to cases that are being locally transmitted. So, my starting point is going to be a dated phylogeny. So I expect many of you are familiar with this, but just to make sure that we are on the same page, what I mean by that is, you know, as opposed to standard phylogenetic methods that reconstruct trees in which the branch lengths are measured in units of evolution, for example, the number of mutations or the number of The number of mutations or the number of substitutions per site, some methods, like Beast, for example, is one of the best-known software to do this, can reconstruct what I like to call data phylogenies. And the difference, the branch lengths are measured in units of time. So we've got an example here on the slide. You can see that the time we have a scale that is in years. The genomes for which we know the date of isolation are aligned on the x-axis here with a known date of isolation. With their known dates of isolation. And as internal nodes of the tree, for which we don't know what the dates of their existence actually is, this is something that is being estimated by BIST in this case. And to do that, a molecular clock has to be estimated, which represents the number of mutations happening per year. You can see this molecular clock is quite central because it's what allows us to convert genetic distances that you have in a sort of standard phylogeny into dates or dates. Dates or dates of ancestors, which is what we have in a dated tree. So, those types of data trees are very, very useful for genomic epidemiology. There have been loads of examples of that. And maybe just as a side note, I mean, Beast is really well known for producing this type of trees, but there are other methods to do it. And I would like to mention very briefly my own software called Back to Dating, which is a bit different from Beast in that it takes a standard phylogeny and it will turn it into a dated phylogeny. So, here we have an example. It into a dated phylogeny. So, here we have an example of a simulated case in which the true dated phylogeny was shown here on panel A. And this is not what's observed. What's observed is a standard phylogeny, like what you have on part B, where we don't know where the root is and the branch lengths are measured in units of mutations, not here. But by detecting the temporal signal in this signal, which is what is shown in part C, you can deduce the correct data tree, which is shown in part D. Dated tree, which is shown in part D. So the input of backdating is what's shown in part B, and the output is what is shown in part D. And you can see that that corresponds very closely to what we had in part A, the correct dated phylogeny with a few added features, like the fact that we don't know exactly, of course, when the ancestors existed. So we have those blue bars that represent the intervals of confidence. So if you have a standard phylogeny and that you want to apply some method like the one I'm going to be describing that requires Describing that required dated phylogeny, you can use backdating to turn your standard phylogeny into a dated phylogeny. So, to return to the question that we're interested in today, which is the question of detecting imports, I would like to say first that it's related, of course, to phylogeographic methods, but it is different. So, in a typical phylogeography problem, what you have is samples from multiple locations, and we're going to try to infer. And we're going to try to infer something. We're going to try to infer their relationship, which is shown here by the tree. And we're going to try to infer something about past migrations from one country to another, which corresponds here to the changes in colors from one country to another. We also try to infer something about the migration rates, which is illustrated on the bottom left here. That's what typical phallogeographical methods do. They are some in beast, and they are, of course, very And they are, of course, very valuable, but it's different from the question of detecting imports. What we try to do when we try to detect imports is that we have samples from just a single location. So, imagine this tree, if you only had the samples from this pink color, for example, the four at the top and those few and those few here. And you didn't have the rest of the sample, you don't have genomes from any other location, we try to say something about the fact that these must have been sort of separate imports into. Sort of separate imports into the geographical location because in this case they are separated by quite long branches, right? So you can see that the question of detecting imports is harder because we are given less information. We're only given genomes from a single location, but often that's what we have. I mean, often rich countries, for example, when we're interested in antibiotic resistance, rich countries do a lot of sequencing and we have a lot of genomes from Europe or the USA, but we don't have so many genomes from Have so many genomes from less wealthy countries, and yet we know that a lot of resistance arises there. And so we're left with a typical problem of having to detect imports and having to establish how many times resistance spread into a country in Europe, for example, without any notion of what is the reservoir of antibiotic resistance present in the rest of the world. So to do a phylogenographical inference. To do a phylogenographical inference correctly, you would need to have a good sample from all the locations in which the pathogen is spread. That's almost never the case. And in the worst case scenario, you have just sampled from a single region, then you're left with this problem of having to detect imports into that region. So how do we do that? It's a problem that I want to address today. And it has to do with how quickly the, as you've sort of already guessed and hinted at on the previous slide, it has to do with the length of the branches and some branches being Length of the branches, and some branches being too long to be explained simply by the local transmission of the local population. So, more specifically, the key parameter of interest here is what we call here the coalescent interval and corresponds. So, if we look here in this case at the last sample in this genome, S10, the most recent one, and we look at how much and we see that it coalesced with the rest of the tree at this point, C9. Rest of the tree at this point, C9. But if you look at all the branches that it crossed before it coalesced, it's what we've illustrated in red. For all that time, from C9 to S10, the genome could have coalesced with S7, but could also have coalesced with any of those other lineages that existed between C9 and S10. And everything that's colored here in red is what we call here the coalescent interval, which represents how much branches are. Much branches are being crossed before we find the coalescence point of the latest genome in this case. So it can be written down as this equation here. If we represent AKT, the number of ancestors that existed at time t, when you consider the genealogy made of up to the k first leaves, then the crescent integral. Then the constant integral is simply the integral from c k minus one, so in this case c9 to sk, so in this case s10, of the integral of the number of ancestors that existed at that time. Okay, and so imports will have larger coalescent intervals compared to locally acquired cases. And so you can see that what a sort of basic idea that we're going to be using is to look for cases that have a relatively large coalescence interval. Okay. Okay, so let's try to do that in a very naive way first. And so, here I'm looking at two different simulations. On the left, here I simulated a tree without any import, so it's a sort of perfectly normal tree. And so, here on the in part B, I'm plotting this coalescent interval for each of the leaves. I'm plotting on the x-axis the dates of the different leaves, and on the y-axis, the coalescent interval as defined in the previous slide. And we find that most, of course, some coalescent intervals are larger than others. And if you looked at the average cores and interval, and given that we expect this crescent interval, in this case, perhaps to have a mean around 0.5. We know that the distribution of the current interval will be exponentially distributed around this interval, and so we can around this mean, and we can deduce. Around this mean, and we can deduce that those last three cases look like imports because they have higher coalescence interval than you would expect just by chance. Actually, this is completely wrong in this case because this simulation was done without any imports. So, here we have an example of three false positives, cases where if we do naively what I've just described, to look at the current interval and look for some current intervals that are larger than you would expect just by chance, you get some erroneous. Some erroneous false positive. And conversely, here on the right, I was simulating with just a single import where, you know, this is my import. Here's this whole top of the tree. You can see there's a long branch separating it from the rest. And it corresponds to this branch here, the first of the cases from that import, which must be somewhere here. Oops. That didn't get detected as an import, so it's a false negative, but on the other hand, we have a lot of false. Negative, but on the other hand, we have a lot of false positives here. The problem with these simulations and this inference that I'm doing here is that I'm not accounting for the fact that there were variations in my simulation in the local population size. And those variations in local population size cause the coalescent intervals to change over time. When the population size is large, then the coalescent intervals are going to be large. And when the population size is small, they're going to tend to be small. In fact, this is the exact relationship here. The exact relationship here between population size any at a given time and the distribution of the coalescent intervals. And you can see that it depends, of course, on the population size at various moments. And there's this integral here that looks difficult to calculate, where we have at the top, the number of ancestors at a time t, and at the denominator, the population size at time t. So we cannot do what we just said, what I was doing on the previous slide, we cannot assume that there's going to be a constant. That there's going to be a constant expectation for the value of the cohesion intervals because that's going to depend on the proportion size. Now, unfortunately, calculating this integral here would be quite difficult, and we don't know a priori what is the operation size of the time. So, what we do is that we use, we're going to model the mean coalescence interval as a Gaussian process over time, and we're going to look for cases that have relatively large coalescence intervals. Correspondent intervals compare to the current mean value of the correspondent interval in the discussion process. So we compare values of the correspondent interval against values around the same time, if you want, which represents, if most cases are locally transmitted, that gives us an idea of what current intervals are going to be at that time. We can, because you have a Gaussian process to infer, it makes the problem a bit more complicated, but we can use Bayesian inference. And specifically, we implemented the Hamiltonian Monte Carlo method. Implemented a Hamiltonian Monte Carlo method that is already implemented, in fact, in the Stan platform. And all of this is implemented if you want to use it in R package called DetectImports. So let's see how it does on the simulation I was just showing you before. So I've got those two simulations, remember, on the left with one import and on the right with, sorry, on the left with no import and on the right with no import, with one import. And when I was assuming a constant coalition interval mean, I was getting something. mean I was getting some false positives here, some false positives there, and one false negative here. Now, if we apply the Bayesian method that I just described with the Gaussian process for the current interval mean, we find correctly that the current interval on average increased over time. And so those three values that were high, that are here, are no longer significantly higher than you would expect. So those false positives have gone away once we've accounted for those variations in the current. Once we've accounted for those variations in the crescent interval. And here on the right axis, on the right-hand side, not only have the false positive gone away because we've correctly inferred that the crescent interval increases, but because we've also realized that the current interval was quite small back around that time, we now have correctly inferred that this case here, which really was an import, is indeed an import. So again, by accounting for the So, again, by accounting for the variations in the local population size, we are able to correctly infer what is an import and what isn't. And here I'm showing you just two examples, of course. So you might be tempted to think that I picked those examples carefully, but we did that many, many times, of course. And here I'm showing you the rock curve with on the x-axis, the false positive rate, and on the y-axis, the true positive rate. And you can see that the model with a constant population size, which is what I had. A constant population size, which is what I had in the middle before, doesn't do very well. But the model with a variable population size based on this Gaussian process has an almost perfect rock curve with an area under the curve of more than 99%, which means that we are much likely to detect true positives than false positives. That's when we do simulation under a simple model of import into the local population. What we can also do is simulate under the structure. What we can also do is simulate under the structured quarters model, which is the model I showed at the start that is often used in phylography. And so we use this software by Vogen and German called Master to simulate under the coalescence model, the structured coalescence model, with uniform migration rates between different locations. And I'm going to consider several locations, like five, three, or two locations, but I'm only sampling a single one of them. And I'm asking, given the sample that I have from that single dem. The sample that I have from that single dem, how many imports have happened? So I can count that now because I can look at the simulation and I can look at how many migrations really happened. And here on the x-axis, I'm showing the correct number of migrations that were in the different simulation. And on the y-axis, I'm showing the inferred number of imports detected by the software. So it's not perfect. There are some migrations that are not being detected clearly, but this is exactly what we would expect because some migrations happen quickly. Some migrations happen quickly forward and backwards between two DIMS, and there's very little power in this case to detect them. I was actually quite surprised to find that, even in the case with just two DIMS, where we have just two regions in the world infected, and we sample for just a single one of them. And in that case, I was expecting it to be really quite hard to detect imports because of the structure of the problem. Even in this case, we are doing less well than when there are more DIMS, of course, but we are still doing quite well. Teams, of course, but we are still doing quite well. You can see there's still this very clear relationship with maybe something like more than 50% of the migration that happened that are being inferred by detecting pools. Okay, so I've shown you a lot of simulations. Now, maybe it's time to look at a couple of real examples. And the first one I looked at is an old data set from an old paper of mine. We're looking at an outbreak of gonorrhea that happened in a single town, Sheffield. Happened in a single town, Sheffield, in England. We had 132 genomes from that outbreak collected between 1995 and 2000. All those genomes are from cases of ST12 of gonorrhea. And a tree was built in the original study using beast, which is shown here on the x-axis. And here you can see the inferred coalescence interval and the inferred interval. And not a single case here was inferred. And not a single case here was inferred to be an import, which means that this is just a single outbreak and just without any imports coming from other locations, which is what had in fact been inferred going back to the original study based on contact tracing, it had been inferred that this was an outbreak taking place in Sheffield quite separately from the rest of England and the rest of the world. So just an example where Just an example where here we are confirming that this is a single outbreak without any import, and therefore we can analyze this outbreak in terms of transmission between the cases within Sheffield. Here's a slightly more interesting example, an epidemic of Shigera. It's a data set from Cathol et al. 2016. So 155 genomes of Shigera sonii were collected. All of them are from a single clade of soniae. And the collection And the collection was done within a single country, Vietnam, between 1995 and 2010. This tree was built using backdating, which I mentioned at the start of my talk. And the tree is shown here on the top. And you can see in red, I've highlighted a single import that corresponds to this crescent interval here that was inferred by detect imports. So if you look just at the tree here, it might not look very striking, this branch here, but actually, it is one of the largest. But actually, it is one of the last genomes to be sampled. And it is really quite a long branch with quite a high coalescent interval, with all the branches being crossed before we find the coalescent. So much so that there is a good chance, although we cannot be completely sure. We're talking about a p-value between 0.01 and 0.01. Actually, I think it's only slightly below 0.001, as far as I remember. So we cannot be completely sure whether it's an import or not, but it is possible that this. It is possible that this is an import as opposed to the rest of the sample that clearly have coalescent intervals compatible with local transmission within the country. And finally, my most advanced example for this talk is this outbreak of Ebola. And this is a very, very nice data set, of course, by De Dacetale, where they sequenced Ebola, so the outbreak that took place in 2014. To the outbreaks that took place in 2014 and 2015. And here I'm only looking at the 1031 genomes of Ebola that were collected from Cierleon. So this is a tree that was built by Diudacetal using BIST and sub-sampled to just include Cierleon, because what Deudacetal did actually was to order that they also sampled some genomes from Liberia and from Guinea, which are the three countries with Sierra Leone where Ebola. Where Ebola, there were by far the most number of cases of Ebola. So, what we can do, we can focus on just Sierra Leone and pretend that this is all we have and ask ourselves the question, how many imports happened from Ovibola into Sierra Leone? And this is what was done here. And here we have shown on the number of imports that were detected over time. And we found that they were actually. time and you've we find that there were actually a few imports open since the start of 2015 and then there were more imports a few more imports happening from the january 2015 and and we can relate that with a full phylgeographic analysis that was done originally by gida fetal where they looked not just at the genomes of cerealion but also the genomes from guinea and liberia and we can and they had come actually to exactly to a very similar conclusion of a relatively small number of imports that uh into sea alion that That into Sierra Leone that starts around 2015 with no evidence for any imports before that. So, by looking at a subset of their data, and of course, if you have all the data from all the three countries, it makes sense to use a phylogenographic approach. But if you imagine that only C alion had had the capacity to sequence at the time, then this is what we would have been left with. And we would have been left with a problem of detecting import into the population as opposed to the full phylogenographic. As opposed to the full phylographic inference that Didas did. And it's nice to see that even in that situation, with this limited amount of data, we are able to say something about imports that took place of Ebola into C early on. Okay, so just to conclude with what I've been presenting today. So, I mean, maybe I haven't said enough about the importance of distinguishing imported cases from locally trusted cases. I mean, quite clearly, this is very important to guide public health interventions. If you have an infectious disease that spreads a lot within a certain region or within a certain country, then you need to take measures that are targeted at breaking the chain of transmission in country. If, on the other hand, you have a lot of imported cases, then you know that you want to sort of limit this number of cases through other types of methods. Number of cases through other types of measures that can be taken, right? So we've seen a lot of that with COVID, of course. So phylogenographies is very valuable. Of course, it can reconstruct migrations between locations, but that requires good samples from all the locations, right? So here we developed this alternative idea, which is to detect imported cases within a single location based on genomes just from that location. And we do that by looking for deviation from the null distribution of locally transmitted cases. Of locally transmitted cases. So, the vast majority of cases are going to be locally transmitted. We can look at their coalescence intervals over time, and any values that are much higher than average are likely to represent important cases. So, as I hope I've shown you with the simulation, it's very important when you do that to account for the variations in the local population size. Otherwise, we get some false positives and false negatives. But once you do that, the software works quite well. So, this software. Software works quite well. So, this software once again is implemented as an R package. It's available free and open source on my GitHub. And there is a preprint, it's not published yet, but there is a preprint already available on BioArchive that you can find if you search on BioArchive for detecting ports or my name. Thank you all very much for your attention. That's the end of my talk. Stop sharing now. Thank you, Javier. Very interesting talk. We have five minutes left, and I would like to take the opportunity to ask a couple of questions. So I think it's seeing what you present, and especially with the Ebola tree, where you can reconstruct importations without necessarily having the other data. So, and that is quite consistent. I have one question regarding the long branches because. Regarding the long branches, because long branches can also be a result of undersample local images, right? And those could be a confounding factor when you have large qualescent interval interpretation. So could you, is there a way to correct for this? This is my first question. So that's a very good point. Yes, yes. Ideally, the data tree that we analyze with detecting ports is a single lineage, a single variant of the pathogen. Variant of the pathogen that transmits locally. And it's not, and it's quite right what you said that if we have multiple lineages, they might be inferred to correspond to separate imports. That would be true, but each variant would only be found to have been imported once and once it's sort of been detected to be imported once, which actually corresponds to truth. Usually, variants didn't emerge within the country, but were imported at some point. That were imported at some point, then any sort of subsequent case of that same variant will be not detected as an import, but will be compared with the cases of that variant that have been reported so far. Thank you. And my second question is, is there any way of estimating what is the sampling threshold? So, if you have a very sampled data set and you dilute the sampling and to see how far you can go. How far can you go until you detect no importations? That's a very good question. How dense does the sampling have to be for imports to be detected? And the answer to that really relates to what I've shown on how important it is to correctly infer the population size dynamics in order to correctly detect imports. So, really, the requirements are for the sampling to be dense enough to infer correctly those. To infer correctly those variations in the coalescence interval that you see over time. So, very similar to how densely you need samples to be in order to do typical phylodynamics, like scaling type of plots, is what is required. Yeah, and I guess this will also be quite sensitive to sub-sampling approaches people use to reduce data sets and to infer further parameters. So, that's also an important that's right. So, the sampling needs to be dense enough for this to work, and there needs to be enough. Work and there needs to be enough locally transmitted cases. If you only have cases that have been imported, then it has nothing to build the null distribution of the quasi-detables on. Yes, that's right. So we have a question there in the chat by Sandrine saying, very interesting talk. Do you try to apply your methods with SAR-COV2? I was curious about what would be the behavior within munosuppressed individuals or passage through animals. Would they be detected as an input? Would they be detected as an import? So that's a very good question. Of course, this method was not to advise with SARS-CoV-2 in mind, because actually the idea of it came to me before the pandemic, but certainly it is very applicable to SARS-CoV-2. And in fact, in our preprint, I didn't show you today, but in our preprint, we have an example of application to SARS-CoV-2 in Scotland. We haven't actually done try to address this question about what would happen. This question about what would happen with immunosuppressed individuals. Possibly, this would be seen as an import because it would correspond to those types of long branches that are the typical signal of import. So I suppose the conclusion had to be taken always with a little pitch of salt that imports are only detected as a deviation from what is a sort of normal transmission pattern. And any deviation from that is going to be called an import, but could perhaps be some. Code and import, but could perhaps be something else. That's it's true to say, yeah, yeah. And maybe another question that would be related to this one is: do you think of a way to change the method and to discriminate between these cases? Possibly, but in that case, you will really need some information about what you expect imports to look like and what you expect other source of deviations to look like based on what Based on what you know, we've been trying to develop a method that really just looks at the data tree for a local region. And based on that, really, there is no information, there is no way really to disentangle what's an import from what is another type of deviation. So to do that, you would need that extra bit of information or data that would tell you how to separate the two. Sally here has a question. Just a couple of follow-ups. I think Marina was also talking about spatial structure within a country. So when you say importing, you don't know if it's from another country or just from a region that you're not really sampling. But I wanted to follow up on Sandrine's question because, first of all, we have so much information with SARS-CoV-2 that we are learning that evolution can proceed in these two ways: both a prolonged period of evolution within persistent infections and then transmission, but it may. Infections and then transmission, but it may well apply to many other diseases. And for detecting it in SARS-CoV-2, there's a different signature mutations, more in SPICE, for example, than elsewhere, but more in the kind of immunogenic pieces of the genome. And so that might be a signal that you could apply for these ones. Do they show a typical mutational spectrum or a biased mutational spectrum to find out if you do have it in other diseases? Other diseases. So, in the case of SARS-CoV-2, you're absolutely right. It's exactly what I had in mind when I was saying to Sandrine: you know, you would need some information about what looks like an import or the mutation spectrum of an import or the sort of random mutations, as opposed to the sort of typical mutation that would be associated with immunosuppressed individuals. For other pathogens, I'm afraid we know a lot less really than we do for SARS-CoV-2, and certainly there hasn't been nearly the same sort of amount of dense sampling. Dense sampling. I mean, one situation I'm really interested in is antibiotic resistance, and in that case, it's very, very typical that we have good sampling within, say, the UK, but very little information about what the sort of resistant cases might look like in Asia, for example, where we think a lot of resistance arises in the first place. And that's exactly where the problem of detecting in pulse, as opposed to doing phylogenetic. Detecting imports as opposed to doing phylogenography really comes to life is when you don't have when you only have information about the local population. Well, I think we should stop here. Thank you again so much. Just a quick reminder: I would appreciate if people in the online version of our meeting could raise their hand so we can keep up the structure of the questions and so on, right? And so on, right? So we're going to move.