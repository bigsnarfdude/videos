For the emerging virus lineages using the number of segregating sites. So, although genetic sequences or genomic sequences can be used to understand many different aspects of infectious disease dynamics, one of the noticeable use so that the genomic sequences can be used to understand many different aspects of infectious diseases. One of Diseases. One of the noticeable uses of this sequence data were the inference of epidemiological parameters during the early phase of SARS-CoV-2. And the inference of these epidemiological parameters often relies on the phylogenetic tree rather than using the sequence data directly. And this phylogenetic tree, which describes sorry, which describes the sorry. which describes the, sorry, which describes how the sequence virus are related to each other, are relying on the relying on the genetic variation in the sequence data. So if there is not enough genetic diversity or genetic variation in the virus population, especially when an outbreak is started by an emerging viruses like SARS-CoV-2. Emerging viruses like SARS-CoV-2, there would be a significant amount of uncertainty there, which should be integrated over to estimate the epidemiological parameters. And this could be a time-consuming step for an inference. And then also, this phylogenetic-based models are often have more parameters to be estimated with a limited amount of information. With a limited amount of information if there is low genetic diversity. Also, it is not related to the low genetic diversities directly, but the phylogeny-based approaches cannot directly estimate the timing of the index case. So, one of the works that estimate the timing of the index case in Hubei, if I'm remembering correctly, in that work, the timing of index case is estimated by combining the five. Estimated by combining the phylodynamic approach and then the simulation of the early phase of the infectious disease dynamics. So here we are suggesting a phylogeny-free approach to circumvent the need to reconstruct a phylogenetic tree when there is low genetic diversity. So we are setting our niche here where the viruses are newly emerging. Where the viruses are newly emerging and the virus population is yet to accumulate enough amount of genetic diversity. So instead of using a phylogenetic tree, our approach is based on the idea that the pattern of virus spread is reflected in the pattern of genetic diversity that changes over time. So this is because when virus replicates, mutations are introduced to the population and spread with the virus. And spread with the viruses. So let's say that this virus here reproduced, and one of the offspring has a mutation. So now the virus population has some genetic diversity. And as virus spreads more and more, the more mutations are introduced in the population and spreads throughout the population. So they have higher genetic diversity. Genetic diversity. However, when forest population shrinks, they are losing some of the variations. So the genetic diversity this time is decreased. So the dynamic of the virus population could be reflected on how genetic diversity changes over time. And just as the time series of case data can be used to infer the epidemiological parameters, The epidemiological parameters, we thought that our time series of genetic diversity can be also used to invert the epidemiological parameters. Then how do we quantify this genetic diversity? So we used a classical population genetic, classic population genetic statistics called the number of segregating sites. And this statistic is defined as the number of sites that is. Defined as the number of sites that is more than number of sites with more than two or more alleles, or in other way, the number of sites that is polymorphic. So in this sequence from four samples, if we see the first site, this site is not polymorphic or like segregating because they only have adenin in the site. However, this second site However, the second site are, second sites have more than two alleles, so this site can be called as like a segregating site. And likewise, the third site is also a segregating site. And we continue to counting these segregating sites for the rest of the virus genome and get the number of segregating sites. And the segregating sites in this example would be five. And this summary statistic is directly observed from the sequence data without building any phylogenetic tree. But one thing to note is that this summary statistic depends on the sample size because if we have more samples, then there is a higher chance for a site to be polymorphic. So before we So, before we move on to the inference using the segregating sites, we first wanted to confirm whether this segregating site trajectory reflects the underlying dynamics and can be used to infer the epidemiological parameters that governs this dynamics. So, we first simulate an epidemic and obtain the segregating site trajectory by By sampling 40 sequences from each four-day windows. So, this is a multiple segregating site trajectory just to see the overall patterns of the segregating site trajectory that we can get from this epidemic. And then if we sample less, so for example, sampling 20 sequences per time window, then the number of segregating sites is somewhat decreased compared. Is somewhat decreased compared to the one obtained by sampling 40 sequences per each window. So, this is basically showing that we need to control for the sampling effort when we are comparing segregating site trajectory from one to the another. So we compared this segregating sites from 40 sequences per window with With segregating side trajectory from different scenarios. And this one is showing the comparison between the baseline scenario and the scenario with higher R naught. And then this one is with transmission heterogeneity. And this one is with a scenario where the basic reproduction number or the transmissibility is reduced to like 1.1 and 0.75. 0.75 at some point of the epidemic. So we saw that the we saw that even though sampling effort is controlled, the different underlying scenarios or different underlying scenarios resulted in different segregating site trajectory. So now with that, the segregating site trajectory is reflecting the underlying dynamics and informative of underlying informative. Informative of underlying informative could be informative. I'll briefly go over our model structure and inference framework. So, as we've seen in the previous slide, we have a time series observation of the number of segregating sites and the infectious disease dynamics that is not directly observed. And we want to infer the parameters covered. Infer the parameters governing the dynamics of this infectious disease or virus. So, this makes our system very suitable for the state-space model. And to briefly mention or introduce a state-space model or the POMF is a model that has a two-part where the part with where the first part is with unobserved state variables. observed state variables and the second part is the second part is where the observation of underlying state is happening so for our system the first part simulates the epidemiological and evolutionary dynamics and the second part simulates observation of genetic diversity as a segregating site And with this state-space model, we calculate the likelihood of a parameter using the particle filtering algorithm. And we start with a number of particles for the initial state. And then we iteratively updating particles throughout the time windows. And for each time windows, Time windows, each particle simulate the underlying dynamics using the state process and simulate the observation process and get the weight of each particle, which will be used to calculate the likelihood and resample the particle according to the weight so that we can start the next time points. Okay, so in our state process, we simulate the epidemiological dynamics using a simple compartment model. And for the evolutionary dynamics, we assign a virus genotype for each infected individuals. So this virus genotype is infected, sorry, inherited from the infector to infecte and is defined as a unique set of. As a unique set of sites, unique set of sites with mutations. So if we say this genotype zero as a reference genotype, then this genotype zero will have a known mutation, no mutated site. And it is also possible that mutations occur during the transmission. So this individual's So, this individual received a virus with two mutations occurred during the transmission. And this offspring genotype has a two-mutational sites, which is shown as one and two. So, our model is based on the infant site assumptions, which means that no mutations hit the same site twice. Okay, so here. So here, this individual is receiving a virus with one mutation occurred during the transmission. So that will have a new mutation at site three. And then this individual receive another mutations from, sorry, this individuals receive virus with another mutation from this genotype 2, which makes Which makes the mutational sites of the virus genotype 3 to be 3 and 4. And in the observation process, we first sample the individuals who recovered during the time window. And to control the sampling effort, we sample the number of individuals in our observed data. So if we have four samples for this time window in our observed data, then we sample four individuals. Observed data, then we sample four individuals from the simulation too. And we get the number of segregating sites from these samples. And we repeat these steps several times so that we can get the mean of this simulated segregating sites. And the weight of this particle is determined by the probability of observing. Observing the observed segregating site given the simulated mean sick mean simulated segregating site, assuming that this observation follows the Poisson distribution with mean of this average number of segregating sites from the simulations. So, to summarize, we have our time series of segregating sites. Series of segregating sites and state-space model. And from this state-space model, we have two parts: which are process model and measurement model. And using this state-space model, we use particle filtering to calculate the likelihood of a parameter. Okay, so before we apply our approach to the real-world data. The real-world data, we wanted to first validate our approach using the simulated data. And we simulated an epidemic with RNA of 1.6. And we sampled 500 sequences, but this time more proportionally to the number of sequence, sorry, number of individuals who are recovered during at each time point. And these 500 sequences are band into four. Sequences are binned into four-day windows again to obtain the segregating side trajectories. And this obtained segregating side trajectory were used to obtain the log likelihood landscape for the basic reproduction number. And our maximum likelihood estimates, which is indicated with this red vertical line, was very close to 1.6, which is the true basic reproduction number, and the 95%. And the 95% confidence level also included the true basic reflection number. And we further expand our approach into the joint estimation of two different parameters, which are the R0 and the timing of the index case, which is denoted as T0 here. And again, we obtain the landscape for the parameter combinations. And the lighter. And the lighter areas are indicating higher likelihood. And this area surrounded by the red lines are showing the area that is with that is the likelihood larger than maximum likelihood minus 1.92. So again, this result is showing that our approach could recover the true parameters. Could recover the true parameters. And with our approach, being able to recover the true parameter value, we compared our approach to the phylogeny-based approach, which is phi dyne. And here, they cannot directly invert T0. We invert the time to the most common resent, most recent common answers. Most recent common ancestor and R0. And finite result gave Titer 95% credible interval for R0 and R0 including the true value. However, the true T0 value was located at the upper bound for the estimated TMRC. This would likely be an underestimate. Would likely to be an underestimation of the TMRCA because, as pointed by Picar, the TMRCA is expected to be later than the timing of the index case. So we are expecting TMRC somewhere here, but they are estimating TMRC to be somewhere here. So, sorry. Sorry. So, this suggests that our approach is doing comparably well when compared to the Phi D approach, giving wider confidence interval for R0, but more accurately estimating the T0 or the timing of the index case. And after the validation, we applied our approach to the early SARS-CoV-2 data in France, and we could use 432 sequences from January 23rd to March. January 23rd to March 17th. And this was before the countrywide lockdown was implemented. So the transmissibility over this time period was relatively unchanged. And again, we binned this 432 sequences into four days time windows, and we counted the number of segregating sites. And for the french analysis, we considered France analysis, we considered two different models, which are single introduction model and the multiple introduction model. So let's start with a simple model. So in this model, the epidemic in France is initiated by a single introduction and there was no additional introduction from the outside. And in this model, we used SE1, E2, IR model, where E2 and I are And I are the infectious compartment. And this model is also used by SALJ to infer the basic reproduction number using the case data and then hospitalization data and then test data. So using this model allow us to compare our estimates against their estimates. And we also incorporated transmission heterogeneity where 10% of the Where 10% of the infected individuals are responsible for the 80% of the secondary infections. And for the mutation probability, we used 0.33, which is estimated from the known transmission pair. And here, I'm showing the joint estimation for the basic reproduction number and the timing of the index case again. Timing of the index case again. And if we highlight the cells with a likelihood that has a likelihood value larger than maximum likelihood, minus 1.92. Then the range for the R0 was to range of R0 was from 1.7 to 3.6, which is Which is overlapping with Salj's estimate, although our range is pretty wider. And the range for the T0 was between December 22nd to February 8th. Although SALJ did not estimate the timing of the introduction, they set their model to start at January 22nd with various number of infected individuals. So I can say that our estimates in general. In general, our estimates is in general consistent with SALJ's estimates. However, as Roby suggested in his work about the multiple introduction in Washington and Europe, the multiple introduction of SARS-CoV-2 in France is also highly likely. So, in addition to the single introduction model, we also considered an alternative model that allows multiple Alternative model that allows multiple introduction. And in this model, we implicitly model the outside reservoir, in which we only consider the genotypes that started the epidemic in France. And I'll call this genotype a basal genotype. And this basal genotype is assumed to emerge at TE from the outside reservoir, and the number of infected individuals. And the number of infected individuals with number of individuals infected with this basal genotype increases exponentially from the outside. And these individuals, in fact, susceptible individuals in France with a reduced contact rate of eta. So for instance, if eta is 0.01, then the contact within France is 10 times more than 10. Is 10 times more than the contact between the France and the outside reservoir. And again, this is the joint estimation for the basal reproduction number and this time eta, which is more like a Nuance parameter here. And as we cannot observe the emergence of this basal genotype outside of the reservoir, we use different values for the TE. And the results that I'm showing. Results that I'm showing is with the TE value of December 24th, 2019. And again, the range for the R0 was between 2.1 and 3.6, which overlaps with the estimates from SALJES in another literature. We further compared our estimation with seroprevalence data by reconstructing the state variables. Reconstructing the state variables. So, the range of seroprevalence, such as from our literature, is overlapping with our reconstructed seroprevalence, further supporting our inference approach. And this result was consistent with different TE values. Okay, before we finish, I would like to briefly introduce our in-progress extension. In-progress extensions. So, although it is three years ago by now, it is still remaining unclear about how many times the SARS-CoV-2 is introduced Wuhan. And recent work by Picar suggested that the two lineages in Wuhan, which are lineage A and B, are likely to be likely due to the multiple introduction. Due to the multiple introduction of the SARS-CoV-2 into Uhan. So, we would like to apply our approach to see if our segregating site trajectory can give a further support to their conclusion or they suggest a different scenario than Picard suggested. So, in this approach, we are going to use generation time interval, which is we are going to use the generation time interval instead of using. The generation time interval instead of using the compartment model. And this will be done by first getting the number of segregating site, sorry, number of the secondary infection from the negative binomial distribution. And second, getting the time of these secondary infections from the generation time interval. And third, getting the time of sampling from the sampling time. Sampling from the sampling time distribution. And in addition to this generation time interval, we're going to incorporate the epidemiological data, which are more readily available, especially at the very beginning of the SARS-CoV-2 emergence because sequencing techniques are not very ready. So this case count data will be Data will be incorporated as an additional data stream, complete data stream to complement the segregating site trajectory obtained from the sequence data. So to summarize, when the genetic diversity is low in the virus population and there is significant amount of phylogenetic uncertainty, our inference approach using the segregating site trajectory could be a good complex. Trajectory could be a good complement for the phylogenetic-based inference approaches. And with that, I would like to thank Mike and Katia and also to Erin King, who had a discussion with us, and then all of you who are here today. And I'll welcome any questions if time allows. Great, thank you very much. Jungsen, any questions, or we can just leave them for the breakout sessions or session. Thanks, Anton. That was a great talk. Just wondering how scalable your method is. So, how many genomes could you include? But one strength of our approach is that the runtime is not really dependent on the number. Depends on the number of it is more depends on the number of genotype representations. So it's I would say it could be pretty scalable by because the runtime is not dependent on number of sequences. Um and then there is a lot of populations not tolerant. So Thanks. That was great. Really, really cool. And I'll ask a question, but I guess we can probably just go into a general QA and rather than do a breakout room, I guess, for anyway, we can just kind of carry on for a little while until the questions are exhausted. While until the questions are exhausted. So I'm curious. You're doing this inference over in France from over a six-week time period or something like that. And if I understood correctly, you're using all that data in the time period to make a point estimate. Yes. Right. Or of the parameters. Yeah. And a little bit of like, we try to provide a range of the point as well. Sorry, sorry. Yeah. Yeah. Yeah. So, I guess my question is: how little data can you use? And if you say, oh, we have after one week of an outbreak, can you get information? And again, does it do better? How does it compare to a traditional phylodynamic kind of? So I would say because it is time series data, we need some amount of time series that allows. Sorry. Um, sorry, we need some amount of like sequence data that allows me that allows us to get a time series. So, um, if there is a enough amount of sequences that allows us to get a segregating site trajectory, and if the number of segregating sites are meaningful, which means that there should be more than like two sequences per time window, then Um, I would be excited to see how further our approach can go, but we don't really have an exact number. But if there is more like more sequence data, which is which should be way more than like 400 or like 100 for maybe not 100 for one, but like if there are, I think, yeah, we can use those data, even if the time of the even if the time of the timing of the sequence is very short. Maybe or yeah. Okay, so first of all, very cool. Thank you. So I want to try reframing a little bit your project in the way that inspired me. So one way So, one way to think about this would be that the segregating sites are like a realization of a coalescent process, and whereas a phylodynamic approach is trying to capture the specific phylodynamic coalescent realization. And so, one way of reframing what your intro would be like, well, if you don't have enough information to figure out the realized coalescent, don't bother. Just use the distribution of coalescent events because that's what you're going to get if you like Bayesian out the. Bayesian out the uncertainty in the phylogeny. So now the question. So if I was to frame it this way and then think about like what other coalescent statistics you could add to like best capture more information, like what coalescent statistic other than segregating sites would you want to add next? So that is really a great question. Thank you for that. Because like the sec before you answer, I just want to make sure you're sick. It's working. Okay. Okay. So I think that is really a great question and overlaps with my interest for later project because the number of segregating sites itself is a summary statistics for the genealogical tree or phylogenetic tree. So for now, we are just used a simulation to see whether the underlying dynamics are reflected in the segregating side trajectory. Trajectory, but there, I think it would be possible to get the more analytical form to relate the set number of segregating sites to the epidemiological dynamics. I would be really interested in expanding our approach or backuping our, like giving more support to our approach. But yet, I am not fully equipped. Fully equipped to do those mathematical works. But for now, one thing that comes into my mind is that the site frequency spectrum could be one summary statistic that could be added, although we couldn't find a way to get the weight using this size frequency spectrum because it would include more, like it is higher dimension. Like it is higher dimensional compared to disaggregating side trajectory. So, yeah, that could be one, but I'm not sure how I could do that. Mine was a really similar question. And so it was pairwise diversity that I was thinking. And while it's a star-like phylogeny, the segregating sites will have like all of the information. But the pairwise diversity may tell you one of two things. First of all, your sampling is not going to be. First of all, your sampling is not going to be random. So you're going to get clusters of related individuals more likely to be sampled. And so maybe your pairwise diversity would allow you to measure that. And then the other one maybe that it would give you information about is this over dispersion parameter. Yeah. So sorry, go ahead. So actually the clustering of the sampling is happening in the one sequences. And then we are, we think that that could. We think that that could be one of our one of our one of the approach of our inference suggesting that if there is if the estimate of the epidemiological pharmaceutical report, for example, like R0 is too low compared to the what is expected, then that would suggest that there could be a clustering of a sampling and that resulting. Sampling and that result in the lower genetic diversity in the sample, making segregating sites like lower segregating sites, lower number of segregating sites, and bias the estimation of the epidemiological parameters. Yeah. And then actually there is a study that is using the Tajima's D to infer the epidemiological parameters. And for now, we started with Tajima's D. With Tajima SD, but that didn't work very well with SARS-CoV-2 data. I'm not sure why it is, but that one was with flu. Maybe because it is an emerging virus population, like the SARS-CoV-2 emerging virus population have lower genetic diversity, possibly making signal weaker if the Tajima SD is used because it is the difference between. used because it is the difference between two different genetic diversity statistics and then divided by the variance. Yeah, so that one did not work very well. So we switched it into the segregating side trajectory. Yeah. I mean, I can ask you questions all day, so don't let me do that. But I Do that, but um, I was a little bit curious about this like time of origin because I understand that a phylodynamic model can only estimate the TMRCA of your sample. But if you think about diversity accumulating amongst your sample lineages, how does that give you a window further back in time than a phylogeny would? Could you repeat the question? Repeat the question because I don't think I'm getting it. Yeah, yeah. What is it about segregating sites that gives you information before the origin of the? Once again, I'm trying to think about both of these as a coalescent process. If I can infer the coalescent process, what is it about just looking at the distribution of coalescent times? It's giving me information before the TMRCA. So I think that is where our segregating answer. Where our segregating approach is a little bit maybe deviate is not the best word to describe it. But in phylogenetic approaches, they are using phylogenetic tree to estimate the TMRCA. But in our cases, we are using the T0 to be a parameter and then starting the simulation from starting the simulation or the particle filtering based on. The particle filtering based on that parameter and estimating the likelihood of that parameter, and that is how we get the estimation for the timing of the index case. And yeah, that is because it's forwarded to that basal branch. You can think of it as prior activity. Yeah. Whereas in a code, you're absolutely right. In coalescence, you can't get past that. So in some ways, you're incorporating the probability of so you're The probability of so you're just saying, okay, well, here's the diversity, but what's the probability that so it's you could do a phylodynamic thing and then all add on that probability plot branch. Yes, okay, yeah, right, right, because yeah, right, exactly. So that is so. So, because we are limiting our approach to the emerging virus, we are assuming that the single virus is introduced to the populations. And then those viruses are replicated, that virus replicates, and then the virus population increases, and the mutation operates. And that's how our particle filtering or the space-based model starts. So, yeah, that is our assumption, and which could be also. Assumption, and which could be also our limitation because it does not allow a pop for a population to be diverse at the start. So, in that sense, the model will also be quite limited when you are studying viruses that have been introduced by zoonotic processes, right? Because you're assuming, okay, so it jumped from a species, but then you're assuming that is a new state with zero mutations, right? Mutations, right? So you wouldn't be able to compare transitional stages between populations, for example, because what would be your no-mutational stage, right? So you need to, it's only within a population that you are able to estimate the parameters. So for the multiple introduction, we are considering that there is a genotype that is introduced to the population first and then. The population first, and then establish the epidemic, which is called a basal genotype, as I mentioned in the yeah, but like in the one analysis where there are two lineages of lineage A and B, we are trying to simulate each lineage separately and jointly estimate the four parameters like 204 lineage A and 204 lineage B and R04 lineage. Lineage B and Rna for lineage A and R naught for lineage B. That is how we are trying to deal with multiple introduction of different lineage, which might not be able to expand like to very high genetic diversity, like introduction of very high genetic diversity, but that is how we are dealt with. So, yeah, multiple state zero basal, but limit. Yeah, basal, but limited, like you because otherwise, then you can recur to phylogenetics. Yeah, that's right.