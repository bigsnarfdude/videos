So I will uh consider in this talk these equations, which are the equations of evolution for a compressible fluid which is subject to viscosity and heat convection. So these are the typical PDEs that govern convection problems in fluid dynamics. So you see here the first equation, the fruit momentum balance equation, involves the usual UP rho phi term. And in addition, you have here the deep diver normal. In addition, you have here the deep divergence of the viscous stress tensor. Then you have the mass conservation equation here, and here you have the entropy equation, which involves the usual advection of S, the entropy density. And here you have two terms, one corresponding to the production of entropy due to viscous effect, and one other term corresponding to the production of entropy due to the heat exchange. the heat exchange. So in this formula, J is the entropy flux and T is the temperature d epsilon ds and this whole equation is known as the entropy production equation. So I have two goals in these talks. First I will present, this is the main goal, present the geometry of these equations in the sense that we like, I mean as dynamical system owner LIGO. I will approach this problem from the variational side and then from Variational side, and then from that I will explain very briefly how we can connect to other geometric structures. And another goal, if time permits, maybe very roughly, how we can use goal one to discretize these equations in a way that preserves all the good properties of the equations. Yeah. Uh what is the function phi doing here? Phi is a potential, a gravitational potential force. Anything that is not an excellent line force. Is not an external force. So the red terms describe the reversible dynamics. That's the one that follows from the Arnold point of view, right? It follows from Hamilton's principle. It has Poisson brackets, Lipp Poisson things that we all understand well. What I want is to include the blue terms in this geometric setting. As I said, I consider here two kinds of irreversible processes, viscous and heat, but we can Process this costs and heat, but we can have more like phase changes or resistivity, other things that we can also add to this list. So the red term may follow from Hamilton's principle, right? I will use this in more details, but it's Hamilton's principle, the usual one, all different. And how we approach the blue terms, I mean the red plus blue term, is by Is by following a D'Alembert approach. So we consider a kind of Hamilton's principle, but in which we have constraints on the curve of the solution, on the critical curve of this action function. But we also have similar constraints on the variations that you take when you compute this critical point. So this is something that arises in physics for non-harming systems, for instance. So this is the plan, right? One through very detailed and One, two, very detailed, and if three, I have time, I will go to three also. So let's start by saying why we like Hamilton's principle, because it's the first principle from which we can deduce the nice geometric structure that we are used to see, like Poisson, symplectic, Dirac, etc. Also, it's nice because they covered a lot of theories in physics. All the major theory of physics emerge from Theory of physics emerged from critical action principles. So, how to extend this to non-equilibrium thermodynamics? These are the types of dynamics that underlie the Navier-Stokes-Courier equations. So, we have to remember some Jargon from thermodynamics. This is the only thing that we will need. The entropy production is always a product, a sum of various products. A flux times a force, it's always like this. This is all we have to re to retain. All we have to retain for today's talk. The flux typically the edge of the flux, the discussed flux inside this, the force is the gradient of the quantity of intelligence, like temperature or chemical potential, density. And in very briefly, our principle is like this. Compute remittance principle, but not subject to any variations, but subject to constraints. And these constraints are And these constraints are coming from this expression of the entropy productions. So once we have an entropy production given by this bilinear operation, we add this type of constraints on the critical curve and this type of constraints on the variations of such curve. And the recipe to link these two constraints is following Dallamer's advice. Advice replace the rate of change by virtual change. Replace power-like quantities by virtual force quantities. That's the nature of our approach. So let's see in some simple case. The simplest thermodynamic case uh system that you can have in mind is a mechanical system like a piston, like this, but which has a very two mechanical part. Mechanical part, it's just one mass and one entropy variable. So I have a fluid here, but I decide to describe it just by a uniform temperature or entropy. So following this recipe, what we have to write is Hamilton's principle subject to the force that I have in this system. In this system, I only consider the irreversible irreversible. Irreversibility coming from the interaction of the molecules hitting the piston here, which creates at the macroscopic level a friction force. So I add the power of this force here, like I did here, abstractly, and the virtual work of this force here. Computing this, we get the term of mechanical equations. So this is a primitive case, a primitive instance of our approach. Of our approach, right? We get the mechanical and thermal equations that are coupled via this Danuber thing. So if you see well what happens here, you will understand well the Nagi-Stok's Fourier system. It's the same thing, just the objects are more complete. So if it were just this, it would be a bit restricted, but we can treat other processes like diffusion. diffusion, heat conduction, resistivity, phase changes, they all can be brought into this formalism using the similar approach, right? And computing each time the thermodynamic flux acting on the thermodynamic force and computing this Dahlumber like principle, right. So um another important case that I want to briefly mention is the case of open systems. Is the case of open systems because that's what happens for the Navier-Stokes Fourier equation when we heat, for instance, the wall or the boundary of our free. So in this case, there is a slight change, for instance, in this piston problem in which we heat from outside. We have some prescribed temperature that is giving some entropy flow from the outside in the internet. Then we have to. Then we have to amend a little bit our principle, but we will see exactly how it works for the Navy Stokes 40 case. Also, in that case, you have to keep in mind Prigogin's equations, which tells us that the entropy of a system the vari the increment of the entropy of the system has two contributions. One that is coming from the internal process Coming from the internal process like viscosity or heat convection in the system, and one that is coming from the entropy flowing out or in the system, like here. And the second law tells me that this piece is positive. This one can have any sign. So that's crucial. That's the origin of having two entropy variables in our system, S and sigma. So if we go back here. So, if we go back here, we see the occurrence of two entropy variables. So, I don't describe in detail the formula, but you have seen it in principle what happens by it. So, Dalamberg type of principle and being careful about using the total or just the internal entropy production. So, now let's do what we like. We do compressible fluid dynamics. So, as we So as we all know, we take a contact Riemannian manipul with boundary, with smooth boundary, we take as configuration space the space the group of all diffeomorphism, everything is smooth in this store. Homorphism of the field, we take our Lagrangian, which is just kinetic minus potential of internal energy, and we start like Arnold in the Lagrangian description. So we define our Lagrangian on the So, we define our Lagrangian on the tangent boundary of the diffeomorphism. And here, this is the density in the material or Lagrangian picture, so it's a constant in time. I have no irreversibility yet. This is just a review of the user case. Entropy also is constant in time because it's just transported. This is a compressible area. And we add the internal energy contribution to the Lagrangian in this formula. To the Lagrangian in this formula here. So epsilon is the expression of the state function of your gas or free that you have, right? Like perfect gas, for instance. Hamilton's principle gives you the equations of motion, the Euler equation, the compressible Euler equation in the Lagrange and frame the usual way that you have seen already earlier, right? The only difference is that now P is not a Lagrange multiplier. A Lagrange multiplier because we are compressible, but P really comes from the physics of the field, right? It's deduced from the state equation you chose. So you get the usual type of balance for free dynamics. Because we want to do things in the Liberian description, we can either Description: We can either convert directly by hand this principle to the Eulerian frame, or we can also, because we are geometry, use reduction theory like it was done here, which is extension of Euler Army equations to Lagrangian setting. And so he defined from the the material quantity, the diffeomorphism, the mass density and the entropy density in the Lagrangian frame. Density in the Lagrangian frame, we define the velocity, the mass density, and the entropy density in the Eulerian frame simply by pushing forward these quantities with the diffeomorphism loop. Like here, they are forms or densities. This is just so we recover the Lagrangian in the Eulerian frame for the compressible fluid. And as we have seen in the tutorial on Monday, when we On one date, when we go in the earlier realm frame, the variations that were free earlier become constrained now in the earlier realm frame. This constraints have no link with the earlier constraint that I have with the Lagrange de Lambette. These are constraints due to me looking at the thread from the earlier side. So I see constraints. Great, so we compute this, we get the Great, so we compute this, we get the Euler-Poincaré equations for free for continuum systems. So we recognize here. This is the lead derivative, the add star of the LDU. This is contribution of things that are not due to phi, and these are the transport equations. So now we want to do to apply our Lagrange de Languer approach of thermodynamics to this type of problems in order to recover. In order to recover the Navier-Stokes-Fourier equations of the first slide, so the first thing to observe is that the entropy density S in the Lagrangian frame is no more constant in time because we have some irreversible process. So I don't have any more, sorry, I don't have any more S of X like that, but I have S of X and T. So I have to add even if So I have to add it, even if even though I am in the material description, the entropy density depends on time. Then following the recipe, I look at each irreversible process. Here I have viscosity and heat conduction. And the corresponding thermodynamic flux are the viscous stress tensor P and the entropy flux J in the material picture. And the guys that pair with this are the velocity and the the temperature, which we want to see also as a velocity. So we write t is a time derivative of something else. So following our previous strategy, so let me go back so you see exactly. Following this, we have to write this. This, so we have a critical action principle. I will say what is this, and we have two constraints. So critical curve of this, such that this critical curve satisfies this constraint, this is the sum of the two contribution viscosity heat, flux time force, flux time force, and the the virtual version, virtual work, virtual work for heat. War mutual work for heat and discontinuity. So, if we apply this principle instead of Hamilton's principle, we get the Navier-Stokes Fourier equations in the material frame. I don't write them, but that's what we get. This term, I could spend more time explaining it, but it's a reminiscent of the least energy dissipation of evolution, in which here we see the entropy S minus, this is the total energy. S minus this is the total entropy, this is the internal entropy, so this is the uh portion of entropy that is due to the exchange of the system with the external. So this principle in some sense also includes the least energy dissipation principle, in some sense that I have no time to explain. But that's the idea to address. Now uh we do the same reduction principle as earlier, but Principle as earlier, but in this Lagrangian or context. So I don't explain all the details, it's just that you pass from the red, the Lagrangian frame to the Eulerian frame. So your thermodynamic flux becomes the usual viscous stress and entropy flux. These guys I just use small letters instead of big ones. And if you change variable here, you get this. So we recognize. So we recognize here it starts by the Euler-Poincaré variational principle. We have delta U, delta Rh, delta S that have the usual formula. This least energy dissipation term becomes this, where the dot, the material dot now are Eulerian time derivative, and similarly with the viscous part and the heat part. So this is the viscous stress acting on gradient. Stress acting on gradient of U. This is entropy flux acting on the gradient of gamma dot, which is now an Eulerian derivative. So everything which was material is now Eulerian. You apply this, you get the equations that I was starting with. This Nager-Stokes Fourier equation. Also very interesting is that here it follows from that these boundary conditions, and this is important for numerical. And this is important for numerics because uh uh this is one of the hardest parts in our approach. How to correctly uh describe the boundary condition. So J dot n equals zero means the fluid is isolated, right? Heat flux is not going through the boundary. Okay, so there are some modifications to take into account if we want to change this boundary condition. To change this boundary condition. For instance, I go very roughly, but if we want to impose a prescribed temperature at the boundary of the fluid or prescribed heat flux, which are really conventional ways to impose boundary conditions for the thermal sector, then we have to change a little bit the variational principle in the same way that I explained you earlier for this system. For this system. So we have to make clear the occurrence of the temperature from the external surrounding, how it appears in the constraints in both sides. So without going into the context, it's just the schematic way we have to impose this. So we have the earlier term, but we have also terms related to the fact that we are heating the fluid for. That we are heating the fluid from outside. Anyway, this is especially important for numerics because we have to take into account all this. And this is the okay, so before I continue, let me just mention some abstract point of view. So what is Lagrange de Lambert? Lagrange de Lambert is a compute Hamilton's principle subject to this type of Subject to this type of constraint, where you have a constraint that depends on the position but linear in velocity. And the associated constraint on the variation is like this. Now, abstractly, what we do, what we need as a geometric setting behind this is passing from x dependence to x and x dot dependence. So we have, in fact. So we have in fact um not a distribution but constraints that depends on the veloci the position and the velocity of the nature of our approach. If we really look from it very far, look far abstract. And it's when we look at this problem this way, it's clear that on the Hamiltonian side, the structure that corresponds to our variation. That corresponds to our variational approach, our Dirac structures. I don't enter into this, but it's just interesting to keep this in mind. When we do Hamilton's principle, we have canonical symplectic form. If we do our type of Dylan change in the variational principle, what we get as a structure is a Dirac structure. Okay. There is also an interesting link with the bracket formulations. With the bracket formulations. If I have time, I will tell more about this, but we can recover several types of bracket for the by using the by transforming our equations on the Hamiltonian side. Okay, so this is the end of the part about the geometry. Now, in the remaining time, I will say some words how we can discrete. Say some words how we can discretize this in space and time in a way that preserves the main underlying conservation law. In our case, this will be energy, mass, and we want to preserve also the second law of thermodynamics. This means the entropy has to the internal production of entropy has to increase at each time step on each cell of the pre. Of the pre. So the idea is an extension, it's a finite element version of this original approach due to Pavelov, Martin Debron and collaborator, which consider of in replacing the diffeomorphism group, so the configurational group of our problem, with a certain matrix group. So they did this in a finite difference way. What we do here. Difference way. What we do here is more in a finite element way, but same type of approach. And how it goes very roughly, so we choose, I prefer the finite element space for scalar function, and the replacement of the diffeomorphism group will be made by GL of this, so innotable linear map of the finite element space. Then there is some steps to understand how we can realize the Lie algebra of this group as velocities. Takes some time to clarify and to analyze. And the good surprise is that the subspace of the Lie algebra of this discrete homogeneous group that corresponds to Italy Relevant To equally relevant uh a vector field is a finite element space, which is a Raviartoma uh space of high order two R. So this uh step three here really relate our Lie group approach, a finite dimensional Lie group discretization to finite element method because we didn't ask that this this is specific. That this this specific class of uh vector field should be in a finite element case, but it's a theorem. It turns out that it is like this. So, yeah, here these are some details about this, but I will not so to summarize the situation is the following. So, we have a Lie group of linear invertible transformation of our finite element space. This is the DC. Element space, this is the discrete instrument of this two. This is its Lie algebra. Now, vector field can be realized as a subspace of this Lie algebra. And the good news is that this space is a very well-known finite element space. It's a Ravier-Tomak finite element space. And the choice of the final finite element space that we need are those on which the Lacrosse. Space that we need are those on which the Lagrangian is hyperregular. But this is a technical thing that it's important to have when we want to solve effectively the file. So what we do now for reversible dynamics is that we apply the Euler-Poincaré variational principle on this finite-dimensional Lie group instead of applying it on the differ Lie group. So in our So in our notation, in our Lie algebraic notation, we get some equations. So we have a discrete Lagrangian depending on the velocity and the mass density. But this is now in the Lie algebra of this finite-dimensional Lie group. And we get the Euler-Poincaré equations. This is nothing else than those equations but written on GLN. Not those one. This one. And so finite element people will not recognize it, so you have to translate them in the finite element space. So if you work in finite element space, you recognize terms. Otherwise, you just accept that this is what we get. So we get this finite element version of the Euler compressible Euler equations. So they can be. So they can be followed by temporal discretization, and since they have been derived geometrically, it's not hard to find temporal schemes that preserve the energy and all the good things that we have preserved in the spatial discretization. And uh there are versions also on M H D that uh could be useful that are useful also when once one wants to discrete I One wants to discrete it. So, briefly, how we can extend this to the Navier-Stokes Fourier case. So, we do the same thing, replace the diffeomorphism group by a finite-dimensional Lie group, and we apply the variational principle for thermodynamics on this diffeomorphism group. A big change is the boundary condition of velocity, right? When we have this. Viscosity, right? When we have viscosity, now it's usual to assume u is zero on the boundary. Also, I specify now the viscous stress and the entropy flux to be given by the Nagier-Stokes and Fourier law, because that's what I'm doing, Nagi-Stokes-Fourier. And this is incorporated in the formulation by defining these two uh uh expressions. That are constructed from these two flux, right? So now here, don't be impressed by the notation. What I did is just I copy-paste part one in the discrete setting. So this is the same variational principle, exactly the same. All the notations have changed because now it's discrete, but don't worry, it's exactly the same. But don't worry, it's exactly the same thing. So we have a critical action principle and we have two constraints: one on the curve, one on the variations to be taken when we compute the critical curves. And this can be also followed by temporal discretizations. And the main theorem is this one. So if we discretize the Navier-Stokes Fourier equation, The Navier-Stokes Fourier equations using this variational approach in space and time, we get these three properties. So, first, we have exact conservation of mass, k is the time step, right? We have exact conservation of energy, so very important, the Navier-Stokes Fourier equation preserves the energy, unlike the Navier-Stokes usual one without the rest. So, energy is preserved, so it's a hard. So energy is preserved so it's a hard statement. It's not an energy preserving uh idea in the Hamiltonian setting. It's an energy preserving result in an irreversible setting. And this is nothing else than the second law, but written strangely because I have discretized everything. But it says that the entropy created due to the irreversible Due to the irreversible process of heat and viscosity in the fridge, should be positive at each time, at each day, and on each cell of our so as far as we know, it's the first finite element scheme that achieved these two properties. So there are works in that direction, but as far as we know, and uh it seems that uh Uh it seems that uh only partial uh properties of these three one can be achieved using geometry is helping uh to improve uh previously known finite element space. So I will skip the numerics, we can discuss if you will and we can summary summarize a bit what I did. So first So first the Lie group uh approach to heat conducting viscous fluid, which extends Arnold's approach to involving viscosity heat conduction or other irreversible process. This in general the general uh structure of this variational pro uh approach is a D'Alembert type, like the one used in non-honomic mechanics. Used in non-hero mechanics. These two things can be discretized in space by using this approach of finite dimensional B group that replace the diffeomorphism group. And we can incorporate several boundary conditions. This is extremely important for applications. If you have a scheme with periodic boundary conditions, it's not useful. Boundary function is not useful for them because all the processes of convections, etc., they have boundaries and they depend on the way we prescribe the heat flux and the temperature and the boundary. And besides numeric, there is also interesting directions. For instance, we can derive several bracket formulations, the metriplectic bracket, the Kaufman bracket, the single generator bracket. The natural geometric The natural geometric structure is a Dirac structure. This is also geometrically interesting. It's also useful for modeling, not only disputing known equations, but deriving new models that preserve this law of thermodynamics, which can be a bit hard in general for systems that approximate the real dynamical system. Okay, thank you very much. Very much. Thank you very much, Patista. Are there some questions? Yes, please. So I was wondering, you mentioned that the granches need to be hyper-regular. Is it somehow related to the conservation of energy? No, it's related to being able to solve your equations. You don't want Euler Poincaré equations with DLDU not uh isomorphism to you item. Uh isomorphic to U, right? The m the Lagrange transform not invertible. This would yield strange dynamics. So we don't want the discretization to break the hyperregularity of the Lagrange, and that's all what I meant. It would be artificial. I would suggest that you can set up nice structures in the container setting that is applicable directly to the display setting. And I think on the continuous, you got some nice uh Some nice conservation of new touches in the discrete setting. So, I'm not saying if this is kind of consequence of your particular choice or finite element spaces. Well, like, does the same still apply if you pick up like say another finite element space or even as a kind of discretization, say, for example, finite stable space? Yeah, so it's not the the good properties are not due to the choice of the finite evaluation space. To the choice of the finite even space. They are due to the way we rearrange the term in the finite. For instance, if you look at the original equations, you can devise some finite element space. A lot of them have been derived for the Nali-Stokes free equations. You look at the equations and you try to discretize, to find a finite element discretization. In principle, there is no need to. In principle, there is no need to know the variational structure people need. But our way is to use the variational structure to exactly know, to exactly know which term to arrange and to discretize, right? So what we want is this form, right? For instance, we want this form. Yeah, where we want the earlier Poincaré form uh the guide. uh the guide to discretize the equations you see. So as far as the discretization kind of has this thing? Yeah, the discrete scheme has this form. Yeah, exactly this form. We don't take the equation as discrete types, we take the what emerged from the variational principle rederide them with discrete titles. I hope I am true. But we get also non-linear brackets, so I don't know if they could be recovered by the four brackets. Is it not? Non-linear? You mean uh non-bilinear? Non-bilinear bracket, but not the Bracket, but not the the the single generator, the Edward Bayley's bracket. Yeah, you know. But you can uh linearize those quite easily. Linearize, but I wouldn't get the same equation. Yes, with the same equations. Okay, so maybe we can get it for rest. What about the direct structure? Can you tell us about it? So it's yeah, so the direct structure is known in non-hornic. Is known in non-dynamic mechanics when we have the Lagrange-D'Alambert principle, we know it's not symplectic. So, what is the track? There are several ways to. But the most natural way from the variational side is to get the direct structure induced by the non-normal distribution. You have a non-namic distribution on Q and you have the associated direct structure on T star Q that governs the dynamics. So, here is the same thing, but it's a bit more. But it's a bit more involved because our constraints are not given by distribution in this way. They are not distributions on the manifold. They are associated to this kind of constraints, which are more general type of constraints, but can also wield diracy of construction. So we can literally write  