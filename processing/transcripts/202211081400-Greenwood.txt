To speak at the conference. This particular talk may be a little bit outside most of the talks of the conference, and also not quite sure how it fits being moved from a different session into this session. But what I'm going to be talking about is modeling methylation data and then I'm going to be speaking about some of the Speaking about some of the statistical issues that we ran up against when we were, we found all kinds of over-dispersion in the data. And so I want to highlight when I start, Kaichong Jiao, who is a former PhD student of mine who graduated last year. And she was a really fabulous PhD student who is basically the one who's done this work. For those of you who are Canadian, For those of you who are Canadian, she was awarded a Cancy Distinguished Postdoctoral Fellowship, which is what she's doing right now. So I'm going to be talking a little bit about DNA methylation to start with, and then I'm going to talk about this model. We started out with a simpler version, which I'm calling here the smooth binomial model, and then we extended it to try and deal with the overdispersion we were running into. And then I'll talk about what we found. And then I'll talk about what we found in a data set where we're actually looking at ACPA levels and DNA methylation. So there are many epigenetic mechanisms and knowledge is increasing very, very quickly at the moment in this field. There are histone modifications. There's sort of microRNAs are sometimes put into this category. Are sometimes put into this category. There's the way the chromatin structure of the genome is laid out. There's the way the chromosomes fold. But what I'm going to be talking about specifically is the DNA methylation, which is very simply the addition of methyl molecules onto the cytosines, which are somewhat represented in the bottom of this figure here. So DNA methylation is very easy to measure. Very easy to measure because it's a single mark added to specific positions in the genome. And I could really oversimplify here and say one of the things it does is block access to the DNA. So if you have a methylated promoter, for example, indicated here with these little lines in the bottom panel, then a factor that is initiating transcription of this gene will not be. Transcription of this gene will not be able to bind to that promoter. So, DNA methylation is very different between cells of different types, for example, and it really is the primary factor determining cell type. But what's really interesting about it is that it is not entirely constant over one's lifespan or over time. It's associated with development, sure, but even beyond that, even after the development phase is finished. After the development phase is finished, methylation changes in subtle ways with age and in subtle ways with exposures to various things and with disease status. And so it may represent a kind of signature inside our tissues of how some of the regulatory processes are being altered. And it may also capture different kinds of exposures and their impact on how. And their impact on how our genes function and our DNA functions. So, with that, to start, oops, let's go to the here. I'm going to talk about this particular data set throughout the presentation, so I'll just give you a little bit of an introduction to it. This was done with some colleagues who are rheumatologists and are really interested in studying rheumatoid arthritis. And the anticitrillinated protein antibodies or ACP. Trilinated protein antibodies or ACPA tend to be high in people who are going to get rheumatar arthritis before they actually get it. It's kind of like a sentinel marker. So it will also be high in people who have rheumatoid arthritis, but this is something that seems to occur early before the diagnosis actually occurs. So they came up with the idea of taking samples, storage samples of Samples, stored samples of blood from the Cartogen study, which is a sample of 40,000 people in the province of Quebec, where they did genotyping and they stored various blood samples, urine samples, etc. In about 5,000 individuals, they, or 3,600 individuals, they measured the ACPA levels and then they did an extreme sampling design. So they picked some Extreme sampling design. So they picked some people who had high ACPA levels, some people who had low ACPA levels, and not a very large number of each, like about 150. And then they measured DNA methylation in these two groups of individuals with high and low levels of ACPA. So this was done with a whole genome bisulfite sequencing technique. So this was relatively expensive to do this last step. Was relatively expensive to do this last step down here. So, what is this ACPA? This is a schematic that I have borrowed from the internet. But this is what, you know, sort of a hypothesized scenario at this point, that you start to see these clones, ACPA clones, that have some pathological mechanism, and they become more frequent as people progress in their rheumatoid arthritis. In their rheumatoid arthritis thing. And so, this is why it's something that you can measure before a diagnosis actually occurs. So, the question that we're asking very simply is whether methylation patterns are associated with the ACAPS status, high or negative. I should maybe mention that among the individuals who had their ACP levels measured and their methylation measured, there were a couple who. Methylation measured. There were a couple who self-identified as having rheumato arthritis, but really not very many, you know, sort of four or five, because this was a population-based sample of cartogen, and so most of them were relatively healthy. We want to make sure we can adjust for confounders during in order to do this analysis. Some of the confounders that are really going to be important here would be things like smoking status, genetic variation, age, and also some. And also, cell type composition, which is a really crucial one when you're talking about DNA methylation, because if you happen to have in a blood sample a higher proportion of, let's say, active T cells or a lower proportion of B cells, that will change the methylation patterns. And it may be simply indicative that somebody had a cold or somebody is a little bit older, etc. So we want to figure out a way to do an analysis that can look for the association. Can look for the association that is desired and control for confounders and covariates at the same time. How is methylation measured? So there's a simple trick. You can treat DNA with bisulfite, with a bisulfite treatment, and it actually converts cytosines to uracils when they are not methylated. If they are methylated, the bisulfite treatment doesn't work. Treatment doesn't work. It doesn't change that cytosine into a uracil. So, this provides a mechanism for estimating whether a particular cytosine is methylated or not simply by comparing the DNA sequence before and after a bisulfite treatment. And at the end of the day, this kind of platform gives you count data. This is a toy slide. You know, you've done some sequencing. Know you've done some sequencing, you've got some reads, you align them back to the genome. So, here I've got five CPGs, and at each position, I can then count how many methylated and unmethylated reads I may have at that particular position. So the bisulfite sequencing has happened. You know, this is bulk sequencing from a blood sample, so there's going to be many, many different cells in that sample. In that sample. And so I'm getting a kind of a composite picture at every position of the proportion of the chromosomes that were methylated at that position. And so at the bottom, I've introduced a little bit of notation. I have a methylated count that is going to be called Y. I have a total read depth, which is going to be called X. And then my methylation level can be estimated by the proportion Y over X. Y over x. It's important to also note that here, as you can see in CPG position one, sometimes the read depth is not very good. If the read depth is not is low, then of course you're going to have a very imprecise estimate of the methylation level. And with the randomness associated with sequencing, this kind of thing is going to really happen quite often. This particular study was done using a targeted custom capture by sulfite sequencing experiment, which means that certain parts of the genome were targeted for sequencing. This is an approach that certainly saves quite a lot of money. There are a couple of platforms that do it. McGill's platform measured about 400,000 regions across the genome or about 5 million CPGs. 5 million CPGs. If any of you are familiar with array-based platforms for measuring DNA methylation, such as the Illumina EPIC chip, that gives you about 850,000 positions in the genome. So you get quite a bit more. And these libraries are generally designed to include the positions that were on the Illumina arrays. So you get most of what's on the Illumina arrays plus more around those positions. So, to be a little bit more specific about the data set, in fact, there was an initial study done in 2016 and a validation study done in 2019. The second data set has 120 people, and I'm sorry, that's a typo. It says 100, it should say 120. 60 were negative, 60 were positive. We got about 4.2 million CPGs. CPGs and about 12,000 regions that contain about 50 CPGs after re-filtering. So, this is a because it's a targeted approach, there are little sections or little regions of the genome that come out of the sequencing platform. And there were about nine covariates that were available in both data sets. Of course, the ACPA status, whether it was high or low, the cell type composition information, which we capture by four different covariates. Different covariates, the proportion of you know, T cells, the proportion of B cells, etc., and age and sex and smoking information. Smoking is coded as two variables, one whether or not it was yes or no, and then a missing as well. So with that introduction, let me turn to what the data actually look like. So here is some data from one of the regions in the genome. The two different colors here. The two different colors here represent the ACPA high in yellow and low in the sort of cyan color. This is a small region. Every vertical position or every position on the x-axis is just a different cytosine, and every dot is a different sample. So, what you can see clearly, I hope, is the methylation is high on the left, decreases towards the right, and Towards the right, and that there is an awful lot of variability going on. So we have this sort of trend among the cases or the ACPE high people as sort of decreasing from left to right, but there are also some individuals who have methylation levels that are essentially zero on the right-hand side of the region, and some that are in the middle of the range. And we also see far more of these cyan dots up at the top. Cyan dots up at the top with high levels of methylation. So we have lots of variability, we have lots of dispersion going on here. There's also differences that can by eye that you would say that the yellow and the blue seem to be different here. There's also a lot of correlation going on between nearby positions. So how are we going to analyze data to try and see whether there's an association between ACPAC? Association between ACPA status and the methylation level. We want to account for a variety of features that are built into the data that's coming out of the sequencing experiment. The first thing is the variability in read depth. So if read depth is extremely low, we might want to give less weight to that data point. We might want to allow for actual errors in sequencing. They do happen. They, of course, we know that sometimes they're in certain kinds of repetitive DNA sequencing. Of repetitive DNA sequencies might be more common. We want to be able to adjust for potential confounding by cell-type mixture. And we want to exploit the fact that the data are regional. And so we actually have this sort of highly correlated little clusters of data. And hopefully we can use those as best possible. I am just looking at the time. Oh, my goodness, I'm far too slow here. So the first thing we did is. So, the first thing we did is we built a binomial model. They are reads. Some of them are methylated, some of them are not. Binomial is a good place to start. And we're going to assume that the methylation proportion varies smoothly along a region of the chromosome. We're calling that pi of T, where T is going to indicate position. So we have the number of methylated reads at Y. We can build in some errors. So this is allowing for sequencing error. Allowing for sequencing error, the probability that what I see is looking methylated when it truly isn't, and vice versa, probability of getting a methylated read falsely called un-methylated. So I have two new parameters, P0 and P1. Whoa, I'm sorry, I don't know how I did that at all. Jump to the end. Okay. Here we go. I apologize for that. So now I'm going to build on this. I'm going to force some smoothness by putting in some lines to force smoothness across the region to make sure they're not too wiggly. I'm going to penalize the curvature with some penalty parameters. And this we ended up, this is sort of like the first version of the algorithm that we did. And the right-hand column is what we is our method. It deals with read depth, experimental errors, confounding, multiple covariates. And we compared this method to a variety of other approaches. And it worked very well. So this is just an illustration of what you get. An illustration of what you get. Here is another small little region where we had monocytes, T cells, RA patients, and controls. And if you run this algorithm, you get results that look like this. As in, you get the effect of a covariate represented by a smooth curve across a region. We get a pointwise constant interval, and we also get a region-wide p-value. So this was all nice. Was all nice, and we can also go back to sort of original methylation proportion scales if we wish to, which are shown here on the right. This has some nice advantages. As I said before, we get some increased power by analyzing across a region. We appropriately deal with read depth and errors. But now we went to try it in this data. Now we went to try it in this data set with ACPA levels, positive and negative. And what you see here are QQ plots of p-values on the negative log 10 scale. The dashed line in gray would be the line y equals x. So if there were no associations with ACPA status, we would expect these lines to follow that dashed gray line. I wouldn't have been shocked to find some associations with ACPA. To find some associations with ACPA, but I wouldn't necessarily expect what I'm seeing here, which looks like every single test we do is showing associations with ACPA well above the line of y equals x. And we played around with different covariates and things like that to see if we were missing some confounders. And we, you know, that did not help. So here's the crux of what I wanted to say today is the thing is we have over-dispersion and it is violating the assumptions built into that. The assumptions built into that binomial model. So, on the left, you see the graph I showed earlier. But what you see on the right is a sort of estimate of dispersion just at one CPG at a time. And you can see that we have huge over-dispersion happening in part of this interval. And over-dispersion, of course, if you don't account for it, can give you p-values that look far too small. We see that here. So, what we had to do was move into a quasi-binomial model instead to allow for some extra dispersion. So, this is what I'm calling version number two. So, we do a quasi-binomial mixed model here. We include two different kinds of dispersion. We have a multiplicative dispersion term, phi, and an additive dispersion term, which comes in as a subject-specific random effect that's going to be called. Random effect that's going to be called U. So I've put these two new parameters in red to highlight them in the formulas. And then we still have smoothness to look at the to make nice smooth curves across the region. Why do we need two different dispersion parameters? I'm trying to explain this here in this particular slide. If I have no dispersion at all, a sort of basic binomial, you would get a graph that looks like a different graph. Would get a graph that looks like the top left. If I only include a multiplicative effect, I get a graph like the top right. And it's just not enough. It doesn't capture the variability that's actually going on in the data that we see. We have more dispersion than we would see with only a multiplicative effect. And in fact, when we put both of them, we get what we see in the bottom right here, this sort of pattern of dispersion. This sort of pattern of dispersion that comes now close to what was actually seen in the data. Estimation is a bit nasty. We have three sets of unknown parameters. We have sort of a mean parameters, variance component parameters, and dispersion parameters. The estimation includes all these things here, which I don't need to Things here, which I don't need to walk you all through, but we are using some quasi-likelihood theory, we are using approximations, we are using sort of expectation solving algorithms, and we also have to do some tricks here and there to try and get variances as we needed them. So, yes, we did some simulations and things. And things look quite nice as one would expect when one decides to do simulations and we know what we're looking for. So we are able to estimate the curves that we are generating in the simulated data. And we are also able to show that the dispersion seems to do quite well. So, what you're looking at in this graph here is a series of QQ plots. Of QQ plots where if things are looking good, the lines would follow the diagonal because these are simulations and they are under the null. And the green model, which is closest to the diagonal, is the model that has the two different kinds of dispersion in it. And if you only have one of the kinds of dispersion or no dispersion at all, you see these other colored lines that are violating the assumptions really badly. Badden. We also did some simulations for power, and we can also show here that the green lines are doing much better. So let me go back to the ACPA data set and to show you a little bit about what we got there. This is really one of the key results from my point of view. So what we have are the two estimated dispersion parameters. Two estimated dispersion parameters shown in this graph. We have on the x-axis or the log of it, and we have the variance of the additive random effect on the vertical axis. So the two lines in the graph, so the horizontal line or the vertical line, are basically showing what you would expect if there was no over-dispersion. So, first of all, we can see that the multiplicative dispersion, over-dispersion, Multiplicative dispersion over-dispersion is present in pretty much all the probes. So, most of this cluster is really far to the right-hand side. And we can also see that the sigma squared, you know, there's lots of non-zero variances here as well. So, basically, if we ignore this, it's not surprising we're going to get strange results. If we go back to the qq plots, If we go back to the QQ plots, looking at association in the data set, the three colored ones here are the ones that have either no correction for overdispersion, only one kind of overdispersion, or both kinds of overdispersion here at the bottom. And you can see we're still not necessarily following that diagonal line, but we're certainly closer to it. And of course, I don't know what the truth is. It's entirely possible that there are lots of regions in the genome that are associated. Of regions in the genome that are associated with changes in ACPA levels. I'm not going to make any claim for cause, but at least our distributions are now much closer to the diagonal than they were before. Another thing I think that is interesting to note is that building in some sequencing error rates into the model seems to be a really important point. If we assume that there aren't any We assume that there aren't any errors, we seem to get quite a bit of inflation. It's also important to note here that the method that we use to estimate dispersion in the slides that I skipped over far too quickly, it does matter. And these are assumptions related to how you average things across a region. If you look at other methods that people have used, Look at other methods that people have used for analyzing methylation data. Some of them are shown here in this slide. We end up with sort of more evidence for there being some associations in the tail of our QQ plots than other methods do. Now, of course, we don't know the truth, so one could argue that this is good if one expects to find something and bad if one doesn't expect to find something. But we are really quite happy. We are really quite happy with the behavior of these QQ plots on the left, and so we're hoping that this is interesting stuff on the right. And just to give you one example, here is a single region that is near this non-coding gene. And these are all the curves that we fit in the analysis. So there's one curve for every covariate. Curve for every covariate. So the second one here is the ACPA covariate. There's also age, sex, smoking status, and the principal components of cell type composition. And you can see that over here on the right-hand side of the region, we are estimating a coefficient that is non-zero. The point-wise confidence intervals do not overlap with zero. Yes, I see that I'm running out of time. That's fine. I'm near the end. Of time, that's fine. I'm near the end. If I actually look at the data, I can see that there is differences in the box plots between the ACP positive and negative categories in this region. So I don't need to show you this, but I will just go to the discussion and say the analysis really gains power by Really gains power by borrowing information across the region, but the addition of two different kinds of parameters for dispersion was crucial here in order to try and get valid distributions in this hugely heterogeneous data set. And the other thing that was important was accounting for error. I started out by acknowledging my student, Kai Chong Jiao. There she is. She is. There were also lots of people involved in this project, many of whom provided the data sets for us and helped with the interpretation of the data sets. So I'll stop there. Thank you. Do we have time for questions? Okay, yeah, sure. So let's take some questions. I cannot see on Zoom. Okay, perfect. Perfect. So let's start with here, people in the room. So I'm going to pass the microphone. Celia, it's a great model. I'm just curious, in your simulation, you actually saw a lot of false positive, right? If you look at the QQ plot in the simulation, in the simulations, a lot of deviation from the zero line. The zero line, diagonal line. Only when we generated over dispersion and didn't adjust for it. If we start adjusting for the over dispersion, then other method, they have that problem too. Yes, as soon as there's over dispersion, everybody will have that problem. Yeah, yeah. But in the real data, it just seems like all other methods didn't detect anything. If you look at the QQ plot, yeah. At the qq plot, yeah, that's true. This doesn't quite match your simulation. So, my question is: your simulation is how realistic are your simulation? Well, you know, that's an that's a, it's always difficult to figure out how to simulate data when you have something really complex. We did actually start with real data in terms of trying to, you know, like we picked regions from our data set and selected the CPG space. And selected the CPG spacing and things like that, starting with data, and then we added the phenotypes on top. So, you know, to answer your question, of course, the devil is in the details. Like, exactly, how do you assume that that over-dispersion is arising? Where does it come from? Is it associated with subject-specific Subject-specific changes in, I don't know, you know, subject-specific changes in cell type composition. Is it associated with something that's very regional? Maybe it's associated with some local SNPs having an effect on methylation. I have to say, before we got to this model, we spent a long, long time trying to say, well, what did we do wrong? You know, just sort of going back to the data and trying something else, going back to the data and trying something else. We need a new confounder. We need to readjust for SNPs. We need to do this. We need to do that. To do this, we need to do that, and we never managed to figure out what was going on. And your test is at the CPG level or at the regional level, it's the same side at the same time. We have both. We have the point-wise intervals, and then we have a regional p-value. But the qq plots that I'm showing are the regional. And that, okay, that's actually an important point because it's not easy to get a comparable regional p-value from all methods. We tried. Methods. We tried because they weren't really set up for it. We had, in some methods, it's easy, and in some methods, it's a little trickier to actually define the regional level p-value. Thank you. I think Jesse also has a question here. Yeah, hi, Celia. It's Jesse here. Can you hear me? Hi, Jesse. Okay. Yeah, really interesting stuff. And I guess sort of a bit of a follow-up to Hong Ji's question is, so you have. Is so you have like these four measured cell types, but and this is, I'm very naive in immunology, but right, of course, you know, my immunologist colleagues will say, oh, but there's like a bazillion types of T cells. And so I guess I'm wondering if even if those aren't measured, if sort of, you know, from the data, like if you can imagine doing like a PCA or something like that on the methylation patterns to kind of find, you know, to learn like if. To kind of find, you know, to learn like if there are some clusters, I mean, I guess similar to like dimensionality reduction in GWAS or something, you know, to control for population structures, even if you don't know what they are, how many of them to account for, something like that, if that would help. So you're bringing up a really important point here, Jesse. What I have four principal components here of cell types, but there are actually six cell type proportions. Six cell type proportions that are estimated, but one of them is really rare and some of them are correlated. So we actually reduced them to four principal components of cell type. But they aren't directly measured. They're actually estimated from the methylation data per se. So if you really wanted to do it properly, you would need to actually do flow cytometry and separate it out, you know, and so that's just a whole different. That's just a whole different financial proposition and technical proposition. And apparently, if it's been frozen, you can't do it anyway. Okay. Okay. No, I think I didn't understand exactly where those were coming from. Yeah. Yeah. But no, you're absolutely right. There could be sub, you know, any effect on methylation that's relevant to a particular phenotype may be particularly in one subgroup of cells. And, you know, I mean, that's the advantage of going into single cell techniques and things like that. But we are. But we are limited by what we have. Yeah, yeah, thank you. Thank you. I cannot see if anybody in Zoom would have a question. I don't see anything in the chat. Okay, no one raised their hands either, right? So, anybody else would like to ask anything here, or I think we can, if not, we can just. We can, if not, we can just take a little break.