Thank you. Thanks very much, David, for the introduction. And I'm very happy to have this opportunity to present my work at this workshop. Thanks for the invitation. Today, I want to talk about ongoing research on mediation analysis with mediator and outcome missing not at random. This is a joint work with my PhD student, Shu Ji Zhuo, who is a first year PhD student in bio statistics. PhD student in biostatistics and a professor Peng Ding from UC Berkeley. As many people here are very familiar with, mediation analysis is a very useful and widely adopted approach for investigating causal pathways through which an effect arises. However, many mediation studies are challenged by missingness in the mediator and/or in the outcome. Outcome. Okay. And this is a motivating study. The National Job Corps study, NJCS. Job Corps is the nation's largest education and training program for 16 to 24 year old disadvantaged youth who are disconnected from school and work. And the Job Corps provides intensive educational and Intensive educational and vocational training with a goal to improve their economic well-being. And the NJCS is an experimental evaluation of job corpse where subjects were randomized to either the job corpse program or to a control condition. And because in the job corpse program, educational and vocational training is a key element or central elements. Also, people are interested in asking what's Asking, how much of the impact of Job Corps on earning that is mediated through educational or vocational attainment? And here, our mediator is measured as whether or not a subject received an educational or vocational certificate, which is measured at 30 months follow-up. And the earning, which is the outcome, is measured as the Outcome is measured as the weekly earning four years after randomization. However, in this study, the mediator and outcome values were obtained through interviews, and the non-response rates are not low at all. If we just focus on the treatment group, you could see that among those 5,084 subjects, Subjects in the data under the treatment condition, there were 545 of them who, although reported outcome value, however, failed to report the mediator value. And there are another around 500 subjects who although reported mediator value, however, not the output value. And also, there are around 500 subjects who didn't report either mediator value or the output. Either mediator value or the outcome value. And this results in that the proportion of people with missing data in either the mediator or in the outcome under the treatment condition to be around 31%, which is not a missing rate that is negligible. And similarly, there are also many missingness in the control group. In the control group. And our concern here is that the missingness may be potentially missing not at random, MNAR. Because if you think about the missingness in the mediator, for example, it may depend on whether or not the subject received the certificate. We are worried that people who didn't receive a certificate may be less likely to Maybe less likely to report whether or not they received one, right? So, this is the concern. In the field of mediation analysis with missing data, most of the previous literature assume either missing is completely at random by focusing on complete cases or missing at random. And most of the work listed here are under the linear structural equation. The linear structural equation model framework, and some of the work addresses the missiness through weighting. Consider missingness in the outcomes only. Lee and Zhou 2017 paper, they utilized an instrumental variable type of covariate to identify the direct and indirect effects when the missingness in the outcome is missing, not at random. But there, one need a covariate that. one need a covariate that predicts the outcome. However, it's conditionally independent of the missingness in the outcome, which you can imagine in many studies, we may not have such a covariate available. So in this work, our goal is to explore and study the identifiability of the direct and indirect effects under various interpretable missingness, not at random mechanisms. Random mechanisms. Okay, so this is the outline of the talk. First, I'm going to introduce the notation and the basic assumptions underlying the mediation analysis. To present our identification results under various missing not at random mechanism, I will start with the simplest scenario where it's just a Simplest scenario where you just have missiness only in the mediator. And then I will extend the results to more complicated scenarios where you have missiness in both mediator and the outcome. And then I will present some preliminary results on our application to the job corpse study. Okay, notation. We use potential outcomes framework to We use potential outcomes framework to define causal effects. We use TI to represent treatment assignment for subject I, one if being assigned to the experimental group, and zero otherwise. We use MIT to denote potential mediator value under treatment condition T. Note that everyone has two potential mediator values, right? One under treatment condition and one under control condition. And which one can be observed depends on the actual treatment of some. Depends on the actual treatment assignment. We use YIT, MIT, or equivalently, YIT, to denote the potential outcome value under treatment condition T. And we use XI to denote the vector of measured covariance values, those notation MI and YI without parenthesis to denote the observed value of the mediator and the outcome. Okay. Here, excuse me. The average treatment effect ATE is defined as the expected difference between Y1 and Y0. Note that everyone is assigned to only one treatment arm, right? So half of those potential outcomes are not observable. So essentially, causal inference is. Essentially, code inference is a missing data problem. ATE can be decomposed into the sum of natural indirect effect represented by NIE here and natural direct effect represented by NDE here. Okay, and in this decomposition, another potential, which is a counterfactual outcome, is involved that is Y1. Is involved, that is Y1M0. It is talking about the potential outcome under the treatment condition, had the mediator taking its value under the control condition. NIE is the average difference between this Y1M1 and Y1M0, which quantifies the amount of change in the outcome under the experimental condition that is attributable to the change in the outcome. To the change in one's mediator from M0 to M1 that would be induced by the treatment. In contrast, NDE is the average difference between Y1M0 and Y0M0, which quantifies the amount of change in the outcome due to treatment. That is not attributable to the change in the mediator induced by the treatment. Okay, and the sum of NIE and NDE is equal to. Of NIE and NDE is equal to ATE. Well, when there is no missing data, the identification of NIE and NDE requires the following sequential ignorability assumption, which essentially assumes that given the measured confounders X, the treatment assignment T is independent of all the potential outcomes, including the potential mediators. Potential mediators. And given X in each treatment group, the potential mediators are independent of the potential outcomes. And here, this is the non-parametric identification result on expected value of Yt Mt prime given covariance under sequential ignorability assumption when there exists no missing data. And note here. missing data and note here t and t prime they can be the same or different they take values of zero and one if if the treatment is binary now based on this result it's clear that if there are missing data in the mediator or in the outcome then the key would be to identify the following two conditional probabilities one is the conditional probability of y given tmx the other Given t m x, the other one is the conditional probability of m given t and x. Okay, once you can have those quantities identified, you can have the a and d identified. Okay, now let's move to the simplest scenario where you only have missingness in the mediator. Let's use Rm to denote the missingness indicator of M, one if observed and zero otherwise. And zero otherwise. Let's first just think about what is missing completely at random and what is missing at random in this scenario. If Rm, the missingness indicator, is independent of everything, including X, T, M, Y, no matter fully observed or not, right? The missingness is missing completely at random. In this case, using complete case analysis, In complete case analysis, one can achieve unbiased estimation. However, if R is independent of M given fully observed data, X, fully observed variables X, T, and Y, then the missingness is missing at random. And in this case, the missingness does not depend on the missing value itself, and therefore Well, the missiness in M can be accounted for by variables X, T, and Y. However, in the job corpse study, we are concerned that people who failed to obtain an educational or vocational certificate were less likely to report compared to people who successfully obtained an educational or vocational certificate. Meaning that we're concerned that. Meaning that we're concerned that the missingness Rm may depend on the missing value M itself. Okay, now, this is our proposed missing not at random mechanism, which could be plausible in many studies. For simplicity, all of the graphs we presented in this talk condition on X. We allow covariance to have an impact on everything. On everything. Okay. This graph says that we allow the missingness Rm to depend on the missing value m given t and x. However, the missingness Rm is conditionally independent of the outcome Y given T, X, and M. The idea is that the outcome occurs later, right? So it is this graph is or this mechanism is Is or this mechanism is describing scenarios where it is reasonable to assume that what's happening in the future do not have an impact on the missingness in the past. Okay, now let's take a look at the identifiability under this missing not at random assumption. First, the identification of the distribution of y given tmx. Tmx. This is trivial because Rm is independent of Y given Tmx. And therefore, you can simply plug in or we're putting Rm equals one into the conditional part. And this conditional probability can be identified by complete cases. Okay. However, in dealing with the conditional distribution of M given T and X, you can no longer simply put in longer simply putting Rm equals one in the conditional part because m and Rm may be correlated given t and x. Okay, so a little bit more work is needed. Here we define p my1 given tx to be the joint probability of m y rm equals 1 given that t equals t x equals x and p plus y 0 given t x to be the t x to be the joint probability of y equals y rm equals zero given t equals t x equals x so both of those two both of those probabilities can be identified with some observable data now um the p plus y zero given t and x it's just a sum over m of the joint probability of m y r m equals zero given t and x. Rm equals zero given T and X. And if you play with this probability a little bit and assume that Rm is independent of Y, given X, T, and M, you can get the last identity, which involves some unknown ratios, which is marked in blue. And this ratio is describing what's the ratio between the The ratio between the probability of non-response versus the probability of response in each strata defined by the values of mtx. Okay, now if this ratio is identifiable, then the probability of missingness in each strata defined by mtx will also be identifiable because the numerator and denominator sum up to one. And therefore, you will be able to identify the conditional probability of f. Identify the conditional probability of M given T and X. Okay, now the question is: when will those ratios be identifiable? And based on this derivation, we need to solve a system of linear equations represented by one. And if this system of linear equations have unique solution, then those ratios can be identified. Okay, so essentially, those ratios are identified. Those ratios are identifiable if the above system of linear equations has full rank, which essentially requires that first, support of y is not smaller than the support of m. Second, m needs to have an impact on y given t and x. Now let's take a look at a simple simulation study in this setup. We consider x X, which is a univariate covariate, normally distributed. Treatment assignment, completely random. And MI is a mediator we generated following a logistic regression. And YI follows the linear regression model with the mean being linear in T, M, and inter. In TEM and interaction between treatment and mediator. And the I apologize for the coughing. I've been coughing for months now. And for the missing indicator Rm, it follows a logistic regression model. And you could see that when lambda m is not equal to zero, then zero, then the data is missing. Then the data will be missing not at random. And the data are generated with a missingness rate in M around 22%. And here are the methods that we used to analyze the simulated data sets. The first one is Oracle. It's just a plug-in the two values of the missing data. The second one is a complete Data. The second one is a complete case. We use subjects without missing data. And the third one is our EM algorithm, which is designed to incorporate the missing not at random mechanism. Okay, here are some simulation results. This is based on a thousand simulated data sets with sample size 1,000. With sample size a thousand under missing this not at random mechanism that we just described. And this is it, this is a scenario where M have an impact on Y given T and X. If you look at the performance, let's first focus on the model parameters in the Occam model, Y model. Notice that in our previous identification, Our previous identification results, complete case is able to identify the conditional distribution of Y given T and X. And therefore, both our complete case and YAM algorithm are able to provide consistent results for the parameters in the OCAM model. However, if you look at If you look at parameters in the mediator model, the complete case has substantial bias. For example, the intercept in the mediator model is actually only 0.5. However, the complete case will estimate it as 1.something. And this bias will further lead to Bias will further lead to bias in the estimation of the NIE and NDE. You could see that the complete case, the percentage of bias are as large as 30% in this study. And our EM algorithm is able to provide consistent results on all of those model parameters and also NIE and NDE. Now, let's take a look at a scenario where M is independent of Y given T and X. In this case, we may not be able to achieve non-parametric identification of NIE and NDE. And indeed, if you look at the estimates, you can see that both the complete case and the EM algorithm provides biased estimates for the parameters in the models of the mediator. Models of the mediator with the complete case having more bias. However, if we look at the NIE and NDE, both complete case and EM algorithm still provides consistent results in this scenario. This is simply because that when M do not affect Y given T and X, then the probability, the conditional probability of Y given M T X will be given m t x will be equal to the probability of y given t and x and therefore ni equals zero ate equals nde all the treatment effect is contributed to the direct effect um and in this case uh the the the and nde just won't depend on the model of the mediator model okay uh now uh let's Okay, now let's move to more complicated scenarios where you have missingness in both the mediator and the outcome. Okay, again, let's first think about what would be missing completely at random and what would be missing at random in this scenario. Let's use ry to denote the missingness indicator of y, one if observed and zero otherwise. If observed and zero otherwise. And if Rm and Ry are both, are independent and are both independent of everything else, X, T, and Y, no matter if we observable or not, the missingness is missing completely at random, right? And if Rm, Ry are independent of variables having missing data, M and Y, given variables that have complete measurements, T and Complete measurements on T and X, then the missingness is missing at random. Okay, next, missingness not at random. Still allowing Rm to depend on M itself and considering scenarios where future variables do not affect the missingness in the past, we found the following three missing not at random mechanisms. Not at random mechanisms that can achieve identification under some full rank conditions, similarly to the ones that we discussed before. Let's first take a look at the first mechanism described by the following graph. Essentially, Rm is allowed to depend on m, t, and x. However, not the future variables ry or y. Or y. And Ry is allowed to depend on Rm, T, and X. However, now to be conditionally independent of M and Y. If you compare this graph with the previous missing at-random one, this one on the right side, it's clear that MAR is a special case of the proposed. Special case of the proposed missing nod at random mechanism one. Okay, and one can show similarly as before: the conditional distribution of y and the conditional distribution of m are identifiable, or we say NIE and NDE are identifiable if the corresponding system of linear equations with the following ratios in blue as unknowns is full rank, okay, which also requires that. Okay, which also requires that the support of y is not smaller than the support of m and also m is not independent of y given t and x. This is a mechanism of interest when the missiness of y is likely to be largely driven by the missiness in M, okay, given T and X. On given T and X. People who are less likely to report their mediator value may also less likely to report their outcome value. This is the idea. Now let's take a look at the second missingness not at random magnetism. This one allows both the missingness of M and the missingness of Y to depend on the missing value itself. Different from the Different from the first mechanism, it changed the arrow from Rm to Ry to an arrow from Y to Ry. Okay, and therefore, it also requires that Rm and Ry to be conditionally independent. It is talking about a scenario where the missingness in Y is likely to be driven by the value of Y given T and X. People who People who have no earning or zero earning may be less likely to report their earning. So in terms of identification, this one actually requires that the support of y is equal to the support of m. And also it requires that m is not independent of y given t and x. Okay, this is the third missingness not at random mechanism. Different from the first two, this one says that it is m, the mediator value, that drives the missingness in both m and y given t and x. Okay, and also our m, our y and y are conditionally independent given m t x. In practice, I think this one might be This one might be less plausible compared to the previous two. When we think about why an outcome would be missing, right, often we have the concern that it is perhaps due to the missing value of y itself, or it is missing because there are people who just don't want to report no matter m or y, and therefore rm and ry are correlated, right? It's very hard to come up with a scenario where it is. With a scenario where it is M that drives the missingness of Y, but not Y itself or R M. So in terms of identification, this one essentially requires that the support of Y is no smaller than the support of M, and also M needs to have an impact on Y given T and X. Now, this is a brief summary of the previous three. Summary of the previous three missing node-at-random mechanisms that we just described. Assuming that what's happening in the future do not affect the missingness in the past and allowing M to have an impact on RM, we have shown that identification of NIE and NDE can be achieved under some full-rank assumptions. Assumptions when Ry only depends on one of Rm or Y or M given T and X. However, when Ry depends on more than one of Rm, Y, M, for example, if Ry depends on all of those three, given T and X, then the identification of NIE and NDE cannot be achieved without further Cannot be achieved without further assumptions. Okay, now let's move to some preliminary results that we obtained in our application to the job corpse study. The data we have describes about 8,700 subjects who are randomized to either job corpse group or control group. And the mediator M here describes whether subject I obtained. Describes whether subject I obtained an occasion or not collected at certain months follow-up. One if obtained a certificate and zero otherwise. We use YI here to describe the weekly earnings four years after randomization, and we have missing this in both M and Y. This is the covariance information. The covariance information, we could see that besides gender, age, race, we also have many other baseline measurements such as baseline earning, which we can account it for in the analysis. If we look at the outcome distribution, just the same as in many studies on earning income. Earning income or medical cost. The outcome contains excessive zero values and pretty skilled positive values of earnings. In order to account for those two issues, we use two-part models for the outcome. Here are some of the model comparisons that we have done so far. So essentially, So essentially, we analyzed the data under missing knot at random mechanism one, and also missing not at random mechanism three. And for the missing knot at random mechanism two, we haven't done the analysis yet. In this case, because M is binary, Y, if using its original scale, which is Its original scale, which is continuous, then the support of Y is much larger than the support of M, which under magnetism two do not lead to non-parametric identification. Okay. And for the Alka model, we considered a two-part model with gamma model for the positive. Gamma model for the positive part, and we also considered a two-part model for the using a log normal model for the positive part. And among those models that we have fitted so far, the gamma model under missingness mechanism one provides the best likelihood. Okay, now let's take a look at the model and the results based on this model. Those are the models that we fit. Model for M is binary, so we used a logistic regression model. Model for Y, we applied a two-part gamma model with log-link. The first part talks about whether the earning is positive or zero, and the second part models skilled or positive earning. A conditional on A conditional on that earning is not zero. And under missing mechanism one, the model for Rm, we include M, T, and X as predictors. And the model for Ry, we allow it to depend on Rm, T, and X. Okay, and for estimation, we adopted EM algorithm. Okay, here are our data analysis results. The confidence intervals are obtained based on 500 bootstraps. You can see that our NIE, the complete case and our EM algorithm, they provide very similar estimates and similar confidence intervals. And the AIE is positive and significant at the point of Significant at the 0.05 level. And for the NDE, the complete case is at the boundary of significance at the 0.05 level, whereas the EM algorithm doesn't find a strong evidence for a positive effect at the 0.05 level. If you look at the coefficients estimates in the two Two missingness models. For example, the coefficient of M in the RM model, it is estimated to be 0.497, which says that obtaining a certificate is associated with higher chance to report. But this effect is not significant at the 0.05 level. level um and the coefficient of rm okay rm on ry is estimated to be 1.874 with a p-value extremely small so essentially subjects who are more likely to report their mediator value they're also associated with higher chance to report their outcome value which makes perfect sense however we're still However, we're still worried that the missingness of Y may depend on the missing value itself, right? We're concerned that, for example, people who had no income may be less likely to report to address this issue. We propose to conduct a sensitivity analysis. We want to assess the sensitivity of our causal conclusion to the impact of Y on Ry. So we revised our model as follows. Model as follows. Here are some preliminary analysis where we just include whether or not the income is positive as a predictor. And we treat gamma y as the sensitivity parameter. As you can see, when gamma y equals zero, it is the same as the previous analysis under missingness not at random mechanism one. Okay. Okay, this table presents our sensitivity analysis results. We vary gamma y from five to negative five, and it looks like our causal conclusions on NIE and ND are not sensitive to the impact of RY. Okay. Okay, to summarize, our study shows some positive results on non-parametric identification of NIE and NDE when mediator and words the outcome are missing, not at random. And here I want to end the talk with one of our favorite statistics quotes by Cox and Donnelly. If an issue can be addressed non-parametric. Can be addressed non-parametrically, then it will often be better to tackle it parametrically. However, if it cannot be resolved non-parametrically, then it is usually dangerous to resolve it parametrically. Okay, that's all about this talk. Thank you very much.