So, the title of this talk is Machine Learning and Physics-Informed Neural Networks for Petroleum Engineering Applications. I picked a couple ones that I thought would be of interest to you all. We have done the multilayer perceptrons to do rig state classification just by looking at lots of data streams and talk about what kind of activity is going on on offshore rig. We've also done some work using convolution neural networks for feature identification from. For feature identification from the seismic data or creation of some synthetic well logs. But today I'm going to talk mostly about some sort of time series data, whether it is from the drilling rig operations or from the production. So like everybody is talking about it, all the credit due to the graduate students who worked on this. Mark Bell is now working for Chevron. He did the work on the The work on the reservoir or the production data that I'm going to talk about for creating the pin out of the injection and production well data sets. So if you have lots of water injection data and then oil, gas, and water production data over a period of time, how do we create some sort of reduced order model out of it that follows certain physics? And then I'll follow up the second part of the talk. Talk, which is the PhD work of Chi Shua Yin. He's now a faculty at China University of Petroleum Beijing. That one is looking at experimental data facility, which is a test scale pilot rig where you have a gas kick coming to the surface, and then we are trying to look at the signature of expansion of a certain gas volume and come up with an alga, you know, machine learning model that can detect the. Detect all the indicators, whether it is a gas kick coming to the rings, and should we stop the operations, or can we estimate the size of those gas kicks? So that's what's going to be the scope of the talk. So I'm going to show you some of this time series data so that we don't have to spend a lot of time looking at when we are talking about reservoir management or, for that matter, the offshore drilling safety. Time series data. Time series data can be of a very long period or could be of a very short period time, even if it is in like a at a resolution of what's going on at every minute and a second on a drilling rig. So I'll talk about that and maybe skip over the overview of long short-term memory networks because that was done in the morning. But maybe people wanted to kind of Maybe if people want to kind of recap that, we will do. So, two major examples that I'm going to cover is reservoir management and acknowledgement to the wolf. It's coming from Equinor around 2017-18. Equinor basically created an open data set for the oil and gas community. It's like five terabytes of data. And almost 80-85% of the data is seismic data. So, 4.something terabytes is all seismic data. We have not tried looking at that. Seismic data. We have not tried looking at that yet. But we looked at their reservoir, we have looked at their production, we have looked at their well logs. So it's an interesting thing. And unlike the turbulence community, where you have several open data sets, this is something that I think oil and gas industry should learn from folks that have been organizing open data sets for analysis. So I think the progress can only happen when we share these kinds of data sets to develop these data-driven models. Otherwise, so maybe BP shall. So maybe BP Shell, all these big major operators should think about how to create the data sets that Johns Hopkins and for that matter, other universities have also created. So this is the outline. So here's an example on the left. I'm going to show you like what's what's in the whole field. It's a small one. It's a field operated by Equinor and Northsea. They were producing from it from 2008 till 2016 or so during it. 16 or so during eight years of production didn't produce. In the initial part, it actually had some economic value. And then once it tapered off, the water cut went up. It was not very economic for them at that particular point of time. In 2016, anyway, the oil market was crashing too. So if you look at that kind of a time series data, this is what we have, you know, the production of oil and gas. And if you, or this, the axis is not very visible, but it is almost like 80 years of. Is almost like 80 years of production data, and the production data is at the granularity of almost daily production rate to monthly production rate. You can actually resolve at that time scales. On the right-hand side, I'm going to show you an experiment that is related to the gas kick. You will see a variety of data coming from like bottom hole pressure, standpipe pressures, weight on bit, torque, all kinds of measurements that we are doing at the drill bits. That we are doing at the drill bits and around the pipe. And at the bottom, you will see these different colors that we call it as a risk level going from zero to five. This is something that we devised as a part of it. What happens is if you have only two indicators for risks, saying, okay, it's safe to operate and it's now you stop, it's not a very practical way for drilling operators or the guys that are on the rig to kind of make a decision. On the rig, you kind of make a decision. But if you gradually increase the risk level, maybe their alert system will be a little bit better. And I'll explain more what those black lines versus colored lines mean is black was the raw data. And if you draw raw data directly for this interpretation of time series data, you will be changing your decisions in almost every other second. So you don't want that. So we smoothed those time series data before we did the data-driven model. Before we did the data-driven model, so that when we make a decision, we take a certain amount of time and stay in the same risk level for a short period of time. Okay. This is the building block of a recurrent neural network. You can unroll a recurrent neural network to see what is inside one unit, and it is composed of a variety of, you know, you have input gate, forget gate, output gate. Part of this work was already described by Professor L. S. Fannin this morning. Professor LS fan in this morning. One debate could be: you know, we are using LSTMs, we could use transformers and other things also. We have not delved into that yet, but another thing that goes in favor of these LSTMs is the dominance of some of these long time period signals that we have in our data set. So, transforms usually work when the When the time periods of these things are not unusually long. So we stuck around with this LSTMs for this research. So let's start with these reservoir management problem. What was it? So this is the wall field, and the purple spots are talking, showing you where the valves are. And if you were to solve And if you were to solve this particular problem like a reservoir simulator, you will be writing its governing equations in terms of its mass balance, in terms of how is the oil rate, flow, water rate, and the gas rates in the subsurface environment and converted it into what happens to the oil and gas volume side as it comes to the surface, right? And that's the kind of data that you will be observing only on the wells. So, truly speaking, So, truly speaking, our observables are well heads. So, apart from these five production wells and two injector wells, these are the seven points where we are doing measurements. Everything else is sort of either you have some sort of a geological interpretations, everything is in subsurface, right? So we do all this detailed reconstruction of subsurface environment based upon other measurements, and then we run these governing equations for you could say flow through porous media and. You could say flow through Poros Media and for this multi-phase flow through there. Now, if you want to design a reduced-order model, the idea would be to basically just look at what is happening between injector and producer pairs. And then because you know how much volume of water you are injecting, you split the fractions where it will go to different producers, and then you apply certain amount of resistance between the injector and producer pair. Between the inject and produced repair to what we call a capestance resistance model. So it is already right from the beginning is a reduced order representation of the entire reservoir field. And then we'll use this time series data to come up with a coupled system of ODEs and find those coefficients to reduce. So here is the recap of what a reservoir simulation versus CRM will look like. Reservoir equations, this is a mass balance for oil, water. Oil, water, gas, gas could be in solution or could be in the free phase. Everywhere you have the oil rate and water rate, you will convert that back using the multi-phase form of Darcy's law. So you will using relative permeability as a function of saturations and then gradient of that particular phase pressure. So those equations will turn into saturation pressure equations and the source. And the source terms are related to the well productivity index. So, the thing that shows up over J, that is telling you how prolific your well is as a producer or injector is. And that's the average pressure in the vicinity of the valvore. And then you have the bottom hole pressure. So that sort of gives you the driving potential. So this is the pressure drawdown near the valvore. Down near the valve bore, or the pressure injection. In that case, it's the other way around how fast you are going to be basically injecting to the valve. So, this is the reservoir simulation that is needed on close to a million grid point calculations in the whole field if we were to do matching the parameters over there. So, but we sort of have been doing that thing routinely. It's a conventional simulation, but let's talk about reduced order model. In this case, you will have because you have eight, 10 wells, you know, you have five inches. Eight 10 valves, you know, you have five injectors and and two, uh, no, two injections and five producers. So, there are combinations, there are 10 combinations out there. So, you have a coupled system of equation over there, but we split, we split for each well the contributions in terms of, you know, you go from number of injectors that how each inductor's contributions will go over the rest of the pairs. So, you do pairwise contributions over there. You see productivity index also split like that, and the coefficients. Split like that, and the coefficients now you have to determine is the resistance and then the fraction that what you have the water injection rate from each injector, and you are splitting them between different producers. So, this is the capacitance resistance model. So, what do we do? So, what we did is we looked at the time series data from the wall. We split it into two-thirds, one-third type of training versus testing. And to a large extent, To a large extent, flow through porous media with this kinds of, even if you have these oscillations and if it is a well-behaved system, Laplace equations are a very good, you know, this is a pressure diffusivity equation that you're really solving. So once it learns how to do that, in fact, it translates very well to other wellbores also. So what we are showing is we train and validate it against, let's say, well number 12, and then we passed it on to the rest of the other well. Of the other wells, it worked very well. The LSTM predictions actually matched the true production better than the simulator. So if you just looked at the last few length of these things, the time series data, the LSTMs are doing better job than even the full simulators. And I think the reason they're being is in a simulator, there is an accumulation of errors also happening. Accumulation of errors also happening. So, if you're dealing with a very simpler model, you're not accumulating that much amount of error anyway to begin with. And then, if you were to take that trained data for one producer well, and then there are other four producers and see how that actually goes to different other producers. We see the volumetric total cumulative volume errors coming from the LSTMs are far less compared to the STMs are far less compared to the simulator. So, this is only just by looking at each individual wells. Now, if I were to basically put it all together, and this is where comes this, why we are just doing time series training only on one producer and then see if it just, you know, because all the wells are in the same field, we expected them to work really well. So, this is not really, I can't boast it around like this is truly transfer learning. It's just the same field, right? Learning, it's the same field, right? However, if you do not put any constraint, this red is the mass imbalance. What is the mass imbalance? If you think, there is no reason for it to be considered as a closed boundary problem because we don't know. But let's say we make an assumption that we had certain amount of water injected in and then we have certain volume of fluid coming out. Can we conserve that volume of the fluid that has been sent into this particular subsurface environment? Particular subsurface environment. So, for that, we actually enforced that thing using these governing equations of physics-informed neural network. And as soon as we do that, your mass imbalance is more or less gone. You have a very little one that is left over there. And after that, so this is the one thing that you achieve by using pins. And if you were to reinterpret it, what is happening? So, we're just kind of showing what those. Just kind of showing what those taus and f's and j's would look like between the injector to the producer pairs. These are the well numbers, well IDs as given by the wall field. So basically, you can rewrite the entire system of your reservoir by these ODE systems by the coefficients that I was showing you before. It's as simple as that. So instead of running those million grid point calculations, you have this coupled ODE. Point calculations, you have this coupled ODE systems with these coefficients that were determined, and this can do your reservoir management. Now, this particular model is as small as that you could run from your cell phone. So, if I were to basically give it as a spreadsheet calculation or an app, somebody could run results and talk about the cumulative oil production, water cut, and have to make any decisions, they can do it. So, this is the advantage of having a reduced oil model. And then you try to compare it, like what those things are looking. To compare it, like what those things are looking like compared to the we also ran the full uh reservoir simulations and then trying to look at where the streamlines would go. So, if you are in the vicinity of injector four and you do the stream traces by releasing these particles over here and see where they're going, keep in mind there is a 11, 15, 1. So, let's see what happens there. So, okay, I need to go back just to kind of see we were injector four. kind of see we were injector four so 11 14 or so so basically you start seeing almost 32 percent of the of the flow should be going towards that particular pair 21 percent 21.5 percent of that injector should be going towards so we can actually even interpret in that particular fashion so this is something beautiful about this reduced order model uh so we So, we very high-level conclusion, I would simply say it is that LSTMs for useful ML models for time series of production data from the producers. Well, this is a real field data. So, that's what I enjoyed about this particular research. It can help with reduced order models for reservoir management. And PINS actually gave something physical. They were able to enforce that there is no mass imbalance. We are not losing mass by doing all these. Mass by doing all this water injection, and we don't know where that water is going. Okay, so that's the first one. Let me quickly go over, and hopefully, I will take the apologies from Shunheer. This is the picture from the Makando blowout. Why is this very important? This thing brought awareness to our oil and gas industries about how important safety is. So, with the, you know, you know, nobody likes disasters, but disasters are a very good way of. But disasters are a very good way of waking ourselves up and seeing that, well, something that we might not be doing right. And there are several things that went, you know, some multi-phase flow problems. At that particular point of time, we didn't even have a good idea how to even calculate the worst case discharge. So you'll see the error bars going in all over the range. You know, everybody that was working on this particular problem, and somebody who was doing the mass balance, they got this range. This range, and it's all over the place. And that's my colleague from LSU. At least he got that thing right. So let's take that particular problem as a motivation for the drilling safety. What's the problem I'm looking at? We are looking at the early kick detections. What is a kick and why does that happen? So, if you look at in the offshore drilling, you will have a floating grid, you will have a long riser, drilling riser. Riser, drilling riser, you will have something called blowout preventer. This is a wall that you will be closing against if there were to be any pressure coming back up. Then you will have an actual valvo. And then this is where your drill bait is. Typical depths below the mudline could easily be what's your deepest valid BP now? Right, several. So I'm talking about tens of. So I'm talking about tens of thousands of feet right here. And the deep water level that we are talking about is again, you know, we used to be around 5,000, 6,000 feet, and I think it's even bigger than that. So you got quite a lot of delay just because you're on a floating platform and then you have this deep well. Okay. Now, the problem over here is there's something called fracture pressure gradient at a called fracture pressure gradient and pore pressure gradient. What is pore pressure gradient is telling you is this the pressure of the hydrocarbons when you are reaching in this or the fluids that are in the pore spaces. And what is a fracture pressure gradient is saying is if I were to increase my hydrostatic of the drilling mud, it will actually fracture the formation. So if I'm doing the drilling, the drilling operation is such that you're sending a drilling mud in through the drill bit as it cuts. It as it cuts the rock, it brings those rock cuttings back to the drilling mud. That's how the operation is. Now, the drilling mud weight has to be greater than the pore pressure because you don't want the fluid to be moving into the valve bore until you have the casing. And it cannot be greater than the fracture gradient, otherwise, you will fracture the formation and the drilling mud would be losing to the formation. Problem in the deep water, this mud window. This mud window is very small. So, this is your margin. This is the margin in which you are drilling. And this SG is specific gravity. And as you keep going down, it is telling you that margin is going away to 0.01 specific gravity in your drilling mud. If your drilling mud is lighter than that, you will start seeing the influx. It's the drilling mud. Start seeing the influx, it's the drilling mud is heavier than that, you will be fracturing into the formation. So, that's a tight mud window problem. It's a challenge. Now, so what we did is this, we are looking at, let's say there is a pressure sensor right above the drill bit, and we have an acoustic sensors right above the BOP, and then we have all the conventional comprehensive logging data from the mud tank. How do I use all this data fused together and then come up with a model that will tell me? Up with a model that will tell me whether there is going to be a gas kick or not. Like, let's say if your mud weight goes below the spore pressure and the hydrocarbon fluids do come into this well bore and then they start rising up, can I estimate that that I am now going to see an influx of hydrocarbon coming to the floating platform and how much is that volume going to be? Now, this job has to be done fast enough for the drilling of. Fast enough for the drilling operator to take a decision. Okay, so this is a simple setup done at China University of Petroleum Beijing. You can see all the surface facility with the pumps, the curls flow meters, the mud tank volumes. This is what conventionally people do. So if you were on land, you would not have all these things. Basically, you will have some sensors about the. Some sensors about the drill bit. That's about it. But they make all their decisions based on that. That's how they have been trained to do it. Problem there being is in the deep water wells, there's a lot of time delay. So all the well control training that we have for the onshore well, the online wells probably doesn't apply to the offshore very easily. So the time series, why is these things kind of invisible? All I'm talking about over here is different types of parameters that I have and Parameters that I have and the sort of signal-noise ratio, just to prove the point that for the time series analysis, your signal-to-noise ratio has to be over 2.5 so that you're not just fitting through the fluctuations all the time. Okay, so let me go in detail about we briefly covered that in terms of what we have at the bottom hole pressures, weight on bit, torque. These are all the parameters. Torque, these are all the parameters that are of importance. And so, if let me kind of point you out to this thing: differential flow out. So, this is already telling me that there is a volume or is increasing in the mud tank. And as a mud tanks get full means the kick has reached to the surface, I should have stopped. Okay, so look at what my risk level is. Risk level is five, it is telling me I should stop, okay. Me, I should stop and here risk level is four, it is telling me to prepare to stop until this point. Operations are normal, so they will be all green. Okay, let's see what happens. We did lots of experiments with different shapes of how we were ejecting the gas into this particular thing, and then we tried different algorithms like decision tree, k-nearest neighbor, support vector machines, and LSTMs. And if you go, uh This is the ground truth, and I'll just talk about LSTM over here. I should have stopped at this particular point of time. There is a little bit of a delay, and then LSTM catches it first, then support vector machines, then others. And others have other problems also. Once they're at the stop, their decisions fluctuate between going the risk level five to four. But in LSTM, But in LSTMs and support vector machine, at least you have this, not changing your decisions between different risk levels. So catching that particular part is what we call is early kick detection. We are able to detect that there is an influx coming in your valvo and you should stop faster than any other method. Now, this is where I would probably stop. And if there are questions about can we estimate the gas volume? Estimate the gas volume. I have that in the backup slides. But in the LSTM part, we don't know really exactly how this will work. So we did the grid search to find the optimal parameters for LSTMs. What worked best is the eight layers, 80 neurons per layers, and all the parameters that we put over there, because with that combinations, we were able to get the recall, F1, accuracy, and precisions all above 90. And this one I'm showing you the accuracy of doing like almost 0.945. Almost 0.945 94.5% accuracy in detecting if you're getting the gas kick or not. Okay, so what have we demonstrated here? We have shown the usefulness of ML models using LSTM RNNs for early kick detections. What I did not talk about is downhole gas kick evaluations, but those are in the paper. So the talk that I talked about is in the SPEG journal, which is about machine learning for deep water drilling, gas kick alarms classification. Drilling, gas cake alarms classification using pilot scale rig data. So, with that, let me stop over here and take some questions. Yes, John. Oh, you need that. Yes. So, what level of accuracy, I guess, in terms of those percentages of these tools would Of these tools, would the industry like before they say we'll do it automatically? In other words, whenever your criterion goes over threshold, we just shut this thing off no matter what operator person there decides, yes or no. Thank you, Charles. I'm not the industry guy, and there is an industry guy sitting right here. But I think he is from modeling groups. So you don't do the drilling, right? True, true, true. Right. Now, so the reason why we put the multi-level risks. So there is something called false alarms. If you have too many false alarms, the rig crew starts ignoring it. So there was a like the penalization for the, that's why we should not have a lot of false positives. And that's captured in precision. And that's captured in precision. The biggest penalty we would have here is if we actually have a false negative, because there was a kick and then you are not doing anything, and that shows up in your recall. So we presented all parameters. It's not just the accuracy. So your question is actually highly relevant. Is accuracy the best way to talk about it? And my answer would be: apologies, I should not have shown you accuracy. I should have shown you recall, which would be that the target. The target for our actually, it's in the paper, it's recall. But what we showed it: if your model works well, it probably has all the parameters, the matrix fairly high. So our accuracy recall, F1, and precision were all above 90%. The reason why we went after 90% was anything less than that is sort of, you know, right now, maybe we think that we are not. We think that we are not overfitting it because we did all these grid search for the LSTM parameters. But you've got to kind of at the next level thing, what we should do is just take it to a different kind of condition and see if the workflow at least applies, if not the same model for a different well, different field, if similar things are possible or not. But I don't know whether oil and gas industries. Know whether oil and gas industries would look for anything less than 80 percent or no in the field, they would like to have some sort of certainty because shutting those things down means loss of revenue for them. Yeah, yes, Ricardo. Thank you for a nice presentation. So when you do pins, what is the cost of pins compared to that of CFD for a for the same problem? For the same problem? Okay, if I understood it correctly, so my pin was already for a reduced model. So that cost will be negligible compared to running the full reservoir simulator. So that's one because the reservoir simulator is running on solving a PDE for close to a million. For close to a million grid point calculations in this particular case, versus you're talking about a coupled 10 ODE system. So, even if you do it with pin, I think it's probably, we didn't compare it. So, the true answer is I didn't compute the pin computational time because we didn't think that it's worth comparing apples to oranges. One is an ODE system, the other one is PD. Yeah. Yeah, but I mean, in the end, Peans, what it's doing is solving. In the end, pins, what it's doing is solving over an equation using neural networks, basically. So, cost of computing. The cost of the cost of computing. So, overall, why do you choose pins over any other solver or a time stepper or any way of integrating the equation in time? Why is pins beneficial in this case? Oh, no, no. This is okay. Now, I get it. Excellent question. So, the main reason is, again, I think this has been sort of discussed in terms of interpretability of the model. Of interpretability of the model with this particular form of equation. Let me go back to this. Yes. So we knew what those capacitance resistance equations look like when you just treat them as the injector producer pairs. We selected that. Again, this is not the only reduced order model. There are a hierarchy of such models that are over there. So if you go back to lots of talks that are talking about how simple is simple, should we go? How simple is simple? Should we go simpler? So we tried looking at lots of reduced order models and we settled down for something like that has few parameters, but not overwhelming too much because folks keep adding more and more. So we stopped at something which was like, there have been a lot of previous work that they tried to do it, but this is the first time that we are doing it using a completely data-driven approach. Yeah. So we had the system of equation, that's why we went after it, but there is no other reason. It but there is no other reason why we why we think uh this would have worked better than any other. No, I guess just to clarify, I guess what what you're saying pins here simply refers to the fact that you're enforcing that the sum of the q's is constant or or because the stars will show up only in these ODEs. Okay, so right okay so you have the residue the residual of that ODE is enters into the into the cost function of Enters into the cost function of your gotcha. This example of this application, you were comparing with pin and without pin, right? And you were showed some differences. So why was without pin? Why did you have to add pin? Did you not have enough data? Or what was wrong with the if I understood? Nothing's wrong. The thing is. Well, the thing is, if I were to not, yeah, this one. Yeah. So if you did not enforce those insults, you are getting some sort of this imbalance in the volumes. You see, at the end of the day, your reservoir patients are glorified as that, right? You're taking the volume of oil, volume of water, volume of gas, just conserving. So, here's a big Conservation. So, here's a big assumption: that in the whole field, that whatever volume you are injecting, you are basically producing that through your room. Now, if there were a water drive or you are leaking this volume somewhere out, then this is perfectly justifiable. We don't know that. But if we enforce pin, we sort of sum that up volume and we made sure that whatever we were injecting, we were seeing. That whatever we were ejecting, we would see that coming back out. As soon as we did that, mass in the balance. So, you forced the mass balance, but what if there was actually a leak? You didn't know that? Nobody knows. But what I'm saying is having some sort of an interpretation because with the pin, we had those sequestrance resistance, but we could also enforce that summation of the fuse, right? Now, where's the drive? Where's the drive? Is your all the production data that is coming from all the producers and the injectors that we have follow from the world field that all the volumes should be because they did not report all the water injection. Nobody reports water injection. They're talking only about how much oil I'm producing, what's the water cut, how much water I'm producing. They're not talking about how much water I'm product. All right. Is there any questions on the Zoom? Probably folks are asleep there anyway. All right. So nothing there. So let's close the day two. Thank you all for your attention. And tomorrow we'll have a short session. And thank you. Thanks to all the speakers for participating on the day. To all the speakers for participating on the day two of the burst workshop.