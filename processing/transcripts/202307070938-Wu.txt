Thank you for the organizers to invite me into this workshop. It's actually I enjoy every single presentation as well as the discussion throughout the week and also I enjoy the road trip in the evening. So it's been a very healthy week for me this week. So today I would like to present some of the work that I have been. Present some of the work that I have been done at the CINI University. So, first, I would like to introduce the data structure that I've been focusing on in this talk. I assume that most of the people here already will be very familiar with the data structure of the single cell, which is gene-by-cell matrix. But the data that I'm actually working on in this project is a little bit In this project, it is a little bit more complex. Is that it is a multi-conditioned and multi-sample experiment. So, actually, for in single-cell data, now we actually have a series of a gene-by-cell matrix, and each of the matrix is from each of the individuals. And this data structure can be a little bit more complex: is that sometimes different studies, they have a similar interest, so they want to sample. To they samples the individuals from similar conditions, and then some people would like to merge these two data sets and then look at it as a whole. So, now in this situation, we will have three layer information. So, one is that samples can belong to different studies, and then different samples like it will belong to different phenotypes, and each of the cells will belong to a different cell type. So, there are So there are, it seems like different, a lot of different data sets like this data structure, and we have curated 20 COVID-19 PBMC data set that has 5 million cells in total and 1,000 individuals. So this data set is generated from different labs all over the world. And also, we have cleaned up the metadata associated with the individual. So we actually find that this represents a very diverse. Represent a very diverse severity outcome and also age categories. So, the question now is: Can we actually integrate to the analysis data so that we can gain more insights from these different experiments? So, in our workshop, we have already covered a lot of data challenges that are associated with data integration. And here, actually, in some And here actually is some of them that I have been working on. And so, first is this matching annotation. So, although even though each of the studies have their own annotation, we actually find that in reality, this annotation can be very different. So, on one hand, is that as we already keep discussing, is that the cell type is actually not well defined. So, the cell type labels can, even though Labels can, even though they can define based on a slightly different markers for a sub-cellular cell types. And on the other hand, they can just name a same cell type with the different names or with the capital or not capital in the cell, or they just have a typos in the file they provided. So, if we want to manually clean up this for 20 data sets, it would be a very time-consuming procedure. And secondly, it's related to remove. Is related to remove the study effect in these data sets. So there are three kinds of the main things that we need to keep in mind. So first is the unwanted variation, it actually is multilayer. So we have unwanted variation that associate with the study due to different experimental setup. And we could also have, within the study, we will have the batch and also the donor effect. And the next one is also the bilaration is multilayer. The biologist is multilinear. So there is information that associated with the sample, so it's the phenotype related to the sample treatment or disease data, or also the information that associated with the cell, so it's cell types. And lastly, is the scalability, so we are able to integrate a million scales data, so this is also one of the challenges. And lastly, is that so now we can actually integrate. So now we can actually integrate data from different studies. So now it actually gives us opportunity to link the individual phenotype to the single cell data. So the question now becomes how can we summarize the single cell data to individual level. So I will talk through each of the components one by one. So first is the matching annotation. So this is a typical workflow in single cell data analysis. So we curated a different cohort. Different cohorts, and then we pre-process the data, and then we perform our data integration, and then we do some custom, and then we identify the markers and annotate it. So there is an alternative workflow that we can actually think about, is that we switch the cell-type annotation with the data integration. So now, using the external reference, now we can actually unify this cell type annotation utilizing the external reference. And then we can also use this cell type. Then we can also use this cell type annotation information to guide our data integration. So we developed a method called SD Classify that is based on hierarchical classification. And the strength here is that first we can actually annotate cell type onto different cell type level. And secondly, we can utilize multiple references. So here I select three references. So they are either generated from SISIC data, so which means that they have protein data. So, which means that they have protein data, so we give a more reliable cell type annotation, or they are generated from the whole blood, so they will have cells like neutral fields that are usually not captured by PBMC data set. And utilizing this method that we are able to annotate and unify the annotation of the 20 studies. And then, next, we would like to remove the study effect from the gene expression. So, earlier, we have So earlier we have developed a method called SCMERGE, which is based on an IUV3 model, which is similar to what Argus has presented on Tuesday. So basically we model our gene expression data by using two components. So first component is a biological variation data and second is we model the unwanted variation. So the idea here is that we want to estimate the unwanted variation use same Wanted evaluation using two main by borrowing two main information. So one is the negative control genes. The second is that we want to utilize kind of the pseudo-replicas. So pseudo-replicas is trying to identify the cells that are similar across the study. So usually this will be kind of like the cell type information. So it's like we can actually use the cell type annotation from the previous step. The previous step. So SEMERGE was relatively powerful in 2019 when we published it because at that time the average of sales per study is around 1,000. But now as the technology actually explodes, so now we are actually now dealing with million scales of data. So now we actually need to, and also the data structure has become more complex. So to deal with the three main challenges, To deal with the three main challenges I have just mentioned, we actually come up with three strategies that we think is useful for data integration. So first is that the hierarchical data set merging. So we first merge within each of the study or we merge the study that have a similar characteristic and then we merge all the data set as a whole. And secondly, when we construct the pseudo-replicas now instead of just Of just doing the cell types across all phenotypes, now we construct a phenotype-specific pseudo-replicate. And finally, instead of estimate the models using all the cells, we try to aggregate the cells first to construct pseudobox and utilizing suitable to actually estimate the W alpha in the model. So, this strategy actually gives very good results. So, FC. So, as you can see here, compared to the SC Merge 2, so SC Merge 2-H is indicated that we have the hierarchy, we utilize a hierarchical strategy, actually significant improve in terms of the cell type identification performance compared to H3MERS2. Also, there are two other methods that actually have some sort of similar idea, but H3MERS2 actually allows a Allows a more flexible hierarchical merging strategy compared to the two methods which only allows to do pairwise merging. So and also utilizing pseudo-bulk, we have significantly improved our computational time. So in SEMERGE, it requires around four hours to for fifty thousand 50,000 cells, but for SMS2, this task can be finished within 10 minutes. And for 1 million cells task, it can be finished in 1 hour. So all these strategies allows us now to integrate this 5 million cells and 1,000 individual data sets. And this is showing that SIMERSH is able to remove the study effect and as well as to preserve the cell time information. To preserve the cell type information. And with this integrated metric, so now we can think about what actually we can be done with this data set. So one thing we can be doing is that we can utilize the cell type specific expression to actually predict the patient's severity. And we can also compare with different cell types to see what are the cell types that have a highest DC power. So we can see that. Power. So we can see that utilizing the integrated matrix, we can improve the accuracy rate. And also, what we can notice here is the CD14 monocyte actually gives the highest accuracy rate across all the cell parties. And then we can actually zoom into the cells and then perform some de-analysis to look at what are the how are the cells are like behave differently between the motor and severe patients. In severe patients. So, and then we can perform the gene enrichment analysis to see what kind of genes are associated with it. So, another advantage of this is actually we can now increase the sample size of a certain patient group. So, this is showing using the age group as an example. So, if we zoom into 41 to 50 patients here, it studies. Patient here, each study may have only 10 to 25 patients that is from this age group. But if we aggregate all the 20 studies, now we can actually have 150 patients that belong to this age group. So now by increasing the sample size here, we can actually perform some interesting meta-analysis between different age groups. So this is one example we're trying to understand. One example, we try to answer a question to the mechanism behind the mild severe patients are different in different age groups. So, what I mean by this is I try to compare the moderate severe within 41 to 15 and also the moderate and severe within the 71 and 8. So how can we actually summarize this single cell matrix? Summarize this single-cell matrix to the individual data. So, Yule from our group have developed these interesting methods that try to summarize the genes by cell matrix to feature to one vector for each of the individual. So, these features could include like some type of portion, some type of specific expression, some type of interaction, and so on. And by utilizing this vector, so now we This worker, so now we have samples, features by sample matrix, and then we can actually perform some machine learning to identify what features have a highest accuracy rate to predict the patient severity. So it's interesting here that we can see that this is the pathway of commerciality. So it actually has a low accuracy rate in 41 to 58 true. 41 to 50 A true, but actually has a very high accuracy rate in the 71 to 80. So, which means that if you use the commability, you can actually predict well in the older group. So, then we can actually look at what are the features that are actually contributed to this condition. And lastly, I would like to introduce the work that I collaborate with Joe Trust team. Trust team. So we actually have put all the 20 data sets and also the metadata, integrated data, and also the cell time annotation into a well-created open web resource. So this actually can allow you to download and subset the data quickly to look at the data and explore the data. And so this is the summary. So we present a scalable workflow using SE Classify and SEMERSE to And SIMERGE2 to analyze these COVID data sets. And also, I would like to mention SIMERGE2 actually can be generalized to other cell types in single-cell data set, including size and spatial transmutomics. And if you are interested in our method, it is available in bioRxiv and hopefully will be published soon and in the GitHub. And lastly, I would like to acknowledge the people that I have been working on. I have been working on in these three projects. Yes, so and also all the members from Sydney Precision Data Science Center. Thank you. Maybe one quick question for Nising and maybe one up in January. You can do stuff. It's always possible. So your SD plus but sorry SD merge work. How would you calculate just in rendering that work? Did you have that just in writing that? What did the ground show come from? Where did you compare two questions? So for the one that you just saw is still from the original paper annotations. Quite a bit of disagreement.