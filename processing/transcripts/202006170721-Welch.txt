Or, good evening. My name is Josh Welch. I'm an assistant professor at the University of Michigan in the Computational Medicine and Bioinformatics Department. And thanks very much to Alana and Kim On and Adin for putting on this great workshop. It's really been enjoyable so far. So I'm going to talk to you this morning about analyzing the SCNM T-Seq data perhaps in a different way than the other speakers. Than the other speakers. So, I wanted to start by sharing a taxonomy of how I think about single-cell data integration algorithms. So, if you think about the different kinds of single-cell data that we might want to integrate, there are measurements that can only be performed on different cells, like single-cell RNA-seq and single-nucleus attack-seq are generally performed on different cells, although there are some really Although there are some really nice cutting-edge protocols like SCNMT-Seq that give you data from the same cells. So, one scenario is we might want to integrate these different modalities from different cells, or we could integrate them from the same cells like with SC, NMT-Seq, or SNARE-Seq, which I'll talk about a little later. And then if we look at data from the same modality from different cells, there's a number of sort of batch correction-like methods out there. Like methods out there for addressing these challenges. And then, if we look at cases where the different cells are measuring different modalities, perhaps the list gets shorter, but there are still a couple of methods, including Serat V3 and Lager, which I'll introduce in a moment. And sort of the way that people have proceeded with this problem is to make the assumption that there are shared features across the different modalities. Features across the different modalities, which allows you to identify a shared set of co-expressed genes or biological signals that you can use to link cells across modalities. And then maybe the hardest case is where you have different cells, different modalities, and no shared features. And there actually is a little bit of work in investigating how to integrate these types of data sets. An example of this. An example of this sort of integration would be if you want to try to link single-cell RNA-seq data and single-cell high-C data from different cells. And this is an even more challenging problem because there's no clear way to link at a gene level the chromatin conformation of a gene with its expression. But there are some unsupervised manifold alignment techniques, such as MATCHER, which I developed, and MMDMA, and a few others. And MMDMA and a few others that can address this problem. So, what I'm going to focus on for the rest of the talk is the different cells, different modality, shared features case. And just to give a little bit more motivation for why we would want to do this sort of integration, there are many published data sets where either single-cell RNA-seq or some other modality are available from Modality are available from cells of the same population, but not from the exact same cells. And so, if we could somehow link the cells of these different modalities, we could use the multiple types of information to jointly cluster the cells. And I'll give an example in a little bit of how we can use this approach to construct a cell atlas of a tissue using multiple modes. Tissue using multiple modalities that were measured on different single cells. So we can perform joint clustering, and then if we're able to link these cells across modalities by using this shared feature assumption, we can infer pseudo-multiomic profiles, which allow us to answer some of the same questions that you could answer if you actually had simultaneous measurements from the same cells. And then this can also allow us to look at some differences and similarities among modalities. And similarities among modalities. For example, local decoupling between a gene and its promoter or nearby enhancers. So I developed an approach called LIGER, which stands for Linked Inference of Genomic Experimental Relationships. And the approach takes as input a set of single-cell matrices that are each cell by That are each cell by gene matrices but have a shared set of gene-level features. And there are a number of different contexts in which you could get data sets like this, such as multiple single-cell RNA-seq experiments across individuals or species, or even data sets of different modalities like single-cell RNA, single-cell attack-seq, single-cell DNA methylation, or spatial transcriptomic data. And LIGER proceeds by using a joint non- By using a joint non-negative matrix factorization approach to identify a set of shared and data set-specific metagenes. And the fact that LIGER uses these both shared and data set-specific metagenes allows a lot of robustness and flexibility in modeling very different data sets. And so this allows us to identify a joint set of clusters that are inferred using the information from all of the data sets or motor. From all of the data sets or modalities that are available. So, now I'm going to walk you through a couple of ways that we've used Lager previously and then show how we can use the true multimodal measurements of SCNMT-Seq and SNARE-Seq to try to validate this sort of integration of different modalities from different cells. So, in our paper that we published. So, in our paper that we published last year, we showed that we could integrate single-cell RNA-seq with SNMC-seq, which is a high-throughput DNA methylation profiling experiment from single cells. And the data set that we used is from mouse cortex. And using LIGER, we were able to identify a very strong alignment between the RNA and methylation. In brief, we assumed that the gene body, non-CG methylation, for a Non-CG methylation for a gene is inversely correlated with its expression. And this is a little bit of a funky special case because in neurons specifically, there's this inverse gene-body relationship, whereas in most cell types, there's a small positive correlation between gene-body methylation and expression. But in any case, using that inverse correlation assumption, we were able to construct shared features that we use to link these data sets. That we used to link these data sets. And this resulted in a very concordant set of joint cell types where all of the cell types were shared across both the RNA and methylation data sets. And if we looked at the published cluster annotations from each of the data sets individually, the joint clusters accorded very well with the published analyses. There's a couple of advantages of doing this. There's a couple of advantages of doing this type of integration in this case. One was that we were able to better identify ambiguous cell types from the methylation data. And the annotation of cell types from methylation alone is quite challenging because most of the cell type markers that are known are expression markers. And so we were able to identify that a cluster that was annotated as deep layer three actually corresponds to cells from the clostrum. And it turned out that the lineage markers that were known in this case. The lineage markers that were known in this case tended to have overall low methylation and were difficult to distinguish. So, having the expression allowed us to disambiguate this population. We were also able to better resolve methylation subtypes than in the initial analysis of the methylation alone, and we identified a total of 12 subtypes of the MGE interneurons compared to three in the original study. And we were even able to identify a very rare population that only had represented 0.1%. Only had represented 0.1% of all cortical cells. And more recently, we applied Lager to a massive data set that was generated as part of the Brain Initiative Cell Census Network, which has the goal of mapping all the cell types in the mouse and human brains. And in the pilot phase, they generated a data set of about 600,000 single-cell profiles from one region of the brain, the motor cortex. And the data set that we integrated consisted of eight individual single-cell data sets generated from five prototypes. Single-cell data sets generated from five protocols and four labs. And it included RNA, attack-seq, and methylation. After filtering, there were over 400,000 cells and nuclei. And using LIGER, we were able to put all of these data sets together into a single joint latent space and perform joint clustering. And we observed very strong concordance across all of the data sets and modalities, and we're able to align them very well and identify the dominant populations of the motor cortex. Motor cortex. And if we zoom in and do sub-analyses on the main subclasses of cells, we were able to identify even more structure that was shared across the modalities. And we ultimately identified a total of 56 joint clusters corresponding to neuronal and non-neuronal populations. So that's how we've used LIGRE previously. And when I saw the data set for this hackathon, I was excited for the chance to try out LIGRE. To try out LIGRE on this data set because it gives a chance to validate these predictions that we're making of links across the different modalities. Because here we actually know the true correspondences between cells. So the analyses that I'm going to show next, we treat the modalities as if they were measured on separate cells and see how well we're able to recover the original known cell correspondences. So this is what we get if we look at the unlike. If we look at the unaligned latent space that Liger produces, the H factors. And what this shows is that the stages separate very well from both the chromatin data as well as the gene expression data. But if you look at the lineages, there's still clear separation in the gene expression data, but much less clear separation in the chromatin data. And this was also true for the methylate. Chromatin data. And this was also true for the methylation. So then I tried using LIGER to align the latent spaces. And the results were a little surprising and disappointing. So the result was that the modalities did not align well. And I'm showing here the analysis from the chromatin data, but a similar result occurs if you use the methylation data or all three at the same time. And if we quantify the degree of alignment between these data sets using our alignment metric that we used in the Liger paper, the alignment metric is 0.44, where 0 is complete separation and 1 is perfect alignment. So this is quite poor alignment, which you can see qualitatively in the TSNE plot. And if you look at the lineages, they are not well separated in the chromatin data. Data. So I was a little surprised by this, but after talking with Rickard, it sounds like maybe this result is not completely unexpected given the unique biology of the embryo. And so since we used promoter in gene body chromatin and methylation profiles, it seems that in the embryo, in the early embryo, there may be a sort of epigenomic decoupling between the promoter. Coupling between the promoter state and the expression of the nearby gene. And I took a couple figures from Ricard's nature paper from last year that demonstrate this point. So here you can see that the overall correlation between a promoter and nearby gene expression for both methylation and chromatin is quite low, except for a handful of statistically significant genes. And this is actually quite different from. And this is actually quite different from the scenario in the adult mouse neuron. So, another point that Rickard pointed out to me recently is that his MOFA analysis suggests that enhancers may be much more predictive of gene expression than promoters. And so, this is a plot from figure two in his paper that indicates that the factors that explain most of the variants are related. Are related to distal enhancers rather than H3K4 trimethylated promoters. So, one future direction that we could look at is whether if we can somehow link these enhancers to genes, whether that gives us a better migration. So, I also decided to look at a different protocol, which is called SnareSeek, that was just very recently published. And this protocol uses a different strategy. Uses a different strategy to generate single-cell RNA-seq and single-cell attack-seq from the same cells. In brief, they treat the cells with TN5 before performing droplet generation so that the TN5 just kind of sits in the chromatin locally before it can be barcoded. And then they use a splint oligo to attach a poly A barcode to the transposed attagmented fragments. Fragments, which allows them to be captured by standard DropSeq beads. And the quality of the data is better than the previous protocol, SciCar, which was developed for generating a similar type of data. And the authors generated several data sets, including one from the adult mouse cortex. So I was curious to see if I could replicate my success from previous. My success from previous analyses of mouse brain. And indeed, if I separately integrate the RNA and ATTAC-seq from these measurements, they align quite well. And the alignment metric in contrast with the SCNMT-seq data is 0.85, which is still actually a little bit lower than what I would have expected. But there's a population of attack cells that don't align that brings down the alignment score. Down the alignment score, and these cells have much lower counts than the rest of the cells, so it's possible that they're just lower quality cells. But after this integration, I was able to identify jointly using the RNA and attack the dominant populations of the cortex, including intratelencephallic projecting excitatory neurons, non-IT excitatory neurons, inhibitatory neurons, and a couple of neurons. Neurons and a couple of glial populations. And if we plot the gene expression and chromatin accessibility of the same gene for several key markers of these populations, you can see that they correspond very well, which suggests that qualitatively we are aligning the cells to the right populations. But since we actually know the correspondence in this case, We actually know the correspondence in this case, we can look at use the ground truth cell correspondences to actually ask how many times are we correctly mapping two cells, two modalities from the same cell to the same cluster. And it turns out reassuringly that in most cases we are able to map the two halves of the same cell to the same cluster. So on the right I plotted a confusion So, on the right, I plotted a confusion matrix where I showed how many cells from cluster I get mapped also to cluster I between the two modalities. So ideally, we would have a matrix with white on the diagonal and a red, red off the diagonal. So, you can see from this plot that most of the mistakes are between closely related clusters, like sometimes we confuse layer 2, 3 IT. Layer 2,3 IT neurons with layer 4 IT neurons. It's much less common to confuse GABAergic neurons with L23 neurons, for example. And the other most frequent type of mistake is mismapping between the annotated clusters and the clusters that are annotated as unknown or the low counts attack cluster. So, this is reassuring and indicates that. Reassuring and indicates that, at least at a high level, we're able to recapitulate the known cell correspondences in this case. And one other benchmark that I performed was to look at the difference in counts between this SNAR-STEEK attack data and the regular 10x genomics attack-seq protocol. Attack-seq protocol. And as you can see here, the total number of fragments that fall in genes and promoters is actually much lower for the SNARE-seq data than the 10x data, which maybe explains why I saw slightly lower alignment than I was expecting on the snare-seq data. So the median counts in gene body and promoters is about 4,000 for the 10x data compared to about 1,700 for the SNARE-seq data. For the SNARE-seq data. So, at least for this particular protocol, you do pay somewhat of a penalty for having the modalities from the same cells. I think I didn't do the analysis formally, but my impression is the SCNMT-seq data actually has much more coverage than either of these protocols by virtue of the GPC strategy that they use when you measure chromatin as compared to the tagmentation strategy of attacks. Strategy of attack steek. Okay, could you just move to the conclusion slide, Josh? We are finished. That's it. Great, yes. So with that, I'll thank my students who helped with the analysis and my funding sources. And thank you for listening. Great. Thank you, Joshua. It was a really interesting talk. So unfortunately, we don't have time for the questions, but I'll put them in the Slack and you can answer them. Thank you. Thank you.