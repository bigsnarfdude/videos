We're going to move on to our next long talk that will be kicked off by ATM. Thank you. Go ahead and take a look at it. Thank you. So for those who don't know me, I'm a public health physician at Copec's Public Health Institute and a former physicist, which explains why I'm interested in math models for academics. So the work I'm presenting today is work that I've done when I was finishing my residency and I was a fellow at McGill with Caroline Wagner and Matthew Marie Gicoul. Wagner and Matsuma Rujipou. So, this work was started about two years ago, and I kept working on it at the Public Health Institute. And now, Simel Torres is a grad student. He's doing his master's with Carolyn, and he's contributed to this work. So, a lot of what you're going to see has been done by Sam Lawrence. So, in this presentation, what I want to do is describe to you the components of our dynamic transmission model for COVID-19 in Quebec, which we use. COVID-19 in Quebec, which we use to evaluate the vaccination policies that were implemented at the beginning of the pandemic. I'm going to explain also the algorithm that we use to calibrate the model to the observed data and present you what are the actual public policy questions that we're investigating and present some preliminary results. So in the province of Quebec, as much as the rest of Canada, COVID-19 started circulating in late February and early March 2020. And March 2020, and we've had like four distinct waves of infection between spring 2020 and early winter 2021, which were driven by three main variants: the wild type, alpha, and the delta variant. And the vaccines were first available about the end of December 2020, January 2021, but initially we had a significant shortage. There were not enough doses for the entire population, and so we needed to prioritize, let's say, basically define who was eligible to receive the vaccine. To receive the vaccine first. And our goal is to basically evaluate: were these strategies optimal? Could we have done better? Could we have prioritized in a different way so that more hospitalizations, more lives could have been saved? There are obviously no real work counterfactuals that are available to test alternative vaccine strategies. So basically, we relied on mathematical models to generate our counterfactuals and Counterfactuals and run alternative vaccine strategies through this model. So, the model that we chose is an SR type model, but highly modified. It's very similar to what Evan described in his presentation. We chose this for the simplicity and model formulation, but still we included a high level of stratification to try to achieve a good realism because for policy. Realism because for policy evaluation, it's very important to be as realistic as possible. If you're starting to tell people, well, you should have done this in a different way. Well, if we base that on the model, the model better be as realistic as you can. So we have, for the natural history of disease, we have eight types of compartments, uninfected individuals, infected individuals which are in contact with the community. And these people were split into latent, asymptomatic, presymptomatic, and symptomatic individuals. Basically, it's the only Basically, the overall structure is very similar to what we've seen before. We've added tracing and isolation in the model. So we have infectious individuals that are removed from being in contact with the overall community. And then we have hospitalizations, and that's from COVID-19. Additionally, we stratified our compartments for increasing the realism. So we stratified compartments by gender, by age. So we picked these six. So we picked these six age groups there to reflect disease severity by age and also what age groups were considered for vaccine prioritization in Quebec. So that's why we use these age groups. Vaccination status was basically stratified by number of doses received. We could have stratified by vaccine types also, but the model structure allowed for this, but we decided to keep it as simple as possible. We have three strains that are circulating in the model: the wild type. That are circulating in the model, the wild type, alpha variant, and delta variant, and each strain has its own transmissibility and disease severity parameters. We've seen, it has been observed that the transmissibility of each variant was different and that severity of disease might be different. We stratified also for immunity status. So each individual in each compartment is either immune or susceptible to infection, and that's specific to each strain also. So this makes for a lot of compartments. Makes for a lot of compartments. So, this is overall that's the structure of the compartments and the flow from one compartments to the other. But I won't spend much time with this because it's been seen in the previous talk. For vaccination, we considered only uninfected individuals to be eligible. And the way we derived how many doses we give in our model is to calibrate that from the vaccine coverage data that we had available in Quebec. We tried to look at the number of We tried to look at the number of doses, but the vaccine registry data was too inconsistent to be able to use directly the number of doses. So we inferred them from the coverage data, which was better. And the way that vaccination works in the model is basically when an individual gets vaccinated, its immunity profile is changed. So basically you may become immune if you are susceptible. And the immunity you gain is very inspecific. So just for information, I give the base values that we have, but in general, Base values that we have, but in general, the vaccine efficacies were a parameter that we calibrated, and I'll tell you how we calibrated it before. And vaccine efficacy was also stratified by age to reflect the variation in the immune response by age. So in the elderly, we allow vaccine efficacy to be so we have many other features that are included. So, for example, we have detailed contact matrices. So, basically, we use the pre-pandemic matrices. The pre-pandemic matrices that were measured in the Connect study, the one by McNisson's group, where the contacts are divided into different types. So you have contacts at home, at school, at work, in transport, in leisures, and different activities. So there are various types of contacts, and that's very useful because when we want to model the non-pharmacological interventions, say school closures, we can shut off one of the contacts specifically. The contacts are also stratified by age and possibly by family. By age and possibly by vaccine status as well. And we changed the contact patterns based on the timeline of government mandates during the first four weeks. So that's how we decided. So basically we looked at every mandate that was implemented, what should it affect? And so then we said, well, these types of contacts should be more effective than others. And that's how we tried to mimic the effect of the MPIs. So just to give you an idea of what the contact matrices in the model look like, so this is for In the model, look like. So, this is for home with children, home without children, leisure, school, work. So, it's mostly assortative contacts. So, basically, people in the same age group tend to mix together more. Except for home with children, you see that there are contacts between here, between adults and children. But otherwise, it's very much people in the same age groups tend to mix together. And so, how we built the cheat. The impact of the NPIs on the contact matrices. Basically, you have a complete contact matrix that's kind of a linear combination of all the types of contacts that we have. And these kappa coefficients are model parameters that we calibrate. So basically, these are going to be determined by the model calibration. And so that's just to give you an idea of how we approach NPIs in our model. We also include cross-protection. We also include cross-protection. So, basically, if you recover from an infection by the wild-type strain, you can get protection from the delta variant when it's going to arrive later on. So, this is a feature that we wanted to have. We also included the waning of immunity, but we did not consider hybrid immunity because the Omicron variant did not arrive yet, and hybrid immunity is really more relevant for that portion of the pandemic. And for severe outcomes, we did not. And for severe outcomes, we did not include waning because we had fairly reliable information that immunity against severe outcomes tended to last much longer than immunity against infection. So we simplified the model by having no winning against severe outcomes. And for each wave, we only model the transmission of the relevant variants to speed up the calculations because otherwise you end up with too many compartments. So, this type of model has a lot of advantages. A lot of advantages. I mean, it's that we have a fairly high level of realism for a compartmental model. I think we have a lot of stratification that is capable to include a lot of different dynamics. We have high flexibility to model a wide range of public health interventions pretty specifically, but the main limitation is it requires a lot of compartments. I mean, we have, if we stratified as much as we can, we can have like thousands and thousands and thousands of compartments. So that's an issue, and it makes for That's an issue, and it makes for fairly long runtime for the model. So, you run it once, it can take a few minutes. So, when you try to calibrate and you have to run it like hundreds of thousands of times, then you need supercomputer and it takes weeks. So, that's the main drawback of this approach. And the high number of model parameters also makes calibration more difficult. So, that's kind of the drawback of trying to be realistic with a compartmental model. But you'll see that we still were able to make it work very well. They also make it work very well. So, I want to switch to calibration. So, basically, for those of you who don't really know what calibration is, it's the idea of identifying which set of model parameter values best reproduce observed data. So, you don't know all the values of model parameters, but you have to try to pinpoint them as best as you can. One way is to look at the literature for the model parameters that are fairly well known, but the other way around, for the parameters where you don't have good value. Parameters where you don't have good values, you basically have to do trial and error until you find which ones are the best. And the data we used for calibrating our model were the time series of new hospitalizations stratified per age group in Quebec during the first almost two years of the pandemic, and also the time series of proportion of cases attributed to each variant, so that we can model type replacement fairly accurately. So, we did not use case data for calibration. We tried. Use case data for calibration. We tried, but it turned out that we had it was too difficult. And I don't think it's because we had the wrong approach, it's probably because the case data was not good enough. It was not clean enough, and I don't think it really represented transmission well enough. Hospitalizations were doing a much better job at reproducing transmission. So this is our epidemiological target data for hospitalizations. So that's the time series of new daily hospitalizations attributable. Hospitalizations attributable to COVID in each age group that we have. So that's the data that we wanted our model to match. And for the proportion of cases per strain, so basically when the alpha variant arrived, it gradually replaced the wild type strain, and that's the curve that you see here. So that's how the proportion of cases attributed to the alpha variant changed with time as it replaced the wild type strain. And the same thing when delta arrived, it replaced the alpha variant. Arrived at replaced the alpha variant. And what you see here, the dashed lines are logistic growth curves that we fit to this data. And the model was calibrated to the logistic growth fits. And it's the technical reason why we chose to do this instead of calibrating to the data points. But basically, it just worked better with the logistic growth curves. So which model parameters do we need to calibrate? So which are well-known and which are less well-known? Are less well known. So basically, it's the parameters of natural history of disease that we know very well. We can look at the literature, for example, the duration of latency, the duration of infectiousness. Those are parameters that we felt that were very reliable, and we decided to just pick them out of the literature and set them fixed. You don't touch them, and you try to fit the model with those parameters. No. Parameters that were not that well known that we needed to calibrate were the transmissibility of each variant, was the probability of getting infinity. Variant was the probability of getting infected by contact. The impact of the NPI is on contact patterns, so the government gives a mandate, but who knows how well the population responds to it. So we did not know how the contacts were affected by the mandate, so we had to calibrate these. Capacity to trace an isolate cases, especially asymptomatic cases that are infectious. So these were, it's very difficult to have an idea of how well we were able to trace these cases. Trace these cases and remove them from the pool of cases that we're transmitting to the community. What are the proportion of cases that remain asymptomatic? The proportion of cases that are hospitalized per age group, those were not parameters that were that well described. The real world vaccine effectiveness, we have clinical trials, but in the real world it might work a bit differently. And also the seeding of new variants. So when the new variants arrived, how they were explained. Arrived, how they were incorporated, so what was the importation basically of the cases? So we did not have very good data on this in Quebec, so this was another parameter that was calibrated. So how do we do the actual calibration? So we picked a method that's called the ABC-SMC. It's based in Monte Carlo simulation. So the main idea is to sequentially generate ensembles of model parameters that progressively fit the data better and better. Fit the data better and better. I mean, the space of model parameters that we have is so huge that you cannot possibly hope to sample it at random and think that you're going to find out all possible solutions. So the idea is to basically, at first, you sample from prior distributions that you think are fairly well representative of what your model parameters might be. You do a bunch of samples from these, you run the model, and you check whether the model fits well the data or not. If it fits, The data or not. If it fits fairly well, at first, you know, by fitting fairly well, you're being very generous at the beginning. So you don't say it has to fit really well, just fairly well. And then you keep those sets of parameters, and the ones that don't work, you reject them. And once you have accepted a certain number of parameter sets, you say, okay, I've done enough with this generous strategy. I'm gonna start again with refining a little bit. I'm gonna be a little bit more careful as to what I say is a good fit. What I say is a good fit. So you start again, but you sample from the parameter sets that you've already accepted. And you repeat that, you repeat that gradually until you find a really good ensemble of parameters that fit, that makes the model fit well the data. So that's the overall spirit of ABC SMC. And just out of curiosity, that approach will end up like you'll end up with a set of parameters, but not necessarily a Set of parameters, but not necessarily error bounds on the estimates. Is that what's different with MCMC? You can. You can get error bounds, and I'm going to try to show you how it works. Basically, what you end up with is a sample of the posterior distribution at the end. Once you've made your tolerance criteria, that they're saying, like, okay, this is a good fit to my data. And at the end, you're very, very strict about what a good fit is. Then, what you're going to add. Good fit is, then what you're going to end up, the sets of parameters that you have, are essentially a sample of the true posterior distribution in some limit. And so from that, you can derive all sorts of error estimates and so forth. So those are approximate results. So it's not quite done yet, but I'm showing you here calibrated results for the first four waves of the pandemic and the adult age groups for hospitalizations. Groups for hospitalizations. And so you see that we're fairly capable of reproducing the overall shape of hospitalization curves in different age groups simultaneously. So with the same set of contact and the same set of parameters. And so that's what it looks like. So each curve here is one accepted particle, but we're going to have to present these results a little bit better by taking the mean and giving some credibility intervals. So that's preliminary, but at least it shows that the algorithm is capable of selecting. That the algorithm is capable of selecting and finding good parameters for the model. That's the fit to the logistic growth curve for the type replacement. So the model is capable of reproducing very, very precisely how well the alpha variant replaced the wild type and how well delta replaced the alpha variant. So we're very confident that we have very good transmissibility parameters for variants in the model. So that wraps up basically what I wanted to tell you about this model. About this model that we use, and now what do we use it for? It's for vaccine policy evaluation. So, as I said in my intro, so we have first vaccines arrived at the end of December 2020, but there were not enough doses for everyone. So, how do we decide to prioritize who do we give the vaccine to at first? And basically, what was decided in Quebec was to start from the elderly and gradually go down to the youngest age group. That's what was decided. And it was also decided to give one dose to as many. And it was also decided to give one dose to as many people as possible. And that went against what the vaccine manufacturers were saying. They were saying at that time: you give one dose to a bunch of people and you save the rest of the doses. You have to give a second dose later. But it was decided not to do that. It's decided, no, we just give one dose to as many people as possible and it's going to save more lives. And so, this is one aspect that we hope to investigate with this model. Is that a good idea? So, there are many questions. So, there are many questions that we can ask ourselves. So, was our strategy optimal? Could we have done better? Could we have distributed the doses in a different way in the early waves of the pandemic when there was a shortage to do better? And one question is that, could we have done better at protecting the elderly by spreading out the doses to try to gain some herd immunity effect in the younger age groups instead of aiming for direct protection of every individual and the the most vulnerable. Individual and the most vulnerable each group. And before Omicron, the vaccine was fairly decent at interrupting transmission. The vaccine efficacy against transmission was not so bad then. With Omicron, that changed. I mean, nobody is hoping to get herd immunity against infection with Omicron. It's not possible. But back then, it could have been the possibility. So, what we do is basically we test different vaccine strategies, is basically just, well, Strategies is basically just, well, let's prioritize these age groups instead of these other age groups. So we have a bunch of scenarios here where basically scenario A is we distribute those as equally in the youngest age group. So of course this is not realistic, but we wanted to see what would happen in the model if we go that route just to get a sense of basically how protecting these people is that going to give a good herd immunity elsewhere. And so that was a way to kind of probe our contact matrices to see how. Our contact matrices to see how the contacts work. And so, for example, this strategy here, strategy E, is instead vaccinating equally all adults and see what would happen then. What would the actual strategy look like on that picture? What would the strategy that was employed by Quebec, what would it look like if you were to? It would look like basically starting with this and then moving to this and then moving to this. Moving to this and then moving to this. Yeah, that's what it would look like. So, of course, in these strategies, this picture is not complete actually, because it's possible that, well, once you've vaccinated everybody here, then do you stop vaccinating? No, that's not true. After that, there's a sequence that occurs, and it's kind of hard to plot. So, we're going to have to think of a way to better represent what our entire strategies look like. Yes. But the main idea is to come up with alternative priorities. To come up with alternative prioritization schemes and test them and see which one goes better. So, basically, I just said all of that. And I just want to add that we considered vaccine hesitancy in our scenarios because vaccine uptake is not as high in the 1849 age groups as it is in the elderly. So, basically, if we decide to prioritize the 1849, we have to stop before reaching 100% coverage because there's no way that this would have been achieved in reality. So, we have like tax. So we have taps on the maximum coverage that can be achieved in each age group based on vaccine as it is data. And our preliminary results, I'm not going to give numbers because we haven't really fully validated them yet and it's kind of a sensitive issue. So I want to be extra careful before giving numbers on that. But what we find is that there are certain strategies that could have led to gains in the adult age groups. The adult age groups regarding hospitalizations while maintaining what we had in the elderly. And basically, there are strategies where we've spread out the vaccines a little bit, especially in the 1849 age groups, which seem to be the main driver of transmission in that model. It was not the youngest, basically, because schools were closed a lot during that period. So it was really the 1849 that seemed to be the main drivers of transmission. So if we try to vaccinate those people, we could see gains through herd immunity. Could see gains through herd immunity. But in practice, how do you implement that? Because it raises all sorts of equity issues. So if you say, well, we're prior, we give the vaccine to all adults, but non-adults can get them. So how do you decide who gets vaccinated? So there are practical implications with these types of strategies that I want to discuss and makes them possibly difficult to implement in reality. But still, it's interesting to see that there could be strategies that would have done better. Could be strategies that would have done better. But overall, the strategy implemented by the Quebec government was nearly optimal in the older stage groups. It was very difficult to do better. It was possible, but it was nearly optimal. So just for order of magnitude, we could have saved maybe 100 or 200 hospitalizations more over a total of like 9,000. So it's not that big of a difference. The main gains are really in the younger regimes. So future works, well, we have to run. Future works. Well, we have to run all our vaccination scenarios with the fully calibrated model. So, right now, we're ending our work to calibrating the delta wave. So, we have the first three waves fairly well calibrated, but the delta wave is not done yet. So, we have to rerun everything. And we still have to look at the scenario where we save doses for a second dose. We haven't looked at that yet, so that's part of what we're going to investigate. And we want to also use eventually this model to evaluate the vaccine passport policy that was implemented during the Delta Wave. That was implemented during the Delta Wave. That was very controversial, but we have this model that has all the structure that you need to be able to look at this question. And so that's something that we're going to do in the future. So thank you very much for your attention. We'll be late in the afternoon.