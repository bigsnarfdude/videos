Yeah, okay. Can you hear me okay or no? Barbara, you should put it in the whole screen. I mean, full screen. Yeah, yeah, yeah. No, I was worried about the audio. Can you hear me all right? Yeah, now you're fine. All right. All right. Yeah, that's good. Okay. Now, just before you start, Barbara, you are the chair for the next session. Okay. Thank you. All right. So I'm going to talk to you this morning about catastrophes and queuing systems with time-varying periodic rates. This is joint work with Sharif Amar from Manofia University in Egypt, and he is with us today. And he is with us today. So it's really good to be here in Banff. And I wanted to thank the Banff staff and SN and also our organizers. So here's Java and there's Yicheng. And before I give you an overview of the talk, I'd like to tell you a very short story. Short story. So, this is a screenshot of a website called The Noctronists, and it's a collection of podcasts by medical professionals. Most of them are doctors, but the one that I'm going to tell you about today is by an AOC. And in this context, AOC means administrator on call. So she was an intern in the capacity of administrator on call. And during her second day at Day at 2:30 in the morning, she got a phone call from the hospital. And they woke her up and she said, What's the emergency? And they said, the refrigerator doesn't work. And so she's kind of nervous because it's the second day on the job and she doesn't really know what being on call entails in this capacity. So she says, Well, that doesn't sound too bad. Which refrigerator is it? So this is a story from the before time. From the before time, and the refrigerator was in the morgue. So she's thinking, okay, I'm going to have to deal with this crisis. What does that entail? What happens when the refrigerator in the morgue doesn't work? Are we concerned about the bodies beginning to smell? And they said, well, no, they start to leak fluids. So this is my example of a catastrophe. And in the before time, Catastrophe. And in the before time, deaths within a hospital system would exhibit a periodic trend that was not uniform over the course of the day or over the course of the week. And so we've got a periodic process which experiences catastrophes. And that's what the talk is about this morning. So here's an outline. I'm going to define for you what I call the key equations, which are The key equations, which are just the generating function equations in the case where we have periodic processes. So, first, just for a general quasi-birth-death process, and then for a quasi-birth-death process, but for it also having catastrophes. So, as most of you know, a quasi-birth-death process is one where level transitions are possible to adjacent levels or within the existing level. Existing level, and that's it. And that's where it gets the birth/death name. You can have a single birth or a single death, so you can go up a level or down a level. But we also allow catastrophes where we go to an unnumbered level in which repairs occur. Also in the background, I'm going to talk about the exponential generating function for the Bernoulli numbers. This has nothing to do with Q's, but the method that we use to analyze it, at least that I'm going to go through. Going to go through does have to do with the method that we're going to use to analyze the asymptotic periodic behavior of these queuing systems. Then next, I'm going to show you, not for quasi-birth-death processes, but just for a simple scalar birth-death process, the single-server queue, both without catastrophes and with catastrophes. And then we're going to look at an example of a QBD where the phase process is Erlang arrival. Processes Erlang arrivals without catastrophes and then with catastrophes. In each of these cases, we're going to be getting the exact solution for the level distribution for the asymptotic periodic distribution. And by that, I mean that for these ergodic queuing systems where transition rates are periodic, there will be an analog of the steady. An analog of the steady-state distribution when rates are constant that's the same for each time within the period. So that's what we're looking for. And we can get those exact distributions for these particular examples. So we study the asymptotic periodic distribution of queues with time-varying periodic rates and catastrophes that occur randomly according to an exponential distribution. When a disaster occurs, the system will reset all customers. The system will reset, all customers are lost, and an exponentially distributed time will go by while a repair is made. The asymptotic periodic distribution, as I mentioned a moment ago, is analogous to the steady state distribution when rates are constant. So next, we're going to derive the generating function equation for QBD without catastrophes, then with catastrophes, and then we're going to Then, with catastrophes, and then we're going to look at how these might be analyzed by examining the example of an exponential generating function, the exponential generating function for the Bernoulli numbers. So, QBDs, we've got a two-dimensional state space. X is the level of the process, and J is the phase of the process. In this talk, we're just going to be looking at QBDs, that is, birth-death processes. That is birth/death processes, except that catastrophes are also allowed. When the catastrophe occurs, we go to an unnumbered state, which is the repair state. And the processes are going to have periodic transition rates with period one. So here's the infinitesimal generator for a QBD. The B's and A's here are block matrices. They're functions of time within the period. And below we have And below, we have a system of differential equations. These guys are vectors with one component for each phase that the process can occupy. So here's the key equation. This is simply the result of we multiply this equation by z to the n, we sum them all up, we get a differential equation for the different generating function. Generating function. We use the technique from the first week of differential equations, method of integrating factors, and we can solve this up to an integral equation. And then in the case where it's periodic, we assume that at time t minus one, pzt is equal to pzt minus one. And so we get this factor here. And it's the zeros of this, the determinant of this matrix that govern the asymptotic. That govern the asymptotic behavior of the system. So, if we can figure out the zeros of that, that will be the poles of the generating function. If we know the poles of the generating function, we can get an asymptotic formula for the level distribution. And in the examples that we're looking at today, we can actually get an exact formula. So, moving from the case without catastrophes to the case with catastrophes, the stuff highlighted. With catastrophes, the stuff highlighted in green is all that's different. Eta is my repair rate, and that first row represents my state when the system is broken down. A catastrophe has occurred, and we're repairing it at rate eta. Gamma is the rate at which the catastrophes occur, and it's the same for any level within the process. So, but for this column, this is just a QBD, and so. And so that's the basic structure there. And so the key equation for the generating function is very similar. And I've highlighted in green what's different. These guys are also different. They're multiplied by this exponential that gives the rate at which the catastrophes occur in the exponent. So, and the system of differential equations is basically the same, except we've got this unnumbered repair. This unnumbered repair state, and then we've got the possibility of having a catastrophe occur. So now we're going to step back and we're going to look at Bernoulli, the exponential generating function for the Bernoulli numbers. And so this is just like an ordinary differential ordinary generating function, rather, except that we're dividing by n factorial. By n factorial. So if we've got a sequence a n, the exponential generating function is just the sum n equals 0 to infinity of a n times z n over n factorial. So this EGF or exponential generating function for the Bernoulli numbers is this. It's going to have poles wherever e to the z here is equal to 1. And of course, that occurs at 2 pi ik for any. At 2π ik for any integer k. And so we can get a formula for the Bernoulli numbers from this generating function by reading off the coefficients on z to the n over n factorial of this generating function. And we can get those coefficients by using these poles. So this thing I didn't bother to put in a box. This thing I didn't bother to put in a box is a theorem that we're going to be using for analyzing our queuing systems. This is a simplified version of a result from Flagelet and Sedgwick. I'm just looking at generating functions where there are only poles of multiplicity of one. And in that case, the coefficient on z to the n is just going to be given by this. Is just going to be given by this formula where there's some error, this magnitude, where that capital R is the contour in the complex plane if we use the Cauchy integral formula to get the coefficients of the generating function. So we're going to use that approach to analyze the Bernoulli numbers. So basically, So basically, what we do is we take R and we encircle some of the, let me get rid of him for a second, we encircle some of the poles and we just let R increase until we've got the entire complex plane. And because the Cauchy kernel is z to the minus n minus one, that's going to decrease as an inverse power of capital R, and so that will converge. And so that will converge. So, usually, I would have a picture of Bernoulli here. This fellow is, he wrote the piece of MATLAB code that I've adapted to help with the visualization of the complex numbers. So this is the generating function. This is a graph of the generating function for the Bernoulli numbers. The colors here represent, if I express Z. represent, if I express Z as R times EI theta, the colors represent theta, different values of the angle, and the kind of quilting represents the modulus. The black circle is a unit circle, which is irrelevant for the Bernoulli generating function, but it matters for the probability generating functions. So what we're seeing here, see if I can get this to pause. There we go. What we're seeing here is where all the colors What we're seeing here is where all the colors come together, that's a pole. And so I'm pushing my contour further and further out so it incorporates more of these poles. And eventually I get the entire plane. And what that corresponds to is an infinite sum. I'll show you in a minute. So here's the Bernoulli generating function again, the EGF. This means give me the coefficient. This means give me the coefficient on z to the n. So, since this is an exponential generating function, the coefficient on z to the n will be the Bernoulli number divided by n factorial. Remember that this z over ez minus one is asymptotic to one of these roots. Oh, that's going to cause me trouble. Okay. Okay, let me second here. Uh, we'll make a video. Okay. Sorry about that. Sorry about that. All right, so rather than try and draw on that so that I don't get the thing changing sizes on me, remember that this is asymptotic here to this expression. So if I divide that through by chi k, numerator and denominator, I'm going to have 1 over z over chi k minus 1. Z over chi k minus 1. And you'll recognize that as just being geometric. And so we can express it as the coefficient on z to the n of the term corresponding to 1 over 1 minus z over chi k is just being this thing. And if we sum over all of those residues, we're going to get that formula. And this is just rewriting it, noting that we're excluding zero from our sum. We factor zero from our sum, we factor out the common term of 2πi to the n. This picture would correspond to something from up to just up to 2 because I've got the residues from minus 2 to plus 2 showing there. And so this gives me a formula for e to the n over n factorial. It's just this guy when n is even. And so I can solve for the nth Bernoulli number. For the nth Bernoulli number. And if I truncate my infinite sum, it's just going to behave like a constant times a zeta function, my error, the tail of it. So that's my basic approach. So why am I talking about the Bernoulli numbers in the midst of a queuing talk? Well, let's now let's look at the single server queue. So here's my key equation there. And this term comes from the periodicity. Remember, we're comes from the periodicity. Remember, we're assuming that Pz of t is equal to Pz of t minus one. And so when we solve our equation for Pz of t, we get this factor. And so we treat it just like the denominator of the Bernoulli number exponential generating function. And we're going to have poles there where that's equal to zero. So that happens when that exponent is equal to two pi i k. And those solutions are given here. And you'll notice I don't have the minus one here. That's because we're working with a probability generating function. And when this solution, when we pick the negative of the pair when you're solving a quadratic equation, right, this is quadratic because I've got, if I multiply through by z, this will be z squared over here. And so I've got a quadratic equation. So it's going to have two solutions. I don't want the negative solution because that's inside the. Negative solution because that's inside the unit circle. And if those were not removable poles, removable singularities, then that would mean it's not an ergodic stochastic process because it wouldn't converge inside the unit circle. So all those guys are, they don't count, basically. So here's my picture. So here's my picture of the generating function for the single server Q with this particular periodic rates for lambda and mu. We are inside the unit circle. The unit circle is black and you'll see it as we zoom out. All these pretty things, these are zeros of the generating function. So what I'm, I'm sorry, poles of the generating function. What I'm graphing here is the denominator. If I had the numerator as well, then the zeros in the numerator would Then the zeros in the numerator would cancel these out. So we're zooming out. Here on the right, we've got an approximation. The red is the ordinary differential equation solution, and the blue is our asymptotic solution. So let me see if I can stop this. So this is the approximation when I sum from minus one to one. So this is the singularity corresponding to minus one, to zero, and to one. But it's not very good. But let's go out a little bit further. But let's go out a little bit further. And so those are in sync. And just test my coordination here. So we really don't have to go out very far before the approximation is excellent, and it is exact if we were to take the infinite sum of all those terms. So let me. So let me and here's what the exact solution looks like. So I just here's my to get the probability of being in level L, I just take this general formula and multiply it by the root to the minus L power and sum over all those for all For all the different roots k. But I can truncate it at a fairly short time and get a very excellent approximation. Okay, so now we're shifting to catastrophes. This is the key equation for catastrophes. It's barely different than for the MM1Q. I've just got, I've got this term, and then in here, and in here, I've got a gamma factor. And then there's this repair state. Repair state. But basically, it's the same. And so my roots are these guys. There should be a minus one here, but again, that's inside the unit circle. So I ignore that because it's also a zero of the denominator. Same deal. So the blue is the approximation when I just take a single term. And as I pan further out, I'm going to be taking more and more terms. And you'll see the singularities appear in a column here. Singularities appear in a column here on the right. And down here at the bottom, these are the arrival rate, the departure rate, the catastrophe rate, and the repair rate. Okay, so that's the now we're going to look at the Now, now we're going to look at the QBD, not just scalar. So, here's the key equation specified to the airline arrivals. And I haven't told you what these matrices H and H inverse are. They don't depend on time. So they're constant. They do depend on Z, but they don't depend on time. That matrix that I just showed you is H, and then this diag H inverse. A component that's m off of the diagonal is given by this formula here. And so you can see where we're going to get our poles from. And so that yields this formula. Notice that the columns of this matrix, this column times chi to the one over k will give me the next column, and this one times chi to the one over k will give me the next column. So I can write. Give me the next column. So I can write this formula very compactly, like this. And I should have used a different letter than Q, so let me just call that D G because it's not the repair rate, it's just some function. So you can get this very simple formula for the probability of being in level N, phase J, at time T within the period. And here's some examples. This is with, this is level one, phase zero, when I've got six possible phases for my Erlang district. Possible phases for my Erlang distribution. The blue is a single term of that asymptotic approximation, and the red is the ordinary differential equation result. And so, you know, you really can't tell the difference when I've got three terms, minus one, zero, and one. This is level one, phase five. And just take a few terms. If I take my rates and I multiply them by 10, My rates and I multiply them by 10. It takes a little bit longer to converge, but it still does it. And here's phase five. Phase five takes a little longer to converge than phase one, but there you go. So in the case where we've got the phase distribution, the QBD distribution and we've got catastrophes, we just make these couple of adjustments, and this is adjusted too with the gamma. And two with the gamma in the exponent. And so here's the asymptotic approximation with just a single term, and we would just sum over all of the poles chi m so I'm going to show you some references and then give you a summary statement. So these guys are about catastrophe. About catastrophes. This is the theorem in the more general case, not in this specific example of for meromorphic generating functions for approximating the coefficient on Z Vn. Here are some papers that are related to finding these solutions when you're not dealing with catastrophes. This is a nice paper by Takash about Erlang arrivals in the case of constant rates, and then there's Constant rates, and then there's Wilf's book on generating functions. So, just to remind you about what the talk's about, we're using these singularities of the generating function to figure out what's going on. Here's a photo from when CANQ was in Banth back in 2011. And the summary is: we can find the exact solutions, the asymptotic periodic distribution for some queuing systems. Periodic distribution for some queuing systems using singularity analysis. So, thank you for your attention. Thank you, Barbara. Very good.