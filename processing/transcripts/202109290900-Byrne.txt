is the oh right okay so angiogenesis is the process by which new blood vessels form and that might be in wound healing it might be in developmental biology a whole host of different situations and sometimes it will happen for example in For example, in impaired wound healing, it doesn't happen strongly enough. And in other situations, for example, in tumours, it is dysregulated and it enables the tumours to grow and spread to other parts of the body. So if we think of tumour angiogenesis in particular, a cluster of tumour cells that are growing in response to externally supplied nutrients, eventually some of those. Nutrients. Eventually, some of those cells will become starved of nutrients. They will secrete a whole range of different growth factors, including, for example, vascular endothelial growth factor, VEGEF, which will diffuse through the surrounding tissue. When they come into contact with endothelial cells that line blood vessels, they stimulate them to proliferate and to undergo directed movement via, say, chemotaxis, upspatial gradients of those different. Spatial gradients of those different diffusible growth factors. Other processes, such as haptotaxis, where there are sort of non-diffusible cues coming, say, from the tissue matrix through which the cells are crawling, can also help to guide the movement of these endothelial cells as they traffic towards the tumour. And as they do that, they form these sprouts, which if they fuse together, then they can form loops. Together, then they can form loops through which blood can flow, bringing the nutrients that the tumour cells need in order to continue to grow, and additionally, as an escape route to travel to other parts of the body where they could establish secondary tumours or metastases. So, there's been, I guess, a long history of modelling angiogenesis. And, Thomas, if we can go to the next slide. If we can go to the next slide, and I guess part of what we're going to talk about over the next few hours, a couple of hours at the most, is to just touch upon some of those different mathematical models and the relationships between them and the approaches that we use to analyse them and explore their interrelationships. And if we move to the next slide, this, you don't need to look at it in too much detail. You don't need to look at it in too much detail. It's really just to give you a sense of the different modeling approaches that have been used, are being used to model angiogenesis. And again, it doesn't have to be angiogenesis. It could be a whole host of other biological applications involving collective cell migration. So the models that we see range from agent-based discrete models, which can use different Which can use different sorts of cell-based frameworks. We've already heard about some of these already this week. At the other end of the spectrum, we can have continuum models framed using systems of ordinary or partial differential equations. And I guess there's stochastic models as well that could be incorporated into the mix. And as I think a field matures and we have models sort of sitting in all of these different domains, it's natural to ask questions about how we. Natural to ask questions about how we relate them to one another. And I guess a secondary question there is, and something that's increasingly relevant, is how we can relate these models to experimental data. So I guess those are some of the themes that we're going to sort of visit as we go through our talk. And if we can go to the next slide, Thomas. Oh, yeah, yeah, this slide. So this is really just to give you a sense of. this is really just to give you a sense of the different of the the the outline of our double act um so thomas will start off by introducing um a sort of very detailed agent-based model uh multi-scale model of angiogenesis and then talk about methods for um coarse graining and then i will take over and look at um so i guess the coarse graining there is about how we can take these multi-scale models and make them more efficient Models and make them more efficient so that we can run multiple realizations, do efficient parameter sweeps. I will then take over and look at ways that we might quantify or characterize the morphology or structure of vessel networks with a view to both comparing mathematical models and also analysing data. And then look at another way that one might compare mathematical models. Might compare mathematical models by taking discrete, detailed ones and coarse-graining them to derive continual models and comparing them in that framework. So I guess in the spirit of the conference as a whole, if you do have questions, please shout out. If we're not being very clear or whatever, please feel free to ask a question. We'd be very happy to pause and Happy to pause and listen to any remarks, or if we're not being very clear. But without further ado, let me hand over to Thomas, who will start by telling us a bit about multi-scale modelling of early androgenesis. Thank you, Thomas. Great. Thanks, Helen. So what I'm going to talk about today is part of the work for her PhD of Daria Stepano. But can you see my point? But can you see my pointer if I move it? Hello? Would you want to go to full screen mode? Well, I've been trying to, but I can't. So I'm going to stop sharing for a minute and let me try something. Okay, let me try again. Yeah, there you go. Okay, so as I was saying, this is the work that I'm going to present is part of Daria Stepanova's PhD thesis. Daria is a PhD student that Helen, Philippe and myself are co-supervising. So just to motivate a little bit what we are going to do, I'm going to show you first a couple of experimental results or movies. Results or movies. So these are movies of the very earliest stages of angiogenesis. So, as you can see here, the process has already started. This is what you see through the microscope. Here they have marked the nuclei of the endothelial cells in green. And here, what they have done is to represent in different colors nuclei of cells that initially Of cells that initially are clustered together within this network. So, as the process continues, we can track them. So, and what we can see here is that, well, the vascular networks continue to grow. But what I would like to call your attention to is that if you can see here the colors of this, for example, this blue cluster here, right, that they were cells that at the very beginning or at this point. That at the very beginning, or at this instant in time, they were close together. As the process of angiogenesis continues, they sort of separate and they mix and they overtake. And there is a whole bunch of complex cell dynamics here that involve this mixing and overtaking and whatnot. And basically, with the model that we are trying to, that we put together, what we try to understand is whether this try to understand is if whether this sort of complex dynamics have some role in the in the growth of the of the antiogenic network or in the growth of a functional and properly structured angiogenic angiogenic network or is just uh noise okay so well here there is another there is another movie that illustrates this phenomenon of overtaking so here what we have seen is that initially this red and blue cell is at the tip of the vessel Is at the tip of the vessel and it's being overtaken by this greenish one. Okay, so in order to incorporate all this kind of complex cell dynamics into the model, we formulated a multi-scale model in which a hybrid multi-scale model, in which we have an intracellular dynamics that accounts for the process of phenotype selection of the endothilial cells. The on the endothelial cells. So we will consider two types of endothelial cells. The tip cell, the tip cell is a polarized active cell that is able to send out this phyllobody or these protrusions, and that it's active, it's responsive, and it moves, whereas the estox cell is a sort of more passive phenotype. Then the selection of the phenotype or the acquisition of the phenotype by one particular cell. One by one particular cell is determined by the well-known pathway, which is the delta-notch pathway. In this case, it's the VGF-Delta Notch pathway because it's stimulated by the antiogenic factor, by the VGF. So, basically, we have an intracellular model that selects for the phenotype as a function essentially of the microenvironment. So, in this case, Essentially, of the microenvironment. So, in this case, the microenvironment is the local concentration of the VGF and the state of the neighbors, which prescribe the interaction between a cell and its neighbors in the network via this delta notch pathway. So, then we have a cellular sort of level or layer that basically takes into account cell motion. account cell motion. Okay, so basically migration, branching and overtaking. And we have then a third layer in which we deal with the interactions between the endothelial cells and the extracellular matrix. So basically we consider the gradation of the ACM by the cells, by the endothelial cells. We also consider basal members. Basal membrane assembly. So, this is basically our proxy for maturation or our proxy for age of the vessel. And then we also very important for the model, we have ECM realignment. So basically, what we have is that the cells, as they move, they orient, they realign the fibrils of the ECM in the direction in which the cells are moving. Okay, so I'm going to describe now in So I'm going to describe now in a little bit more of detail, but not much each one of these scales. So the cellular scale, as I said, incorporates this mechanism of cell-to-cell interaction, which is the delta-notch signaling system. So basically, this is a well-known lateral inhibition system. And basically, what happens is that there is a phenotype, which is the tip cell, which is characterized by the phenotype. Which is the tip cell, which is characterized by low levels of notch, which is the R receptor, or high levels of delta, which is the ligand. Okay, and for example, here is represented in this figure, the tip cell is represented by this greenish color. And what this system is doing is that if this cell is a tip cell, basically what this cell does is repressing the expression of delta of the ligand in the cells that In the cells that are in contact with it, in such a way that these cells acquire a stock phenotype. So here you will notice that we don't see the typical checkerboard pattern. This is for two reasons. First, we are considering a stochastic version of this pathway. And the other reason is that we are not considering just first neighbors interaction. Neighbors' interaction. We are considering a radius of interaction that can extend beyond the first neighbor in the lattice. And this is what we are considering here. And besides the typical ingredients or the classical ingredients in the Delta Notch model, we also have a stimulation by BEGF, which basically what it does is that it stimulates the production of the delta ligand. So, in a sense, the So, in a sense, the VGF stimulation basically stabilizes the tip cell phenotype. Okay. So, as Helen said, if there are some questions, please tell me because I cannot see anything now. I cannot see the chat or anything. So, if someone has a question, please just interrupt. Okay, so regarding the cell-ECM interactions, we basically have the The gradation of the cellular of the extracellular matrix. And this is implemented with this very simple ODE. So basically the cell, the ACM is degraded or consumed at a rate that depends on the concentration of delta that the cell at position X. That the cell at position X at time T is carrying. Okay, so basically a tip cell which is characterized by a higher level of delta will consume or degrade the ACM at a higher rate than a tip cell, sorry, than a stock cell that is characterized by a lower level of delta. Okay, for the basement membrane assembly, we have a very similar model where the A very similar model where the rate of deposition of this basement membrane material also depends on the phenotype, basically on the level of delta which is approximate for the phenotype. Okay, and the ECM sort of realignment, we model this in a very, very simplistic way, in which basically what we assume is that when a cell is moving in a certain direction, or it's magnetic. Certain direction, always migrating in a certain direction, it basically gives attack to the fibrils in that position of the extracellular matrix, and it sort of aligns the cell or realigns the cell in that direction. And the size or the intensity of this tack is proportional to, again, it depends on the phenotype of the cell. If the cell is a T. If the cell is a tip, because the tip cells are sort of more active and stronger and they interact in a stronger way with the environment, the tag will be bigger. And if not, if it's a stock cell, it will be smaller. So now I apologize for this transparency. Well, it's one of two sort of transparencies contained. Sort of transparencies containing maths, or sort of. So basically, this is the extra, as I said, the cellular layer is basically modeling cell migration. We model this as a random walk on a hexagonal lattice. Okay, and this random walk is far from the sort of simple isotropic random walk. In fact, we end up having something that resembles very much a reinforced random walk or a persistent. Walk or a persistent random walk. Okay, so basically, this is the model is characteristic in terms of this master equation. And the basic ingredient of the master equation is this transition rate here, which gives you the probability per unit time of moving from position I in the network to position J. Okay, and these rates incorporate a number of elements, so it depends. Of elements, so it depends. So, the rate of jumping depends on the local concentration of ECM, it depends on cell-to-cell adhesion. So, you don't want endothelial cells to wander very far away from where they are. This is the overtaking probability. This is the probability of one cell jumping over another. And this part here accounts for the direction of the movement. I'm going to describe this in a little more detail. So, basically, what we consider So basically, what we consider is that cells, endothelial cells, are going to prefer to move in the direction in which the fibrils of the ECM are aligned. And this direction provides what we call the mean polarization direction. Now, because we have noise in the system, we assume that cells can deviate. can deviate from well the the the the direction in which a particular cell decides to move will deviate in a in a in a in a statistic manner from this uh from this mean polarization direction. Okay, and the way in which we are modeling this is using a von Mises distribution. So the von Mises distribution basically is a Gaussian in polar coordinates. Okay, so basically So basically, and we have it represented here for different values of the parameters. Okay, so the von Mises distribution, as exactly as the Bausian, has two parameters. One, it's the mean angle, which in our case corresponds to the argument of the mean polarization direction. And then it has a variance, which in this case depends on two quantities, depends on the amount. On the amount of delta and on the amount of base membrane that has been deposited in a particular position. Okay, so basically what we assume is that tip cells, because they are more exploratory and they are more active, they will be more prone to explore directions different from the one prescribed by the fibrils of the extracellular matrix. Okay, so basically, what we assume is that this variance is going to be bigger for the tip cells than for the stock cells. In that way, we will allow the tip cells to explore different directions, whereas the stock cells will be forced to move in the direction in which the fibrils are oriented, which basically coincides with the direction in which the vessel or the branch is being formed. Or the branch is being formed. And the dependence with the basal membrane, this is basically to stabilize the vessel. Okay, so we want that the older parts of the vessel don't, that there is no branch in the older parts of the vessel or the networks. So basically what we assume is that this variance is a decreasing function of the quantity of basement membrane deposited. A basement membrane deposit. Okay. So, yeah, that's basically everything that I wanted to share with you about the model formulation. So we calibrated this model with, well, sort of calibrated this model with data that was available from the experiments that I showed you at the very beginning. These guys measured a number of statistics regarding Statistics regarding the structure of the network and how the network grows. And we compare our simulations, our numerical simulations, for different parameter values to those results, until we had an agreement that was good enough with the experimental data. So then we started running different sets of simulations. And the first thing that thing that we realized, or we were very glad about this, of course, is that there are a few qualitative features that one would expect to have in an angiogenesis model that it's, for example, branching. And in this case, these qualitative features in our model emerge as an emergent feature of the dynamic. Of the dynamics other than being prescribed. So, for example, we can see here that our model produces branching as an emergent feature. And this is because of this property of the tip cells that I mentioned before, that they are more exploratory. So in that way, we allow the tip cells to branch off in directions that are different from the one in which the vessel is growing. Vessel is growing, okay. And the second of these, Thomas, yes, can I just ask? And so, we've just Leah's just put a question in the chat. So, can you just, it's all right, I can, I can do that for you. Um, do you want to just explain what the difference between the red and the green cells is? Oh, sorry, yes. Uh, so yeah, the green cells are tip cells, okay? So, this this uh this bar here, okay, is the level, it refers to the level of delta. Refers to the level of delta. So, high levels of delta correspond to deep cells, and low levels of delta correspond to stock cells. And is there a VGF gradient? And what is it here? Not in this one. In the next one, there will be a VTF gradient. So, in this one, the VTF is uniform. We started with a uniform distribution of VTF because this is. VETF because this is what we had in the experiments that I showed you at the very beginning is with a constant concentration of VTF. And because we wanted to calibrate our model with the data from those guys, we started with a uniform VTF distribution. But if I can go to the next slide. So here there is a VTF gradient. Okay, so there is a higher VTF. There is a higher BGF concentration at the top than at the bottom. Okay, so we can see this here. And what we can see here, for example, is that after some time, branches start growing in the direction towards the VGF gradient. And we have also something like the brush border effect, which is this effect in which you start having a lot of branching close to the VGF source. And again, this is big. And again, this is because, well, this is basically because of the intracellular dynamics. The VGF stimulates or stabilizes the tip phenotype. So you have more tips and therefore you have more movement in that direction, more branching, etc. Okay, so after this, we also try to validate our model with a different set. Our model with a different set of data. And for that, we took the results from this paper by this is from the group of Katie Bentley. And basically what they were doing is they were studying to, so they were studying two mutants, one in which the expression of the VGF receptor 2 had been Receptor two had been reduced, and another one in which the expression of the VGF receptor two receptor one had been reduced. So, the difference between these two is that whereas the receptor two produces signaling, so it signals to the delta notch circuit, the receptor one is basically a trap for BGF. So the BGF binds to the receptor one, but the To the receptor one, but the receptor one doesn't produce signaling. So, in a way, having less receptor one implies that you have a higher effective concentration of BGF. Okay, so and this is what we get from our simulations. Okay, so these are, sorry, these ones are the wild type, which is the ones that we always take as a reference. I think that's probably enough of that. I think that's probably enough of that. Okay, so in what we get sort of in a qualitative way, we run many of these simulations. So these are specific realizations, but because this is a stochastic model, we need to run a number of different samples to structure statistics. And that's what it's sort of meaningful, hopefully. So and what we got also in agreement with the experimental results by these guys. The experimental results by these guys is that whereas the receptor to mutant basically exhibit sort of poorly are poorly produce poorly expanding networks. In the R1 mutants, basically what we get is longer vessels, and this is because of this increase of the effective concentration of BGF sensed by the endothelial cells. By the endothelial cells, and also it's characterized by fewer branching points. These few word branching points, and perhaps comparing this to this, is not particularly clear, but if you do sort of the number of branching points per unit of network surface, then you get fewer branching points. Okay, so you get here, you get more network, but you will get less branching. Will get less branching points in proportion. Okay, so and so now, so at the very beginning, I told you about this mixing, this mixing phenomenon in the sort of, at least in the early stages of magiogenesis. And now we want to study that. And to study that, the first thing that we need to do is, of course, quantifying this. And to quantify this, we came out with what we call ideas we came out with with what we call the mixing measure which is probably a failure of imagination but that's how we call it um so and basically what to to to to to produce some quantitative measure of of this mixing phenomenon we did basically what the experimentalists did did in a in a visual manner we did it in a quantitative manner so basically we took clusters of cells that at some point t they are they are together they are close to each other Are together, they are close to each other. We let the system run or evolve for some time Tm, and then at this later time, we measure the distance between these cells here. So in our model, because the model is discrete, we can keep track, we can sort of label the cells and we can keep track of how they evolve. So then we can measure how far away are How far away are these cells at a later time? So we don't measure the occludent distance, we measure the distance on the network, okay, which is sort of different from the, of course. And so basically we do this for all the cells in the cluster. We average and then we normalize with the maximum distance that we find. And then we can apply this to the different. Then we can apply this to the different cases, to the different scenarios that we have considered. So we will start looking at. Excuse me, Thomas. Yes? Are these cells not connected, the red cells, for example? Or do they physically have to detach in order to go down the separate pathways? Well, they are, well, do you mean in the experiment or in the model? Well, in reality, they are. I'm asking you the... No, they are. I'm asking. Well, this is part of the complex dynamics. They attach, but they are not. Just recall that this is not a major vessel. These are early stages of angiosynthesis. So the junctures or the connections between the cells are looser at this stage. So that's why. That's quite, so when they evolve, they can, so even if they are closer together at some point, they can be separated at later times. Okay, so they are not conjoined very tightly at this stage. Okay, thanks. Yeah, okay. So yeah, so we first tried this quantification with the wild type. With a wild type network, with wild type cells. And what we obtained is basically what we expected. So, as the cell, sorry, as the as the network grows, this mixing measure, this quantification sort of grows as well. And this is because as the network gets bigger and there is more branching, cells have more pathways to follow and therefore there is more mixing. therefore there is there is more more mixing so so far no no surprises and then we we tried uh we tried we we we we uh quantified the same the same thing this level of mixing for the mutant uh for the mutant cells okay and what we what we got is for the r2 uh mutant uh again we what we got was not surprising we expected to to get to get this and the and what we get is that the level of mixing is We get is that the level of mixing is smaller than in the while type case. Okay, and this again is because this is a smaller network with less branching, so cells has less capacity to sort of find new pathways and separate, etc. But in the case of the R1 receptor, where we get this sort of bigger networks, we were surprised. Networks, we were surprised to find that the level of mixing is bigger than for the R2 receptor, but it's smaller than for the wild type. Okay, and this kind of led us to conclude that maybe this mixing dynamics has some sort of function, because what this is doing in our model is basically shuffling the cells with The cells with different phenotypes. And it's basically bringing the tip cells instead of leaving them in the sort of more mature regions of the vessel where there is a lot of basement membrane deposited and they cannot do anything else. So, this mixing phenomenon, basically, what it does is that it moves the tip cells to regions of the network where they can branch. The network where they can branch or where they can degrade the endothelial, sorry, the extracellular matrix and produce more movement. Okay, so this is the conclusion that we obtained from that. And so this is everything that I want to tell about the multi-scale. Sorry, the multi-scale model. So, I'm going now to move to this second part that Helen was mentioning about the coarse graining of this and intracellular dynamics to make the model more efficient. So, perhaps, is there any questions regarding the first part? I think, Paul, you have a hand up? Yes, I wanted to ask on your overtake probability, then, how do the um how how do the how does your model uh results affect that overtake probability because it seems rather important okay so it's um it's okay you perhaps perhaps it's it's it would be easier if you think about the volume exclusion okay so if if i have a cell that wants to jump onto a position where there is already a cell that's occupied by a by another cell basically what we consider is that with some probability okay probability okay these two these two cells will exchange positions and otherwise they will stay as as they are okay and what happens is that or what we are considering is that if the if the cell that it's attempting to jump uh is a tip cell there is a there is a much higher probability of exchanging the positions that if the cell that is attempting the jump is a stock cell Is that uh that does that answer your question? Yeah, thank you. Okay, great, thanks. So, if there are no one else, I'll keep on going. Helen. Thomas, can I ask a few questions? Of course you can. What about other sort of metrics to characterize the degree of mixing or in the In the network, I guess, like say this children. This is something that, well, the first thing that we thought about is, well, the director of the center where I work is an expert in ergodic theory. And so Daria and I asked to ask him about how to characterize this. Uh, how to characterize this using some sort of notion of entropy or something like that, and we had a very long conversation with him, and I didn't understand a word of what he was saying. So, uh, in the end, uh, we decided, but I'm uh, yeah, I mean, it would be great to have, well, first, it would be great to have data to sort of data that allows. Sort of data that allows you to follow the endothelial cells in those kinds of experiments that we have seen before. And it would also be great to have other. I mean, if someone has some idea of how to quantify this, I'm more than happy to hear. But yeah, I mean, this is what we came out with. I mean, that's a good idea. Anything else? I think we're good. Okay, then I will go on. Thank you. That's fine. Okay, so well, Helen sort of alluded to this problem in her introduction. So when we are simulating this multi-scale These multi-scale models, the issue of simulating the intrasolar dynamic in detail is computationally expensive and makes these models very inefficient. And this hinders the ability to simulate larger networks or going to more sort of more realistic situations. However, the issue here is this word in this phrase in detail. In detail. I mean, how much detail do we need to characterize the dynamics properly? So, in this particular case, basically, what we need to know, so we don't need to know the dynamics in all the details. What we need to know is essentially whether the cell is a tip or is a stock. So, whether the level of delta is high or the level of delta is low. And this is essentially what we need to know to characterize. Need to know to characterize the behavior of ourselves, at least at the level that we are considering here. Okay, so instead of simulating this complex model in a lot of detail, what we can try is that we can try to cross-grain the intracellular dynamics into a two-state Markov chain where this two where the two states This where the two states correspond to the two phenotypes. That, as we are seeing here, I mean, the phenotype switch can occur sort of deterministically because the cell's microenvironment has changed and that induces this jump, or it can also occur because of noise-induced phenomenon. Okay, so in so, but basically, in either case, what we What we need to, if we want to coarse-grain this internal dynamics and to produce this kind of reduced description, we need to characterize the rates of switch between these two phenotypes. And to do this, we resort to large deviation theory. So I'm going to be very, so this is the second mathematical slide, and there won't be more. So consider a Consider a stochastic differential equation like this one. And then assume that this B of X, this is basically the deterministic dynamics. This is what it's left in the system if we ignore the noisy bit. If we neglect this part, then we have a system that is x dot equal to b of x. So assume that this b of x is biostable, something like we have here. So we have Uh, we have here. So we have x1 and x2 are stable steady states, and then there is somewhere here a southern point. Okay, so if the system is deterministic somewhere here, we will have a separatrix, and obviously the initial condition will determine whether the fate of the cell or the system is x1 and x2. Okay, that's the end of the story. If we have noise, so if this if we switch on this part of the equation, this Part of the equation, this separatrix becomes a barrier, and then we can have transitions between x1 and x2. Okay, so what the Ledge deviation theory tells us about these transitions is that they occur, that there is a maximum, a path for this transition, which is this green line here, which is sort of the path of highest probability. Highest probability. And this path is determined by minimizing this action functional, which is given as a function of a Lagrangian density. And for this kind of system, the Lagrangian density is known, but for me has, and it's perfectly characterized. So we can solve the variational problem of finding the minimum action path, which is this psi of. Path, which is this psi of t. This is this the path that minimizes this dysfunctional is the sort of most likely path of transition between the two states. So what alert deviation state is that the deviation of a stochastic sample path like here from the minimum maximum path is suppressed exponentially. So the farthest, so the okay so the farthest so the the the the the the probability of being very far away from the from the optimal path is suppressed exponentially okay and and so uh this is what uh what the theory says and then we can uh we can calculate the the quasi-potential which is this quantity which is basically the action functional calculated over the over the the minimum action path or the over its minimum the over each minimum okay and then once we have once we have this the transition rates are just given by this oh sorry i screwed up the later here okay but it should it should say something similar to here okay so the the the transition rate to go from x1 to x2 is exponential it's an exponential of minus the quasipotential divided by the density of the noise that it's this epsilon parameter here okay so basically okay so uh basically once we have this using the uh well the the the the the large deviation theory we can calculate we can calculate this path with the path we can calculate the the quasi-potential and with the quasi-potential we can calculate the transition rates okay so and uh we have done this for the delta notch model so here i'm showing you a couple of examples of transitions from the of transitions from the stock to the to the tip and from the tip to the stock. These are the dotted lines are the minimum action paths and these trajectories are examples of sample paths for the transition. Okay, so once we have this, if we want to sort of use this in the simulation. Use this in the simulation of a multicellular system, we need to calculate this rate and, therefore, this quasi-potential as a function of the external variables. In our case, the external variables are the variables that control the environment, which are three. It's the concentration of EGF, the levels of external notch, and the levels of external delta. Okay, so here there are, so here I'm representing Uh, so here I'm representing this uh this as a surface, as a surface. So, we are projecting this three-dimensional uh thing in a plane. Okay, so we are we are looking at this surface, this landscape, as a function of the external notch and the external delta. So, this region here is the bi-stable region, and this the red. And this, the red region and the green region. So, here this is the monostable region where the only steady state is the tip. And here is the steady state, the region where the only stable steady state is the stock. And here in the middle, we have this biostability region. This by stability reaching. Okay, see, so here for each one of these external notch and external delta, we can go to the surface and calculate and just see what is the value of the corresponding quasi-potential. And with that, we can calculate the transition rates. Okay, and with that, this is not a blank. Okay, and with that, this is not a blank slide. We can perform simulations of the multicellular systems. So we have done two examples: one monolayer and another one, we have run this model on a branching structure. Okay, so this is not a geogenesis. This structure is not growing, but it provides a different geometry. Okay, so the first thing that we did is First thing that we did is just so we need to validate this against the full multi-scale stochastic model just to check that we are not losing essential information when we pass from one description to the other. And for doing this, what we did is measuring the number of clusters of a certain size. So for example, if we go back here, we see that we have clusters of tip cells. The green cells are the tip cells here. Green cells are the tip cells here as well, and we can see here that we have clusters of size one, clusters of size two, clusters of size three, occasionally sizes, clusters of size four. So what we did is to, again, we run a bunch of the simulations and we did the statistics of the number of clusters of a certain size. Okay, and this is what we get for the full. So this first row is for the monolayer, and this second row is for the is for the uh for the branching for the branching pattern okay so and what we see is that uh using these statistics we can see that the uh the coarse grain model is doing uh is doing quite well okay in the in the monolayer and it is also doing quite well in the branching uh geometry although uh we are losing uh a few clusters of size three but but not a lot okay and then uh well Okay, and then well the last thing that I'm going to show you is the numerical performance because that was the whole point of doing this. So again these are these are results for the this upper row are results for the monolayer and this is for the for the branching but the results are very similar in the sense that if you if you see here, so here we are in CPU times of order 10 to the 5 and here we are on CPU times. Are on CPU times of order 40 to simulate the same thing. Okay, so the reduction or the increasing performance is quite spectacular. And this is everything that I had to tell you. So thank you very much. And if there are any other questions, but I don't know, Hans, what do we do? Do we continue with Helen or do we do questions? Ellen, or do we do questions now? Hello. Oh, there I go. Okay. Sorry. For a minute, I thought that I had been speaking for half an hour to the void. I think from the standpoint, you know, this is fairly complex, and so it may be wise to address the questions now before things slip people's mind. And give me the privilege of starting off. I wonder, have you thought about the possibility of introducing more energetics and mechanics into the process by looking at a free energy functional. Looking at a free energy functional because these cells have to do work in order to move. And in some way, they're choosing an optimal path based on least resistance, probably. So that might be an alternative, and it'd be very interesting to see how it would compare with what you have. That's a very good point. In fact, this is the next thing in the pipeline. So unfortunately, Daria is an excellent. Daria is an excellent student. She's very bright, but unfortunately, she's reaching the end of her funding. So we will have to let her go soon. But this is, I mean, this introducing mechanics in this, so rather than having this phenomenological thing of just, you know, cells move in that direction and then they tag and then deform and having some sort of more principled way in which the cells. the cells interact mechanically with this with the with this structural matrix that's um that's the next thing that uh we want to that's the next thing that we want to try so the answer is uh yeah and well we will we will report soon yeah thomas yes helen no i think other thomas thomas or thomas thomas rather than thomas okay that no but That's why, but so, Thomas, I have a question too. Um, I was intrigued by this large deviation theory. This is really cool stuff, but but uh, you use it to describe the switch between high and low delta concentrations. As I saw this first, I was thinking of a bistable system, a switch between two stable, steady states. Um, is there a reason you chose one over the other? No, we are we are calculating, no, sorry, I perhaps I wasn't clear in that. We are calculating. Perhaps I wasn't clear in that. We are calculating the jumps in both directions. So if you've got it written at the bottom of the slide there, so you have transition rates. So it's a way of simplifying all of the subcellular dynamics to just have some probabilities of I'm in a certain state. Sorry, perhaps you are confused by this. But in any case, you can calculate. is you can you can calculate the champs sorry let me go to the yeah this is the this is the real so for example here we have calculated the the well here that what we have calculated is the minimum action path for the for the stock to tip and for the tip to stock okay and here we have calculated the landscapes for the stock to tip and for the tip to stock so would it be okay to say that these gray lines Be okay to say that these gray lines in the previous image show the manifolds of the two steady states and you jump from one to the other? Exactly. Yes. Okay. So then I got it. Yeah. Great. Thank you. A follow-up question. Can you go back to slides? Well, no, that one. So how do you define this functional? Well, this is in the case of Of a stochastic differential equation like this one. I mean, this is basically the Freyling and Bensel theory, which is described in great detail, perhaps too much detail in this book here. This is a classic in stochastic dynamical systems. So basically, if your system is described like this, this Lagrangian has an explicit form, which is basically it's. Okay, which is basically it's the scalar product of this difference here. No, sorry, it's the scalar product of the difference between path psi and this quantity here. And this scalar product is weighted with the inverse of this noise here. Noise here. Okay, so this is. Yeah, sorry, go on. As I understand it, in order to compute this, you need B. Yes, yes, yes, exactly. And so the question is, you know, how much of the intracellular dynamics have you used to compute this L? Well, that's, I mean, if the system is multistable, then this is then, well, it depends on. Well, it depends on that. I mean, I suppose that you're right that it depends a lot on this B here. Okay, so if this B here is multi-stable in general, but it doesn't need to be bi-stable, it can be multi-stable, then you can apply all this. If you are thinking on, for example, something like a signaling cascade or the sort of activation cascades that we were seeing in the Jom's talk yesterday. Talk yesterday, then this cannot be applied directly to, as we have told you. Okay, but having said this, large deviation theory is a completely general, it's a very general theory. Okay, so there are results that can be applied to that kind of systems. The only thing is that if you want to work with that kind of system, systems that are not multi-stable or bi-stable or whatever, then you have to go back to the math. to go back to the to the maths and see what what is the mathematical result that um is is useful for you okay that you're you're you're absolutely correct that you know all this depends a lot on the properties of this b here okay so in our case the delta node system is biased it has a has a biostability region so we are yeah okay so you start really knowing the biostability and then all the other follow-ups yeah yeah in other words this thing that i have told you This thing that I have told you can be sort of applied more or less straightforwardly to any system that is multistable. So, basically, every when you are dealing with cell fate decisions or phenotype changes, all these systems are multistable because that's how that's how the fate selection works. If you are thinking about other things like signaling or activation caskets, then we need to go back to the drawing. To go back to the drawing board, as it were. Yeah. Okay. Well, if there are no further questions, perhaps we should carry on. Okay, so then I will stop sharing, Helen. Yep. And you can take proper. Well, thank you to everybody. Right. Okay, so I'm going to. So, I'm going to, I guess, probably take a more simplistic view in terms of the modelling of angiogenesis, but focus, I guess, on ways of comparing models of angiogenesis and comparing those models, I guess, with experimental data. And look at, I guess, a couple of different approaches for doing that. So, first off, So, first off, if we think of, yeah, so okay, just to sort of try and put that into context. Yeah, there are many, many different models, discrete ABM type models, multi-scale models of angiogenesis. How do we compare those? And also, how do we compare them with experimental data? So, yes, just a gratuitous picture of a lot of Mexican birds for you. Mexican birds for you. So, in order to compare these models, we want, particularly when we're thinking about models that are often stochastic, what sorts of metrics can we use to compare the structure, the morphology of the vascular networks that are emerging from these different models and also from the experimental data that we observe. At a very, very simple level, we could think of statistical quantities, for example, the number of tip cells, the number of different segments, or penetration depth. And many people have taken vascular casts or experimental data and used these sorts of metrics to characterize vascular networks and their response to different perturbations, whether that's treatment with some. Whether that's treatment with some sort of vascular targeting agent, whatever you might, or some sort of angiogenic factors. But I guess it misses a lot of the detail about the topology or the structure of those networks. And so I guess the idea here is: can we do any better if we try to take account of something more of the structure of the data? And I guess, furthermore, can we? Furthermore, can we? Um, yeah, no, let's just go with that for now, I guess. Um, and um, but before we go there, so if we think about the statistical sort of descriptors that I've just described, here is just a few, three different simulations from a mathematical model by some time ago from Mark and Sandy Anderson. And really, this is just to show you you can generate whether it's synthetic or it's Whether it's synthetic or experimental data, you can vary parameters or experimental conditions, and they will influence the structure of the networks that we see. And you can see here how as we vary the contributions of or the influence of chemotaxis, haptotaxis, etc., you can see that the structures are different. So, I guess what we want to do is: can we quantify these differences in an objective way? And if we use Way. And if we use, if we quantify each of these networks as they evolve over time by counting things like the number of tip cells, the number of segments, and or the spatial extent, the penetration depth of this vascular network, then we can see for these three typical simulations, we can see results such as those shown down here. And I guess over time, what you can see is for. What you can see is for the ones where the network is penetrating across the domain successfully. So, I should add that what we've got here is a number of endothelial tip cells initiated on the left-hand side, migrating out in response to, say, a gradient of a chemoattractant. And then there's a gradient of fibronectin in the basement membrane, which is being remodeled as the cells migrate across the domain. Across the domain, so Helen, I'm sorry, I need to stop you. There seems to be a broadcasting issue, so some people cannot see your slides or your cursor. Oh, I see it just fine. I don't know how would you like? Shall I stop and start again? What would you like me to do? Yeah, maybe that's a good idea. Right, okay. Thank you, Thomas. Okay, here we go again. Right, where am I? Yeah, it's funny. Right. Okay, sorry. Let me is is that better? Can you move your mouse over it? Can you see a cursor? Looks fine to me. Yeah. Does it look fine? Anybody else who wishes to see it? Looks okay. Looks okay. Okay, anyone who had problems, would you like me to continue? I'm sorry, maybe I shouldn't ask that question. Yeah, go ahead. Thank you. And thank you for shouting out, Thomas. So I guess the bottom line here is you can see sort of trends from these simple statistical measures of whether that's the spatial extent. And you can see how, as we vary model parameters, how those different statistics. How those different statistics change. At the same time, you can see also just by comparing these simple scalar readouts that we're missing a lot of information about the structure of the networks. And so I guess what we're interested just from a structural point of view, in terms of thinking also towards the function of these networks as they evolve, are can we characterize other topological features of these networks? Technological features of these networks. And I guess two simple features that we might quantify for 2D networks such as these are what's called Betty numbers of dimension zero and one. Doesn't really matter. Really, just think of them as the number of connected components and the number of loops. And if you look, so here is, say, a beginning simulation. I've got two. I've got two connected components and there are no loops. As this network evolves, we have an anastomosis event. This tip hits the other one. Now we have just one connected component, but there are still no loops. So Betty zero goes from two to one. In this particular case, we have a bifurcation, but we still have just our two connected components and no loop. Two connected components and no loops. If we move to this situation where we've had a branching event and then an astomosis where those two tips have fused together, we can now see that we've got a loop emerging. So we have one loop by Betty one is equal to one, and so on and so forth. So what we can do is quantify sort of topological features of the network. of the network and see if we can how well those how well those describe whether it's synthetic or biological networks. Now, in truth, one of the other advantages of using a sort of topological approach is it's a way of generating a multi-scale description of a network. So let me explain what I mean by that. That. So, if we run a simulation and where we have an endothelial cell, we just binarize the simulation. So, we put a red square where there's an endothelial cell. So, this is just a snapshot of a region at a particular time point. So, red cells are red squares are occupied by an endothelial cell at a particular time point. So, what we're going to do here to get our multi- Here to get our multi-scale, if you like, summary of this particular network is we're going to take a plane and we're going to sweep it from right to left across our network. And as we do that, at each point, we're going to count how many connected components and loops are to the left of our sweeping plane. So, and so you can see this is what we're doing up here. You can see this is what we're doing up here. We're just running a plane from left to right, and the red dots are the ones that are now in our domain of interest, if you like. So, and the picture down here at the bottom is for the points of interest that are within being considered at this point in our filtration, we can see which of these, how many connected components or loops are. Components or loops are present within at this stage of our filtration. So you can see here at this stage for point cloud two, we've got a connected component here. We've got another, oops, sorry. We've got another connected component here and a third connected component down here. And as we progress across, sweep across through our image, then we can. Our image, then we can see that some of these features are annihilated. So, as we move from here to here, this small connected component fuses with this other one. So, this dies and it merges with this connected component here. We can also see, if we move over to the right-hand side, as the plane sweeps across to the right-hand boundary of our domain, we can also see loops appearing in our Appearing in our network. Okay. So what we can then do is as we sweep from left to right, and so you can talk about this as we have a filtration parameter, which is the position of this sweeping plane. And that will tell us at each point, at each value of that filtration parameter, it gives us information about the structure. Information about the structure of the network. And so you can then draw, produce graphs or barcodes that tell you how many connected components and or loops there are at a particular value of your filtration parameter. Okay, I hope that makes sense. Here's just, if you like, this is quite a simple example, a way of summarizing the output from Summarizing the output from this exercise is to produce what's called a persistence diagram. So what we've got on the x-axis is what's called the birth. You can think of that as the position from left to right. And then we'll see different components, connected components, loops, etc., appearing at different positions of our sweeping plane. And then as we see. And then, as we saw with this connected component here, those components may disappear or die at a certain position of our sweeping plane. So, we can have a notion, we put a dot at the coordinates where the feature of interest, connected component or loop, where it was created, and when it disappeared. And this is a way, I guess, of summarizing for what's quite a simple example this. This sort of network structure. And you can then see that by the time we get right to the right-hand side, what's happening in this particular network is we have two connected components and we have one loop remaining, and that's what's left on here. Okay, so this is just a way of characterizing the structural features of a network. And there are many, many different And there are many, many different ways in which you can do this. I guess, sorry, just to take this a step further, what you can also do is from those sorts of persistence diagrams, construct a 2D image, which rather than on the y-axis, rather than having death, we just have birth minus death instead. And we can sort of produce a 2D plot, which shows you, we essentially put a Gaussian around each of those different features, the different Those different features, the different sorts of components that are in the network. So, if you think about the numbers of loops, there was just one loop in that network. So, we have a dot here, and we put a Gaussian centered on that position to generate what's called a persistence image. And I guess that's, in a sense, trying to take sort of account of noise that might be present in the data. And now, you might be thinking, well, that sort of makes. Well, that's sort of making, you know, you've traded a 2D network for a 2D matrix. That seems like making an awful lot of extra work. What is the point? And that's a fair question to ask. And I guess the point here is this sort of gives you, I guess, a nice summary of the structure of that network. And it's a way in which, if we compute similar images. Compute similar images for different networks, we can actually compare them. We can perform statistics on these sorts of metrics, on these sorts of images. The way in which we actually do that is to vectorize the matrices, but that really doesn't matter. I think this is just a way of being able to compare different networks, which isn't possible if you just look at the raw images. Sorry, I hope that sort of the rough ideas there make sense because. Rough ideas there make sense because what we'll do now is try and apply these sorts of methods to first synthetic and then biological networks so that you can start to, I think, get an idea of the insight that they can perhaps provide. So I hope that makes some sense. Question? Yes. Do you at some point put time into the picture to see how this evolves? So we can put it in. We can put it in, so, in a sense, time is sort of implicit, if you like, in this filtration for this particular example, because here our network is evolving left to right. But in a sense, it's not implicit at the moment because we're just taking a particular image at a particular time point and summarising the structure of the network at that time. Structure of the network at that time, but there is a legitimate question, which is a good one, Hans. Um, about, for example, if one had more complex models where you had remodeling of that network, it might be appropriate to introduce a notion of time as a sort of another, if you like, filtration parameter. And that's sort of a direction that this work can go, but that's very much at the Can go, but that's very much at the sort of cutting edge. Okay, thanks. Okay, um, right, back to the plot. So, what I'm going to try and do now is show you, as I said, that might all seem like using a very big hammer to crack a small nut. What's the point? And I'm going to try and convince you that there is some value in using these sorts of descriptors to describe or characterize. Describe or characterize vascular networks. And sort of to illustrate that, in contrast to Thomas and Daria's beautiful, very detailed model of early stages of angiogenesis, I'm really going very back to first principles to a model by Sandy Anderson and Mark Chaplin back in the last century. Scary to think. Really, very, very similar. Really, very, very simple biology here. So, we have a parent vessel with lined by endothelial cells. We have an angiogenic source tumor, perhaps, that's pumping out andiogenic factors that diffuse across through to this parent vessel. We also may have a gradient of fibronectin, which acts as a haptotactic stimulus, directing the endothelial cells that. The endothelial cells that break away from the parent vessel proliferate and migrate across to the source of the chemoattractant via a combination of chemotactic and haptotactic migration. And as they migrate, these capillary tips may branch to form two tips. They may fuse together via anastomosis to form junctions, or we may also have. Functions, or we may also have two tips fusing together tip-to-tip anastomosis. So that really just gives you a flavour of what the model looks like. And again, I think I've already showed this sort of illustrated to you before how the qualitative behaviour of the synthetic networks that the model generates, the structures change quite markedly as we vary system parameters. And the two parameters that we're going to focus on here. That we're going to focus on here for this study are the sensitivity to chemotaxis and haptotaxis. And so these are just representative simulations for different values of those two parameters. And you can see how, as we vary them, it's affecting the penetration depth and the sort of density or tangledness, if you like, of the networks that emerge. And so Emerge. And so, what we can do is apply a whole range of statistics, including the statistical measures, but also the sort of topological descriptors that I just described. And there are many different sort of filtrations or ways of quantifying the structure of these networks. So, keeping in sort of line with the Line with the sweeping plane idea, one can either take an image and sweep from left to right, which was what I described. Equally, you can sweep right to left, top to bottom, bottom to top. And you can generate sort of count the numbers of loops, connected components, etc., etc., for each of these different ways of filtering the networks. And each of those will give you different curves, and hopefully, the next. Different curves, and hopefully, the next plot will give you an example. So, here's a typical simulation. On the bottom down here, in grey, is showing you sweeping from left to right. And you can see that initially we've got, I don't know, about eight different capillary sprouts. And as we sweep from right, from left to right, the numbers of some of these connected components fuse together. We see a reduction. Components fuse together, we see a reduction in the numbers of connected components. And then eventually, when we reach the right-hand side, we've got, I don't know, a smaller number, six or whatever. In terms of the numbers of loops, as we go across, initially there are none. Eventually, we see that some of these sort of messy bits here actually are little loops. And so we can keep track of the number of loops. And we can do the same sort of process going from right to left, top to bottom, and bottom to top. And we can generate. And bottom to top, and we can generate these sorts of curves, which essentially are some sort of summary of that particular network. And we can do generate similar curves for different parameter sets. Okay. And so the question then is, well, so part of what we wanted to do here is, maybe I'll just show you this slide. So what we did was generally What we did was generate a whole load of different networks, taking as parameters of interest the chemotactic sensitivity. So we had, I don't know, 10 or 11 different values of chemotaxis and 10 or 11 different values of the haptotaxis parameter rho. And we generated, I don't know, 100 and odd simulations for each parameter pair. And we characterized them, quantified them in a variety of different ways. Quantified them in a variety of different ways. So we use the model, varied these two parameters to generate synthetic data. For each of those different simulations, we can analyse the resulting networks either using our standard statistical descriptors, numbers of tip cells, vessel penetration depth, etc., etc. Or we can use these topological descriptors. Descriptors. And I've just focused on plane sweeping. There are others, but I think, in the interest of time, I think just I think hopefully you get the idea. From those, we can generate these Betty curves, persistence images, etc., etc. And then what we did was take these statistical outputs from the different networks and we tried to cluster the data based on these descriptors. And then we used K-me. And then we used k-means nearest neighbours to try and cluster the data into whatever four, five, or so many networks. And we looked to see whether the clusters that were predicted under the different types of descriptors, whether those were biologically interpretable, i.e., whether the different descriptors can stratify the networks into groups based on the parameter values that were Values that were used to generate them. I hope that makes sense. And what we found was that depending on which descriptors we used, we'll get slightly different clustering of the data. In particular, as the slide says here, no single descriptor by itself gave us clusters that were nicely biologically interpretable. What we did find. What we did find is if we took pairs of descriptors, so if you can imagine we do a left-to-right filtration and a right-to-left filtration, take the outputs from both of those and use that data to cluster the networks, then what we find is we can get these sorts of clustering. So, this is a left-to-right and right-to-left clustering based on the numbers of connected components or different combinations of those. Combinations of those summary statistics. And you can see, so here the data has been partitioned into five different groups. And you can see how, depending on which descriptors we use, that influences the way in which the data is grouped. And I guess in particular, you can see, so we're showing how the data clusters based on the values of the two parameters that we were varying. Of the two parameters that we were varying. So, this, I think, combination here gives us a nice stratification of the data, as this one is not too much worse. I think this was the best stratification. So, it grouped together all networks generated with high values of chemotaxis and so on and so forth. So, the networks seem to cluster based on the parameter value. Based on the parameter values that were used to generate the networks. And I guess to try and make that a little bit more meaningful, what you can see here, so we take those persistence images, the way that we get the clustering is we can do principal component analysis. And what you will see here is if we look at the first two principal components from those persistence images, this is showing you how for the five different groups, how the Groups, how the simulations are clustering according to which group they belong to. So, I guess I hope what this shows to you in a sort of very simple overview that these sorts of ways of characterising vessel networks have the potential to enable us to compare vessel networks. Vessel networks in, I think, quite different ways than what we're used to. And the object of this synthetic study was to show you how these sorts of ways of characterizing those networks, that they do seem to be able to detect sort of changes in model parameters. I mean, I think there's a lot more work to be done here, but I think it gives us a flavour of what these sorts of techniques Sorts of techniques, the potential value that they might have. Okay, so I think I've already gone through that. I guess, as I said, many ways in which to take this forward. Sort of one of the things that we'd kind of be interested in, and this sort of goes very much back to what Thomas said in his talk: looking at more complex models and seeing whether the structures that they generate, how much extra detail are the structures. Extra detail, are the structures, are those networks very much different when we add in a lot of biochemical sub-cellular detail and/or different types of mechanics? Again, we can look at different geometries. There's a whole host of compare on lattice, off-lattice. I think it's a framework that has the potential to allow us, I think, to start to compare the different modeling frameworks that we're using to simulate. That we're using to simulate vascular networks. And again, just as a sort of short aside, I think one of the nice things is we can apply these same metrics to biological networks. So in sort of separate work, what we've done is, and I guess the advantage here is that we can apply the same methods to 3D networks as well as 2D networks as we had in the synthetic data. We had in the synthetic data. So, what we've done here is taken two different types of data sets: intravital and ultramicroscopy data, doesn't really matter. We can get beautifully rendered 3D images of vascular networks. Going back to Hans's question earlier, we can follow these networks over time and see how the structures are changing. And the way in which we've kind of analyzed these networks, rather than doing the sweeping plane that we talked about before, what turned out to be useful for these sorts of data was to do what we call a radial filtration. So if you imagine putting a spot at the center of this vascular network and inflating a balloon outwards, then your filtration parameter is essentially the size of. Parameter is essentially the size of that 3D balloon, and what we do is we see which parts of the network are present inside the balloon at a given sort of value of our. So, as we inflate the balloon, more parts of the network will be inside our domain of interest. We count numbers of connected components, numbers of loops. And then, when we generalize into 3D, we can also pick up other structural features. For example, we can pick up things like voids. We can also get Voids. We can also get measures of things like tortuosity as well. Tortuosity would be, I think, sort of small connected components. So, if you imagine a wiggly vessel, you might have two components on one value of your radial filtration, and then they would collide together on the next step. So, it's a way of getting, if you know how to read the sort of summary statistics that are generated, it gives you insight into more details of the structure of these. Details of the structure of these networks. So we applied these to a range of different data sets. And what we observe here, we're very much compressing a lot of that multi-scale information into some simple scalar readouts. And really, this is just to show you how maybe we just focus on this panel here at the bottom. So it's a series of tumours. So it's a series of tumours. They either have control or they've been treated with an agent that inhibits the formation of new blood vessels, inhibits andiogenesis, or it promotes, that's DLL4. And what you can see is, so we follow over time, and you can see that the trends that are observed in terms of numbers of loops mirror. Of loops mirrors what we expect for the known mechanisms of action of these particular agents. We can also get spatially resolved information about how these different quantities at different sort of if you imagine these are different annually from the tumour center, we can count numbers of loops, etc., at different radial positions and see how those are also changing over time. I think that becomes a little bit more meaningful. Becomes a little bit more meaningful when we look at the response to, say, irradiating tumours. So in this study, we took or they took a variety of a number of different tumours and they either irradiated them with a single large dose or fractionated radiotherapy over, I think it was five doses. And what this analysis enables to do is to characterize and quantify. Um, characterize and quantify the impact of radiotherapy on the tumor vasculature. And you can see how the numbers of loops and other features are changing over time. And in particular, with I think the radiotherapy, you can see where the strongest angiogenic response is occurring when we irradiate. So, I think, for example, So, I think, for example, if you look here, you can see the outer rim. There's a high-level, let me just see, numbers of loops. You can see how it's say focused towards the periphery and how that changes over time. So, there's a lot more information that we can pull out of these sorts of studies. Right, now in the interest of how much time do I have left? Because I don't want to, are we okay? We have time. It's only 10:30. Of time, it's only 10:30. Okay, sorry, I'm um, you know, when can I ask a question now that we're on? Absolutely. So, how does a doctor use this information to determine the efficacy of a treatment? Well, uh, so at the moment, really, what it's just doing is showing so. Is showing so what this is showing us is the impact that the radiotherapy is having on the blood vessels, nothing more, right? I think further down the line, so and this is sort of work that's ongoing, is trying then to link that up. What's the functional consequences of these changes? Yeah, okay. And so that's, and I think that's where it gets quite interesting of trying to. Gets quite interesting of trying to link the sort of structure of the vessel networks to their function. So we haven't, we're starting to think about that, but we haven't done it yet. At the moment, really, what this is just trying to say to you is if you have data and you analyze it in this way, you can see the impact of these different sorts of treatments. Treatments. That's really all that we're saying at this point in time. Sorry, it would be interesting if, given some of the early data, let's say, the outcome of that would direct the treatment. Yes. I.e., if you have a very highly looped network, maybe one type of treatment would be appropriate versus a more Is a more unlooped one. Yeah, yes, exactly. And I guess sort of going ever so slightly off topic, but in sort of separate work that hopefully will be published in the next week or so, we've been applying these same sort of ideas to look at, say, immune cell distributions in tumours. And there, I think there's a lot of potential for, say, looking at. For, say, looking at the using these sorts of techniques to characterize the distribution of different immune cell subtypes with a view to predicting which might respond well to particular types of immunotherapy and or by comparing before and sort of on treatment to see which ones look like they are responding well to treatment. So I think these sorts of metrics have potential, but I think it's very much still at early days. Much still at early days. So, these are things that we're thinking about. But, and I think certainly on the vascular front, the interesting thing here is linking the changes in the vessel morphology to the actual function. And I guess the thing that I've kind of swept under the carpet with the radiotherapy here is obviously the radiotherapy is having an impact on the tumour cells as well. But I guess the interest in this piece of work was really. In this piece of work, was really people tend to ignore the impact of radiotherapy on the vasculature. So, what this work was designed to demonstrate that it does actually target, have an effect on the vessels as well. And it can kind of quantify that in some ways. Okay, thank you. Right, okay, does that um right, I shall move on. Um, so that was about, um, I guess, looking. About, I guess, looking at detailed models of collected cell movement andiogenesis and one way of trying to compare them using, I guess, quite detailed topological, multi-scale topological features. Perhaps another way to go is if we have very detailed models, can we coarse grain them? And I guess here going from Them and I guess here going from micro to macro scale, can we use those sorts of approaches to compare different models? And what sorts of insights might that give us? So that's kind of where I want to go here. And really the idea, what I want to talk about is so comparing, say, an agent-based model with angiogenesis with, say, a With, say, a classical PDE phenomenological model of angiogenesis, and also taking a coarse-grained version of the discrete model. And so, there's, I guess, a number of questions there of how you compare these different sorts of models. So, back to our discrete model, the same as we had it before, an on-lattice model. Here I'm going to neglect haptotaxis for simplicity. Haptotaxis for simplicity. So we just have cells undergoing a bias random walk in response to a prescribed chemoattractant field. The cells proliferate into empty space. So the tip cells move and then the cells, the following cells behind will proliferate to occupy that space. So we maintain a nice continuous vessel. And all the other rules about branching and tip to tip and tip to sprout anastomosis. And tip to sprout anastomosis can also apply. And as we saw before, just a slightly different rendering. We can generate simulations and we can perform multiple realizations and we can average them to get sort of summary images such as those shown here on the right-hand side. And I guess it would be natural then to try to compare these to sort of PDE type models, continuum models. And if we want to think about that, then we might. And if we want to think about that, then we might go back to some of the earliest, I guess, sort of phenomenological models of angiogenesis, which due credit to Leah building very much on earlier models of fungal growth. So the assumption here is we have tip cells in the PDE model. They might move by a combination of random motion and chemotaxis up gradients of our chemoattractant. Gradients of archaemoatractant. They will branch at a rate which is an increasing function of archaemoid. They will fuse with other vessels and or with other tip cells. So we will have annihilation events. And we can write down PDE models of this form. And then the key assumption of this, what's called a snail trail model, is as these tip cells, and you can think of them as like the leader cells. Of them as like the leader cells, for example, in the neural crest work of Paul and Philip on Monday. So, as these cells, these tip cells are moving, there's a trail of stalk cells being left behind. And so, the rate at which those new stalk cells are being produced is proportional to the flux of the tip cells as they migrate out. And so, the earliest models would have been just written. Then just written if E is stalked cells, DE by dt is proportional to the flux of the tip cells. So we just put sort of moduli sign around here, and it would be a direct conversion with no. So this corrective factor here, which is going to appear in a moment, is going to be just equal to one. So we can solve this PDE equation and we can just PDE equation, and we can generate some simulations. There's our ABM data, and here's some corresponding similar PDE data. And you can see that they're not too bad. Particularly, the tip cells are in reasonably good agreement. The stalk cells, though, look a bit qualitatively the same, but there's a bit of a discrepancy. And that becomes much more pronounced if I do a cross-sectional average and just look. Sectional average and just look at how those profiles change with distance as the vascular front moves from the left to the right. So, what you can see here is that the 1D, the phenomenological model underestimates the number of stalk, the rate of stalk cell production compared to our ABM simulation. And so, it was a question we thought, I remember when PhD student did this originally, and we just kept thinking, you've got it wrong. And we just kept thinking, you've got it wrong, you've got it wrong. But it wasn't until sort of a recent PhD student, Duncan Martinson, that we really kind of got a satisfactory understanding for this discrepancy that is really embodied in the corrective factor that appeared on the previous slide. And just in a very simple way to try to explain why this happens, and really it's down to this sort of This sort of way in which we model that stalk cell production term as the tip cells move out. In practice, we've got a biased random walk and the cells move left, they move right, back and forth. And each time they move in the stochastic simulation, they're going to be laying down vessel. Now, in our PDE model, we just keep track of the resultant effect of that. And as a result, we lose all these lateral steps. lose all these lateral steps that that are sort of um not contributing to the general drift of the model from or of the network as it moves from right from sorry from left to right so if we kind of introduce um a correction factor um say this kappa here then um that can be um we can formalize a functional form for it um which is written here Which is written here. And μ and chi are the rates of random cell motion. And if you think about it, it's the random cell motion which is going to give rise to these sort of left, right, up and down. Those are the ones that are going to contribute extra production of vessel that's not that's going to add to That's going to add to the overall density of vessels, but not driven by the bias from left to right. Sorry, I hope that roughly makes sense. So what we find is if we introduce this corrective factor, then and we can work out what the values are based on the balance between random motion and chemotaxis, then the agreement between Um, the agreement between the phenomenological model and the ABM is much closer. And sorry, if you want the details, which will be explained much better than I did, then please look at the recent paper as listed here. So, and again, just to say that this corrective factor works just as well, generalizes to 2D, as you can see. Really, it's the stalk cells where we had the difficult. Cells where we had the difficulty before. So, I guess the point here is: if we think about the development of these models of angiogenesis, initially we had the continuum phenomenological models, then we kind of go back and develop much more detailed models. And by only by trying to bring them together, I mean, you could argue, again, this is a detail, is it really important? In a sense, no. In a sense, no, because the qualitative behavior is still the same. But when we want to try to use models to fit them to data to have a good understanding of the meaning of those parameters, these sorts of differences can make quite a difference in terms of interpretation, biological interpretation of the parameters that we're estimating from the data. I guess that would be a justification for the value of this. The value of this work. Just, I think, to end, what I'd like to do now is think about another axis of comparison. So what we can do. I guess we were doing a direct comparison there between outputs of our ABM and an existing phenomenological model. Another way of doing that comparison is to take our ABM and to course graph. Our ABM and to coarse grain it to develop an alternative PDE and to do comparisons this way. So that's what I'd like to talk to for the last few moments. And without going through the gory details, let me just outline the methods. And again, if you're interested, please, well, either talk about it later or I direct you to this publication, for example. So the procedure roughly as follows: we have our 2D agent-based. We have our 2D agent-based model. From that, we can generate a master equation and a mean field approximation. We can then take perform Taylor series expansions, derive essentially a 2D PDE model, which describes the densities of tip cells and endothelial stalk cells. If we average in the cross-plane, we can reduce that 2D model to a 1D. That 2D model to a 1D model, and then we can compare the resulting 1D model either with our averaged ABM simulations or with our phenomenological models. And I guess just to spare you the details, so this summarizes if you do all of that, then the resulting PDE model that arises from our ABM. Arises from our ABM looks something like this. By comparison, this is the sort of classical snail trail model that I mentioned a few slides ago. Random motion chemotaxis, tip cell production, anastomosis, anastomosis. And in particular, the key assumption about this nail trail model being that stalk cells are laid down behind these migrating. Down behind these migrating tip cells at a rate which is equal to the flux of the tip cells. By contrast, if you look at the when we do our coarse graining of the ABM, the equation for the stalk cells is quite different. We have a source term here, which is proportional to the tip cells, and we have migration terms which look quite different. Terms which look quite different. And again, when we did this, we were very surprised because if we run simulations of both of these models, as I'll show you here, they look very similar. How can that be? These equations do not look at all alike, and yet the simulation results do indeed look very similar. Again, sparing you the details. You, the details. If so, in a physiological regime, we would typically expect that chemotaxis would dominate random motion. And it's possible to use perturbation methods if we non-dimensionalize the equations and exploit the difference in, I think, it's chemotaxis dominating cell movement compared to random motion. And I think it's small rates of cell proliferation. Small rates of cell proliferation. Under those asymptotic limits, we can show that both models reduce to the same leading order PDE. And furthermore, you can actually solve that equation. But I think really it's just the principle. Again, if you're interested in the details, they're in this recent Journal of Math Biology paper. But I hope that these simulation results here sort of make that point. So, really, I'd like to. So really, I'd like to end and summarise here. And hopefully, Thomas might join me now. So, what we've tried to do is really give you an overview of different approaches to modelling angiogenesis as a representative model system of collective migration, thinking about now. About now different ways of simulating different levels of biological detail, methods for making those computations quicker and faster and more efficient, thinking about how we can use other techniques to characterize, compare different networks, and how we can also use. And how we can also use coarse-graining discrete continuum as another way of comparing and/or characterising different angiogenic networks. So, Thomas, I don't know if you'd like to say anything. I think I should have blah, blah, blah. So, yes, here was my our summary. And I guess this is trying to pull out really general. Out really general themes that I think we thought were relevant across other models of collective cell migration. So, yeah, models can be very simple, they can be very complicated. If we have very complicated models, it's nice if we've got ways of making those sort of computations more efficient. Of computations more efficient. I think Thomas showed a nice way of doing that for a particular type of subcellular model. We've talked about different ways of comparing models, whether that be statistical, topological, and with a view to trying ultimately to validate those models against experimental data. And I guess also the power of coarse-graining those models in terms of generating novel. Terms of generating novel non-standard PDEs, et cetera, et cetera. I guess just finally, I should acknowledge this is really, I guess, people who contributed to the bits that I spoke about, which sort of adds to the work that Thomas talked about. But I think I will stop there. Thomas, if you want to say any last words, that might be nice. No, I think you made a very nice summary of what we said. So, um Said, so so. Um, thank you for listening. Any more questions? Should I ask? Thank you. Well, thank you both for an extremely interesting and informative set of talks. This obviously raises many interesting sub-problems that can be pursued. So, do people, we have a good five or so minutes for questions. Minutes for questions. Do people have further questions? Thomas. I have a few questions. So let me start with the Betty number topological analysis. Really cool stuff. I like it a lot. Did you do this for healthy tissue? And can you use healthy nets work as a null model where you then deviate from or something? Yeah, that would be a lovely thing to do. So I'd like to do this in wound healing as well. I'd like to do this in wound healing as well. No, we haven't done it yet. It's taken us quite a long while, let me just say, to get that data into a format where we could do it. As I said, the computations that are under the bonnet there, which I've kind of swept through the details, it was non-trivial. Even it was someone's PhD just segmenting those data. Segmenting those data, yeah, I can see that, yeah. Yeah, a follow-up question in the same direction. So, for the angiogenesis, in the end, it is important the flux of the blood through all the flux of the blood through the network. So, can this topological analysis help to understand the flux? So, again, that's something that we're looking at the moment. We're trying to see whether or not these topological. Not these topological, particularly numbers of loops, et cetera, how those. And I guess one of the things we're particularly interested in is vessel normalization. So you can find sometimes with tumours, if you treat them, you know, prune away some of the vessels, somehow the flow is believed to transiently improve. Has that got anything to do with stripping away, having a smaller number of loops? Is there an optimal number? I don't. Is there an optimal number? I don't know. Part of my, I have a slight hesitation about that because there's a number of different ways of modelling blood flow through vascular networks. It can be quite sensitive to the models of rheology, what happens at bifurcations, etc., etc. But it's very much things that we are thinking about at the moment. But very nice. Cool. Yeah. I have one question later, but maybe I'll give Leah the floor for now. Give Leah the floor for now. Thank you. Very interesting set of talks. So, my main question is: there are other groups who model blood vessels, like, for example, Mercks, and maybe there are others as well. So, I'm trying to wrap my head around what is the main difference in the outlooks between such groups. Well, so that's why I would like to find. Well, so that's why I would like to find ways of comparing them. Are they answering? Uh-huh, right. And are they trying to answer different questions from what you are answering? Sorry, my internet is a bit flaky, so I don't know if. I guess there's a number of different people developing so. Developing. So, sorry, Thomas, if you want to answer the in, you're most welcome. I guess what I would say is different people develop models using different frameworks depending on where they come from. So, some people are sort of wedded to POTS models. Some people use sort of on-lattice, off-lattice. Some people are bothered about, it depends on the biology and the questions that they're trying to answer. And probably, yeah, the data. And probably, yeah, the data or the experimental collaborators that they're working with. To me, I think an interesting question is to try to take those models, apply them to a sort of a similar problem, and try to see the sense in which they are comparable. And I think some of these tools now would allow you to do that. Are they equivalent in some sense? Because they all do roughly the same thing. In some sense, because they all do roughly the same thing. We see, you know, they migrate out, and they, but it would give us a much cleaner way of doing that comparison. Yep. Thank you. Yeah, I think that, and again, how much detail does it make very much difference in that structure if I put in, you know, if I do it on lattice, off-lattice, if I have Delta notch talking to VEGF or whatever it might happen to be. Happen to be. Thank you. I think we have time for one more question, Paul. Thank you. So, really cool stuff. So, can you use the continuum model to inform the topological features model rather than the actual biological data? So, in other words, could you run the radiation therapy simulation in continuum like 10,000 times and let it inform? Thousand times and let it inform the topological. Can you say that again slowly? Yeah, the link between the continuum and the topological model. Yeah, so I would say at the moment, the continuum models don't really think about any of the topological structure of the networks. They're built without worrying about it. So something again that I Something again that I think would be interesting to do is to derive continuum models or some sort of models that try to quantify those features in them. But that hasn't been done yet. Well, in fact, I think that would be very difficult to do because the continuum by definition has everything spread out in space. And so it's pretty hard to put in a loop. To put in a loop precisely. But you could quantify the numbers of loops. And that rather than sort of having a vessel density, it would be a way of distinguishing between I got a vessel density that 20% is vessel. It would tell you something a bit more about whether it was one very long vessel or what. I don't know. I don't know. There are also face field models that they don't look at. that they don't look at they don't look at them