More recently we started working together, which has been wonderful. So I hope it keeps going for many more years. And so today, Andrea is going to talk to us about evanescent plane waves and their approximation. The mic is yours. Thank you very much. Yes, as some of you know, I was planning to be in Noraca, but things went a bit differently from the planes. Things went a bit differently from the planes. Hopefully, we'll be there next time. Hope you are enjoying the workshop there. Um, so I'm going to talk about my joint work with Nicola Galante, who was a master's student in Padilla and now is a PG student in Paris. Dan Hui Brex, which many of you know, is in Leuven, Emile Parolaine, who you also know AIC is, I think the audience is connected, who used to be. Is connected. We used to be a postdoc in Pavia and now has a position at Tim Ria in Paris. And I'm trying to summarize these two papers. The first one has been published last year, and the second one is on the archive. Basically, the first paper is on the two-dimensional case, the second one is on the three-dimensional case. So in these slides, I'm trying to merge the two cases in one common framework. I'm not sure I've been very successful. I've been very successful. Let's see. So we're talking about the Helmholtz equation. You all know this equation, plus u plus k squared u equals zero, where k is a positive number, the wave number is relevant whenever we have time harmonic, so sinusoidal in time solutions of linear wave equations. So whenever we are in acoustics, electromagnetics, elasticity, and Magnetics, elasticity, and we have these time dependents. We have either Helmholtz or some more complicated version, like the vector cases for electromagnetics and elasticity. So this is a very simple equation when k is small, just a regular perturbation of Laplace equation. But we know well that when the wave number is large, we enter. The wave number is large, we enter in high frequency problems, and so we need we encounter a lot of difficulties. One of these difficulties is that to approximate a fung a solution like this one, and still using this picture with all these bounds, we need typically a lot of degrees of freedom. So, when we use piecewise polynomials, so one wants to use different. To use different kinds of basis functions rather than use bismuth polynomials, and the typical choice is to use propagative plane waves, which are just this complex exponential exponential of imaginary unit with number d dot x, where d is a unit real vector. You have already seen yesterday in the talk of Peter, for instance, use of plane waves. Typical use is in TREFS methods, that's the reason we are in this workshop. And here in this Are in this workshop, and here I'm listing a lot of acronyms of different variational formulations for the Helmholtz equation that have been used in combination with plane waves. But plane waves are used to approximate Helmholtz solution also in other situations. For instance, in acoustics, people sometimes want to reconstruct a sound field, not by solving a boundary value problem, but just from some point measurements, measurements from microphones, so they don't have boundary conditions, maybe don't even know. Boundary conditions, maybe don't even know the shape of the room, but still they want to approximate some Hermes solution, and they do so by doing linear combinations of plane waves. A very good point about propagated plane waves is that they are very simple functions, they are just complex exponentials. So you can evaluate these functions in billions of points for your computational cost, you can compute all the derivatives by hand. You can compute all the derivatives by hand. You can compute all the integrals that appear in Treft's methods, like integrals of products of derivatives of plane waves on polygons or polyedra, analytically formulas to compute basically all the things that enter in a DG formulation on a polygonal polyethylene mesh analytically. So without quadrature. Analytically, so without quadrature, which is very convenient and gives very efficient assembly of matrices. So, there's a reason to prefer plane waves instead of other kind of TREFS functions, like silkworm waves or so on. Another good reason to use plane waves is that there is a good approximation theory, but complete the same, starting from the paper that. Starting from the paper that was mentioned yesterday by Bruno and Cessna. But there are sort of two strands of two ways of proving results or approximation results for green waves, one originating from the Viberweces and the Prey and one from the thesis of Marcus Mehlenck. They give sorts of parallel results. But the substance, the main outcome. The substance, the main outcome is that you can approximate Helmholtz solutions with better accuracy per degree of freedom using plane waves compared to polynomials. But we also know that there are, these are the good news, that there are also some bad news. The plane waves suffer from some kind of instabilities. So we want to give you our point of view on instabilities. Instabilities. So show you a small negative results. Take a domain omega that is the unit disk or the unit ball. We're able to prove things in this simple geometry. So unit disk in 2D, the unit ball in 3D. And choose some wave number, what you want, your favorite norm on the domain, can be H1 on the disk, L2, any finite order. Any finite order Sobolev norm. You can normalize such a way that all the plane waves have norm one. Since all plane waves, if you use any Sobolev norm, all plane waves will have the same norm on the disk. And choose whatever accuracy you want to achieve. So you want to have 1% accuracy, two digits of accuracy, 10 digits, fine. But even if you are only aiming for 50% accuracy, Aiming for 50% accuracy, we can show some negative results. Then choose whatever number of plane waves you want with whatever directions. For instance, in 2B, you can take a V-space, you can take extremal points or any smart choice in 3D. For instance, yesterday Repeater mentioned some kind of directions on the sphere. And then choose some large number, some number you don't want to see in the outer. Don't want to see in the output of your code. It can be your telephone number, your telephone number squared. I like to take 10 to the 20. Then we can show the following. We can give you a function u, explicit, a very simple function. It is a C infinity solution of the Helmholtz equation in the whole space, normalized in such a way that the your norm sine h one is one on the domain. Here it's important that this norm is a norm on the domain, not a norm on the domain. norm on the domain, not a norm, only a norm on the disk all. And if you have any vector mu, any coefficient vector in such a way that the linear combination of the plane waves you've chosen with this coefficient of this vector mu in your norm is sufficiently accurate for you. So every so the error is smaller than delta. So this is both a relative and absolute error, because you normalize u to one. Because you have normalized u to one. So, whenever you have an approximation that is acceptable to you, we can show that for these special u that are chosen, the size of the vector, the coefficient vector, is larger than the largest, this large number m that you don't want to see. So, this sort of tragedy is this means. This means that to have accuracy, you need huge coefficients, at least to approximate these u. And why having these large coefficients is a problem? Well, if you are working in for doing analysis and you just want to prove results, that might be fine. But if you want to do computations in machine precision, if you want to approximate some u with the size one, Some u with size 1, with a linear combination of objects, plane waves of size 1. And to do so, you need to use coefficients of size 10 to the 20. This means that you have to rely on cancellation. These plane waves combined together give an approximation of u only because they cancel each other in some way. So plane waves with nearby directions will cancel each other. Will cancel each other, and the digits in this coefficient will give the approximation of u are not the first digits, are the least after the number 20 in this vector. Because the first 20 digits, if this vector is a size 10 to the 20, the first 20 digits are used to cancel one element of the vector with the other elements. With the other elements. So if you use only double precision, 16 digits, there is no chance you are able to compute these on your computer. So even if you compute this coefficient by hand analytically, and then you put them here in this expression, then you're not able, and you compute this approximation of U in double precision, then you're not able to plot the solution. So this is what is our point of view on the instability. View on the instability in the approximation of Helmut solution by profagative plane waves. So, in our point of view, this is the source of all the troubles one encounters when dealing with a transmetric based on plane waves. So, ill conditioning, the stagnation, the convergence, the tricky dependence on parameters that were also mentioned yesterday are Are not the main source of instability, are sort of the symptoms of something deeper, the lack of small coefficient approximations. So the existence of this small coefficient approximation is a necessary condition for stable computation in floating point, in computer arithmetics, but according to this paper by Bernard Cook and Uibrex, there are also a sufficient condition in this sense. In these sense. The main message we get from these papers is at least for our purposes, is the following. If we want to approximate an element V of a vector space, vector V, using a linear combination of some approximating functions, imagine this as a basis, but can be redundant, can be linearly dependent. If you have a linear, there is, if there exists. If there exists a linear combination of these approximating functions that gives good approximation and small coefficients, then there is a recipe to achieve good approximation in computer arithmetics if you follow the right procedure, if you do over sampling and some regularization. So if it So, if it exists approximation with small coefficients, then there is some way, probably expensive, but a stable way to compute it numerically. And the interesting thing here is that this does not depend on the condition number of any matrix. There is no matrix here. If this is not a basis, these 5p are a redundant set, they're linearly dependent, whatever matrix you build from them is singular. So the ill conditioning is not the right way to measure how good or bad is this choice of basis or this approximating function phi p. One wants to verify the existence of good approximation with multiple fictions. And we know for plane waves, propagative plane waves, can prove good approximation. This was proved several years ago, but not possible with small coefficients, at least for some functions. Small coefficients, at least for some functions, for some target functions. So, what's the solution we propose? We propose to use evanescent waves, evanescent plane waves. What are these? These are simply complex exponentials in the same shape as before, but with a vector d, that now is not a real vector, but it's a complex vector that satisfies this condition, d dot d equal one, where d dot d is not the norm square of d, is this expression. Is this expression, this sum of squares, which is a complex number in general, and we impose these complex numbers to be equal to one? So this is not a new idea. These evanescent waves were already used by Wintes Mei and the people in Leuven. They are mechanical engineers, they do wipe acoustics, they have a method, a traffic method called WBM, wave-based method. Wave-based method, which is a variational formulation combined with a combination of a discrete space that is a combination of propagative and evanescent waves. So under this assumption, d dot d equals one, these are Helmholtz solutions. And the good thing is that they're complex exponentials, like the propagative plane waves we've seen before. So computation is still very cheap. Evaluation, quadrature, everything is very cheap. So, if we can get a good approximation and stability result for these functions, then we are in good shape. We don't use the simplicity of Trafs methods plane waves. So, vector D, this is a complex vector, has a real part and an imaginary part. So, we can decompose this expression, the vanescent wave, as a product of two terms. One is a One is a propagative wave in the direction a real part of D. But this is a propagative wave with a shorter wavelength than the usual propagative wave force with this wave number. And this is multiplied with a real exponential. Here there is no imaginary unit in this second term. It's an exponential that decays in the direction minus imaginary. Direction minus imaginary part of D. So this evanescent wave is a wave that propagates in the direction real part of D and decays in the direction imaginary part of D. And these two directions are orthogonal to one another from this condition d dot equal one. Since the magnitude of this is a real exponential, one has to be a bit careful with the normalization, which for propagative plane wave is not a problem, you have to be careful because otherwise. To be careful because otherwise, some domain wave can be very small, in some other can be very large. But since the expression is simple, you can do it very easily: infinity, polygon, polyedron, but also L2, and you can compute, or H1, you can compute the normalization simply. The second consequence of the fact that the magnitude is an exponential is that these functions are different from zero. These functions are different from zero everywhere, but numerically they can be localized in some part of the domain. For instance, in this example in 2D, most of the wave is concentrated on the right side. I hope you can see my mouse, the screen. And in some parts of the domain, the wave is very small, and if you The wave is very small, and if you increase the size of the imaginary part of D, you get a wave that is machine precision is equal to zero in most of the domain. So we want to parameterize these plane waves, even as in plane waves, in a different way, not with the direction d, because dealing with a vector d, complex vector with d dot equal to one is not simple. So we rewrite this. So we rewrite this equality as two conditions: one on the directions of the real and the imaginary part of D, or to each other, and one on their magnitudes. It's an equation here. So we'll introduce some more parameters. Here I'm cheating a bit, it's not really what we do, but it's the simplest way to include 2D and 3D in one slide. So we call P the propagation direction, so the direction of the real part of D. Direction of the real part of D, so this is a vector in the humisphere. And then we call E the evanescence direction, the direction of decay. So this direction of the imaginary part of D. So this is a unit vector, but a unit vector perpendicular to P. So basically, it's a unit vector in the lower dimensional sphere. Then we have to take into account how strong is the exponential decay. So we call eta. The exponential decay. So we call eta the magnitude of the imaginary part of the vector t. So this is the strength of the evanescence of this evanescent. In particular, if eta is zero, then the imaginary part of d is zero, so d is real, and so the evalescent plane wave is a propagative plane wave. So propagative plane waves are a special case of evaluation plane waves for eta equals zero. Then we collect these three History object P E eta in a parameter vector y, so I forget the details about P E. And we say that every plane wave is determined by a vector y that lives in some domain capital Y, doesn't really matter what it is, and we use the notation Ewy to denote the evanescent wave with parameter y. Why? Then in 2D, things are much simpler than saying that 2D, the propagation direction is a vector in the unit circle. So we just use an angle in 0 to pi. And given the propagation direction, then the wave can decay. There are only two orthogonal directions, one vector in 2D, left or right. So the finescence direction is either left or right. In 3D, things are a bit more complicated. D, things are a bit more complicated. We actually don't use this vector, but we want to use Euler angles of rotation from some reference direction to D. That's a detail we don't use in the slides. So we want to use, we want to approximate Helmholtz solutions in terms of propagative and evanescent waves and compare the two cases. So we start from a continuous representation of. Representation of Hermann solution. So we recall a definition that is classical, you can find it in the books of Cotton Cress and many papers on inverse problems, the definition of Erglos functions. Erglos functions are just continuous superposition of propagative plane waves. These are propagative plane waves. They are parameterized by the vector D, propagation vector, which lives in the unit sphere. So we take continuous continuation. So, we take a continuous combination of propagative plane waves. So, the coefficient in this representation is a function v, and if this function on the sphere is in L2, and this function is called the Erglots function. The point is that only some Hermann's functions are Herglots. So, only very smooth functions, not even all Helmut's smooth functions are. And smooth functions are erglots. For instance, a plane wave cannot be written in this way because it would need a delta function, not an L2. So when we have an ergloss function and want to approximate that Q, then okay, we can do a sampling of this density V and this looks like a Something we can approximate easily with plane waves and small coefficients. But in general, this is not possible. So we want to extend this representation to evanescent waves. So we want to write Helmholtz functions as a continuous combination of evanescent waves. This now is an evanescent wave with a propagation direction that is complex. But now the context. But now the complex directions don't live only on the unit sphere, but they leave the complicated domain y, we have seen before. So we need to integrate over y. Since y is an unbounded domain, we need to put some weight here, some general weight w to take care of what happens at infinity for very large values of eta. And here we've eta and here v is again the density in the the continuous superposition of evanescent waves. So we can imagine this operation as an operator T acting on the density V that combines all the possible evanescent waves with coefficient V of y. So this is operator mapping V into U. So what we want is So, what we want is to show that for every Helmholtz solution, for every U, there is some V. So, we can represent every Helmholtz solution in terms of evanescent waves and superposition of evanescent waves. We also want this coefficient function V to be small, to have a size comparable to U, to the norm of U. So, some weight, the weight related to norm of this density to be proportional. Of this density to be proportional to the H1 normal field. What we can prove is this result. If the domain is a disk or a ball in 2D or 3D, so this is a strong simplification, of course, it's a very special case, and this operator T takes as input a density function V and gives us output H1 Helmholtz function. One Helmholtz function is an invertible such that the superposition of evanescent waves with density v is u. And the size of this coefficient is not large, it's bounded. Is not large, is bounded by the norm of the inverse of t times the h1 norm of q. To do this, one has to use the networite weight, and the weight that seems to work is simply a negative exponential to sort of penalize evanescent waves with very strong evanescence times some algebraic correction. Here we can note a few things. The first thing is that the main tool we use is the expansion of evanescence. We use the expansion of luminescent waves in circular and spherical waves. So that's the reason why we need to use spherical geometry. It is an extension of the classical Jacobi-Anger expansion. I will show you the next couple of slides. If you are into harmonic analysis, this result means that when Semplin waves are continuous frames for this space of Hermann solutions, and this is the starting point for a numerical recipe. Numerical recipe. We don't want continuous representation, we want a discrete, finite representation, finite approximation of Hermann's solution in terms of evanescent waves. So we can imagine that at the end of the day, we want to do a discretization of this integral, a quadrature by quadrature to this integral, by a finite sum of evanescent waves that approximate Hermann social mu. And we also conjecture that the right hypothesis on the domain is not a disk or pool. What is a disc or pool, but that is has to be a convex element, a convex shape. And in this case, one has to, for shape different from the disk, one has to take, modify the weight. We are not there yet, but Emil and Nicole are working in this direction, and they already have a lot of results. So, what are circular and spherical waves? Very simple, these are solutions of the Hermann's equation. Solutions of the Hermes equation that are separable in polar coordinates. So, in 2D, they are just Bessel functions times circular harmonics. In 3D, Bessel functions times spherical harmonics. In what case, we normalize multiplying with beta L, which is just a normalization in H1 norm. And one can compute using the symptotics of the cell functions the asymptotic behavior or large indices of the For large indices of the beta L. So, for very large indices, L grows exponential. Since the angular direction is this circle or spherical harmonic, these are orthogonal in the ball. And so, since we have normalized in H1, these are both of them are orthonormal basis of the space of Helmholtz solution. H1 Hermont solution in the disk and the ball perspective. They have sort of different shapes if the index L, the Fourier index L, is smaller or larger than the wave number. If L is small, we have sort of bulk waves that are supported in the disk or the ball. While for large indices, we have sort of evanescent circular waves. They are different from zero, but numerically. Different from zero, but numerically they are very close to zero in most of the domain, and they increase very rapidly when we approach the boundary. So moving from the boundary to the interior, they decay exponentially very quickly. So you see there is a relation with evanescent waves. We can also see that these are Hergloss functions, very easy to compute, and the density, so Hergloss functions. Density so eros functions remember means superposition continuous superpositions of propagative plane waves, but the coefficient in the continuous superposition is proportional to beta L. And since beta L grows very fast, here you get some very fast growth of the airlocks density. So this is in agreement with what I said before, that for some Helmholtz That for some Helmholtz solution, any representation with factory plane weights requires huge coefficients. And this suggests that these bed LMO solutions are those corresponding to large Fourier modes. So we can, since these are an orthonormal. Are an orthonormal basis of the space of Helmholtz solution in the ball. But we can write the propagative plane waves as a sum over these basis elements. And plane waves, Riemann solutions, so we expand in this basis. The Jacobi-Angel formula is exactly the formula that gives analytically the coefficients in this expansion. It's a very well-known thing, but Jacobi means it's not a recent. Copy means it's not a recent result. And you can write it in 2D and 3D. What do we understand from this? What do we learn from these expansions? Learning from the 3D is not easy to read, so let's look at the two-dimensional case. The Fourier coefficients are complex numbers, and we want to look at the absolute values of these complex numbers. This is the coefficient for This is the coefficient for the plane wave b direction d, and the direction d enters this expression only through the angle of the direction. And the angles enter through this exponential, which is complex exponentials. So the absolute value is independent of T. The absolute value of this coefficient is the absolute value of the inverse of beta L. So the absolute value of the Fourier coefficients of Value of the Fourier coefficients of circular waves, circular wave is decays like more than exponentially, like L to the minus L, because it's the reciprocal of beta L. So if we plot the flux coefficient of a propagated plane wave, this is the plot we get. That is the same plot we get for any plane wave. Because if you rotate the plane wave, you just change this. You just change the complex argument, not the magnitude. And this plot is very important. Why? If we want to approximate circular wave B L with L say equal to three times the wave number that is here in this position. Every plane wave, and you want to approximate this using a combination of propagative plane waves, every plane wave can control. Every plane wave and contribute only a factor of 10 to the minus 16 to this Fourier mode B L. And since they are orthogonal, the error modes cannot help. So you have to multiply, you have to have coefficients of size at least 10 to the plus 16 to be able to approximate the circular wave with this large edge. Circular wave with this large L. And so this is basically the proof of the result at the beginning. So now we know what is the mysterious function u. If you want to approximate a circular wave BL or BLM, if you are in 3D, then a linear combination of any number of propagative waves, any choice of the direction in each one norm, say, and you want to achieve some error delta, then Or delta, then the coefficients in this expansion have to be larger than one minus delta, which is basically one because delta is the error, so it's a small number, times beta L. So beta L is the normalization, is what is in this plot. If L, the Fourier index, is smaller than kappa, and you have a bulk wave, then these are small numbers, that's not a problem. You can approximate well bulk circular waves. bulk wave bulk circular waves in using propagative prime waves but if L is larger than kappa than K then this is a small number and so this is the oh this is the reciprocal B L is a huge number is larger than L to D L so this is the reason why we get huge coefficients in the approximation of some circular wave Of some circular waves, the circular waves with large Fourier index L. So now we want to do the same thing. We want to extend this formula, this is Jacobi-Anger expansion, to evanescent wave. This is the expansion of a propagative wave. So we can write the same formula for evanescent wave. This is very horrible. The 3D is complicated. That is, we have to use Wigner matrices that are the matrices that are used for. That are used for rotation of sterical harmonics, and we have to use the associated gender function, the functions that are used in the definition of stherical harmonics, but outside of their natural range. Usually they are evaluated in minus one, one, they are weighted outside, so you have to be careful with branch cuts. So to look at the 3D, let's look at the 2D version. Here we have the same formula as before, except for this red tear with expansion of Evanescent wave, we have to take into account the strength of the evanescence, what's called the eta. So now we have this algebraic factor that corrects the coefficient. And this is a good news because this means we can choose evalescent waves with different evanescence strength eta, we can move. Eta, we can move the Fourier content away from the region where there is the Fourier content of all the propagative waves. What do we mean with this? Here we have seen, before we have seen the absolute values of the Fourier mode of a propagative wave, that was this red curve in the center. Now, if we have evanescent waves with different values of the evanescence, we move and we plot the refourier the absolute. We plot the Fourier absolute value of the Fourier coefficient, we get different curves. In particular, if you use a strong vanescence, here is using a different parameterization just for making things more confusing. This is just a change of variables with eta. If you choose, say, eta, proportion to like exponential, exponential of two, we get evanescent wave. Uh wave with um wave with Fourier uh content localized around uh 4k, for instance, for times the wave number. So if you want to approximate a circular waves with index L equal 4k, then we just have to use some circular waves with some evanescent waves with evanescence chosen according to this black line. Black line. So, this is a good sign because sort of suggests that plane wave, even as a plane wave, can cure the problem with counter with propagative plane waves. Skip this. So, just one slide on the proof very quickly of the result I shown before. I want to prove the invertibility of this operator. That assembles plane even SM plane waves with a density V, giving as output a Helmholtz solution. Let's consider just the two decays for simplicity. We define some functions A L that are functions of the parameter y. So they're function that li on the space of parameter capital Y. Parameter capital Y. These are horrible things. They are complex exponential in the angular direction. Now we are in 2D, so the parameter space contains the direction of the propagation of the wave. So we have complete exponential here, multiplied with some algebraic factor in eta, the strength of the Of the decay. Since the weight in this weighted L2 is a negative exponential, all these functions belong to weighted L2, because they're an orange product, against an exponential factor. So we can normalize them to have weighted L to normal, well to one. So this alpha L is just a normalization, and they are they are orthonormal functions, so they are autonomous basis of some space, the room span, which is a subspace of L two. Spain, which is a subspace of L2. Why do we do this? This was the factor that was appearing in the Jacob-Junger expansion of evanescent waves. So we can rewrite the Jacob-Yanger expansion in this sort of abstract form. We can expand every evanescent wave as an infinite sum of some function of the parameter and some function of the position. The position in physical space X. And since both A and B are contain a normalization, alpha L and beta L, you have to compensate dividing by alpha L beta L. And then we can prove that this coefficient that appear here outside is bounded above and below by in a uniform way, uniform in L. And this is the technically difficult thing because here we have to use asymptotic or special functions. Functions and so on. Then, not going to details, but if you think about it for 10 minutes, you realize that this operator is diagonal in this orthonormal basis, precisely because they are orthonormal. So, this is the meaning of this A L function. The A L function is the density in this mysterious parameter space, this capital Y. The density in the linear combination of evanescent waves that gives precisely a spherical, a circular wave. So, if you assemble evanescent waves with the coefficient A L, with this formula, what you get is a circular wave up to a coefficient Ï„L. Since the tau L are bounded uniformly above and below, this means that this diagonal operator between the orthonormal basis is. Operator between the orthonormal basis is bounded and invertible. So this means that for every u there is a v, because the operator is invertible, that is mapped into u. So for every Helmholtz solution, there is a linear combination, continuous linear combination of vanescent waves that gives exactly U. And the coefficient in this expansion, this V, is bounded uniformly in the normal. In the L2 norm by the H1 norm of U. Just one slide before showing some plots. This is all at the continuous level. We want to do finite approximations of Helmholtz solutions. So we want to choose a finite set of plane waves. waves that gives that is able to approximate our target function. So we want to choose some points yp in the in the parameter space y such a way the corresponding evanescent waves are a good approximation. This is like doing a quadrature for the integral representation we've seen before. But using standard quadrature rule doesn't quite work. Rule doesn't quite work, so we borrow a technique from a paper by Albert Cohen and Giovanni Migiorati. What do we learn from their paper? We fix some Fourier truncation level, capital L. We define a probability density on the parameter domain Y. So this is the space, the set that contains all the sort of parameterizes all inescent waves. parameterizes all evanescent waves and these can compute is um verify quite easily is a probability density then one can draw samples from this uh from this probability density can generate nodes in y in the parameter space according to this probability density in a random way or um pseudo random quasi random or in a deterministic way Or in a deterministic way. And then from their paper, my other coin join minority, we expect that any element in the span of the first Fourier Bessel circular waves can be approximated by the evanescent waves with parameters corresponding to the nodes we have sampled from the The nodes you have sampled from the probability density with more coefficients. So it's complicated. And you have a domain with a probability measure. You sample this measure, get some parameters, some samples, and for each of them, there is a corresponding evanescent wave. You collect a certain number of these evanescent waves, and the entities normalized in some way. They can apply. They can approximate all Fourier Bessel functions or circular waves or spherical waves in 3D with small coefficients. And using the Adco-Wilbrex theory, it follows that also these are computable numerically using truncation and oversample. Yeah, use the word expect because this is what their paper said. This is what their paper suggests, but we're not able to prove to have a complete result for this. But we have some intermediate results, and this is confirmed very precisely by the numerics. Here there is this parameter L that is basically the target level of the I mean, if you want to approximate 48. If you want to approximate Fourier Bessel functions, circular waves of parameter little L up to capital L, you can build a space of plane waves, penescent plane waves, with this procedure tuned to that range of Fourier modes. So, show you some pictures. Start with a circular wave. Here we want to approximate this circular wave with Wave with propagative and evanescent plane waves. We use a collocation of the boundary and location of the S B D truncation of the S P D regularization of the matrix. And we see that this function can be approximated very well both by plane waves and evanescent waves. It can go down to 10 to the minus 14 accuracy. Accuracy. And actually, propagative plane waves are more efficient than evanescent plane waves, where the evanescent plane waves are sampled according to the probability density in the previous slide. So for this target function, propagative plane waves work perfectly fine. But if we increase the Fourier index L, we're not taking a huge number. 40 is 2.5. 40 is 2.5 times the wave number. We see that with propagative plane wave, we don't get some accuracy, but not much. We get to the 10 minus 4 in this case, and increasing the number of degrees of freedom, we don't win any. While even SM plane waves, in this case, are much... Even asympline waves in this case are much more, can get almost the same result as for the propagative mode. We can get down to 10 minus 12, and if we continue, we get even better error. While for propagative plane waves, there is no way you can improve this. Why does this happen? Because the size of the coefficient vector, here on the right, you see the size of the coefficients, the size of the coefficient vector for the approximation of the evanescent model. Approximation of the evanescent mode by propagating plane waves grows very quickly. When it reaches the inverse of the machine precision, then SBD truncates this vector. So here we don't see growing because there is no point in growing. Then we won't give any better result. So from this plot, we also see that condition number is not the main point. It's not the main point. For the upper plots and the lower plots, we use the same matrix. One matrix for the propagating waves and one for the evanescent ones. But when we look at the propagative waves, for this propagative mode, for this bulk mode, we get down to the 10 to the minus 14. These are the case, we get 10 to the minus 4 with the same matrix. So the Matrix. So the issue you have here in the lower plot is not due to the condition because the matrix is equally ill conditioned in the first case. It's a matter of lack of good approximation with small coefficients. So we skip this, which is a bit complicated. This is a more complicated function, again in 2D. This is a linear combination of 400 Fourier modes. The Fourier modes, circular waves with a very slow decay, so it's a complicated function in the humid disk. And we approximate this with this real part on the left, absolute value on the right. We approximate this with vanescent and propagative waves, and this is what we see. So similar plots, but with very different scales. Propagative waves on the left, we get error. The value of the error is about eight. Value of the error is about eight. There is not 10 to some negative power, it's eight, so it's a 30% error. While on the right, we have approximation by UNS and plane wave, and here we get 10 to the minus 9, in both cases using the same number of degrees of freedom, 800 degrees of freedom. So, with the same effort, basically, bidding matrices of the same size, we win, going from propagative waves to evanescent plane waves, we gain nine orders of magnitude. And here, you can say. Magnitude. And here, you can say, maybe you need more degrees of freedom. No, if you increase the number of propagative waves, you don't win anything. While if you increase the number of evanescent waves, here you win more. Also, the number of degrees of freedom is very impressive here because they're using 800 degrees of freedom to approximate a linear combination of 400 moles. So there is a sort of oversampling only of a factor of two. This corresponds to one degree of freedom per wave. So something that even we. For something that even with polynomials would be very difficult to achieve. We can do the same thing in 3D. Here, on the left, we have, here there is no solution, just the error on the boundary of the sphere and on sort of the sections of the sphere. On the left, there is the error with the propagative waves, on the right, evanescent wave. And here we see that the error is 10 to the minus 1 with propagative waves and 10 to the minus 9 with evanescent waves. With evanescent waves. Again, a lot of saving in the degrees of freedom. And not because the propagative waves don't have good accuracy properties, because they don't have accurate approximation with small coefficients. So, so far I've been talking about disks and balls, but numerically you can do the same things for different geometries. These are hexagon. Here the target function. Here, the target function is a fundamental solution with the center a bit away from the hexagon. And we see that if we compute the error for different values of the different number of degrees of freedom with propagative wave, we get convergence until some point, and then convergence stops. You increase the number of plane waves. You increase the number of plane waves, and you don't mean anything. These are red and blue curves, are those with propagative waves, with the singularity located in different points next to a site, next to a tip. And you're not going to get any better result than this, while with the propagative, with the evanescent plane waves, we can go down to 10 to the minus 40. We can put this basis. Put these basis functions in a thread DG formulation. This is a very simple example with eight triangles in a square and approximating a corner singularity. So this is a typical singularity you find in numerics next to a corner in your domain. And this is a function that is in with this point two terms is between each one. Two terms is between H1 and H2. And we see, so there is a singularity here on the left side of the domain. We see that evanescent waves give convergence throughout the degrees of freedom we compute, while propagative waves give the same result for small values of the degrees of freedom, and then they stall and they don't improve anymore. So convergence stalls at some point. Stalls at some point. This is a similar result to what Peter was showing yesterday. And indeed, close to singularities, he also had to do something different than increasing the number of ways of refining dimension to use polynomials. Skip this. So I conclude, just to summarize the approximation. As in the approximation by propagating plane waves is unstable, which is often news. Everybody who has used propagative plane waves knows it, but our point of view is that the main point in this instability is that for the approximation of several target functions, accuracy requires large coefficients. And large coefficients lead to cancellation and all sorts of issues when you use. When you use floating-point arithmetics, on the other hand, evanescent plane waves are equally simple to evaluate and to manipulate, but they give stable results. And the key in the understanding of the relation between evanescent waves and the approximation of evanescent waves is this integral representation of all Hermes functions in terms of. In terms of continuous superpositions of evanescent waves. And then this is a continuous level result. And then we go to discrete approximation, finite approximation using sampling in the parameter space y. Another message is that the conditioning of your metric is not the main point. The point is existence or non-existence of small coefficient representations. Of course, this is a Of course, this is only a starting point. We are working on many more teams, actually, Blaney. Emil and Nicole are working on many more follow-up of this, in particular on the extension of these results to more general geometries. We believe that the real assumption we need is convex, not spherical. And then the proof, the proof of the stability. Proof of the stability of the approximation by Brazil made a discrete level. Then, of course, this algorithm is not the most friendly. Say we are using SPD, which is expensive, so we want to do faster linear algebra, and we have this sampling of the probability density, which is not too difficult, but is also we hope to be able to write a more concrete and simpler version. concrete and simpler version and want to understand how the how to use the what's the best way to use this in a DG method in a Trev's method and also to understand where you really need evanescent waves for instance if you have a DG mesh probably in the elements away from the boundary you don't really need to use evanescent waves propagating waves are enough but understand exactly when you need them when you don't is not When you don't is not completely clear. So, as I said at the beginning, I'm summarizing two papers: one in 2D, that is on the 2AN, one in 3D, which is on the archive. And there are also the numerical codes available, the first in Julia and the second in MATLAB, written by Emil and Nicola. They will also present this stuff on something related at WAVES in Berlin in a couple of months. Particularly, Nicola, we talk about the generalization to other kinds of The generalization to other kinds of geometries, and that's all. Um, thank you, right? Thank our speaker. So, do we have questions in the room or online? Okay, do we know? Okay, can you please online tell us if you can hear Bruno now? You hear me, Andrea? Yes, I can hear. Okay, hi. So, my question is about, okay, it's a technical question on your method. So, there is the rule of the weight function W. Do you think it is really important to have the best tuning of this weight function? Of course, I understand that for the theory, it is important. The degree is important. But do you think that at the end of the day, how people say for the numerics, it is important to have the best tuning of this weight? No, I think it's important for the proofs, but not for the numerics. Probably this algebraic factor will disappear next to the exponential. So I guess if you want to prove. I guess if you want to prove things in general, you need all the right weights, but in probably for computations, it's not that relevant, fine-tuning. Okay. And also yes, and also in conclusion, propose you say that it is interesting to look at at exactly this for example, this this lot representation to understand what it okay. It was good before. Okay, it was good before. I didn't understand the yeah, the antique ral representation, the Derglotzen representation. For example, yes, this one. Yeah, this one is okay. And that you would like to extend first to convex main. So, can you explain us where the convexity can play a role in the fact that? in in the fact that the representation it could so it is the convexity here of uh of the domain of b one b one instead of the ball it would be a omega yeah if instead of omega here you have a convex domain we believe that same two two oh why the convexity i believe i'm quite convinced that if he's a non-convex is uh um difficult uh but it's difficult without drawing a picture maybe um Maybe a second and draw a picture on the screen if my computer collaborates with me. Okay, wait, I wait a second, I share another screen. Okay, do you see Alan? Yes, we can see excellent, it seems to me. If your domain is a banana-shaped domain, so the non-convex domain, if imagine your exact solution is a fundamental solution or a Fourier Enkel function. Or a Fourier-Henkel function centered here. So you have an evanescent, you have something large in this region, and then decay away from this boundary, from this part of the boundary. I don't believe there is a small coefficient representation of this with evanescent plane waves, because evanescent plane waves are sort of well-defined. Well defined are good in a half plane. If you imagine the part of the plane where the evanescent wave is smaller than one is half plane. So they are good to cut out convex shape. And you cannot fit evanescent wave around a non-convex part because if they are fit to Fit to approximate this part, then they will blow up in this part behind the non-convexity. Yes, but at the end, for numerical methods, probably we will cut this non-convex object into smaller convex or almost convex parts if we think of the numerical methods. Okay. Sorry, I didn't hear. I suppose he's talking about meshing and doing it on mesh elements. And doing it on each element. Now, if I do a meshing and I use your ideas in all the small cells or the smaller parts, they all will be almost convex, so the obstruction will not be the same. Yes, yes. If you build a mesh and all the elements are convex, that's fine. If they are close to convex, and if you make smaller elements, you can get something close to convex, then you expect to get good results. Yes, the And yes, there will be some evanescent modes only at very high evanescent modes, probably less and less relevant. So you can, if this is your computational domain, you can balance some sort of measure refinement in the non-convex part. I don't know if this is the best strategy, but probably it works. Okay, thank you. This is speculation, basically. Okay, thank you. I think that Igor has another question online. Let's try to be quick. Another question online? Let's try to be quick on this one so that we can move on to the next speaker. Okay, I'll try to be quick. Well, thank you. Thank you very much, Andrea. That's very, very interesting. And what my takeaway is that instead of the usual kind of measures of well-conditioning, we should be looking really at the magnitude of the coefficients. But I'm trying to get some intuition into your setup and the results. And my intuition is: I think it is correct, but well, correct me if I'm wrong, that there are three. If I'm wrong, that there are strongly decaying aminescale components in whatever function you're trying to approximate, right? In the solution, but then if it's strongly decaying into the domain, then if you step out of the domain, then it's going to be strongly increasing. And so I wonder if you were, if your domain is a subdomain of a bigger one, if you want to increase the size of your subdomain, then would you not get back to the positive result? So then if you limit the norm of the function and you step a little bit out. And you step a little bit out, would that not be give you bring you back into positive territory? Um, I'm not sure understand, right? But for example, if you have this is your domain and you consider a mesh element in the interior of the domain, then in this case, I'd expect to have evanescent modes that are relevant. That are relevant in this domain because when you leave the domain, the evanescent mode, the element, the evanescent mode will blow up very quickly and so would correspond to something huge here. So the evanescent components, I expect them to find them only close to boundaries, corners, or interfaces between materials. So we are not there yet, but I think that, I mean, I don't want to throw away all proprietary. I don't want to throw away all propagative waves. There are some functions that can be approximated very well in a stable way with propagative waves, but some others are not. So one would like to predict where you need the invanescent waves because you have invanescent remotes and where you don't. And I guess important criteria is the distance from the boundary or corners or remote waves. Or corners or regular top under conditions. Yeah, I certainly see that. I think I was having a slightly different setup in mind where the function you're trying to approximate is not necessarily a solution of some boundary value problem, but just some smooth function. And it may have an evanescently decaying component to it. And then, in that case, if you step out of the domain and expand the domain a bit, then you will capture kind of the evanescent increase. All right. But if that's really a solution of the boundary value problem, then it can. Solution of the boundary value problem, then that can only occur at the boundary, right? So that's, I think, that is that's clear. All right, thank you very much. Let's thank our speaker again.