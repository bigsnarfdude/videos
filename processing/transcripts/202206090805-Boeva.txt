All right, so welcome everybody to my presentation and also my big thanks to the organizers for inviting me to talk today. I'm leading the team of computational genomics of cancer and so cancer is the main topic of our research and today I will be talking about one specific problem that we try to solve. The research is not final yet but we are getting there. So what we're interested in in studying is intratumoral transcriptional heterogeneity but before I get there I would like But before I get there, I would like to tell you more about what type of heterogeneity we can have in tumors. And first, I would like to start with the difference between inter-tumor versus intra-tumor heterogeneity. So for inter-tumor, we mean heterogeneity and cell composition between different individuals. And then when we talk about intra-tumor, we talk about heterogeneity within one particular tumor of one patient. And then for intratumor, And then for intra-tumor heterogeneity, we're going to have three other types of heterogeneity. So, one would be heterogeneity of tumor microenvironments. So, the composition of healthy cells that infiltrate its tumors, immune cells, terminals, the dulsets, and so on. So, this is one type of heterogeneity which we have. The second type is intratumor transcriptional and epigenetic heterogeneity. And this is when we look specifically at the malignant cells within the tumor, so, cells with mutations. The tumor, so cells and mutations and copy number aberrations, and then these cells here may be all the same, expressing all the same genes at the same amount. In this case, we talk about homogeneous tumor, or we can have cells which display different gene expression profiles. For example, we can have cancer stem cells, which are not proliferating that fast, but more resistant to chemotherapy, versus more differentiated cancer cells that proliferate faster, but can be maybe more easily killed by chemotherapy. Be maybe more easily killed by chemotherapy. And these guys don't have to have differences in their genomes, so they can have exactly the same profiles or mutations. Copinum vibrations, it's just the transcription of an epigenetic states will be different. And then we can also talk about genetic heterogeneity. And in this case, we talk about subclonal mutations or copy number vibrations. So this is different from transcriptional heterogeneity. And of course, there are links between these three types of heterogeneity, but I'm not focusing on these things today. Not focusing on these things today. So, the topic of my today talk is this intratumoral transcription and epigenetic heterogeneity. And to characterize it, we can apply single-cell RNA-seq profiling of our tumors, and we can complement it with single-cell ATAC-seq, maybe to link changes in the gene expression with differences in activities of transcription factors. But again, I'm not talking about ATAC-SIG today, so I'll focus only on transcriptional profiles. On transcriptional profiles and trying to find this heterogeneity on the level of transcriptional profiles between different cancer cells within the tumor. And in addition to the two examples I mentioned, cancer stem cells, or just more differential cancer cells, we can have cells in some hypoxic states that in the same tumor, like memoxic state. We can have cells which are more into UMT, we have delta and zen transition, more migration. We have developed in the Zenkommon transition, more migrating cells, sometimes called nest cells, versus those which are not migrating. So we can find these different states. And what we are interested in is shared transcriptional hydrogeneity. By this, I mean states which are observed not just in one patient, but that can be observed across patients. So, for example, pro-migrative mesenchymal state can be found in several patients in different proportions. Cancer stem cells may also. Stem cells may be also found some cells in high some patients in high proportions in other patients. So, we're interested in quantifying and identifying this intra-tumor archaeogeneticity, which is shared across patients. And there are many works already for different cancer types where biologists and clinicians could find this shared transcriptional states. And one example is given by neuroblast Thomas. This discovery was. This discovery was done by my team together with the team of Zabajanmex from the Curie Institute. And then, same year, we had a publication by Roj Verstead group. And what we discovered is that in one tumor, one neurobostoma tumor, we can have cells in two different transcriptional states. One is pro-migratory mesenchymal-like state. So, here we can see on the staining that these cells have yellow cells, and then you can. As yellow cells, and then you can have cells which are more differentiated. So, this is classic neurodenojic-like neurobostoma state. And these cells can be seen in blue in this particular tumor. So, you see that it's heterogeneous, and we can also confirm the existence of these two states in different tumors and different cell lines. Then, in glioblastoma, 2019, these office published four different shared transcriptional states. Transcriptional states. So, this is the OPS. So, oligodendrocyte progenitor-like, you have mesenchymal-like state cells, you have astrocyte-like cells, and then PC, which is neuroprogenitive-like cells. This is for glioblastoma, then another example, breast cancer. So, you probably know about luminal A, luminal basal types. So, what these authors did, they took tumors which were annotated as luminal B or luminal A. Annotated as luminal V oluminal A or basal or HER2. And within these tumors, they say that we observe cells that display more basal-like properties or more luminal B-oluminal-like properties. So for example, each line here, it's one tumor. And here you can see that in this tumor, which is characterized by a pathologist as basal, only 50% of cells are so-called basal state, and then you have lots of cells in so-called neurology state. So-called state. And then, last example, I wanted to show you: this is a PAGEO skemos cell carcinoma, and here the authors discover eight shared states, and each tumor, which is shown by column here, is characterized as a mixture of cells and these eight different shared states. How the researchers, yeah, why it's important to find this hydrogeneity, characterize this hydrogeneity, because we Because we believe that this can be linked to the survival of cancer patients and also to the sensitivity to different anti-tumor drugs. You can make an analogy of the society. So, if you have a heterogeneous society versus homogeneous society, then this society can be more resistant to stress. So, for example, if we treat our tumor with some standard treatment, then some cells which are sensitive to this treatment can die, but other cells This treatment can die, but other cells may survive and cause a relapse later on. And think that heterogeneous tumors should, in general, more aggressive and more resistant to standard therapies, unless we apply combinations. So this is why I think it's important to be able to identify the shared transcriptional states and characterize intra-tumor transcriptional heterogeneity in cancer patients. So, how it is usually done in these papers that I just Usually done in these papers that I just cited, there we take each tumor separately, we analyze each tumor separately, for example, clustering and the spatial gene expression of single cells, and then we analyze clusters with the differential gene expression, and then we compare signatures or biological processes which are differential between different clusters, different tumors. And then we can identify maybe this shared transcriptional state. So, for example, these yellow cells will form clusters. For example, these yellow cells will form clusters and different patients. The downside of this approach is that if you have some red cell types, like this red cells, it may happen that they will not form a distinct cluster or your clustering port will be not sensitive enough and you may miss this shared state. And we think that remedy to these challenges could be provided by analyzing all tumors together. Together. So we'll take just all tumors, all single cells from different tumors, and we'll try to identify this shared transcriptional state by projecting these tumors into common space. So this is our idea. Hope in the future it will work something like this. So this is a manual analysis of the data. We want to have just one method. Click on the button, get this representation. Why is it? Why is it so complicated to do? This is because you have lots of technical effects which are specific to each patient or sometimes cells, and also you have biological variation driven by differences and copy number variations. So, for example, here I'm showing to you a UMA of gene expression from single-cell data with this colorful cancer data set. And each dot here is a cell, which is characterized by a vector of gene expression and a color. And a color corresponds to the patient. And you can see that cells from different patients form distinct clusters. So, cells from different patients don't cluster together, as we can see here in this beautiful example on globostomer, where the researchers identified four shared signatures. And the main reason for this, in this example, is that different patients have different copy number durations. So, for example, this purple patient can have a low-signal chromosome 10, which is absolutely a change. A low sign on chromosome 10, which is absent in gray-brown patient, and then genes which are present in chromosome 10 will be at lower expression in purple patient, present in brown patient, and this can drive differences in gene expression. So we need to correct for this. And so ideally, what we want to do, we want to somehow integrate this data, remove the patient-specific effects, which are either biological and the sense of copy numbers or technical, and find. And find a common latent space where cells from different patients will be mixed, and then transcription programs will correspond to some parts of this shared latent space. This is what we ideally want to do, but it's not that easy because single-cell data are not that nice sometimes, so they are quite noisy. In particular, they are known for so-called drop-out effect. And here, I'm visualizing to you on the left. On the left, gene expression data by measured bulk RNA-seq for two technical replicates. And so each dot here, it's expression of one gene. And you can see that reproducibility between two replicates for bulk RNA-seq is very nice. And on the right, I'm showing to you the gene expression measured from two identical cells. And again, each dot here, it's expression of one gene within these two rapids. Gene within these two replicates, two cells, and you can see that here in these boxes, there are genes which have zero read count in one cell, and they have very high read counts of 10 power 4 in the other cell. So, this is partially due to the fact that when you do single-cell RNA-seq, we only capture something like one-tenth of all transcripts. So, some transcripts, even if they are present in the cell, may be missed by the technique. Missed by the technical. So we need to account for this. And a common way to deal with this is to model single-cell RNA-seq grid counts with a zero-inflated negative binomial distribution. So negative binomial means foxy for over dispersed poison. And zero-inflated means that we just put some zeros into the distribution. This is the formulas. So it's known that zero-inflated negative binomial models quite nicely single-cell RNC data. All right, so what we need to remove when we try to find this latent space to find the shared transcriptional signatures is first batch effects. So here I'm going to visualize the batch effects which are due to two different chemistries of 10x used in this colorital cancer data set. So here I'm showing to you only healthy cells, not cancer cells, and each cell type is colored by its own color here on the right. So for example, Color here on the right. So, for example, here in gray, we see these T cells and they form two clusters. And if you look at which type of chemistry corresponds to these two clusters, you see that this is clearly chemistry two on the right, chemistry three on the left. So, this is this clustering is clearly due to the batch effect. We need to correct one. But even if we correct the batch effect, we'll still see differences between different patients in terms of gene expression. Different patients in terms of gene expression because these patients will have patient-specific copy number vibrations. Then, on top of the copy number vibrations, what we want to correct for is different biases. So, we have a bias of the total read count. So, each cluster here, it's one particular tumor. So, each dot here, it's a cell from one tumor here, shown in different color. And you see gradients and total read count very nicely. Very nicely. You see gradients linked to the mitochondrial RD account, and you also see gradients related to the cell phase. So all this is unwanted variation. We don't want to capture this when we have this shared latent space. So we try to remove these sources of anodic variation and we propose an approach to do so, which we call CANSIC, which is composed of Which is composed of three modules. I will not have time to go through all of them today. So I will just mention that we have a pre-processing step where we filter out low-quality cells and also we remove genes which are not variable enough. And then for each cell, we quantify its copy number profile using gene expression data so that we can discriminate malignant cells from non-malignant cells of tumor microenvironment. And then the most important part is this model. Most important part is this model line part where we try to find this shared latent space. And then the last part, this post-processing part, this is where we try to associate some parts of the latent space to the non-prescriptional programs using hallmarks of cancer data. I will show you some examples, but first I will mention just how we do the modeling. So the modeling, this is this key part of our pipeline. Modeling: This is the key part of our pipeline when we provide as input a matrix of row read counts and genes in a cell. And then we propose the user to use one of the methods to find this latent common latent space. So either the user can use an approach proposed by the authors of SCDI or home-made conditional variational encoder followed by NMF, or you can. We can use also harmony, and the default one is the FCE method, which consists of running a conditional operation auto-encoder with a zero-inflated negative binary conditional likelihood pass. And why I think this is a good choice? Because first we use auto-encoders. So in this case, we have our little space capturing the hidden cancer. The hidden cancer cell cancer states. So we condense our data to something which is supposed to be shared. Also, variational encoder has very nice properties because it creates a very nice latent space which can be used as a generated model. And then, also, this is a conditional variational encoder, and we can provide. And we can provide this covariance reflecting the unwanted sources of variation as a condition to get rid of, so that the latent space that we identify does not contain information about these different conditions, which is the total read count. So we don't want to have the total read count bias in our reading space. We don't want to see the cell phase too much. We don't want to say patient ID or clone ID if we talk about copy number versions too much. Too much, and we don't want to see much of the gradient of the mitochondrial RNA content. So, all this can be done when we just add this information as a condition, the conditional operational autoencoder. And then we also use different laws than just mean squared error laws. So, here we use these ZIM conditional likelihood laws, also proposed by a CDI, so that we can explicitly model the shape of the distribution of single-cell RNA C data. Of single-cell RNA C data. So we apply this model first on our C related data. So here we have eight samples, they have batch effects, and we model them so that there are three different transcriptional programs present the samples. And what we want to get rid of is cell ID. So, this is what we put under the condition, and our latent space is nicely organized. So, we don't see any Any part of the space which is specific to one batch or one tumor in this case. And then, if you look at the programs now, we see that parts of our organ space are very enriched and program zero, program one, and program two, which we use to model update. So, on simulated data, it looks like our latest phase makes sense, but then we wanted to validate it on real data sets. And the problem with the real data sets is that. And the problem with the real data sets is that we don't know the ground truth. So, what are the shared transcriptional states? The only thing that we can do is we can use current publications. So, here we use publications for these three different cancer types. And then we use the signatures that were manually discovered by the authors of these publications to see whether we also observe the signatures in some parts of our latent space. So, key for validation we used is. We used isopageal cancer and colorful cancer and also breast. But today I'm going to show only the results for esophageal cancer very briefly because of lack of time. So here I'm showing to you what the input looks like before we do the correction. So we see a very strong bias for patient-specific effects. And then after the correction, we see that now an hourlated See that now in an ovulated space, we don't see clear clusters corresponding to patient-specific cells. We also don't see any effects linked to the read count or mitochondrial counts. And if we project on this latent space known signatures, so this is ground truth signatures, we see that they occupy some specific part of our latent space. So here I'm showing to you UMAP projection of the initial latent space, which is six dimensions. Initial latent space, which is six dimensions. And then, when we have this latent space, we can analyze it to say that, if you don't have the signatures, what different cells in this latent space do. And for this, we can apply clustering and then potential gene expression. And then for each cluster, we can apply gene set enrichment analysis to say that one particular cluster is enriched in some whole mark of cancer. Polymer cancer, and we can do it for different number of dimensions of our latent space for different number of clusters, for different number of different random seeds. And then for each combination of these hyperparameters plus random seed, we can look at the enrichment score for our particular hallmark. And if you see that from whatever we do, this hallmark always has a high score in this case. You see it as red, so the most enrichment score above two is. Modern square above two is considerably strong enrichment. We can say, indeed, this hallmark example of different alpha response is one of the shared transcription states. And before I conclude, I wanted to show you a visualization of this post-processing process. So, for example, we apply, we use one random sheet to create one realization of a latent space of Realization of a latent space of 10 dimensions. So, here's six dimensions. Sorry, then we apply clustering with a k equal to 10 clusters. We take this cluster six here. For this cluster six, we do differential gene expression, and then on the differential expressed genes between this cluster six and the rest, we apply gene set enrichment analysis. We see that the strongest enrichment is for the whole market for TLDMESENCOMO transition, so these will be migrating cells. And then And then we do the same with different number of dimensions, different number of clusters, and we see that always, almost always, we have very strong conversion transition. And just to show you how this agrees with the previously published signatures, so for Azipage, Camusol Carcinoma, authors who published the single-cell data set identified this migrating signature, mesenchema-like signature, and you see that the score of the signature is very high. Of the signature is very high, or for our cluster six, which we found in unsupervised. So, overall, what we try to solve is to be able to analyze all samples together and detect the shared trusted states from cancer cells for different patients and program for the sources of unbounded variation. And then, in the end, we link the states or shared states we identify to known biological processes. To known biological processes using gene set management analysis, and in the future, what we will try to do is when we are sure about our results, we'll try to quantify the hydrogenating different patients and then try to link it to cancer-aggressiveness and sensitivity to treatment. And we hope that by analyzing what kind of cells exist in each tumor, we can suggest better ways to treat the patients by killing multi-microchistos. By killing not maybe not just one type of soft, but two types of software combination practice. I would like to thank people who contributed to this work. So, mostly, these are these three PhD students, Josephine Yas, Florian Barkman, and Pavel Bashitz. And I would like to thank you for your attention.