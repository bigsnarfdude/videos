Hi, everyone. Thank you for having me here. I'm Chris Bowers. I'm currently a postdoc at North Carolina State University. At North Carolina State University in Merale, and I'm going to talk to you about modeling of generalized Newtonian flow in porous media using averaging theory. So when we're talking about averaging in porous media, it has a very long history, and many of you already know. It's essentially you can go from maybe a pore scale, like you can basically go from a pore scale where you're resolving the individual Individual spheres and the fluids and everything else. And you can model that very well, but once you get up to a larger scale, like the field scale, then you're not going to be able to run simulations for something that big. You need to average up to some larger continuum scale. So, just a quick word on definitions for scales. There's a lot of different terminology and lingo. I describe the microscope. Describe the microscale as basically the pore scale, the space where you have a fluid continuum in between different pores, and then the macro scale would be the porous region continuum scale, essentially just an average region that includes, that doesn't resolve the individual phases of a system. So historically, models at these different scales have kind of been posed separately. So you have the Navier scale. Separately, so you have the Navier-Stokes equations, you have Darcy's law at the macro scale, you have the invection diffusion and invection dispersion equation, and there's been a big question about how do you go between those two scales. And it's one that's been people have been trying to answer for maybe the last 40 years or so, and there's been a lot of progress made. Now, before I move on to a discussion about these scales, it's very confusing to go from micro to macro. To go from micro to macro scale when you're talking about these variables. Is it a micro scale velocity or is it a macro scale velocity? And the vection diffusion and dispersion equations, I mean, they are the same. You don't have any kind of adornment or anything. So we're just going to fix that. And so I generally use subscripts to indicate a micro scale quantity with the letter indicating the entity you're looking at. So this would be for like a fluid phase. And then super. Fluid phase and then superscripts to indicate a macro scale quantity. It's not uncommon, although what I don't often see, and what we do in our group, is we use additional adornments such as overlines. And essentially, all of our macro scale quantities are all defined in terms of averages of micro scale quantities. And the adornments give you an indication of how that averaging was done. So if you have an unadorned superscript, that's just An unadorned superscript, that's just an intrinsic average. If you have a single bar over your superscript, that's a mass-weighted average. And then double bars are basically something that has to be defined at the macro scale. And we talk about one important specific macro scale quantity is the specific entity average. That's basically like things like porosity, specific interfacial area, things like that. And that's defined just by taking. And that's defined just by taking the average of one essentially, just using the average of the phase indicator field, essentially. So as an example of how we would go from the micro scale to the macro scale using averaging, I'm just going to start with the conservation of mass equation, pretty straightforward. We can throw some averaging brackets on there, all good. But now what happens? Do we have these averaging operators with Averaging operators with partial derivatives of time and with divergences in them. And can you just pull those out? I think most people that work in this field know that you can't explicitly do that. I mean, maybe you can sometimes. It's not obvious. To be able to deal with those, we use the averaging theorems. And these are mathematically derived. And essentially, you can pull the operators out of those averages, but then you also have to implement. Averages, but then you also have to include a boundary term. So the boundary term for the change in time is basically the density times the velocity divided with the outward normal, the velocity of the interface. And you get something similar for the divergence. And in our group, we like to group those boundary terms into transfer terms, macro scale transfer terms. Transfer terms. And so, what that winds up looking like is getting a typical traditional macro scale conservation of mass equation, but then we have this mass transfer term that basically collects those average terms together. And you can do something similar for the conservation of momentum equation or the Navier-Stokes equation. And you get the mass transfer term, but you also get a momentum transfer term. So, it's very painstaking to do. So, it's very painstaking to do these averages. There's lots of different methods people use to kind of standardize this. The method of volume averaging is very common in my field. Homogenization is obviously very common. I've been trained to use the thermodynamically constrained averaging theory, which we call TCAT, which essentially takes averaged quantities, averaged equations and applies thermodynamics to them so that we can get macro scale equations that are thermodynamically correct. That are thermodynamically correct. So, this is a kind of a general schematic of TCAT. Basically, you have your microscale conservation equations, and we also have entropy inequalities. We average those up to the macro scale. We also average up any thermodynamic relationships that we have. And then we combine those into entropy equalities. Essentially, we take all of our equations: your conservation of energy, mass. Your conservation of energy, mass, everything else, and you add them together, and you can generate an entropy equality where you say, okay, this is a set of force-flux pairs, and they always have to generate or create no entropy. They can never decrease the entropy. And we basically pose closure relations based off of those. And another thing that's unique is that you can get a set of evolution equations out of those averages. Equations out of those averaging theorems. And the reason why there's no micro scale equivalent, those evolution equations are for macro scale quantities like porosity, for example, the change in porosity, or gradient of porosity, change in porosity with respect to time. You can derive those mathematically. So I'm applying that to generalized Newtonian fluids. Specifically, I'm looking at cross and currow model fluids. I like to plot these together. To plot these together, you can actually, if you use the same parameters for both, and you can see how they overlap and kind of see how they differ. You can see Coro model fluids tend to reach a power law region much faster than cross-model fluids, but they do actually overlap each other once you get past the inflection point, essentially. Now, looking at generalized Newtonian fluid flow, the historic approach that's been used is something that has many names. Has many names. I've seen it referred to as the shift factor approach, where essentially you take Darcy's law and you just say, okay, we're going to replace that viscosity with some kind of apparent viscosity. And here I'm going to say apparent or effective viscosity interchangeably. They're used both ways in the literature. And this apparent viscosity is calculated from your rheological model using an apparent shear rate that includes this alpha, which is the shift factor. This alpha, which is the shift factor, and this was developed using dimensional analysis just from empirical observations. There's been a lot of questions: okay, well, what is the apparent viscosity? Is it the average viscosity at the fluid-solid interface, the average viscosity in general? Is it no actual real viscosity that we can measure? And we wanted to be able to figure that out by applying averaging theory and t-cap to this. So, I'm not going to get into the constrained entropy inequality. Into the constrained entropy inequality. Generally, the way that TCAT operates is that you generate a general entropy inequality and then apply simplifying assumptions to get down to a simpler one that you can handle. The original constrained entropy inequality for our system was two or three pages, maybe, but after you apply assumptions like isothermal system, an inert solid phase that's not moving, no mass transfer all of the. No mass transfer, all of those kinds of things. Then you can get down to this nice convenient equation. And this is made up of forces, so this term here and here, multiplied by fluxes here and here. And based on the setting law of thermodynamics, you can actually see that forces times fluxes will actually always be greater than or equal to zero. And you can propose closure. And you can propose closure relations that are within those constraints. That's the thermodynamically constrained part of averaging theory. So, our closure relations, basically we assume for our system that we have what's known as a macroscopically inviscid system. Essentially, even if the shear, the rate of strain tensor, which is this D, even if the rate of strain is positive, we're still not going to generate any entropy from the system. And so that means that the shear. And so that means that the shear stress or the stress tensor and the pressure have to cancel out. And then this next term here, which is scary but will become simpler, I promise, essentially we assume that it's linearly related to the velocity. Now, Dr. Hansen mentioned that a lot of these averaging methods aren't generative, and this is kind of where you can be generative. Can be generative, where you can create quantities. And so we assume that this term is linearly related to resistance. We call this the hydraulic resistance, or linearly related to velocity. And the hydraulic resistance is basically the inverse of hydraulic conductivity. There's a couple porosities thrown in there, but that's essentially what it is. Now, what can we learn from this? I mean, we have pressure, gravity, a momentum transfer term, and then we have. Transfer term, and then we have here this is actually chemical potential and gravitational potential for psi. Those are very hard to measure. We need to get rid of those. So starting with that, we use the macro scale Gibbs-Duhem equation to be able to remove those. Now, we have an isothermal system, so the temperature terms drop out. We have pressure and chemical potential related to each other here, but then we also have these deviation terms that come out when you're. Deviation terms that come out when you're doing the averaging. So, how do you remove those? You look at the microscale Gibbs-Duhem equation, and you can rearrange that to find the microscale change in chemical potential with respect to pressure, which is the inverse of density. This is pretty commonly done in the thermodynamics literature. And if you go through and do the calculations, you'll find that these potential terms actually cancel out. Now, it was originally proposed in grade. Now it was originally proposed in Grand Miller that these terms are each individually zero, but that's not the case. They are significant. It's just that they cancel out. So what we did is that the pressure and the chemical potential cancel out. We still have the gravitational potential and the momentum transfer. So you can average the micro scale gravitational potential up. And using the averaging theorems, you again get these gravitational, you get an interfacial term. You get an interfacial term, this gravitational potential term here. And then, as I said in TCAT, all macro scale quantities are defined as averages of microscale quantities. So this momentum transfer has been defined as an average. It's not very convenient to write, so we made it a momentum transfer term. And because we have a no-slip condition, the second portion cancels out. So you just get the stress tensor dotted with the outward normal for the entity. And ultimately, we get this equation where we can relate the resistance times the velocity, which again, resistance is essentially the inverse of hydraulic conductivity, to all of these different interfacial properties. So they look very complicated on the page, but they're all essentially normally measured quantities. So this actually winds up becoming buoyant force. This is the lift I've heard it called, and then this is. I've heard it called, and then this is the drag. And these are all quantities that most solvers, most simulators, can compute. I use OpenFoam, and there's like three or four ways that you can compute these in OpenFoam. It's just that it's not normally done, so there's a bit of an extra barrier actually. So what we did was, okay, we've got this nice equation. We can see what's important for the resistance tensor. Let's just plot everything and see what we get. Let's just plot everything and see what we get. See what kind of understanding we can get. We looked at a set of parallel slits, which for these fluids there's an analytical solution for, and we just plotted everything. We looked at resistance, we looked at average viscosity at the fluid-solid interface, we looked at the shear stress averaged at the fluid-solid interface, and we got some interesting results. So, first of all, the resistance up here seems to be a very important. Up here seems to have the same functional form as the viscosity at the fluid-solid interface. And so we said, okay, well, let's write the resistance that way. And this is essentially, you can get this from the shift factor approach. You wind up getting the same thing. Now, what's different here is that we also noticed, okay, the inflection point of the log of resistance occurs at the same place as the inflection point of the log of the viscosity at the fluid solid. The viscosity at the fluid-solid interface. And if you look at the cross model, that means that the m term in our resistance model, this uppercase M, has to be equal to the ratio of lowercase m times the inflection shear rate divided by the inflection Darcy velocity, which is Q. Well, now how do we get the inflection Darcy velocity? What we did was we looked at the shear stress. At the shear stress averaged over the fluid-solid interface, and we looked at the resistance times velocity, and we noticed that they seem to follow each other. And if you plot them, you'll see that they're linearly related. Now, this was for one cross-model fluid here, but we've done this repeatedly with many different cross-model fluids in many different systems. And we've done it with Pero model fluids, and this is always the same linear relationship. So that means that there must. So that means that there must be some term, L, some length term, that relates the average drag essentially to resistance times velocity, hydraulic resistance times velocity. And mathematically, you can go through and do a calculation, and then you can calculate this uppercase m from that length term. And this length term is something that you can compute just for one flow rate with one flow flow flow flow flow. Just for one flow rate with one Newtonian fluid. And you don't have to do any simulations or experiments with non-Newtonian fluids. You just get that one quantity. So as a recap for the resistance model, we've had our resistance model that's similar to the rheological model. And here you can see this is actually the relationship between resistance and the permeability. So you see, it's not exactly the inverse. It's not exactly the inverse of hydraulic conductivity, but close. We saw that there was an inflection point relationship between that and the viscosity. And we finished that calculation by finding this L term. And this is really important because this means that you could tabulate L for all sorts of different media, and then someone doesn't have to do experiments with whatever cross or corro model fluid they want to simulate. Of Coro model fluid, they want to simulate or use in a macroscope model, they can just go and look in a table and find L. So we did a validation with this. We used five cross-model fluids. This first fluid is actually based off of a guar gum that would be typically used for hydraulic fracturing. And we altered each of the individual parameters of that. And then the fifth fluid is actually one where we severely changed the lowercase m. The lowercase m term just because we wanted to be able to, that essentially impacts when the cross-model fluid behavior occurs and when it reaches an infinite, this infinite Newtonian viscosity plateau. And we did that because we wanted to be able to see the full curve for some of our systems. And it worked. If you look at parallel slits with the analytical solution, it's almost dead on. We looked at a On. We looked at a body-centered cubic array of spheres, which is a very simplified 3D system that has. We used open foam for these simulations with cyclic boundaries and gravity-driven flow. And we wound up getting very good results. We used a very random sphere packing with a wide variety of radii. We saw a little bit of an issue in the transition back to the Newtonian plateau, but that's something that we found later was due to. We found later was due to the level of refinement. Now, that's one thing that I would point out: you need a much higher level of refinement to be able to compute these interfacial terms, and especially when you're doing simulations where you're doing non-dutonian flow. And we also looked at a simplified anisotropic system, and it can be used for anisotropic cases. So, what does this mean for the shift factor? So, what does this mean for the shift factor? Is it just dead in the water? A lot of people use it. It's used to get good results. Not exactly. It's not exactly dead. So, we'll start with just the assumption that's used in the shift factor. We're assuming that Darcy's law applies, and we're using our relationship with resistance. This is an isotropic case because the shift factor is typically used in isotropic cases. It has been used in anisotropic, but it's not common. We can rearrange that and substitute our. We can rearrange that and substitute our models. So essentially, this is the shift factor model with an effective shear rate. We have our resistance model. And you can go through the calculation. And actually, what we wind up finding is that M times Q, uppercase M, is equal to lowercase M times the effective shear rate. Now, for an isotropic case, we can use that term for L to get to essentially. To essentially calculate what the shift factor would be in terms of our uppercase M and in terms of our L. And if you go through and it's a detailed calculation, but if you go through and do it, what you'll find is that the effective viscosity times the effective shear rate is essentially equal to the magnitude of the average of the shear stress at the fluid-solid interface dotted with the output normal. With the output normal. So it's not non-physical, it's not a convenient macro scale quantity. There are certainly cases where you could pull that viscosity out and you wind up getting that these things are equal to each other in a nice convenient way, but it's not for every case. So, in summary, we began with our shift factor approach. We used TCAT to determine the significant parameters, and then we proposed and validated. And then we proposed and validated a very precise model that we can use a priori without any simulations. And we did the same thing for Corot model fluids. In this case, we actually looked at a whole bunch of different media, you know, body-centered qubit, random spheres. We also looked at a random sphere packing where we stretched it in one dimension to make it anisotropic. And we also looked at a system of spheres that's roughly a representative element. That's roughly a representative elementary volume. And this time we got the numerics better. We used a much higher refinement and we were able to do these calculations. It was very precise. The max error, the max relative error that we saw through these was about 2%. When we did the refinement, we used Richardson extrapolation to figure out how refined we were. And we considered our We considered our system grid independent once we reached a relative error of 1% for the Richards extrapolation. So we're essentially within the error of the numerical simulations. And that's my talk. Thank you for your time. If you want to find more detailed calculations, we have a couple of papers that have been published recently that go through that and go through some of the extra work that we did. I haven't gotten to go over today. Thank you very much. We have time for some questions. Thank you for the presentation, Mike.