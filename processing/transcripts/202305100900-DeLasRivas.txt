Long trip. And today, the theme of the day is more about the integration of omics or different data sets to be integrated, more or less. So Javier will give us here a talk on how to look at logistic and survival analysis when integrating genomics and clinical data. So you can switch on, yeah, this. Oh, I thought. Yeah, this oh, I thought that it's more and these handles.   If the history on the edge and the spot I think that's what we're okay. Thank you very much. Thank you, Gabby, and Maribel for the invitation to come to this meeting. It's for me a pleasure to be in this kind of interdisciplinary meetings. I come from my background, I am biochemist, a molecular biologist, doing for many times biophysics and later on becoming a computational biologist, more in a second generation. I work in the cancer. Second generation. I work in the Cancer Research Institute in Salamanca, and I run a bioinformatics and functional genomics group there. I'm going to talk today about the work done by two of my former PhD students, Santiago, that he's now, he's computer science, and he did the master's on cancer biology with us, and he's now a postdoc in another place in Spain. And Alberto, that he's doing the PhD with me, and he's the informatician. I'm going to go into a I'm going to go into an area that, from the analytical point of view of the data science, we have not been dealing with so far. That is what is called survival analysis and risk prediction related to medical data. So, this is a, as you can imagine, supervisual analysis, and this prediction is And this prediction is a key problem and a key question in medical clinical research. And if you've been in any medical meeting, they will put you like 200 slides with Kaplan major plots and survival data. And this is true not in Link Cancer. This is an example of papers of last year, prostate cancer, or breast cancer, or melanoma. You see the number of citations. You see the number of citations, more than 200 citations in the New England Journal of Medicine, all plotting and doing survival analysis and presenting the improving little improvements in drug treatment on the patients. So, for example, this is an example of a paper of melanoma, metastasis melanoma of 10, 12 years ago with a number of 10-12 years ago, with the number of citations, many citations. So, this is a key issue in biomedical research, and then we have to go into how we handle the numbers of this analysis and how can we use genomic or transcriptomic data to explore for genes that mark specific situations on the tumors on the patients. And this is the scope of the scope of the of the algorithm that we are developing i'm going to present today to you that is an algorithm called a suri that is an algorithm designed into analysis of a patient survival by survival time and patient risk prediction based on gene expression signatures so we are the package is more or less more or less ready we are going to show you two examples of application of the package and we want to put it on And we want to put it into Bioconductor, and it's written all in R. As you can imagine, to develop this package, we need a lot of other libraries that are very useful to this development. So what is the package doing? The package is basically, this is the scheme of the workflow of ASURI, and what it's doing is calculating. calculating well doing survival analysis of the tumor samples of the samples of the patients based on reading out the expression signal of the genes that detected in the through transcriptomic profiling in the tumors. So basically the functions of the package will be have a main function that is That is a robust feature selection at the beginning based on an algorithm that is going to do a logistic regression model to do a feature selection. And this feature selection is done doing bootstrapping inside and well, all the mathematics that is behind is we just publish a is we just publish a paper with the application of this part of the algorithm. And this is the scheme of the algorithm. First, the scope is assign or select genes in the expression profile of the tumor that mark survival of the patients. And the second part of the algorithm is optimized re-stratification of the tumors based in Tumors based in multi-pariet cost regression model. And then, basically, what I show you a little bit more in detail: what is the algorithm doing? The algorithm is with the gene source function is going to explore for each gene. For example, this is a case of breast cancer tumors. We have 200 tumors here and sorry, 200 tumors, and then what the algorithm is going to. And then, what the algorithm is going to do is to explore each gene. And this is a canonical gene for breast cancer. This estrogen receptor is a very good marker of survival in breast cancer. So, it's going to explore the expression of this gene and how the expression of this gene can be optimized to separate two groups of patients, two of tumors, based on Kappa Mejer analysis. On a couple major analysis, if there is this separation, assign it to the expression of the gene, if this is possible. And in this case, it is true because it's an exogenous receptor is a very good marker of this survival, well known. But we do that with all the transcriptomic profiling, all the genes that we have in our tumors to see how many genes provide us this kind of separation of the tumor. Separation of the tumors in poor survival or good survival tumors. Yeah, yeah, I will. Yeah, yeah. Yeah, yeah, I will tell you. I mean, we need for this analysis a data set with the tumors, with the clinical data, survival data, and also. Data, all and also full transcriptomic profiling. So, measuring all the genes, the expression level of the genes in the tumor. Okay. If not, you cannot do that. So, you need that information, the data matrix to start. And then once we have done this selection, feature selection of genes that fulfill this kind of profiling, what we do is a multivariate Cox. Multivariate COX regression analysis, putting together all the genes that fulfill this requisite, and then we predict the risk of each of the tumors. In this case, this is a small sample set of 200 tumors, where for each tumor, we assign a risk from zero to 100, the risk score, based on a bunch, a number of genes that we have. Number of genes that we have selected. We, of course, when we do this multivariate cost model, we also can evaluate what is the weight of each genes, each feature into this RICS prediction, what is also very interesting, because it's going to tell us what is the influence or the influence based on the beta values derived from the multivariate Cox model. Ecox model. So, this is more or less the algorithm that we are running and improving, and we want to put available in Bioconductor. I'm going to show you two examples of using the algorithm. One example, first example is on colorectal cancer. And what we have done in colorectin cancer, the first challenge is to obtain a big number of tumors that more or less have the same profile, where you have transcriptomic data plus clinical survival data. And the typical thing. Clinical survival data. And the typical things on many of these survival analysis, especially in many studies with the medics, is that you don't have enough patients and samples to do this. So what we wanted to do in this data science is to integrate a large number of colon cancer tumors where we are able to do a consistent transcriptomy profile. To do a consistent transcriptomy profiling of them, where we also have survival data to do this kind of analysis. And this is the typical problem initially of normalization, how many data sets we can manage to get together. Can we avoid the batch effect typical instead of clustering, the non-clustering? Because when you do this kind of analysis with 100, this is 100, so 1407 tumor samples where we got. Tumor samples where we got the information, we end up with this number of available or where we got full information. And then, how can we integrate this in a way that doesn't happen? This is the data sets. This is the typical analysis of PCA when you put the data by themselves. So, a beautiful clustering by subset. So, how can you improve? We don't want to get rid of the What is all the batch effect? No, the batch effect. And then we apply several algorithms. This is based on this data is micro-arace data, it's all data. But interestingly, we managed to get, to put together all these tumors and then they behave very well and they don't have any, when you do a linear regression analysis, the batch. analysis the the batch uh the batch uh feature is not influencing at all the uh the uh signal the signal, the transcriptomic signal of the of the sample. So we have 1200 samples together and then we start to do the analysis with the algorithm that I told you. So what we are going to we are going to do is We are going to do is to test based a little bit on the degree of the tumor, high degree stage three and four, column cancer versus low degree, we do a preliminary feature selection to select around 2,000 or 3,000 genes. And then, because to put, let's say, the 20,000 genes, protein coding genes in the other body, this is In the algorithm, this takes too long. So we just pre-select around 1,000, 2,000 genes that are really assigned to the prognosis of these tumors. And then we start to explore each genes to find which ones will fill this kind of separation. So the Kaplan media you can see in these two examples, this is a gene where the high expression of these genes is very much related. Of these genes is very much related with poor survival, the same as this, or here, the high expression of this gene is very much related with good survival. In this way, we select a collection of genes. Those are the genes that fulfill our selection individually in an univariate analysis. But what we also do, because we have so many samples, we do an We do an ensemble of models because we run 100 times, we do a bootstrapping, we run 100 times this analysis with subsetting, like in a cross-validation, bootstrapping, selecting, random selecting 80% of the samples to see how many times a given gene provides a couple major significant p-value and as a ratio. And an asset ratio, significant asset ratio, when we run it through this bootstrapping testing. In this way, we select those genes, the top, here are the 40 top survival markers. And once we have those, what we can do is use this to, well, also, this is in a univariate, I mean, testing each gene individually, independently, but let's. Individually, independently, but later on, what we do is to, this is with an independent data set of another court asking with this is coming, I think it's from, yes, this is from RNA-seq data from another data set for 482 patients. If we put together, if we put together the top up regulated genes that mark survival, do they separate? Do they separate very well the patients on this data set? And the result is that yes, they separate. So we are finding gene survival markers. Well, we bought gene survival markers. And once we have done, we can put together all these top-regulated genes that mark survival, and then we go back and we assign risk for the tumors that we are analyzing. So the typical So the typical in this kind of assignment, it usually happens that some of the tumors are very well assigned with high risk and other with low risk and intermediate risk sometimes is quite often, quite frequent. And we do that with all the up-regulated or down-regulated. And this was a study that provides us a bunch of genes very much related to colon cancer that are. Related to colon cancer that are also marking in a way prognosis. So, another study that we did with the same algorithm is now in breast cancer. And because we want to select the genes that mark survival, but associated to the genes that are used in the clinic for immunochemistry, ostochemistry of breast cancer. That is the standard analysis in any hospital. Standard analysis in any hospital in the world when a tumor, breast cancer tumor, arise, the doctors will do an immunostochemistry analysis of these genes to see how is the, what type of genes, of what class of genes, sorry, what kind of tumor is going to be. So the prognosis and the therapy is being driven by these markers. So these markers that are there is. And these markers that are the estrogen receptor, the progesterone receptor, and this resort tyrosenkin is the RBB2 or R2 and also a proliferation marker. So this is a standard measure that for any tumor and any new patient diagnosed with breast cancer is going to be into the clinic through immunoestochemistry. So what we wanted to know is what first question. A first question. Those genes mark survival on the patients in, and we will discover, especially these three, that they mark survival in a different way. Especially we study the top three, the estrogen receptor, prostrate receptor, and the LBB2 or ERS2. And then, if they mark survival, what other genes mark for the same patients also survival? Also, survival. So, we select a gene signature associated to these, let's say, clinical markers. And why we do that? Because breast cancer is a very interesting area of research because there are already three, at least three genomic commercial platforms that just doing PCRs, ProSigna, Oncotype, and Mamaprint. Signa, oncotype, and mammaprint, they do for the patients and they provide to the oncologist risk predictions of a given tumor. So what these platforms are genomic commercial platforms that have been developed through years. Now, most of them are in the clinic, and they are basically doing 50 PCRs or 21 PCRs or 70 PCRs to do. To do having behind an algorithm that predicts risk. What is the problem with these platforms? Well, the first problem is that one test of one patient for one of these platforms is around $4,000. Why? Because all the know-how, all this and that. So, for example, in my hospital, we have the Procigina platform and it's a reference platform for all Castilla de León, that is a big region in Spain. Region in Spain. So each time an oncologist wants to do, he has got, according to the profile of a given patient, has got some kind of doubt. This is a risk, a high-risk person of the tumor. Well, it is extreme receptor positive, but is L2 negative. So I have some doubt because it's a young woman and I want to do some risk prediction, then you go to this platform and they provide you a prediction of risk. Provide you a prediction of risk. The question is that these predictors behind, of course, are developed by companies. They are like black boxes, and the algorithms and the models that they run inside are black boxes. They are not revealed. They don't tell you how they do the prediction. But it was good that three years ago, so they released after being into the market the genes that they say they are profiling. Profiling, what is quite interesting. So, what we did is the following: okay, can we test the performance of these gene signatures, the procigna, the oncotype? No, the procigna has got 50 genes. Many of you have heard about the PAN fifty genomic profiling of breast cancer. This is a very famous study by Peru and many others for. and many others for many years, starting in 2001, till they end up to bring this to the industry and to the pharma and to produce this platform, Prosigna, and it runs 50 gigs. Oncotype is a different development. This is mainly in the States and this is mainly in Holland, but also in the States as well. The space as well, and ancotite is just measuring 21 genes. And as you can see, of course, they are not stupid, and all of them measure the standard markers that are those ones, the markers that the doctors need to read when they go, any patient go to the clinic anywhere in the world. So, what is the problem? This is a very interesting paper where interesting paper where uh barlet et al they select they they took 120 tumors from breast cancer and they predict the risk of these 100 tumors in adequates with the three platforms and also with the immunostochemistry markers. And what happened is that the agreement of the risk prediction of these three platforms is about Platforms is about 50%. So that means that the risk score of 60% of the passion is different. So what is happening, though, this is not very good. A doctor, the director of a hospital in Madrid, told me what is in reading this, what you cannot do ever. I don't know what they do in other, to buy two platforms. Just you buy one and you stick it to one, because if you buy two, One because if you buy two, you are in trouble. But our question was: can we improve the performance of these platforms selecting genes that are associated to the clinical markers? And then this is a paper that we just recently paris, where what we have done is to, through this process, this algorithm that I just presented to you, we select genes that mark survival associated. That mark survival associated to each one of these three standard clinical markers: estrogen receptor, progesterone receptor, and ERS2. And then compare this with the performance of the survival analysis done by the genes that are behind the genomic platforms. So, what we did is with this approach, first we use We use a data set where we have already the immunostochemistry of the patients in 380 samples. We have the immunostochemistry of the patients plus the survival plus the gene expression. And so we select the genes that behave in a similar way. This is with a multi-univariant analysis of the gene that is the strogen receptor or progesterone receptor or S2. Pristoton receptor OS2, and then what other genes perform similarly in the univariate metrics or the multivariate metrics, and to select to create a gene signature. This is an example with this data set that we have. We are, of course, one we select one specific gene, we do the risk prediction of the patients, and we do that. And we do that. And this is the clinical groups that we have well marked. And this is using that, the group of genes associated to ER, no? Or the clinical groups again and the group of genes associated to PR or the group of genes and the genes associated to R2. What is very interesting and is well known because it has been reported and this result that estrogenes is a very good marker of survival. Is a very good marker of survival, but ER2 is not at all a good marker, but anyhow it's used for because there is a special treatment on a special drug very efficient for S2 positive tumors. So the agreement of the concordance that we have using this gene selected for ER, PR, or S2 is very, very good. So we are We are selecting the tumors that are high risk or low risk with a very consistent in a very consistent way. And what we did then, sorry, is to validate that with another, with this, this is just for the group of the genes related to ER, with another independent data set of 640 patients for which we don't have immunostrochemistry. In monostochemistry. And then what we also did, in this way, we select out of this 332 genes, distinct genes, out of this, and we put it in our system. And now with a different, this is another data set. This is a second data set that hasn't got immunoistochemistry, but based in microarrays. And this is a third data set independent, second independent validation. Second independent validation, a new court with 879 breast cancer samples that coming from the TCGA, where we select, we use the 300, sorry, the 34 genes that we select and we separate the samples. And then when we use our gene signature, we defeat both the genes that are behind oncotype and the genes that are. And the genes that are behind ProSigna. And this is what we publish. And I think this is a very interesting result. Why? Because we are in a way also not only trying to, because now, for example, I can go to the, well, it's not going against industry, but imagine to pay 4,000 euros for 16 gen PCR or 4,000. No, see, 4,000. PCR or 4000, no, see, for 4,000 euros for 50 genes, PCR is a little bit expensive. So, what we think is that if you test 40 genes with the PCR, you will have a similar result. This is our approach. So, this is the result, this application of this algorithm where we working for several years. And our scope, of course, will be to put it into BioCon. Um, bioconductor, and we hope it's used. And so far, this paper that we just published on breast cancer has been out for two weeks, and many people are reading it, so it's okay. And that's it. Some questions. Yeah, yeah, yeah. This is what the doctors recommend you just buy one or try to design a system where you have to test to do 30 or 40 PCRs and then you get a risk score. But at the moment, of course, At the moment, of course, the platform, they don't reveal what is the algorithm behind what they are doing. And our idea with Asuri is that you have behind all the analysis behind. So thank you for your nice presentation, Javier. I have a couple of questions. So what are the advantages of this Asuri package against or compared to another tools that provide like Tools that provide like survival analysis. Yes. Well, ASURIS is designed to link survival analysis plus risk prediction with gene expression. That's an important feature. And another important feature is that inside we've been working a lot in to do a robust methodology. We do multiple univariate and multiple. A univariate and multivariate analysis in a way that we can evaluate not only one gene, one feature, but a group of features and also give you the beta values of those features. And also, we are doing internally like bootstrapping and internal validation to see the stability of the feature selection because it's very typical that, well, That well, feature selection is a problem always, and that you can have many false positives. So, let's say to have a robust way, this is what we will sell with this algorithm in a way. Okay, so also I have another couple of questions. So, what is the output of the analysis? Because you showed like an image where we were seeing like some genes that were colored in blue and in red, and I missed like that. And in red, and I mislike that part of what. Yeah, the output of the analysis, the analysis will tell you if you want to do a specific univariate, do you want to test a given gene that you are studying in a given tumor population where you got expression and survival? It will tell you if this gene is associated to survival or not, according to the expression, this is one answer. Another answer is that you can, for a given, if you got that. If you got the data set good enough, you can put a group of genes and do a multivariate and then do the same analysis for this tumor to see which genes are the best markers for survival. And another independent is when you build the model, the internal model that Asuri builds, you can now take one. One different sample, that for example, samples of tumors that you left outside, and then you can predict the risk of these independent samples based on the model that as you reproduce. So it's a risk predictor for a sample that what it's going to do in that case is going to use, for example, in our case, the breast scan 34 genes read out with our model and predict. Read out with our model and predict for a given new sample of a new patient what is the risk. Okay? And put it in the, in a way, put it in this kind of this kind of profiling. Each one of these dots is a tumor sample. So you take a query one and they say, no, Query one, and they say, No, my sample is here, or my sample is there. This is what Procigna and Oncotalpa are doing for a given patient. Okay. So, in the clinical data, does it take into account like patient age or sex or another? For this, not we didn't, but of course, the doctors will take it. And I don't know because. And I don't know because it's not clear. We don't know what the algorithms behind Procigna and Noncotype Aduin. We guess that they are using that. Because, for example, for a doctor in breast cancer, it's very, very different prognosis with a woman of 40 years old that it is 65 years old. Just this is going to be very different for the doctor. Be very different for the doctors, for the clinical point of view. We don't know if they ongotype or do that this kind of evaluation. Any other question? Javier, thank you very much. This is really a nice package to work with. I would like to ask you: is it possible to integrate maybe this package that use, for instance, a metabolic pathway? Because you have Pathway because you have a very long list of candidates. Oh, well, you have a very long list of different expression levels of genes, and then each one of them apports a different weight in the multivariate regression. So, it will be nice if you weight the network with this weight to have also not only the outcome of the effect that maybe an oncogene has, but maybe you know, like you see, all the. Maybe you know, like you see all the integrated information of other genes that participate in the outcome of the cancer. I don't know, it will be maybe well. The idea is true. I mean, you can integrate biological information. Some people are doing that, integrating biological information from pathways, from functional assignment to the genes. At the end, we are evaluating the genes based on the Based on the strength of the influence into the risk prediction. So it's good that it's a multivariate analysis and in a way it's going to tell you why those are influencing negatively into the list. So they provide low risk profiling and those provide high risk profiling. And some of the genes that you put into the list, they give you zero beta value. zero beta value so of course many of these genes are related in fact when we went into the if you go more into the biology the biology of course once we publish that okay it's very interesting that many of these genes for her b2 or many of these genes for a strogen receptor are already publishing new publications related to prognosis and survival of breast cancer but also to Survival of breast cancer, but also to the same pathway. For example, it's very well known that estradio receptor and regester receptor are very much related. In fact, they behave very similar. And in fact, what happened here is that when you test estrogen receptor, it's more efficient and is more independent. But each time you test progesterone, estrogen comes as a big feature. So, this is like a second readout of the same biological events. So, these two tables, despite the fund from the model and the survival analysis and risk prediction, are different. The biology behind is very relevant. Of course, you have to study because you say, ah, then instead of this, why I should test. You see, we have the independent, the individual p-value. The individual p-value and the combined p-value, but the other genes, for example, SUSD3, that has got a much better p-value than X strollin receptor. So why don't you test to the patients SUSD3 as well as estrogen receptor? And some papers, you can go to the literature now, are saying that SUSD3 is a very good marker of tumor progression or tumor in breast cancer. In breast cancer. So. Perfect. Thank you. I will ask one more question and then we go to the next speaker. If the aim at the end of the day is to predict survival or to create a risk score, why have you started with a logistic regression at the beginning, with a regularized logistic regression instead of a regularized Cox regression, for example, in the first step of the Um, in the first step of the selection, and we try both, but uh, at the end, uh, we saw that it's more stable the cost regression, the multivariate cost regression when you do the multivariate, especially there. No, but at the beginning, directly at the beginning, you use logistic regression, right? Yeah, yeah, yeah, we use at the beginning, but inside the assumption. Beginning, but inside the Asuri is all cox now. Okay, so it's we move. I mean, we've been playing with different models and we use also LASSO and ReadNet to do the internal stability, testing the internal stability of the feature selection. And then we say that in the paper we found like intermediate. like intermediate method no it's not here what is in another slide here we uh here in the algorithm that we describe we explain how we went into the process of doing the same thank you so much okay let's thank now uh javier and record