I'm going to be chatting to you today about how to, or our method of understanding, characterising, and analysing DNA topology within atomic force microscopy images. So a lot of people have gone over this already, but ever since Rosalind Franklin discovered the structure of DNA, there's been a heavy sequence-centric view on this. But typically, But typically, DNA is quite a flexible molecule and can be pulled, stretched, twisted, making it, and why would this not affect its interactions with proteins and things like itself, providing access to the genome, which can be explored through things like electrical dynamic simulations and visual experiments. So, just like any long string or pair of headphones, Just like any long string or pair of headphones, DNA can become entangled through various processes. And these entanglements can really interfere with cell function. So not much DNA self-entanglement can happen during, can impede things like transcription and replication and also can increase things like DNA damage and mutation rates as well as. As well as chromatin formation and even influence cellular differentiation. Then catenates, just like our analytic rings, multiple DNA molecules that are interacting and linked with each other. And these are formed naturally during processes like DNA synthesis. And if these aren't untangled prior to cell division, they can cause cell death. So, this happens at cytokinesis to ensure the genome is maintained. So, basically, before understanding these DNA-regulating processes and diseases associated with DNA regulation, DNA topology regulation, we need better methods to understand for these topological intricacies of the DNA and its interactions with proteins. Proteins. So, some methods that have been used all the way up until the map, or are still used in the field, typically a gel electrophoresis, which is essentially a measure of mobility through these porous gels, which people have used to classify DNA knots at their minimal crossing number. This isn't always true, because typically what you have in your liquid is a fluctuation. In your liquid is a fluctuation with this knotting number, meaning that you kind of get this resolution ceiling of your gel, which means that, say, for example, two of the five noded knots, which are the knot invariants, will be really hard to separate on these gels. Alternatively, we have things like electron microscopy, which are a really cool single molecule conference technique, where we can actually visualize the Actually, visualize the DNA topology on a surface. Again, these have issues in themselves, which basically surround the conditions in which these are imaged, such as these are typically done in air, which, as you can tell, is not very related to, it's not how DNA would be found in the cell. And these are coated in protein and also spot on the metals in order to get the EM shadow. In terms of the analysis of these single molecules, The analysis of these single molecules. Typically, these are crowdsourced crossing determinations which are given around the lab in order to accurately determine the topology. So these are quite old methods, as you can see the dates on these. I would think we could do it a bit better. So the method that we've looked into is using top ports microscopy, being a NFM one. Recipe being an NFM well. And this essentially works via a sharp tip interacting with the surface. And this kind of works like a record player, in which a sharp needle will feel the grooves of the record, just like our tip feels the surface, essentially. So basically we have a laser which is shown onto the back of a cantilever which deflects during this interaction, meaning that the position of this laser that's reflected onto a position sensitive vertically diode. Social sensitive vertical diode changes, and we end up with a topographic image. So basically, that image is that each pixel represents a height, and we end up with something like the top row. And now, in comparison to other methods, this AFM technique is really good. It's really high resolution and signal-to-noise ratio image, as you can see. As we can see from those images against cryogenes, we can see that they're done in liquid, so this is more native to the conditions that DNA is found within the cell. There's no labelling that's needed, so we don't need to perturb our DNA sample. And there is no averaging that's also needed, so we can work with longer molecules that are more flexible. And what's really interesting about this technique, really cool, is the really good height rate. Cool is the really good height resolution that we get. So good in fact that we're able to see the double helix. And the lab has got this down to kind of fine art and being able to see this quite often within our APM images. And beyond that, we can even see, shown by the pink and blue regions here, variation within the double helix with the major group getting wider than the pink. And getting more restricted at the blue. Make AFM a really good tool to identify biological features and probe these biological questions. The question is, can we use AFM to quantify this DNA topology? So for our sample, in this experiment, we're looking at, we've used known reactions which create knotted and catamated products. For example, this one, which is an XER recombination. An Xi R recombination reaction, which creates our form odocatines. And then this is identified on a gel and purified by cutting out the regions of the gel that we want. And we use direct and indirect repeat dual CER site plasmids to generate two groups of knots, which again we can see on the gel. Which we can see on the gel. And then the idea is that we can cut these out and end up with our sample, which is supercord on supercord plasmids or on-nuts, four-noded torus, catenome, and then these three knots down here. So the two five-noded twists and a three-noded knot. So why would AFM be a good tool, this, and what's the idea behind it? The idea is that now that we have an image, it represents An image that represents our molecules' topography. We can trace certain regions and draw a line across these regions to obtain the underlying values of the heights. And even in here, we can see the double helix resolution in this. So when we move this onto our crossing region, what are we expecting to see? What are we expecting to see? So, here we can see that essentially we're looking at this from a top-down perspective. I like to think of it as two ropes lying over each other. So, we want to identify which part of the rope is lying over the top and which is going underneath in order to determine anthropology. So, essentially, we look at these and say that the, ideally, we want to say that the overlying strand will have a The overlying strand will have a shallower gradient in its height, and then sort of like this one, and then the underlying strand have a steeper one. And when we do these manual traces, that's exactly what we see, is that when we trace along these high profiles, we see that. So we see the overlying strand has a shallower gradient, and the underlying strand has a Blank strand has a sharper idea. So, the way to quantify this would be to use full width half maximum at the peak, so that's the full width at half the maximum height, to be able to quantify this. So, then when we look at all of the crossings in a molecule, and we can determine these by eye and drawing traces on them manually, we can end up with a topological classification. We can end up with a topological classification. Okay, so that's great. But I think we can do a bit better, and I think we can do this in an automated fashion where there's no manual intervention needed. So that's where our group of software Topostats comes in, which is able to take this raw AFM data, which doesn't look very nice, can remove the imaging artifacts such as tilt and row unalignment to get a nice image. A nice image, and we can also identify our molecules of interest from that image, such as the DNA main circles in this example, or our knots and cats in our examples. Toposet's also able to produce some geometric statistics based on the sample, which can give some insight into compaction of your DNA. So, building onto this, with the mask that we obtained, With the mask that we obtained, we aim to try and simplify this on a physicist by train. So, aim to simplify this into a single pixel trace, something that looks like this using existing skeletonization methods. But the key nard of you at the front might be able to see that where the stars are, there are protruding branches which don't represent the molecules of topography or topology. And also, at the crossing points, depending on the map, thickness of the mass. Depending on the thickness of the mask, this doesn't really align along the DNA backbone. So, we've made some changes and developed some algorithms of our own, which uses the underlying height data of the AFM to bias these towards the center of the DNA background, which will give us more accurate traces. And we also are able to prune all these furious branches. So, now we've got this. So now we've got this. We can identify the crossing point, the splat creation in the centre, as via a local area convolution. So we're looking at how many pixels, we can count how many pixels are nearby. Ones with more than two neighbours will be a crossing point. Once we've done that, we can remove the crossing point and check all of the branches, identify a vector for the branches, and using this vector, And using this vector and bipartisan matching algorithms, we can identify which, through their vectors, which will be most likely to go together. While we're here, we can get things out like crossing angles, getting our traces and quantification of our forward path maximums or our crossing quality. And we can also identify a confidence value or a pseudo-confidence value. Or a pseudo-confidence value, which we're just taking: one minus the length and the max of the crossings. This is going to help us rank how well the tool has done at identifying these crossings later on. So once we have this, again, do the same process. We do this for each of our crossing points in the molecule. And we can determine, and from this we can get confidences. And within the cathode, we can actually separate out both these mini circles. Separate out both these mini-circles, and we can identify their contour lengths, which match very closely to the expected contour lengths of these samples. And from this, which Andrew mentioned before, we can use Topoli to use this, which we can convert into a pseudo-3D trace, plug that into Topoli's XYZ coordinates, and contain a topological classification of our four-node academy. But can we do this for other notes? But can we do this for other knots? Yes, we can. And we can even differentiate between 500 torus and 500 twist nuts. Again, by doing this process on every single one of the crossing points, evaluating them, putting them into Topoly to get a classification out. And this works pretty well when we've hand-picked some of these mice molecules that we see. And again, this can work for relaxed, supercoiled, twist, torus. Supercoils, twist, Horus, catenanes. I've left the three noded not off because it's not as interesting as these ones. But the tool works. Okay, awesome. What if we look at the rest of our data where we've not seen ones that should look like they're not diagrams? So, looking across the whole data set, there's a bit of a problem. But when we look at plasmids, these look as we expected, and we're looking at the crossing regions. As we expected, and we're looking at the crossing regions and the number of crossing points they have, we see that the supercore ensemble has more crossings, typically has a wider distribution of crossings than the negative plasmas. As expected, all was great. As we move to catenanes, something's a bit wrong here. So in our all our NOP diagrams, we're expecting our minimal crossing numbers before, but that's not what we're seeing. What we're seeing in our AFM images is that actually these crossings tend to bunch up, and we're To bunch up, and we're seeing that depending on the topological species of this, in our next versus supercoiled catam, we're seeing different distributions of these crossing numbers with our supercoiled catam showing a wider distribution of crossings than the nipped catename. A bit of an odd result. And as we get further into more complex topologies, More complex topologies. We're also seeing that there are different distributions, not only for different topologies, but also different not invariants within the same top class. So we thought this was a bit weird and warranted more investigation. So we looked at the catamane examples and samples and we came up with four easily identifiable classes. Easily identifiable classes within what we can see. These are all classified based on how many crossing points you can see by eye and how many branches each of those crossing points has. So when we and we've also managed to do some simulations, some coarse-grade simulations, which seem to agree with that, agree with the fact that we do see these quite commonly. See these quite commonly in both coarse-grain simulations and on the AFM. These confirmations do exist and they are, as we expect, for example this one that looks like a two-node link is actually this clustered node is wrapping around the DNA and we see these within our sample. Within our sample. So, again, one of the interesting things that we see from these coarse-brain simulations is that there is a positive RIVE that exists within the NIC sample. So, we think this is due to the smaller mini-circle inducing this RIVE, and then as the NIC gets sealed back up, puts into this MIC sample a positive supercoil. So, as we count these classes, you can see that there's a huge change between the open and the clustered for the mixed and supercode. We're seeing actually much more open structures, which look more like our catenate full-noticenate diagram in the sample. And again, this is because this positive ride that's induced in the molecule is becoming undone by this negative supercore. Which is changing these distributions. So the tool can also characterize these confirmations, not only based on topology, but also based on these values and these manual classifications, which can be automated. So, one of the hard bits about this is trying to filter out some of these non-conforming non-conforming. Non-conforming looking molecules, which might skew the statistic to the end. So, one of these we get rid of as failed traces. So, you can see a big score over here, so we've kind of got rid of molecules like this. So, this is all in order to kind of standardize this filtering process instead of cherry-picking our favourite molecules and making this more transparent. So, here we see that there's a three-node. See that there's a three-noded three-branch crossing point here that's been picked up, which causes a failure in the algorithm because there's not enough vectors to pair. So we get rid of these molecules as well. And again, anything that has more than two branch crossings, we also need to get rid of because of the limitation of the tool. That is, we're unable to pair these wraps based on the spectrometh. So, if anyone has any ideas on how to improve this method, not in. Method looking. Okay, so how do these actually look when we look at our tracing capabilities and our topological classifications? So basically, this is with the mixed and supercoiled samples of our own nuts. We see there's strong recall on the correct topologies, which makes sense. These are the least topological complex that we have. And also that their contour lengths, which is the length of the way the data. Lengths, which is the length of away the DNA backbone, lies very close to what we expect, showing that there's very good tracing capability in there. And this is a measure of how the topology distribution is a measure of how correct our over and under classifications are. And using the confidence rankings, we can flip one of these crossings or the lowest Or the lowest confidence crossing to see if we end up with the correct topology. So, this is kind of highlighting if we have, or highlighting deep deposition effects that might again further skew these statistics where we see these two link catenanes instead of four-noded catenanes. So, again, as we move into more complex topologies, we're able to separate. We're able to separate out the larger and smaller mini circles and the catenades quite well. We do get a cluster where the vector pairing has gone wrong up at the top. But still, we see these quite good and close to the expected contour length distributions of what we'd expect. And again, we see these topological classifications. Classifications, which initially seem very incorrect, which I guess they kind of are, but also these are manifesting the deposition effects of the DNA onto the surface that we showed earlier with this means, as we are also seeing some things like two-noded links and yeah, two-noded links. And again, as we move to look at these topologies, when we click this cross. When we click this crossing, they seem to change too much, showing that the tool seems to be correct. And what we're seeing is more of a deposition effect and clustering these crossings that we can't analyze properly. And again, for the knots, we're seeing good accuracy with the contour length distributions. Again, the more simple topology. The more simple topologies were getting more correct as we get harder and harder. More and more nodes, crossing points, these become more difficult. But again, we're seeing that there's a difference between how the torus molecules like to distribute their crossings among the length, and they like to bunch up a bit more, giving those incorrect readings. And similarly, the twelve. And similarly, the twist, or in the officer hand with the twist, I'd like to display these crossings out a bit further. So to conclude, we've built an open source software to help quantify and characterize complex DNA topological molecules, which has a high 2D tracing accuracy. We can see that the topology affects the clustering of these crossing regions that we can see via the AFM, which makes things difficult for our tool. It's also a cool. For our tool, it's also a cool thing to see on the other side. We see the surface plays a role at manipulating this DNA conformation within these topological classes. And the reason I'm at this conference is if you have any topological insights into this process, please come and chat to me. You're more than welcome to hear them. I'd just like to thank all of our collaborators as well as our team in Sheffield and James. James, Sean, Andres, Giuseppe, and Gernato, who've been helping with the simulations. Thank you.