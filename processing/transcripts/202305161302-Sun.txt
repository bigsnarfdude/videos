So people can watch you real time. So you have to push the start button before you start and then when you finish you can stop the people. All right, thank you Wei, Peter, Quid and Ronglai for organizing this great workshop and glad to be here. My name is Wei Shen from Freihatch. I'm going to talk about the three-body problem. So the picture Three-body problem. So the picture of the this is the Fred Hodge campus and this is University of Washington where I have an affiliation. Okay, so three-body problem. What is a three-body problem? Nowadays, if we have a question, we can ask Chat, oops, the other way. We can ask Chad GTT. So I asked, give me a brief explanation. It wasn't very brief, actually very long. Very brief, actually, very long. I take the first paragraph. Basically, three-body problem is a mathematical problem for three-body, like if we have three signs. And then if you don't use ChatGPT, if you say use the Google, and then you'll find the different things. This is one thing you can find. I'm not sure how many have read the book. It's a great book, very boring at the beginning. Very boring at the beginning, but people reading it will find it interesting. It's also the other three-body problem. So the three-body problem I'm going to talk about is different. It's much smaller scale. So it's about the immune interaction with our biological system. It's IPLA, peptide, and T-cell receptors. So a peptide, a small segment of protein presented. Segment of protein presented on cell surface by an HLA, either HLA1 or HLA2 protein. And then TCR is a T cell receptor that can recognize the HLA peptide complex. And then, so HLA is a human version of this major histocompatient complex. And this is a picture to illustrate the idea. So if you have this. So if you have this cell as a T cell and this is a tumor cell, so tumor is different from other cells because they're somatic mutation, their neuroantigen, the neuroantigen presented in the cell surface by HLA or MHC, and then that red dot is the peptide, and then the TCR can recognize this complex so that the T cell can attack tumor cells. And that's the reason many of us, you know, we can. Many of us, you know, we cancer-free because the immune cell keeps doing their work. And then another for HLA2, it's similar, it's just from CT4T cells, and then look at the HLA and peptides from the antigen-presenting cells. So now this is the beginning, and then this is the outline of my talk. I've started with some background. I think many of you know those topics. Many of you know those topics, but I just try to cover the base. And then I'll talk about one computational method we work on. It's a neural network method to study the relation between HLA and TCR. And then if we have time, I also talk about another work we study the relation between the peptide and the HLA. Okay, so again, the background that the T cells recognize this HLA peptide complex. So if we got this, say, either infected cell or tumor cell, and then if the CD8 T cell recognizes this non-cell to falling peptides on the cell surface, the CD8 T cell will start trying to kill the cells. And then each T cell carry one TCR. In reality, actually, there are some T cells carry more than one TCR, but the vast majority, one cell, one TCR, Vast majority, one cell, one TCR, and it's generated from a stochastic process. So it's unique for each T cell. And the T cell recognizes the foreign antigen, then undergo clonal expansion. So producing many calcase are a cell. And then they have the identical TCR. So we can trace the T cell. Okay, and then the questions we want to study here. So why we started? So, why we started this three body problem? I think I hope I can give you some reason why this is important. And then, the immune system is just so powerful. And then it plays an important role in so many different areas. And then, this three-body problem is a key factor that determine the immune response. And for example, the immune response is, of course, important for infectious. Of course, important for infectious diseases, and it's also very important for cancer and even Alzheimer's disease. And nowadays we have this cell therapy, we can engineer the T cells with a particular TCR to target the tumor. And what the data look like? The data is pretty simple. For each person, first look at the HLA data. We can genotype the HLA. And then the data you got is usually like a name, the name of the HLA allele. Name, the name of the HLA allele, and then there's a HLA sequence behind that. I will talk about HLA next slides. And then the TCR data is the largest data site. So each person can have tens or hundreds of millions of TCRs. And then if you think about you have a population 600 individuals, you got the TCR data. You can just think about this as a big matrix. Say 10 million rows, 600 columns. Each entry says 600 column, each entry saying whether this person had this TCR or not. So it's somewhat like a SNP, a genome. And then, if you do whole genome sequencing, you've got lots of the private or rare SNP. And the TCR is similar, very rare. What is the source of this diversity? Like tens or millions? I don't know. Yeah, I was actually going to talk about that. Do you see a lot of overlap in TCRs from different people? That's another great question I was going to talk about. That's another great question I wouldn't talk next. So, yeah, so why there's a diversity of the TCR? So this is kind of, I'm not going to go too much detail, basically. There's genes encoding in our genome. There's VDJ recombination. After recombination, there is somatic mutation. So it's really a random process to generate a huge diversity of the T cells. And the diversity And the diversity of TCRs. And then, biologically, the reason is just to prepare our body to fight any foreign objects. Because there's SAS Code 2, we don't know that before, but our body, some other immune cell, can recognize that. So we were having chats with Old Ones. I don't know if you know this thing. So he's feeling so angry. Was all these somatic mutations at the junctions between V and D. Is that what you observed? Because he said there could be no somatic mutation within the TRAV segment. So if you have a new tool for genotyping the germline of TRAV, J and C, if you're interested, we'd love to share it with you. Yeah, that would be great. There's a lot of diversity among the human population. Yeah, I would love to. Yeah, I polished it. I will. But is that what we are observing? I mean, I actually do not know exactly. We didn't look at the data particularly. And here, the V gene are mostly germline. There's not much mutation in V gene. And then most of the mutations is in this particular region or CDR3. Like when you look at the sequence, it's really, as you said, really in the DJ. And that's what I understand, but I didn't really quantify that exactly. So then here is a more like refined picture, TCR and HLA1 present the peptide. And then the TCR we can divide them into CDR3, CDR1, CDR2, CDR12 mostly decided by the VG. So the VG is like something germalized, so we can just know their sequence. We can just say this is VG allele1, ViGing allele two. And then the CDR3 is the real And then the CDR3 is the region that is most diverse, so we have to sequence that, because otherwise we do not know there are many somatic mutations there. And so the HOA2 is more complicated because the peptide is presented, it's an open space. The peptides can have different lengths. It can be longer. And here, HLA1, the peptide is 9-amino acid. 9 amino acids. ICRI2, the peptide is typically 15 amino acids, it could be 25 amino acids. Okay, so this is the data looks like. It's so simple. For the TCR, you got the amino acid sequence. So typically like 15 amino acids, not long. And then for the peptide, you got the peptide sequence. And for HLA, you got the HLA alleon. Then for HLA, so a little bit more detail. So, a little bit more detail here. We have HRA class 1, class 2, and then they are located in this particular region in the human genome. That's the most diverse region in the human genome. And if you look at a family tree and then we inherit one copy from father, one copy from mother, then for ABC, so there's a So there's six for each HLA one gene, ABC, there are two alleles for each gene. So there are at most six alleles. And then HLA2, there's at most 10 different alleles. So except the HLA two, they are encoded each HOA two protein is encoded by a gene pair. So they are By a gene pair, so DR, DP, and DQ. So there is a good reason that we have this very diverse HLA allele in the human genome so that our immune response will be different. Like you and me, our genetic sequence is so much similar, but our HLA are different. So human as a species will not have the same response to one virus. Or no one virus can kill us all. We can survive as a species because of the diversity of HRA. Diversity as well. And I want to also give some examples to just illustrate the power of the TCR data, how informative it can be. So this is one of the earlier data, they use TCR to study the infection by CMV. So that's a very common virus. Half of us have that. We just don't know it. Our immune system control that. And then, so here the data, each point is one individual. Each point is one individual. The x-axis is the number of TCR sequencing for that person. And the y-axis is the number of TCR they are associated with this variables. And that association is just simply detected by case control study. You do a facial exact test, logistical regression. You'll find that TCR co-occurs with the people who have an infection. So you'll find those TCRs. And then, so it's like a skull. And then this is. Skull. And then, this is the training data. You can see the people who have the virus infection have much more virus-associated TCR expected. And then in testing data, they also separate pretty well. And then think about this is a study with only sample size, like a few hundred individuals. And then, for those of you who work on genetic GWAS data, it may remind you that polygenic risk scar. Polygenic risk scale. So you have snake, each snake associated with the disease. Then you add them up to predict the disease status. So this prediction is very much like polygenic risk scar. And what's the difference? The effect size of TCR is much larger. The genetic variance, the effect size is like out ratio 1.1. But here, the out ratio is 2 in log scale. So it's really huge. And so that's why we can get So that's why we can get relatively accurate prediction with the small sample size to train our model. So are these germline or is it obtained from RNA? The TCR are from DNA. I mean there is different technique to sequence TCR. You can do DNA sequencing or RNA. This is repertoire. That's what it is. It's not based on germline analysis. Yeah, it's based on the TCR. Yeah, yeah, it's based on the TCR rector. It's those uh TCR after the somatic notation with easy recombination. Yeah, so that's why each person has a large number of unique TCRs. Okay, so what's the computational problem? So that's one thing that when we start working on that, it is a long time trying to learn the concept. And then we encounter this one issue, the three-body thing. The three body scene, there is an HLA there. So those disease-associated TCRs, you can identify them by doing a facial exact test. TCR, yes or no, disease, yes or no, but you ignore the HLA there. And many of the disease-associated TCRs, they recognize the HLA and say virus peptide together. So they are restricted to certain HLA alleles. And then, so basically, So basically I say in conditional particular HL, you can get much more accurate prediction. And I can show you that. So here is, and this is the data we saw before. Previously, this is just when you do the facial exact test, you use a PYU cutoff of 10 to 193. And then this one is the same thing that you look at different PYU cutoff. And then, so this is AOC when you classify case control in the testing data, and then the right Testing data, and then the right points are using all the individuals. So the AOC is pretty good, but if you conditional on some HRA allele, for example, this HRA2 allele, you can guard the AOC much higher. So there is a signal there. It's a simple regression problem. There is a covariate you want to account for. But the problem is this covariate you want to account for, this HRA, is a categorical variable. It's a categorical variable with a thousand categories. So it's not something you can just put them in a variable as a variable in the model. So, what we can do, where naturally we want to borrow information across different categories, and how do we borrow information across categories? We want to know their similarity. So here is our motivation to train a neural network to study the association between HRA and TCR. And then if two HRA, they are associated. If two HLA are associated with the same set of TCRs, then we think they are similar. Then it's a function of similarity. Okay. Now I'm talking about the neural network method here. So we start with just a schematic plot of the method. We call this method as a DEPS deep learning prediction of TCR HLA association. So we look at So we look at basically use the data I just mentioned earlier. The data set is like 600 individuals. Then we have the measurement of TCR, HLA, and the data. And then we just look at their co-occurrence. Like previously, I saw the co-occurrence between TCR and the disease. And now we look at the co-occurrence between TCR and HLA. So I saw in panel A here, so you got a group of individuals, and then you look at whether the Individual, and then you look at whether this TCR and this HLA they co-occur or not. So you have two H, everyone's got two HLA alleles, right? How do you deconvolve in that? Oh, no, we look at the HLA allele one by one separately. So the HLA data is also a big matrix. So for each particular HRA allele, I ask whether the person has it or not. Oh, I'm sorry. Where's the data come from? You're not just like doing. Where's the data come from? You're not just like doing TCR sequencing of someone's blood. Sorry, yeah, the HI data come from independent array source. Oh, okay. This is like this is a mutual study of HILA and TCR. Sorry, where are you getting the HILA and TCR associations from? Okay, so we got the TCR data, it's a matrix. Each row is a TCR, each column is individual. We say whether the TCR is there or not. And then we also have the HLA data, which can be. Have the HLA data, which can be from whole exome sequencing or genotyping. So it's also a data matrix. Each row is one HLA allele. Each column is a person, whether the person has HLA allele or not. But each person has two HLA alleles. How do you know which TCR went to HLA allele? No, we don't do this function of whether they interact. We just ask what their co-occurrence. We just say, you know, this person can have. You know, this person can have even up to 16 HRILU. So in the whole population, there are thousands of hundreds of HRUs in the population. So we basically have a matrix, we just say 200 rows. Each row is one HLA. I just ask the person whether the person has this HLA or not. And then if this person has an HLA, I'll check mark here. And then I got two vectors here. Okay. Yeah, you may have mentioned this. Sorry if I missed in, but what kind of metadata have you had? What kind of metadata do you have here in terms of demographics, potential disease states, et cetera, that's a great question. I think we probably have some age-gender information, but we didn't really account for them here. There are definitely, you know, if there's a like the I think the the race information, there are more uh population. So, you know, the population specification will definitely affect HRA and Affect HRA. So, your goal is to find the partnerships, potential partnerships. Right, right, right, right. Yeah. So, ideally, you want to say, you know, this TCR is bind to this HRA. As Chris mentioned, it's like mixture of the many HLAs. But here, we just say whether they co-occur or not. So it's just an association. Is there like an optical sentence effect, like 0, 1, 2, 2? Yeah, yeah, yeah, yeah, yeah. There is a dosey fact. We simplify them here. And the I shall A or real could be 0. And the ICRA could be 0, 1, TCR can also be 0, 1. Yeah, we could also do this with this quantitative measurement. And the TCR sequence is just the CDR3 region. Here we actually define that as a combination of Vee gene and the CDR3. Enter. I mean, yeah, pair together. How do we get? Here we actually use their sequence. In the neural network, we actually use their sequence. I mean, the we is just. Sequence. I mean, the we is just, you can, it's a great question. So, for we, first you know which we allele it is. There are many we alleles. And then, and then it's long. We use this part of their sequence involved CDR1, CDR2. Okay, so we use this co-occurrence to find So we use this co-occurrence to find the associated HLATCR pairs, and those are the pairs they should be associated. And then we just randomly sample HLATCR pairs, then they should not interact with each other, and then we do a classification problem. And then the input data, their sequence. So there's a little bit more detail here, because when you look at the neural network, it's sometimes tricky. You've got to make sure there's no bias between your positive. Bias between your positive and negative data, otherwise, it will learn that signal. So, you just try to make sure the positive and negative pairs matched by HI frequency and TCR frequency here. But the key here is you got the sequence data, and you use the sequence as the input of the neural network, and then the neural network will predict whether this HLA and this TCR are associated or not. And then the TCR, there's many information. The CDR3 is the PCA. The CDR3 is the key part. The V gene part is divided into CDR1, CDR2, CDR2.5, the sequence. Then a little bit more detail on the neural network. When people use neural network, one question is like it's a tuning game. There are too many parameters, and how do you tune it? I think my experience is it's more like a flexible. It's more like a flexible non-parametric method. And there should be a signal there. I mean, it should be that no matter what the tuning parameter is, you should see it. And the tuning parameter can get you better, but your results shouldn't be too sensitive to the tuning parameter. And that's what we see here. We look at many different things, the architectural neural network, how do we encode the amino acid sequence, and then whether we use the V-gene information as the sequence. Vegin information as the sequence, or just using the Vegin name as a categorical variable. And the neural network, how many layers, what's the number of nodes per layer? And at the end, we have 720 neural networks, and then look at them in the, this is validation data. In the validation data, we look at their AOC. So the vast majority of them, their AOC is far better than 0.5. So the same, there's a signal there. You just randomly pick up a neural network, it should be able to. Up neural network, it should be able to capture that. There are a small number of them, it really doesn't capture anything, but most of them are okay. And then so we split training data to training validation, choose those hyperparameters, and then we got something like that. So this just probably gives some more intuitive idea. For HLA, we also use their amino acid sequence. And HLA is longer. We actually use a subset of their sequence, about 30 amino acids where the HLA interacts. Where the HLA interacts with the TCR or peptide. And then I'll put them together, I'll make a prediction. So the prediction is relatively accurate. So there's so much information you can have from those sequence. So we do not expect at the beginning we can have an AOC like 0.95. So here we got the AOC around 0.8 for actually. Around 0.8 for HRA1 and HRA2 separately in the testing data. And this just tries to demonstrate the prediction score. Score one means they interact, score zero means they don't. And then this is in our testing data, the positive paired, negative pairs. And the third one is independent data. They have a small number of TCR, HLA complex with some structures. So those are the things we know they actually integrate. Are the things we know they actually interact? And then the positive and negative para we got in testing data is just say whether they co-occur or not. Whether they happen to be, appear in the same individual, they may not be the functional thing. And then this additional data is more like accurate to say they do interact with each other. So we can also do well there. So then cover our background. Why do you want Background, why do you want to use neural network? So that usually the neural network will work well. There's strong signal. Like you classify cats and dogs. The signal is so strong, you have to learn the feature. And then this is kind of the case. And then what about other methods? We also train a random forest, which is actually not bad. And then we do better than the random forest, not a big margin, but the random forest is not. Margin, but the random forest is not doing well in this external testing data. I'll speed up a bit. So, another method we compare, a CLAIR method, they also use neural network to predict HLA and TCR association. Probably a key difference is they model the HLA as a categorical variable, so they don't take the sequence of HLA. So, this is a result that is dominated by some HLA. They are more abundant, more frequent. They are more abundant, more frequent in the human population. So, basically, comparing their method, they do better than our method in one HRA allele, which is most popular in the human population, and then we are doing better than in all the other HLA alleles. Okay. And then, so this is one application. We got this prediction, HLA-TCR association. So, what? What's next? So, here is one possible application. So here is one possible application. We try to use this quantity to assess the similarity of the HLA level of two individuals. So our method allows us to transform the HLA from the space of amino acid to the space of TCRs. And then we can quantify their similarity in the space of TCRs. So we look at a particular data set. They are the TCRs from CDAT cells. From single-cell RNA-seq data, and we look at our data, we try to find the so-called cancer-reactive gene expression signature. So, this is very recent development. They do this functional assay to identify the T cells. They actually react to tumor, and then there's gene expression signature. So, we find those TCRs, and then we ask for each person, like say, if we only consider SLA1, there are six alleles. HRA1, there are six alleles, and then which TCR is associated with each HR allele. And then we just take the union, that all the TCRs. So this is a measurement. Say, for this person, based on her or his HR allele, what kind of TCR can be recognized? And then we can use that to measure the similarity of two individuals. This is a Jacques Card distance. And then I guess we can also use. Then we can also use the HLA sequence to define similarity. So that's my baseline approach. If you have the two persons, one person have six, I show a little, the other person have six, I show a little, you can calculate their sequence similarity. And then you got a matrix. Then the thing is you need to convert those matrix to one number to say how similar are the two individuals. Individuals. So we use a so-called optimal transport. Basically, transport the mass from the sixth IGRU to the other six HRU to get one number. And then we can also define a correlation-based distance. Basically, for this person, I got this association between HLA-TCR, and then the HLA is transformed to the association scope. Transform to the association score for a set of TCR. I can tell you the correlation of the two vectors. Anyhow, so we have this different distance matrix, and then we look at their association with the patient survival. Now, this is actually a very long way you think about, this is immunotherapy, but the HRA diversity, how does it affect the peptide presentation, how does that affect the treatment? There are actually many steps, and it's kind of tricky that the immune system just needs to recognize. The immune system just needs to recognize one new antigen. And then, so there's the immune dominance. But, anyhow, with all this potential confounding factor, we do find some kind of suggestive evidence that the HI diversity can be associated with survival time, either without covariate or with a covariate like age or tumor stage. And then, if you just look at HR singularity, because you got the singularity. Because you got the similarity of all individuals. Based on the similarity, you can cluster those cancer patients. And they are in two booths, and you can look at their survival time. Not a huge one, but you can see some signal there. So what does the blue group represent in the direction expected? Yes, yes. I think the question. Question: So, if the HRA is more diverse, if it captures a more TCR, that should be bi-versal I would like. So, that's the right. Yeah, that's the right one. So, why are you comparing alleles of one type with another type? Shouldn't be here we're looking at the same, very same gene across the two. Yeah, we can, but we want to aggregate them into one number, like this one. Aggregate them into one number, like this person has six HOI will, the other person has six HLA wheel. I want to know the similarity of the three person. Shouldn't you be looking at the space same genes? Yeah, we can say we can have one similarity for HLA A genes, one similarity for HLA B genes, one similarity for HLA C genes, and then take average. That totally makes sense, yeah. I think that this optimal transport is almost doing that because when they do the optimal transparency, they just find that the Just find the smallest distance to transport. So for this person, its HLA gene should be more similar to the HLA gene in the other individual, so we'll transport there. Okay, so I think I may have just used another three, four minutes to briefly cover another topic. So another part of the three-body problem, we look at HLA and the peptide. This is actually very well studied. This is actually very well studied area there because the neuroantigen interest their nita NHC many measure in this area. So I was going to talk this very briefly. So the idea of neuroantigen is just you got this somatic mutation then it presented in the cell surface. There are many steps in the processing the proteins and then transportation. So and then and then this is then this And then this can affect the T cells. And so there's a more recent type of data to identify those HLA-associated peptides through my spectrum. So basically, they have like an immunoprecipitation. They grab the HLA and then see what's the peptide associated with those HLA. That grabbing is pan-HLA. So take all the HLA. It's not clear. All the HLA, it's not clear which allele which HLA allele it is. So you got a collection of peptides, and you know they are associated with one of the HLA of this individual, you're not sure which one. So naturally, there's a mixed redistribution problem. And then so we basically model this and then add a randomly selected peptide as negative ones. And then as a mixture distribution, there's standard EM algorithm to solve that. And the same is in. To solve that, and the thing is in the M-step, the maximization step, we can formulate that as an objective function for neural networking. So the M-step is solved by a neural network. And then this is a comparison with our method, with the NetMHC. I would say NetMHC is already very good. And this is really for our start of this whole area, our learning experience. We feel this is a mixture model problem. This is the mixture model problem. One that MSC does is like hard pay-mean. It finds which peptide associated with which HLA they enrich in the model. So they assign the peptide to one class with 100% weight. And what we do is a soft payment. So suppose soft payment should be better than hard payment. And then we do see some improvement. And then if you look at a particular sample, we're doing better than that I'm going to see most of the samples. See most of the samples. So, and then look at the prioritized neuroantigen in melanoma patients. So, this is a study, I see the list of the citation here, RAS et al. 2017 data, and there are 60 patients. So, here, it's a very messy plot. Basically, each point is one potential somatic mutated pipeline. The x-axis is kind of axis is a kind of scar whether they're going to present in cell surface if it's reference, if it's wild type. And the y-axis if this is a somatic mutation. And then you can see basically what we want to find is the upper left corner. This height type is unlikely present in the cell surface if it's well-type, but it's more likely to present the cell surface if it is mutated. And this is a nitimate match C. And this is a nighttime HC prediction. This is our method, a pipeline prediction. And then we use this one to calculate a new antigen load. Basically, the new antigen should have high presentation score after mutation, low presentation score before mutation. And then we associate the scar with this so-called satellite scar. Basically, it's kind of how much immune infiltration there. To email infiltration there. And then again, we see, depending on the cutoff, how do we define what is a new entity across different cutoffs? We can see there's a stronger association using our method. But in the real data, it's actually hard to know exactly what's the truth. Okay, so that's all I want to say. So the first part of the HLA TCR Association was a collaboration with Phil Bradley at FREAR HART. With Phil Bradley at FRIH and was led by a postdoc Celio. And then the second part of HYE Pipetite Association, the dissertation work of a PhD student, Laura ULC. Okay, it was an interesting three-body problem. Thank you for your attention. Questions for the way? Online, offline? 