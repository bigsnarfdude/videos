time for uh putting together such an amazing workshop. It's been a pleasure to to spend this week here. And yeah, I decided to actually add this like small subtitle in the in the slide because actually I am going to present you some very recent results that I worked on with Peter, Gaspar and Marie Denise, which actually focus on pedestrian Focus on pedestrian flows, unidirectional pedestrian flows in domains which we define as bottlenecks. I will be more precise about this later on. And I would also like to thank Peter for allowing me to also keep the multiple time scale dynamics big in this slide because I'm also actually going to talk about multi-scales in space in space, not in time. So I'm happy about that. Right, so to give a bit of context, To give a bit of context, this is actually one of an example of experiments that have been conducted to collect data in this setting. The kind of framework we're working on are unidirectional pedestrian flows. So a corridor is kind of the most simple geometry that you can think of, but essentially domains where you have pedestrians that enter from one side and exit from the other side. So the key here is to have a single Here is to have a single entrance and a single exit. And of course, the idea is that the inflow and outflow rates, so that regulate both the flow at the entrance and the exit, can strongly affect the dynamics of such flows. In particular, they can lead to the formation of so-called boundary layers. In practical situations, this is something that you would like to avoid because boundary layers here essentially means high density. means high density, for example, in correspondence to the entrance or the exit. So when kind of designing such types of domains for real-life scenarios, this is the kind of thing that you would like to keep under control. So how can kind of dynamical systems and in particular GSPT contribute to this? Actually our goal, so the let's say our contribution to this to this work was essentially to Work was essentially to use GSPT, so in some sense exploit the natural multi-scale structure of the problem, this will also become clearer in a minute, to identify prototypical stationary solutions for this problem. So in this sense, you are interested in seeing on a long time scale how the system evolves. So that's why we focus on stationary states. And in particular, we And in particular, we want to say: okay, if we know what the inflow and outflow rates are, we can say more or less how the stationary solution will behave. There might be some specific features that change depending on these features, but the structure should within each region not change much. And in particular, also seeing how the geometry of the domain influences the emergence of the boundary. Influences the emergence of the boundary layers. So, these are the kind of questions that we asked ourselves. So, the starting point was actually a model introduced by Berger and Beachman in 2016. This basically describes pedestrian flows. So, rho is the pedestrian density. U is a normalized vector field which kind of prescribes how pedestrians will move along this domain. Along this domain, G represents the total flux, and in particular, you see here that the boundary conditions are density-dependent. So, here you have your inflow and outflow rates, alpha is the inflow rate, and beta is the outflow rate. And the boundary conditions essentially tell you that the flow at the entrance, which is here denoted by gamma, is influenced by the density. By the density. So when rho is fairly high, close to one, then you basically won't have anyone entering your domain in some sense, and the boundary conditions on the exit, which is here represented by sigma, also feel the influence of the density. Of course, coming from the GSPT world, in this sense, our favorite parameter is epsilon, which is a parameter describing, let's say, Describing, let's say, less rum diffusion within the domain, and as we're going to see, this is precisely what induces this multi-scale structure in the system. But what we are actually focusing our attention on is not the full two-dimensional model, but a one-dimensional reduction based on averaging on cross-sections. So, essentially, you consider this is actually a typical. This is actually a typical kind of bottleneck scenario. We're going to see more of them later on in the talk. Let's say we exploit the fact that the domain is symmetric with respect to the horizontal axis and I won't give too much details about this, but actually in the context of narrow corridors, one can actually focus the attention on, let's say, only the dependence of row on one of the corridors. row on one of the coordinates, on the horizontal coordinate. And this actually allows you to obtain a one-dimensional reduction of the model that I've shown in the previous slides. Here I'm already saying, I've already written down the system corresponding to the stationary states for this problem. And here you see now this new function k appearing. Again, without entering too much into details, k is now the function that kind of entails Function that kind of entails the geometry of the domain. So let's say we are going to describe bottlenecks by making some assumptions on some conditions that K has to satisfy. And the boundary conditions now are pretty similar to the ones that you've seen before, just on a one-dimensional domain of length L in this case. Okay, so as we said, we are going to focus our attention on this type of Attention on this type of domains. So they're called bottleneck because you have this kind of neck in the middle where the domain is kind of restricting. And we describe this type of domains by essentially prescribing that our function k as a unique global non-degenerate minimum. Actually, this minimum doesn't have to be located in the center of the domain. We are actually going to show some, let's say, some Let's say some plots which consider a function k which in fact doesn't have this point in the center. And without loss of generality, we're going to consider domains which have length 1. And well, we introduce this extra function g in our analysis. And we, let's say, incorporate the spatial variable x also as a dependent variable in our system. I would say in other contexts, System. I would say in other contexts, maybe this would look a bit strange, but I know that this is the right place for me to do so. So basically, in the slow scale, you obtain an equivalent form for the problem that I've shown before, the system of first-order ODEs. C now, of course, basically has a very, let's say, simple dynamics. And when you rescale the system with respect to a fast variable, you obtain an inclusive. A fest variable, you obtain an equivalent formulation, and the boundary conditions are just the same, except for the fact that now I have used L equal to 1 here, but nothing has changed. Okay, so as always, the first thing that we look at is the singular limits. And sticking to the correct color formulation according to the discussion that we had yesterday, green will denote fast and blue will denote slow. Otherwise, I wouldn't have survived. Otherwise, Peter, I wouldn't have survived a PhD with Peter, I guess. Anyway, this is basically the layer problem. So, this tells you the dynamics of raw on the critical manifold, which when let's say plotted in the three-dimensional space looks like this. As we're going to see later on, basically, if we take, let's say, a projection of the critical manifold in the J-row space, you can You see that the fast flow looks like this and essentially divides the critical manifold into an attracting part, which is the upper part, and a repelling part, which is the part below. In the middle, there is this line of fold points, which will then also play a role later on. When looking at the reduced problem, this is extremely easy, extremely simple, but since this is supposed to describe the dynamics. This is supposed to describe the dynamics on the critical manifold. It is more convenient for us to rewrite this in terms of x and rho, simply using the relation between j and rho that we have here. And again, this is a sketch, so a reproduction of the slow flow for a specific choice of k, but let's say where we are only exploiting the fact that the assumption on k that we have shown in the previous slides or the existence of one global Existence of one global non-degenerate minimum. You can see here that somehow within the orbits that are described by the slow flow, there are two which are very important and actually one of them even more important than the other in some sense, but which are the canard orbits. And these canard orbits basically allow you to go through from the attracting part to the repelling part of the critical mass. Part to the repelling part of the critical manifold, if you consider the solid line here. And these will play a very important role in the construction of the similar solutions for our boundary value problem. It's worth mentioning that the shaded red region here, I hope you can see it, is a region that actually doesn't play any role in the construction of our singular solutions because technically what you want to do is Want to do is use the fast and the slow flow to match the boundary conditions on the left with the boundary conditions on the right. So the slow flow should somehow allow you to go all the way from 0 to 1, and if you start from any points over here, you will never make it to the other side. So the red region is somehow not involved in the construction of the simulus solutions. Yeah, and as we've already mentioned, the two canard orbits intersect in this point, which is In this point, which is of sorted settle type. So, how do we construct our singular solutions? This is a representation for one of the solutions that we will construct, but you'll see more of these features later on. The idea is, so this is what a typical singular solution would look like. And as you can see, it basically consists of a concatenation of fast and slow pieces. The idea is that. The idea is that essentially your boundary conditions, including the xi as an extra variable in the system, allows us to express the boundary conditions as manifolds in the jx row space. In particular, they will correspond to these lines, the orange line on the left, so c equals 0, and the purple line on the right, so c equals 1. So in your construction, you basically want to use the fast and slow flow to go from the left. To go from the left, from the orange line to the purple line. And of course, this, let's say, the options that you have will very much depend on the alpha and the beta that you're taking into account. And the idea, but again we'll see more details later on, is that you can basically track through fast and slow flow what happens to going here up to To point here up to a level where x is equal to x star, and you can do the same by tracking backwards what happens at the manifold of right boundary conditions and check whether these two manifolds, which are here depicted again in orange and purple, intersect in a unique way. And this is what will give you your similar solution. So, again, typical sort of figures that you will see are displayed. See, are displaying projections of basically what you see over here. So, we are always going to check what happens at the boundaries, so c equals 0 and x equals 1, and then you have to match them somehow in between the elements of the store score. So, to be a bit more precise, essentially this manifold of left boundary conditions, as I already started explaining before, is a line which intersects. A line which intersects the critical manifold in a point which we call small l. And this point small l actually is, let's say, on the other side. Well, its location changes depending on whether alpha is less or equal or greater than alpha. In particular, why do we make this distinction? Because as I said, in order to construct a singular solution, you have to start from somewhere here and reach the other side. Reach the other side. You can reach the other side only if at some point you reach the critical manifold, because that's where the slope flow occurs. So there are two possible scenarios in some sense. Either you are lucky enough already and you are already on the critical manifold, then you just have to follow the slow flow. This will mean that you have no boundary layers on the left because you are already there. Or you can exploit the fast flow. I'm not sure whether the arrows are so visible down, but the fast flow here. Go down, but the fast flow here can bring you up, and so you can basically start from any point over here, go up, reach the critical manifold, and then pick up the slow flow from there. And the only distinction in this case is that if your alpha is less than 1 alpha, this point is separated from this upper region, which we call L plus, whereas when alpha is greater than 1 alpha, it's already part of it. Because actually, in this case, you can reach the critical manifold both from these points over here going up, and Points over here going up and from these points over here going down. Similar things happen when you look at your right boundary conditions only. Now you have to consider the backward flow because this is now what you want to match going backward essentially. So here if you have your beta less than one half, basically the only points that you can reach when you start from the critical manifold to go up the manifold of right boundary can The manifold of right boundary condition for this one, and then there is the point small r. And this point small r is again included in this region which we call now r minus in the case of beta greater than one half. This is the only main distinction that we make. So the idea, as I was mentioning before, is that you basically take the union of these two manifolds, follow it forward up to C star, and then take this one, follow it. Take this one, flow it backward up top C and check whether this intersection is non-empty and, in particular, consistent one point. Okay, so there are actually more special solutions in some sense to take into account in our analysis. So, two of them you already met. They are the Canard orbits that I have shown before. But actually, there is also another, let's say, Femby orbits that we define. One of them is called S-alpha, and these are precisely the ones. Alpha, and these are precisely the ones, the lucky ones in some sense. The ones that already start from the critical manifold, so exhibit no boundary layer on the left, and go all the way to c equal 1. And the value that rho assumes there is equal to rho star alpha. We must point out, but this is in some sense coherent with what we said before, that since the only way to go all the way to c equal 1 is to be away from the shaded red region that I've shown before. Shaded red region that I've shown before, you must have that alpha is less than this value, the initial value Rossi naught, which is the Fokanard value. That symbols here. Analogously, you can define these S-beta solutions. These are actually the solutions that end on the right point. So end in the point small r, so exhibit no boundary layer on the right. And if you track them forward, backward, sorry, their value at z equals zero is defined as row star. equals zero is defined as rho star beta. And till the orbits are essentially just the reflection with respect to the horizontal axis. We point out that actually the values of these, let's say of the start and end point of these special orbits actually only depend on the value of the function k at 0, 1 and at the point C star, which is the point where the canard is located, whereas rho star alpha and rho star beta only depend on the values of k at 0 and 1 and Of k at 0 and 1, and of course, from up and beta. Okay, so how do we proceed now? We actually said in the beginning our goal was to try and split the parameter space into a finite number of regions where essentially whenever we pick alpha and beta in one of these regions, we can tell more or less what kind of stationary solution we should expect. And there are, of course, curves that separate these regions. But essentially, what we get is that for a bottleneck type. Is that for a bottleneck type geometry, we end up having eight regions where the structure of the stationary state is approximately the same and looks like the ones that you see over here. And these regions, or better, the curves that divide the regions, are actually defined by just having the sort of clash between some of the special orbits that I've shown before. The curves highlighted in yellow, which are actually the curves which should look a little bit Actually, the curves which should look a little bit like white over here are the so-called hard curves. I would be happy to talk about it later on. I don't know if I have enough time, but these are, in some sense, the curves, it's already clear from the diagram, where you have a pretty, let's say, abrupt change in the structure of the solution. So, for instance, in 1,7 over here, you see that the solution in G1 is basically below one-half and then as a layer on the right, whereas in G0. As a layer on the right, whereas in G7 you have that the solution lies above 1 as a layer on the left. Okay, so basically our main result is divided into two parts. So the singular case, epsilon 0, where we construct singular solutions for, let's say, the orbits that we've shown before. And then we will sort of consider also the Consider also the general case epsilon positive but small. And essentially, as we said, the idea behind the proof is precisely the fact that, let's say, we want the intersection of the orange and blue manifolds at C star to happen and to give us a unique point so that we can, let's say, track our unique singular solution. But there are only three possible ways for these manifolds to. Possible ways for these manifolds to intersect. In the first case, you have that basically you take the flow of the small point on the left and until x star, and you take the backward flow of the manifold of right boundary conditions up to x star, you have that this intersection is non-empty. This will give us two types of solutions and therefore two regions. In the second case, you have that actually the sort of the larger piece of the manifold, but The larger piece of the manifold, let me call it this way, I'm not sure it's appropriate, but let's say the big and the big manifold coming from the left side and the big manifold coming from the right side, they intersect in a non-empty manner. Actually, they intersect through this canard solution. And this will give us four type of similar solutions, therefore four regions. And in the last case, it's the other way around. So you have that the big manifold coming from the left intersects the flow that's coming from the point R. From the point R in C star. And this will again give us orbits of type C7 and type 8. Basically, the only way I'm going to show you the proof is by drawings. This is, I think, the clearest way. And you can see that essentially within each case, what is mostly happening is the change in the sort of orientation of the boundary layer. So here in Tech 1 and Tech 2, we said, okay, we are in the case where we're essentially. Okay, we are in the case where we're essentially starting from the point L, so we don't have any boundary layer on the left. And the only difference is that in one case we have a boundary layer on the right that goes up, and in the other case, we reach the critical manifold in a way that basically the flow, in order to reach the right manifold of boundary conditions, we have to go down. The let's say most interesting case is the one that involves the canard. In that case, we have four possible orbits because Have four possible orbits because again we have four possible orientations for the or four possible combinations for the orientation of the boundary layers. So in tech three you have the layer going up and then going up again. In the second case you have it going up and then going down, then going down and going up and then going down or going down. But in all cases you basically pick up the Canard solution to go from x equals 0 to x equal 1. Last type of The last type of solutions essentially are the ones that have no boundary layer on the right, and then you only have two possibilities on the left. Basically, in one case, you go up, and in the other case, you go down. Right, so from here, we can actually then infer something about the persistence of these solutions for epsilon positive but small. And actually, of course, again, in this case, the most interesting result is. Case: the most interesting result is the one for the orbits of type 3 to 6, because these are the ones that involve the canard point. And therefore, we also have, let's say, that the proximity of the perturbed solution to the similar solution is order one half, epsilon to one half, sorry. And in this case, give you a bit more details, but essentially what we do is we take we exploit the fact that Exploit the fact that in this case we don't need actually to evaluate our intersection at C star. We can, in these cases, since we have no interaction with the fold, we're basically always staying in the same part of the critical manifold. So in this case, always in the lower part, we can go all the way up to one. So we have that our manifold of left boundary cognitions intersects the perturbed. Intersects the perturbed version of the repelling part of our critical manifold in a point which we call L epsilon. And then we can basically follow or track this down until C equals 1. This will still give us an intersection with the proper manifold of right boundary condition, in the point which we call v1 epsilon. And then we basically obtain the full solution by just following the flow backward all the way up to x. The flow backward all the way up to z equals zero. Again, this is the most interesting case because, in this case, essentially, you have the way you construct your vector solution is essentially you consider a small segment on your manifold of left boundary conditions and you let it flow forward. You call this manifold smooth two-dimensional manifold m0 epsilon. Or epsilon, and you do the same thing, but on the other side. This would be the two manifolds that you see here. You know that these manifolds are exponentially close to their singular counterpart, and this will give you a transversal intersection in a maximal canard. So you know that basically, even in the perturbed version of your system, these two, let's say the full orbit will have or will contain a canonical Akhanard or Pink. And as I was mentioning before, the one-half exponent comes from the fact that this is something that probably many of you know, previous work on the Peter, this involves basically the blow-up analysis near the canard point. And the third case is essentially fairly straightforward. It coincides with case one upon reversal of the flow direction. Okay, I will. I also had, let's say, some numerical results, but I think I will skip them. I just show you somehow some numerical confirmation of the kind of profiles that we have constructed in the singular case. And we've also done this, let's say, for some quote-unquote more realistic bottleneck geometries, trying to see also how the neck influences the structural distribution. The structure of instructions. Yeah, and there is still, let's say, quite a few things to do, of course, quite a few directions to undertake. Some of them would include actually also an improved approximation from the two-dimensional to the one-dimensional model to kind of be able in the future maybe to link more and more with the experimental data. Thank you. Thank you for a very nice talk. We have time for one or two quick questions. I was wondering about your flux function. J you set to rho times one minus rho. I think you followed the work of earlier people. I was wondering if you considered other possible flux functions. What I'm thinking of is back in the 70s and 80s, Jerry Widow had a bunch of undergraduate students at Pasadena, California go sit on two bridges and measure these examples. On two bridges, and measure is exactly the kind of situation you have on the highway, right? There's a big traffic flow, and they're trying to measure how does the flux, this j function, depend on the density row. And one of the things they found was a rho times log rho dependence gave a better fit to data. So what I was thinking is that maybe you could find some undergraduates who could do a series of experiments in your one-entry, one-exon hallway, right? And with different necks and see what type of flux function you want to use. What function do you want to use? I would say that's a very good point. Let's say we did not focus so much on that aspect of the work. So let's say in this sense, actually how the project started was because I started working with Marité Rés on a postdoc and she had already had some discussions with Peter about this. So we thought, okay, we can work together on this. But let's say, at least to my knowledge, Maritene has already worked on. Mariteren has already worked on pedestrian models, and they, I think, most often use this kind of expression for the flux. I know, however, that she was also, let's say, with some other collaborators, exploring at least from a numerical perspective to start with, other possibilities. But yeah, that would be an interesting direction to go on. Very quick question. Very quick question. How do you do your numerics? Do you just integrate in MATLAB or something, or you do need to do something? MATLAB or something, or you do need to do something? I don't do the numerics. No, but I think Kaspar is using Phoenix, if I'm not mistaken. So... The general purpose boundary when you're so make the absolute, but it was very small. Yeah, it was 10 to the minus 3. Yeah, this seems to be fairly accurate. Let's thank Helena again.