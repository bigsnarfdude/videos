And today we'll be talking about the evolution of multi-strained bacterial populations, focusing mainly on this Streptococcus pneumoniae, which is also known as the pneumococcus. So this is a bacterium that was originally divided into different races in the late 18th century and then accurately divided into strains a few years later. Divided into strains a few years later, and this was all based on differentiation by the ability of these isolates to cause disease in a mouse model. So, similar variation is observed in human hosts of this bacterium. So, it's a common nasopharyngeal commensal of humans. It's found in between 20 to 80 percent of snotty children around the world. And different strains vary in their propensity to cause what's known as invasive pneumococcal disease, so typically sepsis or meningitis, by three to five orders of. By three to five orders of magnitude across the species. And this has caused real problems. Now we've been introducing partial coverage of vaccines. So this graph shows data from the UK over the past couple of decades on the incidence of invasive pneumococcal disease or IPD. And during this time, a 7-valent and 13-valent vaccine have been introduced. So the red line shows the incidence of disease caused by strains targeted by PCB7, and the green line shows the incidence of disease. And the green line shows the incense disease caused by strains targeted by BCV13. And you can see these are both immunologically successful vaccines. The problem is that BCV13 has had a net kind of negligible overall impact because the purple line showing overall incidence has not really decreased since BCV13 was introduced. And this represents the expansion of disease caused by strains not targeted by the vaccines. So it's important to understand strain dynamics. So, it's important to understand strain dynamics in this species. So, now we have an abundance of genomes, we can define a strain as a set of isolates that are significantly more similar than expected by chance, given the diversity of the species. And kind of they're most easily identified by using plots such as that on the left here, where each point is a pairwise comparison between two isolates. And the horizontal axis shows the divergence in terms of the core genome, and the vertical axis shows the divergence in terms of the accessory genome or gene content. Genome center or gene content. And with reference to the kind of tree on the right there, if you look at the black isolate as the index, comparisons with isolates in the same strain there in red, a very small coroned accessory genome divergence. And if you compare isolates to ones of a different strain, strain B, those points are in cyan, and those have significantly greater divergence in both gene content and Divergence in both gene content and gene sequence. And it's the discontinuity between that blue and red set of points that suggests you can sensibly divide up this population into discrete strains. And in a tree, that's represented by shallow clades being separated by deep branches. And this pneumococcal style distribution is seen in many different diverse bacterial pathogens. So, what are the characteristics of these populations? The accessory divergence of all these strains could be due to a lot of private. These strains could be due to a lot of private gene content, but that doesn't appear to be the case either in Strepnumo or in E. coli, where you only see 10 to 20 private genes out of thousands of accessory loci, even when you're looking at only a handful of strains overall. Instead, this divergence appears to represent a kind of characteristic combination of common loci, and each of those loci are themselves found in multiple different strains. We also see that strain frequencies differ a lot around the world. So these are data from. So, these are data from lots of different pneumococcal carriage populations, sampled from many different countries. And it's a corelogram where each data set is compared to all the others. And each pairwise comparison is represented by a different glyph or blob. And you can see that most of them are green or blue, which indicates a non-negligible positive correlation. There's no real similarity in strain prevalences. The exceptions, as you can see in the bottom right corner there, you see some orange. That is where you get multiple samples from the That is where you get multiple samples from the same country, in this case, because we've densely sampled South Africa, which has a high burden of disease. By contrast, if we instead of looking at strain frequencies, we look at gene frequencies, so these are based on the intermediate frequency of those sites, so those being present between 5 and 95% prevalence in the overall population. We see there's a strong positive correlation in every pairwise comparison. So, how can we explain the fact we have both diversity between strains within the same population and Strains within the same population and between all these different geographically separated populations. The best explanation I've been able to come up with is that these intermediate frequency genes are under negative frequency dependent selection. So a phenomenon where genes encode a phenotype that is most beneficial when it is rare in the population and the phenotype becomes less advantageous as it increases in frequency. This means that there can be an equilibrium frequency at which the cost of a gene balances its benefit, and that would explain why you get all And that would explain why you get all of these gene frequency correlations, essentially, the stabilization of these accessory locus frequencies across very diverse populations in geographically separate areas. You can then get all these different strains being preserved, different strain combinations occurring in different locations, because each one is simply a way of using strains as building blocks to maintain all individual local equilibrium frequencies. So, the way in which we've been modelling this is essentially to Is essentially to simulate a series of individuals in an agent-based model. So each genotype is defined by a binary presence and absence matrix. So how many, what the accessory genome complement of the genotype is, here represented by different colours and shapes. We can assemble these into a population. And because we know the genotype of each of these, we can calculate the instantaneous frequency of a locus L at time t by just looking at which strains are present in the population. Present in the population, and we can compare that to the equilibrium frequency of the locus L inferred from genomic data. Under NFDS, things that are rarer than the equilibrium frequency are advantageous to the host cell. We can then split these back out and look at our individual genotypes and see which genotypes tend to encode genes that are rare in the population, because those are the ones that are we're going to consider high fitness in our model at that time t. So, as they proliferate, they go to gene-backed equilibrium. So, in terms of the actual underlying. So, in terms of the actual underlying mathematics, if GIL is a matrix of individuals I and whether or not they encode locus L, and FLT is the instantaneous frequency, then for each individual at time t, we can calculate this value pi, which summarizes it's positive essentially when all the genes are rarer than their equilibrium frequencies. And then, if we have a strength of NFTS parameterized to sigma, essentially when genes are rare, pi is positive, and this means that one plus sigma. And this means that one plus sigma to the exponent pi is greater than one, and each individual cell leaves more than one descendant. And that means that you get an expansion of the clone. The genes then rise back towards equilibrium. And obviously, everything is the converse. The genes are above their equilibrium frequencies. So with some tinkering and fitting, we managed to get quite a good replication of the post-vaccine dynamics of the pneumococcal population in Massachusetts. So here we're comparing genomic data at the top, which is simulated data at the bottom. Genomic data at the top, which is simulated data at the bottom. Each number is a different strain, and for each strain, we have a mini-time series. We have one pre-vaccine time point and two post-vaccine time points. And basically, just by simulating selection at the gene level, we can recover a number of different strain dynamics, such as for non-vaccine types, we get the expansion of some that were very rare before the vaccine, whereas others that were very common before the vaccine kind of stabilize and don't expand to take advantage of the fact that a lot of the vaccine type strength. Is the fact that a lot of the vaccine type strains have been eliminated. So, what happens over the next 5,000 years? So, does this model actually correspond to a realistic evolving population? So, if we pretend the vaccine never happened, and we just keep simulating the population, but now rather than just focusing on the accessory loci, we also include an equivalent number of core genome loci, so just neutrally evolving SNPs. Then we can start to look at how these populations diversify. So, this Diversify. So this diagram is based on all these intermediate frequency accessory and core genome loci. The red dashed line is a divider. So in the bottom left-hand corner, we have within strain comparisons. That's about 6% of all the points. And they're summarised by the orange contours. And then we have the blue lines, blue contours summarising the between strain comparisons in the top right-hand corner. So here, those contours again represent the observed data, they don't change, but the black points. They don't change, but the black points show the output of 100 different simulations. So, either neutral or under NFDS. And under neutrality, what we see is that you get an enrichment of the within the strain comparisons and a fewer between strain points as we basically lose diversity from the population. It's easier to see if we look at a ranked strain frequency distribution. So, this is from the observed genomic data. So, you get a handful of very common strains and then a long tail of rare strains. The population overall. Of rare strains. The population overall is pretty diverse. So, those red crosses again show the genomic data in these plots, and the blue points show the outputs of simulations. Under neutrality, you get a few strains, you lose a lot of diversity. Under NFTS, all of those strains are maintained essentially at their stable at their initial frequencies, and we keep the diversity of the population. And obviously, if we look at the temporal dynamics of those simulations, you see a lot of drift as expected under neutrality, and NFDS maintains the strain. And NFDS maintains the strains at very stable prevalences. And because we've got a set of core genome markers that are neutral in this simulation, what we see is that each of the, so this is the core genome tree from the neutral SNP markers, each tip is coloured according to the strain to which it was assigned. And you get these shallow clades separated by deep branches, as you'd expect. So we want to see can we replicate these from the simulations. In the new relations, this one looks a bit weird. This is one example tree, and you only have three. This is one example tree, and you only have three strains surviving at the end of these simulations. Under NFE, although the selection only acts on the accessory loci, it does a good job of preserving the core genome diversity of the population. So that was kind of cheating because all the genotypes were maintained in their original state and there was no recombination. Pneumococcus is famously transformable, so this means it takes up exogenous DNA from the environment and incorporates it into its genome through homologous recombination. And this is how it's able to exchange diversity both in the core and Able to exchange diversity both in the core and accessory loci. So, if we include a kind of naive implementation of recombination under neutral simulations, we lose even more diversity because not only are things disappearing through drift, they're also converging through recombination. Whereas with NFDS, we are able to maintain those between-strain distances and keep things quite separate from one another. However, we lose some of the density of points at the within-strain distances. Strain distances. When we look at the rank strain frequency plots and that bottom right-hand corner plot, what this means is you're essentially flat line. There's no common strains anymore. Everything has become a rare strain as isolates to kind of relentlessly diversify. And consequently, when you look at the core genome, you get a star phylogeny. So everything kind of deeply branches. And this can be explained by the fact that in the model, under NFDS, the competition. Under NFDS, the competition occurs because isolates, when isolates, overlap in their accessory genome profiles, if they don't share any genes, then they evolve entirely independently. So the more strains are able to continually diversify, the lower they compete with other isolates in the population. So this seems to represent an equilibrium if recombination is kind of free and symmetrical. So what prevents real populations reaching this kind of limit of diversification? Well, when an accommodation acts in the Well, when a recommendation acts in the accessory genome, it's not actually symmetrical. It depends on the genotype of the donor and recipient. Deletion of a genomic island, which is essentially just a contiguous accessory locus, is quite efficient. It only requires a short bit of DNA from a donor that lacks the locus. Whereas insertion of a genomic island, which occurs when a locus is present in the donor and absent from the recipient, that requires physically just a very long molecule of DNA, and it's a much less efficient process. Much less efficient process. So, this was something we tested in the laboratory by constructing pairs of isolates that differed in a single genomic island. We constructed those to be between one and 20 kilobases in length, and we measured the efficiency of their movement through transformation relative to a single SNP marker. And what we found with insertions was that the efficiency of their transfer declined exponentially with their length. And that wasn't the case for deletions. So, at the extreme at 20 kilobases, a deletion occurred. A deletion occurred at about 5% of the efficiency of a transfer of a SNP, whereas an insertion occurs with less than 100,000-volt efficiency of a SNP. Really hard to move an insertion by transformation. And those were in idealized, otherwise isogenic donor recipient pairs. In a real population, strains will also differ by restriction modification systems, which are designed to cleave imported double-stranded DNA from other. Stranded DNA from other strains. So these again will target insertions, but not the transfer of core or coloci or deletions because they only involve single-stranded DNA. So it's a strong asymmetry towards strains disfavoring the acquisition of insertions. So how does that help with our population structure? When we do the same simulations, but we include the bias towards deletion over insertion with neutral simulations. With neutral simulations, the asymmetry simply eliminates the accessory genome. It keeps deleting loci over and over again. Whereas under NFDS, when it's combined with this asymmetrical transformation, you maintain those between strain distances at the observed position in the genomic data, but the within strain distances are strongly enriched compared to when recombination is symmetrical. You're better able to preserve the rank strain frequency distribution in that bottom right-hand corner. It's not perfect by any means. Hand corner. It's not perfect by any means, but you do have some common strains and a long tail of rare strains, as you see in real populations. And the core genome tree looks much more similar. So again, even though all of the selection occurs and the asymmetry of transformation occurs on the accessory genome only, core genome, ocean, neutral, and symmetrically exchanged, you are able to replicate the shallow clades separated by branches. And this result is robust. So actually, when you look across all the trees, so rather than trying. When you look across all the trees, so rather than just showing you one example, if we classify the trees by the branch lengths on the horizontal axis and the branching pattern on the vertical axis, you can see that the observed genomic data sits in the middle and the closest set of simulation points are those combining NFTS and asymmetrical recombination. And these results are not really affected whether if you just randomize the inputs, genome, the input data rather than using the observed genomes. Than using the observed genomes, we just randomly generate binary matrices. You still recapitulate in that bottom right-hand corner the kind of distinction between the within and between strain densities of points in the output pairwise distribution. And when we look at the core genome trees from these randomized inputs, again, converge on the same core genome structure, the same core tree structure. So, in summary, basically, NFDS doesn't sustain a FDS doesn't sustain a multi-strain population structure because it drives relentless diversification of genotypes. Asymmetric transformation alone also cannot sustain multiple strains. It just keeps deleting the accessory loci. But when you combine them, asymmetrical transformation is continually trying to delete genes. NFDS preserves gene frequencies by essentially just removing these low fitness recombinants. And this results in outbreeding depression that inhibits the exchange of That inhibits the exchange of sequence between different strains and that preserves these distinct clusters within the population. And that's what gives us, that's what can explain the multiple strain populations that we observe. So the kind of point of doing this is as we get better and better models of bacterial ecology and evolution, we can hopefully use this to optimize our better vaccine designs in the future. So with that, thanks to everyone who made this possible. Thank you for the invite, Leonid, and thank you very much for listening. You very much for listening. Fantastic. Thanks very much, Nick. It was a great talk. And do we have any questions for Nick? All right, so there's a question from David Rasmussen who asks, why do you think NFDS would be so rampant across the entire genome in pneumococcus? So there's when you look at the accessory, these loci that are present between 5 to 95 percent, so in these So, in these models, it's 1090 genes, which is not a huge number of genes compared to the overall pangenome. The overall pangenome in pneumococcus is borderline closed or open, but many, it runs to the tens of thousands of genes if you keep sequencing it. So, actually, as a proportion of all the genes in the overall population, it's a relatively small number. If you look at the functions, it's entirely, you know, it's feasible. There's a restriction modification system. There's restriction modification systems. It's enriched for bacteriocins, it's enriched for adaptive antigens, and then metabolic loci as well. Yeah, I mean, it's absolutely, absolutely needs more evidence, but it seems feasible to me. We'll see how plausible other people find it. Okay. Any other questions? We have time for one more before we move on to the next. Uh, before we move on to the next uh talk, if uh not, then I'll ask one. So there was a symmetry between the insertion and the deletion. And would it not just be a result potentially of the fact that when you're trying to insert something, it requires a lot of accommodation from the recipient genome. Whereas if you're just trying to delete something, then Lead something, then it's essentially just a one-strain type of process. Or does it always involve two different organs such that one of them is always going to capture a deleted fragment of the other one? I mean, the experiments we did involved, DNA, we knew was non-essential because we put it there ourselves. Was non-essential because we put it there ourselves. And it didn't encode anything that was, it encoded genes that were not expressed very highly, essentially. So we would hope it wouldn't mess too much with the overall patterns of expression in the cell. But yeah, it's entirely feasible that different sequences are not biochemically distinct and they're going to be distinct. Chemically distinct, and they're going to be distinct as they're expressed. So, you know, things didn't fit exactly in the line as we would hope. But for an experiment with this particularly unhelpful bug, it wasn't too bad. Okay, well, thanks again, Nick.