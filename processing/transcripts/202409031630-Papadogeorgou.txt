one in person. So we'll have a session on cloud inference. And this is one of the sessions actually organized by the Junior ISPA section of ISPA. And we also have other speakers invited by Junior ISPA. As you probably know, JISPA is the session, sort of a section dedicated to advocate for juniors based in statisticians. And we're very happy. And so we're very happy, very proud to have actually many of the speakers in here at the workshop. So I also want to acknowledge Alejandro Pavalos-Pachako, who is not here today. She's one of the four organizers. She was the chair of the team. So she actually played a very important role in this. All right, so let's get started on the first speaker of this. Of this session, Georgia Papado-Biroku. I'm so sorry that I butchered your name. So she's from the University of Florida. She works broadly in causal inference and Bayesian modeling, but particularly with dependent spatial word networks. All right, Georgia, you can start by loading your space. We're ready for your time. Yes. Just one second. I have updated my IRS. Updated my iOS so now everything looks different. So I'm still learning. But I hope. Okay, so I hope you can see my screen, right? Yes, yes, we can see it. Excellent. Well, hello, everyone. I'm really sorry that I couldn't be there. I really appreciate the opportunity that I can give this presentation online. I know it's a great group that is. I know it's a great group that is there, so I would have loved to be there in person as well. This is some work that I have now presented a handful of times at different venues. It is on causal inference with spatial data. So thank you, Fan, for organizing this session. I know the other two speakers have exciting talks coming up as well. So this is work with a PhD student that used to be at the University of Florida. I used to be at the University of Florida, Srijata Samantha, who has moved on to, I think, Bristol-Meyer Squid since then. So this is a talk on spatial causal inference, and the topics I will be talking about are the topics of unmeasured confounding and interference. So a little bit first about just causal inference. What we care about doing in causal inference is that we have a potential intervention that we want to apply to the population. intervention that we want to apply to the population that we have and we want to understand what would the effect of such intervention be on an outcome of interest so the data i most often deal with are spatial so they there is a spatial structure that complicates things so what are the types of dependencies that show up in spatial structure in spatial data one type of dependency is a causal dependency which referred to as internal Which I refer to as interference. And it has to do with a situation when the outcome in one location can be driven by the treatment not only or the exposure or the intervention not only in that location, but also in other locations. So what happens here might affect not only the outcome here, but also it might affect my spillover to other areas and it might affect the outcome in other areas. So this is one type of dependence that can occur in spatial settings and it's a cause. In spatial settings, and it's a causal dependence, meaning that the effect of the treatment affects the outcome somewhere else. Now, another type of causal dependence can be because of confounding. So, confounding arises when there is, well, most of the times we talk about a situation where you have a predictor of the exposure or the treatment that is also a predictor of the outcome. And that confounding variable is creating baseline differences in what the treated and the control group. In what the treaty and the control groups look like that we have to adjust for. But in spatial settings, a lot of times these confounding variables are spatial in nature. So if we care about the effect of air pollution on health, temperature might be a confounder, but we expect that temperature will be similar across space. So it doesn't vary arbitrarily across from one location to the next location. Now, the other type of spatial dependence that can occur in comparison. That can occur and complicate our situation is the inherent spatial dependence in the treatment and the outcome themselves. So, again, if I want to learn the effect of air pollution on cardiovascular mortality, both air pollution and cardiovascular mortality will have some inherent spatial structure that I cannot explain by my measured covariates. Air pollution here and air pollution 10 feet or 100 feet away from me. 10 feet or 100 feet away from me is very similar. And even if I control for a lot of different variables, the residuals of that regression will still be spatial. So there is some inherent spatial variability in the exposure, and there is potentially some inherent spatial variability in the outcome as well. So these are three types of dependencies that often show up in spatial settings. And I believe honestly that in spatial settings, Spatial settings, most often all three of these dependencies will show up. So, what is the literature in spatial causal inference? The literature is growing. I would say that there is work that has been done on interference. Of course, there is a lot of work that has been done in causal links with interference, not just the papers listed here. These are the papers that I am most familiar with that work on. Am most familiar with that work on interference within spatial settings. Then there is a literature that deals with confounding by spatial variables. These are the papers that I'm most familiar with. Maybe there are a couple that are missing about what spatial confounding means and how to address it. And there's only a couple papers that try to do both confounding by spatial variables and interference simultaneously. Simultaneously. I don't have time to summarize what each one of those do, each one of those does, but I would say that if you read these papers on spatial causal inference, you have acquired a pretty good idea of where the literature currently is. So what is it that we are trying to do in this work? So this talk will have two parts. The corresponding paper has two parts. So, the first part introduces causal diagrams for spatial data that represent in those causal diagrams all these three dependencies that we talked about, interference, confounding by spatial variables, and this inherent dependence structure in the exposure variable. So in my treatment. And exposure and treatment are used interchangeably here. So I'm going to use these causal diagrams, and we use these causal diagrams in the paper to show. Diagrams in the paper to show this is the main result that from part one, one of the two main results from part one is that spatial confounding and interference can manifest as each other. So even if interference does not exist, if spatial confounding exists, I might mistaken spatial confounding for interference and I might conclude that I have interference because it was the spatial dependence in the confounding variables that misled me. That misled me. And the other way around, if I have interference and I don't account for it, I might mistakenly think that I have spatial component when I don't actually have it. So this is one of the main conclusions that will come up, and I will walk you through a causal diagram that shows this. A second conclusion that comes up from this part one is that the analysis that we are used to performing for independent observations for IA. For independent observations, for IID observations, will be often they will be invalid for spatial data. So the fact that my observations are inherently dependent, so the fact that they have a spatial structure, complicate how we can learn causal effects. And some analyses that are valid when the units are independent are actually not valid when I'm working with spatial data. So, after we go through this part one, if I have time, I will also talk about part two, about an approach that tries to incorporate the conclusions from part one and come up with a way to estimate causal effects in the presence of all three of these dependencies, while accounting for the potential that some of these confounding of spatial variables are, in fact, Variables are, in fact, are measured, unmeasured. So we don't have them in our data. So I'll get started with part one now. So it's easiest to talk about this issue when I work with paired, when I talk about pair data with the binary treatment. So I can think I have n observations. They're organized in pairs where there's dependence within a pair, but not across pairs. So you can think about locations on a map that have pairs of locations that are really close. pairs of locations that are really close to each other and therefore they're dependent but each pair is far away from each other so we can think of the pairs as independent across pairs. And for the units in the pair, I have a treatment for unit one and for unit two and I also have potential outcomes for those units representing what would happen at unit one and what would happen at unit two if they received treatment Z1 and Z2 accordingly. And there's also some covariate U that might confound the relationship. Variate use that might confound the relationship of the treatment with the outcome. So, what types of effects could we care about? This doesn't really matter how we define the local and the interference effect at this point. But the important thing to understand is that there are effects that describe how much the treatment here is affecting the outcome here. By saying what will happen to unit one if its own treatment, if the treatment of unit one changes. If the treatment of unit one changes from one to zero while I'm holding the treatment of unit two fixed, there's also an interference effect that talks about how much unit two's treatment will affect unit one, where now unit one's treatment is fixed to little z, and it's unit two's treatment that is changing from one to zero. And we're talking about what is the difference in the outcome that I will observe for unit one. Now, to identify these types of effects, the type of assumption The type of assumption that we would need is that the treatment is independent of all potential outcomes given whatever covariates we have. So here we only talk about covariate u, so the vector of u1, u2 for those two units. So if this assumption holds, then I can control for the vector u and learn all these causal effects, all these contrasts that I might care about. So, how would this actually be? So, how would this actually be? Um, but this is this unconfoundedness is an unconfoundedness that is at the pair level, right? I'm compacting z to be z1 and z2. The potential outcomes are potential outcomes for y1 and y2. The covariate is covariate for unit one and unit two. So, it doesn't really tell us how I can analyze this data as individuals. It only tells us how to analyze them as pairs. So, we want to Pairs. So, we want to understand how these spatial dependencies create complications. We need to unfold this relationship from the bold Z to Z1 and Z2, from the bold Y to the Y1, Y2, and the bold U2, U1, U2, which is what we're going to do with the graphs that follow. So, if I were to denote all possible dependencies that could happen with the covariate U. With the covariant U, the treatment Z, and the outcome Y. This is maybe like a complicated graph, but this is perhaps how it will look like. We have some covariant U. That covariate affects the treatment. It affects the outcome locally. So U1 affects Y1 locally, but it can also affect the outcome in the other location. Treatment can affect the outcome locally, but it can also affect the. Sorry, can you see my cursor? Okay, great. Thanks for nodding. The treatment can affect the outcome locally, but it can also affect the outcome of the nearby units. So this blue arrow represents interference, so treatment in one location affects the outcome in another location. We have this spatial confounding because we have a variable u that is correlated across space that predicts the treatment and predicts the outcome. That predicts the treatment and predicts the outcome. And again, these vertical bars here represent spatial dependence. So U1 is similar to U2 because they're nearby in space. So in this type of complicated graph, we can denote the conditional independencies that we saw back here with the corresponding graphs. So we can try to learn under what graph we can, If we have a graph, what are the assumptions? What is the corresponding conditional independence assumption that will allow us to identify the causal effect that we care about? So this is a very complicated graph. It has all possible dependencies depicted. So in order to understand what are the complications that spatial dependencies lead to, let's simplify it. Let's take a special case. So this is one special case that we consider in the paper. And this is done. Consider in the paper, and this is diagram A from the paper. So, a lot of the errors that were there before are now missing. So, we have simplified this greatly. Now, we have a covariate U that is spatial, an exposure Z that is spatial, and we have U affecting Z and Y only locally. So, let's see how we can learn local and interference effects if these are the relationships in my. The relationships in my data. So, first, let's talk about what these lines actually represent. So, the way I interpret these lines is that there is something going on under the hood that is driving some process, common process that is driving the value at both locations. So, if let's talk about Z, the exposure here is air pollution. Is air pollution, then there are complex atmospheric and chemical processes that are taking emissions somewhere, making chemical reactions and create air pollution across the United States, for instance. So all of these processes are there, they are occurring, they are making pollution here and 10 feet from me be very similar to each other, but I couldn't model all of those. Couldn't model all of those very well. So, this is some underlying process that is making my exposure correlated, and there's another underlying process that is making my use correlated, but I cannot measure and control for it. It's just creating this inherent spatial dependence in the covariant and the exposure. So, if I have this inherent spatial dependence, and this is the graph that I'm dealing with, With in this graph, if I want the local effect of unit one, so if I want to understand the effect of z1 on y1, all I will need to do is take my pair of my pairs of data, take all unit ones, and run a regression of y1 on z1 while controlling for u1. Okay, so it suffices to control for u1 in order to learn the effect of z1 on y1 for this graph. But what if I wanted to learn interference? What if I wanted to learn interference effects on unit one? So this would be the effect of z2 on y1. So here, if I know that this is the true graph, then I know that this arrow is missing. So I know that the true interference effect should be zero because z2 does not affect y1. There's no arrow there. But I don't know really that my data came from this graph. I'm trying to learn whether there is an arrow from zero. Whether there is an error from Z2 to Y1. So, on this graph, I can start looking at backdoor paths to understand what types of variables I need to control for in order to learn the effect of Z2 and Y1. So, I need to go backwards from Z2 and then towards Y1. So, there are four factor paths here. The first two are these two that essentially pass through the relationship of U2 and U1. Of U2 and U1. The next two paths are these two that pass through the relationship of Z2 with Z1. So in these two cases, these first two paths depend on U being spatial, because if U was not spatial, this line wouldn't exist, and these two paths would not be there. They wouldn't be paths, they would be blocked, they would be separated. Separated. Similarly, for these two paths, they only exist because the exposure variable is spatial. So now, if I wanted to learn the interference effect on unit one, there are a few conclusions to make. If u and z were both, were not spatial, then none of those four paths would exist. So I wouldn't need to adjust for anything if I wanted to learn interference. If I wanted to learn interference effects in unit one, so I would just see, I could simply take the outcome y1 when z2 is treated minus the outcome y1 when z2 is control and compare this across pairs. And this would be a valid interference effect of unit one. It would estimate a valid causal contrast. But if u or z are spatial, this first analysis, so an analysis that is valid. So, an analysis that is valid when u and z are not spatial is not valid when u or z are spatial because of these vector paths. So, what happens if u is spatial? Then if u is spatial and I adjust for u, if I adjust for u, I have blocked paths one and two because I have adjusted for them. Paths three and four are still open. Three and four are still open. If I don't adjust for you, all four paths are open. So adjusting for you and not adjusting for you will give me two different results. So I will think that you was a confounder, but you is not a confounder for the Z2Y1 relationship, at least not in the typical sense. Not only that, both of the answers when I adjust for you and when I When I adjust for you, and when I don't adjust for you, will be wrong because there will always be paths three and four that are open that go through Z1. So when U is spatial, adjusting for U1 is necessary, but also I need when Z is at the same time spatial, not only I have to adjust for U, but in order to block those. In order to block those paths three and four, I need to also adjust for this local value of the exposure. So, what we have learned from this graph is that spatial confounding can be attributed to interference. So, I might think that I have interference where, in fact, I have spatial confounding. And this was one of the graphs that we investigated in the papers. But in other graphs, we can see the reverse too, that we might think we have. Too that we might think we have interference, but we might that we might think we have spatial confounding, but in fact we have interference. And something that we saw in this graph and also in other graphs is that the fact that the exposure variable is spatial makes analysis that would be valid when the exposure is not spatial are now invalid. So these inherent spatial dependencies in the exposure complicate how we actually analyze the spatial data. How we actually analyze this spatial data. So, what are the conclusions from these graphs? Is that we need to investigate spatial confounding and interference simultaneously. We cannot deal with them separately. And we need to simultaneously try to learn local and interference effects. And not only we have to control for local values of the confounders, of the covariance, we also need to account for neighborhood values of the covariance. Account for neighborhood values of the covariance. Okay, so Feynman how much time do I have left? Like seven minutes, eight minutes. All right, awesome. Thank you. So essentially, what we have learned from this is that if I wanted to learn causal effects in spatial settings with dependent variables. Dependent variables. Then I need the local value of the treatment, the neighborhood value of the treatment to learn interference effects. I need to control for the local value and the neighborhood value of the covariates. But what if I don't have all of the covariates? So what if there is a confounder that is spatial, but it's not measured? So how do we deal with this situation? So now we move away from having pairs of objects. We move away from having pairs of observations. So let's think that all of we have our n units and they're connected to each other according to some network. Now this treatment that I care about might be binary or continuous and the dependency within pairs is represented by an adjacency matrix A. So this adjacency matrix is telling me who is allowed to affect me, who am I connected to, who is near me, essentially. We have some measured covariates for every unit. Measure covariates for every unit, and for every unit, we have a set of potential outcomes for the vector of possible treatments on the whole network. So let's see, we're simplifying things a little bit to try to figure out how to deal with unmeasured confounding. And the first assumption we make is something that is called exposure mapping and interference literature. It essentially says that it's not the whole treatment vector that will matter for my outcome. What matters for my outcome? What matters for my outcome is my treatment and a function of my neighbors' treatments. So it is often we use the average, the proportion of my neighbors that are treated as a function of my neighbors' treatments that affect my outcome. So how we can denote this is that what my potential outcomes depend on is my treatment and the average neighborhood value of my Neighborhood value of my treatment, Z bar I. So this is assumption one. Now, the treatment that we care about is the one that goes into the potential outcomes. The one that goes in our potential outcomes is my treatment and my neighborhood treatment. So if I need to identify causal effects, I need to figure out what are the confounders of this bivari treatment. Variate treatment. So I need to understand: are my measure covariates sufficient for confounding adjustment? Well, I've been saying that the measure covariates are not. So treatments, the treatment is not independent of potential outcomes given measure covariates. Instead, and this is our second assumption, there is some spatial covariate u that if I control for the measured variables u. Variables u and its neighborhood value, then the treatment becomes independent of potential outcomes. So this means that ignorability holds conditional on measured and on measured covariates in this unmeasured spatial covariate. So this is a relaxation of the non-measured confounding assumption because I'm allowing for something unmeasured to play a role in this assumption. So, the last assumption that we're making here is that we assume that potential outcomes follow a linear structural equation model that allows us to write potential outcomes as a function of the treatment that I care about, z and z bar, and covariates measured and unmeasured, plus an error term. Now, this assumption is not, can be, can be. Can be simplified, we can include interactions, we can include higher order terms, we can use splines, we can do a lot of fancier things in this mean structure of this outcome model. The reason why we're using a linear structural model is because it makes the parameters that multiply z and z bar easily interpretable as the local and the interference effect. So, if we have these three assumptions, so if essentially we have So, if essentially we have the assumption that it's Z and Z bar that matter for potential outcomes, we have that with the unmeasured U ignorability holds, and we have that this is the structure of the potential outcomes. That still does not suffice for us to learn causal effects with unmeasured confounding. With unmeasured confounding. In fact, we need to, we show in the manuscript that we need to specify a joint distribution for the unmeasured variable and the treatment vector themselves if we want to learn causal effects. And we actually show that specifying this joint distribution is necessary from a Bayesian perspective. So there have been approaches that try to learn causal effects with a measure of confounding simply by using an outcome. simply by using an outcome model. And we show in this paper that those approaches cannot be valid because the treatment assignment is not, the treatment assignment is not ignorable in this setting and it is necessary to be incorporated in a valid Bayesian procedure. So after we specify a joint distribution for U and Z that again can be simplified, we are able to show that all of the parameters of that linear structural model The parameters of that linear structural model are identifiable. That means that the causal effects that we care about are identifiable. And it also means that even though I don't have access to the spatial variable u, I can still learn its structure. I can learn the parameters that are governing its distribution because that unmeasured variable u is creating dependencies in the treatment and the outcome. In the treatment and the outcome variable. So I can look at the common spatial dependence in the exposure and the outcome and learn the spatial dependence of here. So this essentially is telling us that even in the absence of even in the presence of unmeasured confounders, we can still learn causal effects as long as those confounders are spatially structured. So they need to have a structure that we can take advantage of. So I'm going to. So, I'm going to stop here. I hope I haven't taken more time than was allotted to me. What I was trying to convey with this talk is that causal inference with spatial data is inherently different from causal inference with independent data. And this we already know for network data and for interference. But here with spatial data, we also have to account for these inherent dependencies that show up in. That shows up in our variables. The fact that my treatment is spatial, the fact that my outcome is spatial. So, spatial confounding and interference can manifest as each other. So, we have to, researchers that deal with spatial data have to be thinking about both spatial confounding and interference simultaneously and not investigate the presence of one without investigating the presence of the other. So, our approach is trying to do both. approach is trying to do both and we have an illustrative example in in the manuscript on air on emissions from from power plants and the subsequent health effects of of those emissions that show effect estimates that are more in line with existing knowledge when we allow for this unmeasured spatial confounding. So the paper is an archive and thank you very much for your attention. Thank you so much, Georgia, for the great presentation. I want to see if there's a question from the audience. Hi, Georgia. Can you hear me? Yes. Hi. This is Armin. Thanks for the great talk. I had a question about the DAG. If we could go to the slide. The simple one or the The simple one or the I think the one where with yeah, that one. Okay. So is path three already blocked because Z1 is a collider? Right? Because there's like some latent U sub Z that is causing both Z1 and Z2. Right. So these pop, and in the, sorry, is this your question? Yeah, that. This is your question, yeah. That path three is already blocked, right? Is that true? Okay, and that is exactly. I didn't have time to get into this. We get into this in the paper a little bit. This path, to block this path, we have to condition on Z1. But when you block this path, you only open up. Yeah, yeah, yeah. And to block this one, you need to adjust for this neighborhood value. Just for this neighborhood value liquivariate. I see. Yeah, that makes a lot of sense. Thanks for bringing that up. All right, so we can definitely take more Q ⁇ A offline after that. So now let's move on. Oh, yeah, and let's thank Georgia again for the brand presentation. So our second speaker. 