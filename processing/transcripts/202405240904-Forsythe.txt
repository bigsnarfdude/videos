My name is Amy, and I'm a PhD student with Sally Otto at the University of British Columbia. And today I'll be sharing some research which explores some methods for capturing vital rate heterogeneity in Leslie matrices. So individual vital rates, such as birth rates and mortality rates, determine how individuals survive, develop, and reproduce throughout their lives. So in other words, these vital rates determine an individual's life history. And as Joanna pointed out the other day, it's plants. But yes. And so it's not hard to see that these spiderites can vary substantially, not only between species and populations, but even among individuals within a single population. So for a long time now, ecologists and evolutionary biologists have been really interested to try to capture this variability among individual vitoids because it can have major consequences for our predictions at both the individual and population levels. So, one tool that we can use to try to capture this variability among vital rates is. This variability among bilarates is the population projection matrix model. And so, one particularly popular type of population projection matrix is this traditional age-structured or Leslie matrix model. And so, Leslie matrices assume that individual survival probabilities, so these S's here, and birth rates, so these B's, depend only on an individual's age class. And so, while an individual's vital rates could vary as of ages, any individuals that are in the same age class would be expected to share the exact same expected survival probability. Same expected survival probability and birth rate. So lastly matrices are a discrete population model and they generate this state vector here which just splits the total population size at time t into the number of individuals in each age class from 1 up to a maximum of omega here. And so then the corresponding Leslie matrix would look like this, with those expected birth rates for each age class along the top row and the survival probabilities along the subdiagonal. And so Leslie matrices have a few properties that make them particular. MHCs have a few properties that make them particularly useful in ecology and evolution. And perhaps the most valuable of those is the dominant eigenvalue, or here under one, and that's because it serves as a measure of the asymptotic population growth rate. And so in the long run, we expect the population to grow at the rate 0 by 1 to 1 each time step. And that means we can use that value to predict the population size at any time. Here I'm using tau in the future. So then the value of the asymptotic population growth rate tells us about whether we expect the population to grow, shrink, or remain stable over time. Shrink or remain stable over time. A couple of other key properties of Leslie matrices are the right and left eigenvectors associated with that dominant eigenvalue, whose entries are proportional to the stable age distribution and reproductive values of each age class, respectively. And so as you can see, Leslie MHs can be really useful for predicting population dynamics. However, like I hinted at before, they rely on a major simplifying assumption, and that's that an individual's vital rates depend only on his age. Depend only on its age. But for natural populations, we know this is very rarely, if ever, true. So there's plenty of evidence that individual vital rates can vary from countless other sources, an individual's size, its genotype, its birth order, or its sex, as just a few obvious examples. And so we refer to this among individual variation in vital rights as individual heterogeneity. And this individual heterogeneity can lead to major life history differences among individuals. So for example, the site from Badger here in For example, the study from Badger here in 2020 found heterogeneity in the reproductive rates of female gray seals around Canada. And this heterogeneity produced three groups of individuals, so frail, average, and robust, where you can see these robust individuals here in blue were expected to produce almost twice as many offspring over their lifetime as those frail individuals in yellow. And so we would expect that those robust individuals would contribute a lot more to the population and its dynamics over their lifetime than those frail individuals. Individuals. And so this variability among vital rates at the individual level can also scale up to influence population and evolutionary dynamics. And so I don't have too much time to get into it here, but as an example, some of our previous work has shown that the structure of individual heterogeneity can influence both population growth rates and the evolution of senescence. And so for this work, we modeled heterogeneity that either resulted in trade-offs among vital rates, so where individuals that had high survival probabilities tended to pay a cost. Survival probabilities tend to pay a cost in terms of their birth rate and vice versa, or that resulted in positive covariances among vital rates. So, our individuals tended to either be really lucky and to have high survival probabilities and high birth rates, or really unlucky, with low values of both vital rates. And what we found is that those positive covariances tended to speed up population growth rates and rates of senescence, while trade-offs, so negative covariances, had the opposite effect. So, hopefully, I've convinced you that it's important to account. So hopefully I've convinced you that it's important to account for this variability within age classes in our models. However, how do we actually go about capturing that extra source of individual heterogeneity? One intuitive way would be to simply extend that traditional Leslie matrix model that I was showing you earlier to account for heterogeneity from some extra source that isn't age. So this could be, for example, due to maternal effects, developmental heterogeneity, environmental heterogeneity, really anything that isn't the individual's age. And so now for each age cost in the model, I'm going to For each age class in the model, I'm going to assume there are row potential vital rate phenotypes for an individual. So, what this means is that now individuals that are in the same age class don't necessarily share the same vital rates. So, for example, here, if each color represents a different vital rate phenotype, then individuals could be in the same age class, but have vital rates that correspond to the blue, green, or yellow phenotypes. And then I also introduced a couple of new variables to allow individuals to potentially transition among these phenotypes. Transition among these phenotypes. These F's here, these represent the probability that a surviving individual transitions into a particular phenotype as it ages. And so, for example, this FX to 1A here, that would represent the probability that an individual in some phenotype X transitions into phenotype 1 as it ages from age A to A plus 1. So, in general, these transition probabilities can depend both on the phenotype and age that an individual has come from and on where it's going to. And then these J's here, these just represent the probability that offspring are born into any of the given phenotypes. And so this allows for parents to potentially give birth to offspring with phenotypes that are different from their own. So on its own, this model is sufficient to characterize individual heterogeneity within age classes. However, one problem with this approach is that the matrices become very large very quickly. And as the matrix gets larger and larger, analyses of population dynamics become Analyses of population dynamics become more and more complex and computationally expensive. And it also becomes empirically challenging to gather a large enough sample size of each age and phenotype category to be able to actually parameterize and use these matrices. So one technique that we can use to try to minimize these problems comes from matrix collapsing, which allows us to collapse all of the vital rate phenotypes in an age class down to a single effective vital rate so that we're left with what looks like a regular glycine matrix. So, we're definitely not the first ones to think of this idea of matrix collapsing. So, one technique that's already out there in the literature is this ergotic flow preserving or EFP merging method, which in our case would allow us to take a weighted average of all the vital rate phenotypes in each age class. The weights are given by the right eigenvector associated with that dominant eigenvalue, and this just ensures that at least in the long run, the proportion of individuals in each age class is the same in both the original and collapsed matrices. And collapsed matrices. A couple of pros of this approach are that it's known to preserve the asymptotic population growth rate and the stable age distribution of that original matrix of the heterogeneity. And it also matches what we would expect to find empirically, that is, if we were unaware of this vital rate heterogeneity and just went out into the population and sampled the average vital rates for each age class. A major con, however, is that this method doesn't necessarily preserve the reproductive values, generation times, sensitivities, or elasticity. Sensitivities or elasticities of that original model. And these properties are really key for a lot of ecological and evolutionary analyses, like, for example, the Senescales ones that I was showing you earlier. There's a second method out there in the literature, and it comes from this paper by Viamanu et al. in 2017. I don't have too much time to get into their approach, but it does have a major advantage over EFP merging in that it's known to preserve the reproductive values, generation times, and diasticities of that original model. However, it comes at the cost. However, it comes at the cost of using this more complex method that doesn't necessarily match our empirical approaches. And it can also be difficult to interpret the final matrix because, in the process of collapsing, this method changes the units, and this can allow, for example, for survival probabilities that appear to be greater than one. And importantly, neither of these methods preserve the transient dynamics of that original matrix, and so they can only be used for populations that we can assume have already settled down to their stable distribution. So, the main question that we're looking to answer with this research is: can a Leslie matrix accounting for individual heterogeneity be collapsed without losing this key information about population dynamics? The short answer is yes, it can, at least in some cases. And so we've developed a new method for matrix collapsing that we've termed phenotypic collapsing. The key assumption behind phenotypic collapsing is that there's no inheritance of parent phenotypes to the offspring for parents of any age. Offspring for parents of any age. What I mean by that is that those J's that I introduced earlier are the same for parents of any age and phenotype. And so, offspring are essentially born into this central pool, and then they have their phenotypes assigned at random with probabilities determined by these J's here. And so this ensures that after the initial cohort in the population dies off, so after at most omega time steps in this example, we get a stable distribution of phenotypes in each age class. But then, throughout life, individuals can keep their current phenotype or they can switch around if we don't make any restrictive assumptions there. The weights for averaging the phenotypes with phenotypic collapsing are then simply given by the probability that an individual is in a particular phenotype X at age A, given that they survived in that age A. So that means that we can calculate the weights for phenotypic collapsing just by tracking individual paths throughout the lifespan. So for example, if I want to know the weight for this yellow phenotype at age Of the weight for this yellow phenotype at age 3, I could calculate that simply by tracking the probability that an individual survives to age 3, and then given that it did survive, what the probability is that it's in the yellow phenotype rather than the green or blue. And again, this only requires that we're at the stable phenotype distribution, not the stable age distribution. It turns out that the answer that we get for the weight is the same as what we would have obtained if we had used the right eigenvectors, so that stable phenotype and age distribution. However, unlike the previous method, However, unlike the previous methods of collapsing, phenotypic collapsing doesn't require a full eigenanalysis of the original model, which can get quite computationally expensive if you're working with very large matrices. And importantly, what we found is that phenotypic collapsing preserves the general solution of the original matrix with that heterogeneity after at most omega time steps, so a single full lifetime of an individual. And so this part is still a bit of a work in progress. So, this part is still a bit of a work in progress, but it turns out the reason for that is that as long as that key assumption of no inheritance is satisfied, the Jordan form of the original matrix will always take on this particular form here, which you can see I've separated into two key sections. Just as a quick refresher, the Jordan form of a matrix contains the eigenvalues of that matrix along its diagonal, and then the only other non-zero entries are these ones, which tell us about how many ordinary and generalized eigenvectors each eigenvalue. Eigenvectors each eigenvalue has. Focusing first on this lower portion of the Jordan form here, this corresponds exactly to the Jordan form of the collapse matrix, and so it contains all of the information about all of the eigenvalues and their associated eigenvectors from that collapse matrix. Now, this upper portion up here consists of a repeated eigenvalue of zero. The number of drawn blocks for that eigenvalue is equal to the number of phenotypes minus one, so that's row minus one in this. Minus one, so that's row minus one in this example here. And each of those Jordan blocks is made up of a chain of generalized eigenvectors whose length is at most equal to the maximum number of age classes in the model. So that's omega in this example here. So in practice, what this means is that this upper portion of the Jordan form will go to zero in a maximum of omega time steps, so that we're left with the Jordan form of the original full matrix exactly matching the Jordan form of the collapsed matrix. The Jordan form of the Klaus matrix. So, in other words, the contribution of all of these zero eigenvalues and their associate eigenvectors up here to the general solution will go to zero in a maximum of omega time steps. So the general solution of that original matrix is perfectly captured by the general solution of the collapsed matrix. So this means, for example, that both the transient and asymptotic dynamics predicted by the collapsed matrix exactly match those that we would have predicted from the full. Match those that we would have predicted from the full matrix after at most omega time steps. It also means that other than these repeated zero eigenvalues up here, phenotypic collapsing preserves all of the eigenvalues and their associated eigenvectors from that original model, so not just the dominant ones that previous methods have focused on. And so this is important because it means that after at most omega time steps, so that single full lifetime, the collapsed matrix captures the exact same information about population dynamics. Information about population dynamics as the original full model. However, because it's much smaller, the collapsed matrix can be much easier to analyze mathematically and to parameterize from our data. Then I'll just quickly highlight one additional use of phenotypic collapsing is that taking these weighted averages of the vital rate phenotypes has allowed us to gain this insight about the influence of the covariance among survival and birth rates throughout the lifespan on population and evolutionary dynamics. And so, for example, And so, for example, in here, this is a pretty simple example. It's pretty easy to see that a positive covariance among survival probabilities and birth rates would increase this average birth rate at age 2 compared to if we just had that expected value here. And so that would tend to increase population growth rates while a negative covariance, so that trade-off would have the opposite effect. And so to summarize, when it exists, which it often does, accounting for variability in vital rates within Accounting for variability in vital rates within age classes is important because it can have major consequences for predictions at both the individual and population levels. However, our models can become very complicated very quickly. So one potential solution is to use phenotypic collapsing to collapse all of the vital rate phenotypes within each age class down to a single effective vital rate phenotype so that we're left with what looks like a regular collapsing matrix. And so phenotypic collapsing can make the model much easier to analyze mathematically. Much easier to analyze mathematically and to parameterize from our data. A few other major advantages of phenotypic collapsing are that it matches what we would expect to find empirically. Again, that is if we went out into the population and just collected the average vital rates for each age class. And after at most omega time steps, so that single whole lifetime, phenotypic collapsing preserves the general solution of that original matrix of the heterogeneity, and so also preserves the transient and asymptotic dynamics of that original model. Original model. So I'll just end on this thank you slide here. I'd like to give a particular shout out to the people involved in the work. So my supervisors, Troy Day and Sally Otto, who have been incredibly supportive and helpful throughout all of this. So thanks so much for listening. I'd have to take questions. Yeah. Sorry, I just thought about that first. Have you come across the word lump? Have you come across the word lumpability in any of your reading? Because I guess there's the area of Markov chain theory where this kind of collapsing large numbers of states down to small numbers of states to preserve the behavior has come up in migration models and theoretical population genetics. I think Asgard Holboth and Lars Anderson is some of that group. I like that word. I like that word. Like, there might be something there that could kind of give you some theorems that can help in this mod work. Thanks, I'll look into that. Yeah. Yeah, Initially, you thought about that too. But then also when you show the Jordan form, what does the other form? It looks very similar to when you're computing the absorption probability in in absorbing microchains. So that's the fundamental matrix, the one that you the the Jordan form that was disappeared. Okay. Okay. I don't know if there's any relationship there. Yeah, I'll look into that too. Like I said, that part's a bit of a work in progress, also. All this feedback is really helpful for you showed how it quickly gets to the stable solution over the time. So you showed the operation. So is that related to the damping ratio or other properties of the market? I mean, so the damping ratio, that's just the dominant eigenvalue. Ratio, that's just the dominant eigenvalue of the second one. Yeah, there's different ways of. Yeah, so it would preserve that after, again, that initial, Sally, correct me if I'm wrong, but I think it would preserve that after the initial omega time step, like that first burning kind of period. Because again, it preserves all of the eigenvalues other than that repeated zero one, so it would preserve like lambda one and lambda two. So I think the damping ratio should be it's more. Yeah, sure. It's more the dampening ratio gives you time how fast, if you perturb it, how fast it merges or comes back to the stable space distribution. And so is that time exactly the same time as you need for the burning? Yes, yeah, so it depends. If you perturb it and you perturb it off of this you typically stable distribution and it'll take a time steps again to get it back. But if it's just off the stable age distribution, I guess that's what I was thinking. Age distribution, I guess, is what I was thinking. Yeah, but it would be the same.