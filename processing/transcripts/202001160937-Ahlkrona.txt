If you ever want to visit, this is what it looks like. The math department at Stockholm University is pretty nice, except the highway. So I will talk about finite element methods for the full stocks equations. How many are working on full stocks equations? Okay, so and how many are doing that with finite elements? Looks like the same one would be done there. Looked like the same one before that, but it's good. Uh so I got kind of interested in that when I did this uh study uh with Thomas on how to couple the shallow ice approximation and the full stocks equation in one model. And then I got more interested in how to actually get the full stocks equations to run in a good way. And mostly I got interested in robustness. So I would like it to be that you can run a simulation, it works and then you change. It works and then you change a parameter a little bit and it still works. And I think that's pretty hard to make that work. So in this talk, I will try to answer these questions. What can we learn from the math, finite element community? Did they do something on this already? The answer is yes. And how does the non-linear rheology and the thin ice domain impact the solutions? So uh the solutions. So I didn't mention that the you get kind of problems because uh the ice is so thin. So there's a lot of different problems you can get from that. And last I will, if I have time, talk about like how can we avoid like remeshing and low quality meshes. Okay, so the first question, what can we learn from the math and the final element community? So it turns out that they did work They did work in the Piantalone community on the Pulstocks equations, yes that they called them the P-stocks equations. Did anyone hear about the P-stocks equations? For me, it took like years before I realized it's the same equations. So, P here is P as in the P Laplacian. And they made analysis for the Fullstock's equations that how they should converge, if you do. How they should converge if you define elements on that. So there's a number of papers, usually it's by the Sperseli and Dianing, and this name that I cannot pronounce yet. I think it's a Czech name, I'm not sure. And I think this paper is really nice to read, to start with. They're super technical, but they're all using the same tool. So if you read one, you can read all of them. So, this is how the P-Stokes equations look. So, as you can see, they look like the full-Stokes equations. You have the stress tensor, the pressure gradient, the gravity, and the mass conservation. And then it's just that they write the viscosity in a different way. So they don't write it with the N, the Glen Flow parameter, they write it with this P. Now I write this P Now I write this P with another font than this one because I don't want to mix it up with the pressure. Yeah, so you have some constant times this. So here is a small parameter, is this regularization parameter, the critical shear rate. And here you have the Fourier's norm of the strain rate tensor. So the strain rate sensor is the symmetric velocity gradient. And then here you have that to the power of p minus 2. Here you have that to the power of p minus 2 divided by 2. If you would have glands flow low, you would have some ends here. So, if you have p equals to 2, that would be a Newtonian fluid. And then, if you have p less than 2, you have a shear thinning fluid like ice. And then you get these problems that you can get some singularities if you would set this into epsilon to zero. So, this is the relation to how you formulate the Fulstock's equation. Into how you formulate the Fullstocks equation. So the P is 1 plus 1 over N. Oh? No? Maybe somebody can switch out cameras. It's fine. I'm not that sure. I think it's also. Yeah, it's that. So if N is 3, then P is 4 over 3, so like 1.3 percent. And if you would like And if you would like to write the Glenn's flow law on the T-Stokes form, it would be something like this. You would get a rate factor to the power of 1 minus P. And this is, of course, not just valid for ice. There's like other fluids that behave in the same way if you choose P differently. I think all of these fluids, as I understand it, can be modelled by the P-stocks equations in some cases. In some cases. Okay, so yes, that's what we can learn from the math community. We can read these papers and see what they do. Thank you. Yeah. And then we can kind of learn something about how the non-linear rheology impacts the solutions. And later I will also talk about how this thin is domain impacts the solution. In Baikston solution. So if you look at how you put the weak form of the P-stose equations, you integrate great by some test function. You multiply by the test function and you integrate. So that's how you would put it for Stokes equations also. Then I think it's pretty interesting that you're not supposed to look in the same spaces as you would do for the Stokes equations. So the velocity is not in H one. Is not in H1, so it's in W1P. So the velocity and velocity gradient should be in Lp, not in L2. So Lp is then L1.333, which sounds super weird. So that means, yeah, it means basically that you can have more spikes basically in your solution. Spikes basically in your solution, it can be less regular than if you would have L2 bits, a little bit more restrictive. And then also the pressure space is not L2, so the pressure should not be in L2, it should be in Lp prime. And P prime is P over P minus 1. So it's 4. So the pressure should be in L4 and the velocity should be in W1, 1.3. Uh and I I didn't know that. Uh I've been I've been thinking that there should be in H one and L two, just because that's how research works. Uh so that also means that you measure when you measure convergence, you shouldn't measure it in H1 and L2 norms. I think every paper I saw where someone measures convergence, including my own, is measured in H1 and L2 norms. And I guess there's And I guess there's no reason for doing that. There's no theory for that. So the convergence, the error of the velocity and pressure should be measured then in these corresponding ones. So that's one point. And then the convergence is not expected to be what you would think from the Stokes either. So the velocity in this one P norm converges like h. Like h. Here I write hx just for something about the flat meshes, but it converges like h. That's how you expect it. Sorry, this is for mini elements and for equal order stabilized elements. That's the two kind of elements that has been analyzed. So then you expect the velocity for like h. But then in the pressure you lose some convergence because of the non-linearity, yeah, the non-linearity of the stress tensor. unlinearity of the stress tensor, so it converges like h over h to the power of 2 over p prime. So p prime was for work for us if we say that n is free. So it means that you lose half an order of convergence in the pressure. So you have to resolve the meshes quite a lot to get the pressure to become good. In the worst case, you can always happen to have a smoother solution. Happen to have a smoother solution where it goes better. And these convergence rates are confirmed by experiments. If you choose an analytical function that you want to test against that fulfills the requirement that they have to fulfill for fitting with the P-stocks equations, then you get that convergence. Okay, so I don't know if this is. Okay, so I don't know if this is Winglish with take-home points, but the take-home point from this part, I think, is that it's good to know that the analysis of the Fullstock's equations exists, so we don't reinvent the wheel. And I think we should start measuring convergence in the right norms, I guess. And that could maybe be a topic for discussion. Okay, next thing: how does the non-normal How does the non-linear rheology that I talk about and thin ice domain impact the fium pollution? So, as Elena said, you have kind of flat elements. Now, this is a bad picture because I enlarge it in this direction, but you have much thinner the elements are much smaller in the vertical direction than what they are wide, and that causes some problems. Problems. So I wanted to figure out how that impacts the solution for the P-stox equations. So I redid this analysis for equal order stabilized elements with a stabilization called local projection stabilization. And I redid that for anisotropic elements. It's a very boring picture, alright. And then I got this result. So here Result. So here, Cv and Cp are just constants. That doesn't depend on the mesh. P is, as before, 1.3 percent, p prime 4, and then this a here is the element aspect ratio. So it's the width of the element divided by the height of the element. So that will be a big number if you have very flat elements. And then if you go through the analysis. Then if you go through the analysis of a standard local reaction, I won't say what this local reaction stabilization is, but it's one stabilization, just like Galerkini square stabilization or interior penalty, this is another stabilization. If you just go for the standard formulation that as they designed it for normal isotropic measures, then you get this aspect ratio here to the power of p prime divided by the p. To the power of p prime divided by 2? Did I mix this up? Oh wait. Yeah, no, sorry, I didn't, sorry. So you get it to the P times uh over two, so four over two. So I get the aspect ratio to power of two. So let's say I have a element that is hundred times wide than it is. Times wide, then it is thick, then I get 100 to the power of 2. So that's pretty bad. And then for the pressure, I get the aspect ratio to the power of 2, too. Okay, so then when I did this analysis, then you can kind of see where these A's are coming from, and then you can try to rescale the stabilization parameter to try to get rid of those A's. So I didn't manage to get rid of them completely. To get rid of them completely. If I modify them, so I modify the formulation of this non-directional stabilization. We've tried to get rid of as many as possible. And then I can get a to the power of p over 2 instead of p prime. So then it's like 1.3 over 2. So that's better. And then for the pressure, I get a to the power of p, so a to the power of 1.3 instead of a to the power of 2. So that's better. The power of two. So that's better. And I can also see that in experiments, that it does matter. So then I did an experiment checking the robustness of these methods. So in these stabilization methods, there's often a little constant in front that you can kind of set a little bit like you want, and you don't really know what to set it as, which is super annoying. Way. So basically, you want the method to be quite insensitive to this little constant that the user can just tweak. So that's what I was testing: how sensitive is the result to this little constant that you can just tweak. So this constant is the stabilization parameter alpha, I call it. So here on the x-axis, I have the stabilization parameter alpha. The stabilization parameter alpha that you can tweak. And here I have the error. And then the red is the vertical velocity, the green is the horizontal velocity, and the blue is the pressure. Solid lines is not gradients, and dashed lines are the gradients of those variables. So for the standard method, you see that if you have Method: You see that if you have too small stabilization parameter, then the pressure error gets high. That is what you expect, because if you don't stabilize equid order elements enough, then you will get pressure oscillation, you get we'll get this check-reward pattern. So then you expect the pressure to go up, but then if you choose it too high, then you basically modify the equations too much, so it won't be the same equations anymore, and then you don't get the Same equations anymore, and then you don't get the right velocity solution. So, if you have it too high, the velocity error goes up. And then you see, there's not really a great value to choose here. The vertical velocity error goes up for very small values of the stabilization parameters. So, there's no value that you can choose where you both avoid the vertical velocity error and the pressure error. And the pressure error. I guess you would choose something here, but it's quite narrow here. And if I use my modified approach, then you see that the pressure, mainly the vertical velocity error, goes up much later. So you can push up the stabilization parameter much more before the vertical velocity error starts to go up. So it means you have some more room to be lucky to choose the right stabilization parameter. How much time they have now? Still time because uh the twenty minutes did not the twenty minutes uh ring did not uh okay still okay so the take-home points for this part is then that uh the non-linear rheology and the flat elements is a bad combination and I say that because uh yeah you could get that Uh yeah, you could get the aspect ratio to the power of this P parameter. So if you have a non-Newtonian sorry? Can I ask the question? Yeah. Would it change this if you instead of solving for very elongated elements, you would put the aspect ratio directly into the equation and solve for more regular mesh with an isotropic? have the equation as anisotropic. Yeah then you yeah you put this aspect ratio inside the equation. I think it's possible that it should have the same result. My guess is that you move the problem and you will get that aspect ratio popping up somewhere anyway. That's deceiving if you've only done it for rectangles because in fact things are complicated as the dice sheets get thinner. Yeah but you can always say that okay I'm You can always say that okay, I will work with a mesh that is 100 times higher than in the reality and then put this scaling factor into it. I think we just moved the problem, but I have no proof. Think of the anisotropic Poisson equation, you know, Kx and Ky, the anisotropic tensor. You can absorb that into geometry, or you can leave it as a coefficient. You lose either way. Yeah, my my my my experience is that it's exactly you you you you That it's exactly you you get exactly the same, right? You're devoted to condition. It does not matter. Okay, so yeah, right. So yeah, it's the non-linearity in combination with anisotropic measures that makes it especially bad, because if you don't have a non-linear material, then this p prime would be 2. So then you at least just have the aspect ratio to the power of 1, but now you have it to the power of 2. So they kind of amplify. Two. So they kind of amplify each other. Yeah, and then if you it's good to know that if you do the analysis, then you can kind of figure out how you can improve things. Okay, so then I have time for my last point. Can we avoid like remeshing? Oh, that was very misspelled. Sorry. Can we avoid remeshing? Remeshing in some way and avoid low quality meshing. Some way and avoid low-quality meshes. So, this I got interested in because I have a colleague who works on methods where you don't fit the domain to the mesh. So, finite elements is often like one motivation that you write in the introduction of the paper for using finite elements is that it's good for complex geometries. But there is maybe a limit to how good it is for complex geometries. How good it is for complex geometries. You do have problems that you have to remesh if you have a moving boundary. And I think we are often having problems with low-quality elements where our kind of domains is not so easy to get nice elements, and that can affect your solution. And that's just not in our application. Of course, that's the problem with finite elements in many applications. So there has been quite some work on alternatives. Quite some work on alternative fat elements methods, such as Xfium, I think it's mainly in Germany, and CATFIM is mainly in Sweden. So they are unfitted methods, and that means that you don't fit your domain to the mesh. So basically, you have a structured background mesh, and then you just put your your domain on top of that and you let the boundary cut the mesh. So these are some references for this catfield method. Are some references for this Cat VM method? Okay, so super fast. I use the Cat VM method. I don't have time to explain how it works, but they do some fancy things with how you basically you don't integrate over all of these elements, you just integrate over the parts that are inside the domain, and you can do that by changing the Gauss integration. So we tried that for ice, so this is the Araule glacier. And then we developed Cafium, so it works for pea stocks. And it seems to work. I didn't have time to do convergence experiments yet, but the solution looks okay, I think. It works also if you have this partial slip condition, because there's been work on Cat Fium for how you can switch boundary conditions. We can make the domain move by using a level set in combination with CADFIM. We have a little bit of problems with the reinitialization. If someone knows about level set, then you have to do this re-initialization to fix this level set function. It's a bit complicated and these very sharp corners. So we tried a different. So we tried different ways of doing these re-initializations and the best way we found so far is it comes from this paper by a panel named Bilman which came up in the past re-initialization procedure. We also tried it for mismip and then we figured out that we have to change the formulation so that it works for anisotropic meshes because for miss MIP the background mesh will be very anisotropic and then you're Isotropic, and then you basically have to change some stuff in the formulation of cathedral. And when we did that, we can at least get a solution. Yeah, thanks. So we oh, sorry. Uh next stop, thanks for uh for uh for actually reminding us that uh that uh the the the natural space for for this this problem unlike balance is. For this problem, I'm like balance, this is not a hidden. I just want to say that not to be too harsh with our community, even in mathematical paper, a lot of times we use wrong norms. Like for example, like the tritical problem, everybody knows that you should use the graph norm, but you see tons of paper that we use L2 and H1 norms. So just to say, I mean I used the L2 and H1 norm myself. Sure, those those are the correct question, but I think it's But I think it's not too bad. I think it's good enough that if you have some compression, especially in our field, sometimes it's a bit hard to see. It's nice that it converges at all. And then another thing, so I think this is true also for others, like post-tool approximation, the fact that you have those particular norms because of the ideology for this shadow shape. And I think that there have been work by Christian Schuff and Guillaume. I think you also. John, I think you as well, uh myself on uh on the on probing the the existence for for store service to order and share. So I don't know if you're familiar with that, but it's on it's for some people, but I know it exists sometimes. You can get units on this okay, so Okay, so I think it's quite interesting. So what wanting is for these equal stabilized equal order discretizations, right? So it's great that you can reduce this influence of the aspect ratio. But my experience is that even the constant in front of that thing becomes quite huge, especially when you have non-linearities, right? You get effective viscosities that vary by quite a bit. And then actually, the constant, the rate is correct. The constant, the rate is correct, right? But the content in front of it becomes very big compared to different discretizations. Did you ever see wrong direction? A lot of stuff you show us? Oh, sorry, I was going in the wrong direction. No, I'm completely lost. So, here's the C V and C. Yeah, yeah, no, I didn't look at this because when I did these experiments, I did it on like a completely artificial solution. So, yeah, I didn't look at it. Because they effectively introduce artificial compressibility, right? So, it's not really divergent-free anymore then. And that becomes quite large because of the non-linearity, and then these concepts can become quite large. then these constants become quite can become quite large I think as well. Yeah it would be interesting to look at some ice related problems. So I just did it for very artificial experiments. I can't remember. I think I have it now. Yeah, so these are some convergence experiments that I did. But yeah, I guess it's not comparable to ICE because it's completely artificial. But this manufactured solution often is very smooth, right, so you don't see how bad it can get. Well, this is like you choose a solution that is like manufactured, yeah, exactly. Yeah, but it's like right on the limit of how bad regularity you can have. So you know what regularity you need to have for the process, and then you choose something that is like almost on that limit. My question, I think, is a very basic question, much more basic version of that, which is if you looked at MFU If you looked at stable elements, is there a linear Stokes literature that tells you what to expect, the aspect ratio? I mean, does anybody look at the aspect ratio question for linear Stokes? And do we know what to expect there for stable and stable? I think so, yeah. There exists stable pairs that have constants that are independent of the aspect ratio. That are independent of the aspect that you show. QK comma QK minus 2 has an intensity constant that's independent of tailorhood on certain meshes or something like that. I don't think it is. I heard there is only some specific things. I'm not sure Tao and somebody driven. But our code is this clothing code that George was involved in is Q Q K minus 2, Q K, Q K minus 2 stabilized. Sorry, not stabilized. Discontinuous. That's the other thing that... So the pressure... The pressure is discontinuous. Conserve mass locally. And that's another thing. I don't know, Georgia, if you're going to say something about that, but that's also a thing that people find. That if you don't conserve mass at the element level, you can get significant developments for the television. Significant problems for the talentary options. For that method, the constant's independent of aspect ratio? The constant? That specific method? Yeah, extremely dependent on it. But use optimal order convergence because your pressure space is two orders lower than the... So you give up a little bit, but then you get a lot of the money. Yeah, you get some optimal in pressure. I mean this is this is interesting. But have you considered using stable um pairs? Stable pairs? No, because I thought it was fun to do the analysis of this, because I read the paper of the local projection stabilization of p-stocks and I understood that one, so that's why I began doing that fun, to be honest. But yeah, it would be interesting to look at stable at the same time. Just in the last application, so it looks like for the cafet uh intermat method, that you lose the interesting feature that you cannot Interesting feature that you can have an unstructured mesh, no? Yes, but you don't need it. No. For example, for the pruning line, you will need much finer elements. I mean, you can... Oh, no, no, no, no. You can have elongated elements, but can you have a completely unstructured mesh? You can, yeah, yeah, you can have any mesh in the background. Yeah, yeah, yeah. I just, yeah, it was easier. I just yeah, it was easier. Is this low resonancy in P for the mean of the implications if you calculate the position of the ground line? Sorry. When you calculate the position of the ground line, there is no contact because there need to be no P. And the slow conversions in P wondering how much implications for the I wonder that too. I think it would be really interesting. So this suggested on yeah some artificial search I mean it would be really interesting to make a converted experiment on. To make the converted experiment on some relevant ICE solution and see, like, maybe the regularity of the solution is a bit higher than the worst case, and then maybe it works better. Because the pressure does seem in many applications, that it does seem that it converges faster. It's something like Jerome that we both know well, when all and all about that it's still converging. About that, it's these total conversions, particularly this effect, that will be better.