Fantastic. All right. So, hi, everyone. You've all heard from me at least once, but I am Leonid Lovich, one of the organizers alongside Jesse and Alex Bouchar of this workshop. And I think Ashley's talk set the context really nicely for what I'm going to talk about today. To talk about today. Unfortunately, my talk is not really a lot about mathematics or statistics, but it's a little bit upstream of that, if you like. So you'll see what I mean in a second. And the talk called Compiling All Publicly Available Genotype-Phenotype Data on AMR. So I'll just mention a couple of connections with. Of connections with Ashley's talk. So, as you will recall, she discussed how the detection of certain specific genes in certain bacterial species would allow us to predict that those particular species are drug resistant or antimicrobial resistant, which is what IMR stands for. However, the question I might pose to you is: well, how do we know? Might pose to you is, well, how do we know in the first place what these genes are? Or in the case of other sequence variation, like single nucleotide polymorphisms or insertions, deletions, indels, how do we know that those are things that are relevant to the appearance of AMR in a particular organism? Well, the answer is there's a couple of ways of doing it. The class The classic way is to perform a lot of lab experiments where you start with a background strain and then you maybe knock out the gene of interest and you look at what happens or you do some manipulation to the strain and you see how the functional response in the presence of an antibiotic changes. That's slow, time-consuming, complicated. Consuming, complicated, and extremely useful. And that is considered the gold standard even today. However, nowadays, we've got a lot of data that essentially allows us to do analysis on a larger scale, where we might not have full knowledge of what these mechanisms of resistance might look like, or what these genotypic determinants of resistance might look like. We have a lot of data on. Might look like, we have a lot of data on them. And so we can try to do this in a data-driven way. And of course, there is, as was already discussed in earlier talks, an issue of power. Do we have enough sample to do this kind of thing? And where do we get enough data to be able to confidently know that we'll have enough to go on? And if you think about how And if you think about how people typically go about doing these, which I'll talk about in a second, well, a lot of the time they just try to look at what's available in the public domain or set up their own study. Well, one of the things that I decided to do is to try to put together all the publicly available data in one nice organized location format. Location format and make it easily accessible for everyone because the frustrations that come with having to collect this type of data are significant. So I'll start by motivating this a little bit more. Then I'll describe what the current situation is, tell you what work we have done so far on this, and then describe some possible applications. So again, Ashley's Ashley's talk showed how AMR is a significant problem because every time we invent a new antibiotic, very quickly we end up with resistance to this antibiotic. Now, overall, in terms of public health, this is predicted to cause something like 10 million deaths a year by 2050, if we do nothing differently. Okay, so the standard status quo projections. And that's Projections. And that's more than we have from cancer today. Also, looking back in time, so this is a projection forward in time. Looking back in time, for 2019, it was estimated that over 1.27 million deaths were directly associated with AMR, which is to say that we're already one-eighth of the way there, if you like. And what this is telling us is that we actually need to start making changes to the status quo pretty quickly. Changes to the status quo pretty quickly. Now, a couple of years ago, the World Health Organization put together a list of 20, nearly 20, I think it was 19 actually, priority bacterial pathogens. And those are the ones that it basically said we urgently need new antibiotics for. Okay, now antibiotics are very slow, costly, and challenging to develop for all kinds of reasons. All kinds of reasons. So, in addition to that, what else can we do? Well, we now have a very nice technology, which is the topic of this workshop, right? The genomic technology. So we can genotype a lot of existing bacteria. And that's something that is being used more and more in the field for the following reasons. First, we can do diagnostics with it. So we can ask which bug infects our patient. Which bug infects our patient and which drugs can we use on it, right? And we can also, going back to the previous talk, think about what pathogens are infecting our food, perhaps, right? We can also do surveillance and ask questions like which resistance mechanisms keep recurring. We can also track transmission. How do we see the spread of drug resistance in a population? And lastly, we can inform our treatment design. So what do we want our vaccines? What do we want our vaccines or antimicrobials to target? And some of these issues are discussed in a recent review that a large team I was part of put together called Applying Data Technologies to Combat AMR, Current Status Challenges and Opportunities on the Way Forward. It is available as a preprint, so I invite you to read it if you're interested. But now I'm going to focus a little bit more on the diagnostic side and in particular talk about And in particular, talk about: well, what are the data aspects of this, right? So, what data should we learn from? And as many of you will be aware of, machine learning tools have become very popular. And in particular for predicting AMR, developing machine learning tools has become a bit of a cottage industry in the last decade. I'll discuss a project called Benchmark DR towards the end. DR towards the end to show something else that we're trying to do in this field as well. But the majority of the methods that have been put forward suffer from some kind of bias. Okay, so there's biases in training data. And to some extent, biases are inevitable, right? We're not collecting this data systematically. We're collecting this data in a In a, you know, we're doing convenience sampling, essentially, right? And it's actually even a little bit worse than that in the AMR case because it's a somewhat biased convenience sampling as well. But nevertheless, they have been shown to perform fairly well and even generalize in some cases. So the typical process for this would look something like this. You start by selecting a few pathogens, usually one, two. Collecting a few pathogens, usually one to five. You curate some publicly available data, and it's very important to pay particular attention to phenotype, as I'll show in a couple of slides. You then train a machine learning model, maybe using deep learning, maybe not using deep learning, but you train it, you evaluate the results, publish a paper, and then perhaps if the results look good, you declare a victory. But well, this declaration of victory might be a little bit premature. So, how do we do these diagnostics in silico? What is the process by which we develop them? Well, essentially what we rely on is a large collection of previously tested samples, right? So, I will talk about how we actually test in a minute, but when we But when we have this collection of previously tested samples, that then serves as the substrate for the training process. And when we get a new sample that we want to test, well, we just plug it into the database and we or we plug it into the method that is trained in the database and we see what comes out, right? And typically we're interested in two things. One is the identification, which is to say, The identification, which is to say what is the bug, and the other one is AST, which is to say what is the set of drugs that are okay to use on this bug. And AST stands for antimicrobial sensitivity testing. Okay, so essentially what we want to be able to say is which of the drugs are okay to use and which of the drugs are not. And how do we measure results? And how do we measure resistance? Well, there's two ways, both of which are useful, but only one of them is generally sort of comparable across the board. So one of them is called categorical or binary, and that is just to say, well, if we're below a certain threshold, we're going to be calling this bug sensitive. Calling this bug sensitive, otherwise, we're going to be calling it resistant. But we can also use quantitative data for this. And the quantitative data looks like this in this example on the right-hand side, top right-hand side, where you start with maybe no drug at all. And that's a control solution. And then you have different concentrations. Okay, so you might have a quarter of a microgram per. quarter of microgram per milliliter, half microgram, it's always powers of two, or it sort of goes in doubling. So you always double except for the zero one, which is a control. You start with a minimum amount and then you just keep doubling until you get no more growth. And when you get no more growth, that is the concentration that's called the MIC or minimum inhibitory concentration. And that tells Concentration. And that tells you how much antibiotic do you need to stop the bacterial population from growing. There's also a minimum bactericidal concentration, which is how much antibiotic you need to actually eradicate the full population. They're not always the same. They can be the same or they can be different. There is a simplified mechanism for doing this nowadays, which is called an e-test. And that's basically where you've got this plate that already Plate that already has different concentrations of the antibiotic on it. And you just incubate your organism of interest somewhere in the center and then see how far it will manage to grow and when does it stop growing and the point at which it stops growing, that's your MIC. Okay, so now, of course, as you can see, Now, of course, as you can appreciate, the binary values are going to necessarily change over time because something that was considered to be a sensitive bacterium 10 years ago might be considered resistant today, and vice versa. Usually, there is a progression in the In the forward direction, in the sense that you see that sort of larger and larger concentrations of the antibiotic are needed in order to kill the wild type population. So, because these cutoffs are based on the wild type population, there tends to be an escalation over time. So, what about the data then? Let's go back to the data. What kind of data do we have to study this? Because ultimately, what we would want to do in order to understand what's driving the resistance is we would like to do the analysis on as large a data set as possible. So there are a dozen databases that contain some data on AMR genotypes and phenotypes. The phenotypes are the things that I just showed in the previous slide. And each one, of course, is going to have its own formats, is going to have some idiots. Own formats is going to have some idiosyncrasies and some data selection criteria that it uses. And unfortunately, unlike for, let's say, cancer or other lucrative diseases, where there's a lot of biomedical information curating companies that go through the literature and scour the literature and create databases that can be licensed of all the. Be licensed off all the existing knowledge on the subject. They don't have much interest, as far as I know, in this field, probably because it's less lucrative. Maybe there's some other reason as well. And furthermore, there's no unified representation of phenotypes. So the methodology that can be used, so people use Agar dilution, which is what I showed on the previous slide, also disk diffusion, e-test, Vitec, and other. E-test, Vitech, and other techniques. So there's lots of different methodologies. Different critical concentrations. Europe has one set, the US has a different set. And both sets of critical concentrations, which are essentially these cutoffs between what's considered sensitive, what's considered resistance, change over time. Replicates are typically not reported. And there's also some differences by source. So whether you're talking about something that's isolated from blood versus Talking about something that's isolated from blood versus something that's isolated from urine, you might have different interpretations of these phenotypes. All right, so seeing that this was the situation, I naively thought, okay, maybe it will be a good idea to just try to bring everything that's out there under one roof and see how that works out. So I did get started on that a few months ago, and this is what I've been able to do so far. So I extracted all the AMR. Extracted all the AMR data from six major databases, which you see listed here on the left. The other ones were either too small, too specific for a particular organism, or I was just not motivated enough to investigate them. And it's also possible that I missed some important ones, so please do let me know if I have. And then I also carried out a system. And then I also carried out a systematic literature search, which covered over 35,000 publications. And about 1% of those ended up being selected as relevant. So the search terms that turned up these publications were fairly broad. And as a result, the precision of the search was fairly low. But nevertheless, But, nevertheless, about 350 of those were selected as relevant because they had at least 100 isolates belonging to one of the priority bugs on the WHO list with both genotype and phenotype data. About half of those then provided usable data sets. In some cases, there were multiple data sets per paper, and about 150 ultimately had a sufficient sample size. And here, the sample size was still 100. Was still 100 for all the bacteria, except for tuberculosis. Tuberculosis, I capped it at 200, mostly because it's the most, by far, the most studied organism. So there just didn't seem to be much of a point. Why 100? It is an arbitrary threshold, and I am aware that this will introduce some biases, but the amount of work and blood, sweat, and tears that goes into actually extracting that information out of these publications, because of all the formats. These publications, because of all the format and all the paywalls and whatnot, it's just so substantial that anything that's less than 100 data points does not seem worth it. And so in the end of this whole process, I've ended up with over 200,000 unique genomes. And those are in a variety of representations. So some are in contig form, some are just short reads. Just short reads, some are already assembled, but overall, 200,000 and a mean of five phenotypes, meaning that on average, each one had about five drugs that it was tested for, which means that we now have over a million data points once everything is put together in one big spreadsheet. So, I wanted to tell you a little bit. I wanted to tell you a little bit just for fun about some of the good, the bad, and the ugly that you see as you go through this process, partly to convince you that you probably don't want to do this yourself at home, and partly just to get you to commiserate with the kind of things that people in this field had to deal with. So, this is a really nice representation. This comes from Really nice representation. This comes from the Compare ML AMR Consortium in Europe that was founded a couple of years ago. They have this uniform format, just 11 columns. This is, by the way, all the same sample. It's just tested for different drugs. Every drug gets its own row, and there's a really nice break up of the measurement. Up of the measurement results. So you have the measurement itself, you have the units, and then you have the sign as well. So the sign typically is an equal sign, but sometimes you get a less than or equal to sign if you're below the lowest concentration that you test, or greater than or equal to if you're above the highest concentration that you test. So you basically stop at a certain point. And then, if you know, if you're still, if that concentration is still not enough to kill the bacteria, then you basically just say, okay, well, The bacteria, then you basically just say, Okay, well, it's greater than that. I don't know how much, but it is greater. And then you just get details about the typing method and the standard and the breakpoint version. So this is really, really nice. Okay. Unfortunately, they only have a couple thousand of these bugs and probably something like, well, yeah, just maybe a dozen drugs per. Uh, drugs per bug. So, it's not a whole lot of data that's in this format. Um, this is the format that I'm kind of considering to be the gold standard in my, you know, and trying to bring this all together. In fact, myself and a couple of other people, including Nicole, who's here in the audience, we wrote this paper called Town Simple Rules for the Sharing of Bacterial Genotype-Phenotype Data on Antimicrobial Resistance. Just kind of like, this is, you know, these are the best practices. Like, this is, you know, these are the best practices for doing this. So, this is currently in review. A bad representation is what you see here. So, first of all, drugs are grouped into categories, well, by family, which is okay. But then you get things like this here. So, you know, this particular isolate. So, these are different isolates on each row. But this particular isolate is resistant to three of the drugs. So, you basically just, you know. So, you basically just write down: okay, so it's gentomycin that it's resistant to. So, you have the gentamycin, you have the tovamycin, and you have the streptomycin, and they're just listed with a space as a separator. So, this type of thing is extremely complicated to parse in a sensible way. Also, you get things like this, where sometimes you indicate what the MIC is, sometimes you don't. Sometimes you say that you've repeated your measurements, sometimes you have. Your measurements, sometimes you have like something completely funky, which is, you know, you're either sensitive or you have some concentration here. So it's a mess. Okay. And then even worse than that, and you might think, well, what could be worse? But it can get worse. And that's when you have a figure. Okay. And the figure is basically a heat map here, which, you know, dark red is supposed to be representing resistance. Light red or light red is susceptible. Light red is susceptible. Very light is not determined. And okay, I mean, you can sort of read it off, but trying to do this, convert this into an actual representation that you can use is a nightmare because it's, you know, even with modern OCR, still a lot of work. So thankfully, this particular paper had too small a sample size, so I didn't have to do it. Sample size, so I didn't have to do it. But if I did, I would not have been very happy. Okay, so what are some applications of this, right? Well, some immediate applications include things like large-scale studies of AMR heritability, because of course, AMR is not uniquely, is not entirely determined by the genotype. Sometimes it can be for some bugs and some drugs, and sometimes it's not. So we can ask the question of how much of the MR phenotype can actually be predicted from the genotype? And then we can also. Genotype. And then we can also ask the question of how much of it can be predicted just from the known resistance determinant. And because we have large-scale data here, we can even try to do something that I call a twin study, which is to say, can we find pairs of isolates that have identical genomic variants within the known resistance determinants and see if they, you know, how many of them differ by status. By status, one being susceptible, the other being resistant, which is something you commonly do in human genetics, but in bacterial genetics, it's never been done as far as I know. The construction of an AMR determinant catalog for other pathogens. So I have been actively involved with creating the one for M. tuberculosis. And that took many years, seven years, in fact. We're still working on version number two right now. On version number two, right now. And for other pathogens, there's not much in terms of determinant catalogs. Most of the databases that are out there with determinants focus only on those that are functionally validated. So that's the thing that I talked about at the beginning, where you do a lab experiment and you actually see, you know, in vitro what kind of changes happen when you disable a particular gene or when you. A particular gene, or when you introduce a particular mutation in a particular gene. And then another thing that we've gotten started already on is benchmarking existing machine learning algorithms for prediction of AMR. This is joint work with Nicholas Schlutzen. And there's a paper now out, a workshop paper that you can see it's linked to at the bottom. And this is what it looks like essentially. So we have some code for parameter setting. Code for parameter setting, some representations, some sample status data that's prepared. Then you have the algorithm or the solver or the catalog. And then finally, you have an evaluator. And the way that we've done it is completely modular. So you can basically swap in and out your representation. So for instance, if you're looking at gene presence absence as your representation, you can do that. If you're looking at You can do that. If you're looking at SNP presence-absence, that's another thing you can do. If you're looking at k-mers, that's another thing you can do. So you can basically just decide in your parameter setting which representation do you want. The same you can do with the status. So you can say, okay, I want my values to be continuous or I want my values to be binary. And then also the cross-validation within the solving process is configurable. Is configurable as well. So everything is configurable and everything can be customized. Longer-term applications, and this is my last slide. It would be really nice to automate the updating process. For the moment, much of this work is done manually. I've made extensive use of the AMR package in R, which I highly recommend if you ever have to do anything with AMR. I've also, of course, Of course, used a lot of tidyverse, but it's still, you know, it's backbreaking work. Also, it would be interesting to repeat this work in fungal pathogens. There's now a list of priority pathogens by the WHO in the fungal space as well. There's a lot less that we know about the resistance mechanisms in fungi. As far as I know, there's only one database. There's a dozen databases in bacteria. Could be really interesting to create a dashboard for. Really interesting to create a dashboard for tracking the trends of AMR mechanisms in bacteria. But again, the challenge here is that the sampling is convenient sampling. It's not systematic. And I'll talk a little bit about some limitations on the next slide as well. And gap analysis is one thing that we could do. So where should we try to do more surveillance, perhaps? And then lastly, creating a virtual benchmarking platform. Platform, which is to say, how can we develop criteria to select a diverse, representative, and accurate gold standard out of all this data that we have that we can agree on? A little bit like the, what's it called, image, I think it's called image debt for computer vision. So basically, having some kind of benchmarking data set that could be used. And we got some funding to do this from JPIMR. From JPIMR. So, a couple of limitations before I finish. Many groups carry out ASTs, which is to say the testing for resistance, and then only sequence the resistant isolates. Okay, so this is why it's actually worse than just convenient sampling, because a lot of the time you're not interested in the sensitive isolates, and that introduces the bias in its own right. And if you have limited budgets, okay, sure, I understand. But if you want to do machine learning or But if you want to do machine learning or you want to do surveillance, it's not ideal. Also, many groups sequence the genomes in batches and might publish preliminary results when the sequencing is not yet completed. So then you end up with all the phenotypes, but only a handful of the genotypes. Again, not a problem if you want to get your results out, but it's a little bit less useful. And also, a lot of groups only care about reporting the interesting results, not so much about making the data publicly available. Making the data publicly available. This is slowly changing, but it's, yeah, I think slowly is the key word here. And of course, it's possible that the literature search has missed a few papers. If you know of anything that you think I should have included, please email me. I'd be very happy to check against the list of things that I did look through. And with that, I'd just like to acknowledge all my collaborators. So on the data tech and AMR and the 10 simple rules, Alita, Nicole. Rules, uh, Alita, Nicole, and Martin, and Benchmark VR, Nicholas, Fernando, and John, um, who's going to be giving a talk later today. And then thankfully for this work, I did manage to get some funding from FIND or FIND, the Diagnostics for All public-private partnership. And I've worked with Anita, Swapna, Antonio, and Aytha. Swapna, Antonio, and Atharv, and a few of the funding sources that I've used for previous work as well. And with that, I'm happy to take any questions. Thanks very much. Wow, we're doing great on time. So lots of time for questions, even for this one as well. Thank you, Lunid. Stop sharing for a second. Oh, getting really dark. No, it's very late. Haley, it's Jesse. Hey, Jesse. Wait, there we go. I'm leaning into the picture. Yeah, no, very cool. And such sounds like a lot of work. So thanks. So I'm wondering, just in terms of applications, having a common database for all species together. All species together. I think often you do it's like do it one species at a time, but I mean, do you think that this can help look for common resistance determinants? Is that, you know, do you think that's a big use of this? Absolutely. Yeah. I mean, there is, so there is some work from my former group in Canada where we actually looked at jointly training on. So for that, we only use the Patrick database, but you can basically Database, but you can basically do some joint training where you sort of create this architecture that is able to kind of share information between the pathogens. And yeah, I think some mechanisms of resistance are shared, some are not. And so I think that doing joint training is a useful idea. And so having all this data in one format in one Uh um you know, repository one directory, uh, I think could be really useful, hopefully. Yeah, so that's that's a great, great point. Um, I think there's a question in the chat from uh John. Do you have any thoughts slash plans on giving programmatic access to this really great resource with an API? Um, uh, I would definitely see the value in that, and I think it would. It would be really awesome if somebody could sort of help me out with this. I'm not an API person myself, but I would definitely want this to be accessible in sort of more ways than one. So, whether it's by querying or by subsetting. For now, what we are trying to do with Are we trying to do with find, or at least we're talking about as the next step is creating a web-based platform where people can at least sort of see what's out there and then maybe narrow down into it. So it's not as a full API, but it's more of a, yeah, I guess just like a web resource. I think for most analysts, the spreadsheet will be good enough. The spreadsheet will be good enough, as you said. But yeah, I mean, I think ultimately, the right format for this might be something more like a relational database or and that's not something that I have much much expertise in at all. So, but yeah, great, great things to think about and we should discuss more. And I think Guillaume had a question. Go ahead, Guillaume. You're on mute right now. Thank you. Yeah, sorry, I was writing it. I was writing it. Thank you very much. It's a very, I think, very useful endeavor for the community. I'm not from the AMR community, so I'm discovering it, but I'm interested in the notions that are used there. You were talking about heritability of the resistance, and I had the impression that it's considered heritable if we have a functional causality. Because in quantitative genetics, we just look at the same genotype in replicates and we see how much of the variance across replicates explain. Of the variance across replicates explains the, and so, in a, for example, in our experiments, we will see if the growth rate remains constant over generations and generations, a priori, it's daughters of other cells, so it's heritable. So, is there a difference or is it just a. Yeah, so I guess here we're talking about narrow sense heritability. So, John, the person who asked me the previous question, is the expert on this, not so much me. But essentially, the idea is. But essentially, the idea is: so, suppose that we have a model whereby we have genetic effects and then we have, so additive genetic effects, and then we have some intervention from the environment. So, it's about estimating how much of this variance is explained by just the genetic effects. So, I think it's very similar to what it is the quantitative genetics definition. It is, yeah. But then we don't need to know a func to have any. don't need to know a func to have any functional we don't need it to be mutated at some known uh gene because i mean it's just a genotype and it and as there is no recombination in bacteria it's it's a clone of itself and if it's steadily increasing so so there is there is recombination in bacteria first of all sorry yeah yeah yeah i meant in the lab and yeah yeah it's a bias from it's a clear bias recombination of humans yeah you know where it's sexual reproduction but there is recombination Where it's sexual introduction, but there is recombination from different ways. But that being said, if you know, if you're sort of thinking of linking it to the known mechanisms, the reason that I sort of, it's more of a conceptual idea to basically say, well, how much of the phenotype can we predict just from the genotype? And then out of that, how much can we predict, just like in human genetics? We predict just like in human genetics, they might say, you know, how much of it can be explained by the common variants versus the rare variants. So, here we can ask the question of, you know, how much of the variation in the phenotype can we explain by those genes that we already believe, you know, to be involved from a mechanistic point of view versus how much else exactly how much the known genes explain the genetics. How much the known genes explain the genetic variants versus how much the unknown genes explain that's exactly it, yeah. Yeah, okay, but thank you. I think we have several questions: one from the room, one from not in the room, plus it's coffee break. So, I just maybe we can turn this into more of a general discussion at this point. I mean, thank you guys. That'd be great, sure. So, lots of time for questions, but just formalizing the formal break here. Okay, cool. Thanks very much. Let's see. So, Lynn, can you can Let's see. So, Lynn, can you hear me? Yes. Excellent. Yeah. So, really interesting talk. And, you know, I really appreciate the work you've done, not only to put this database together, but to do the exploratory work to figure out what it takes to put such a data.