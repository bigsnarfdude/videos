Just a quick comment about the technology for the whole feature speakers. I think there's a time lag because there are 100 things watching the type of support. So in the absolute worst case scenario, please just run up to the keyboard and get back to the pretty critical forward. Let the author please take your time. Thank you so much. I'd like to thank the organizers for putting together this very nice conference. Conference. I'm going to talk to you about something that is going to come from economics. So I'm going to talk to about something quite different from the rest of the talks. So what I'm going to try to do, I'm going to try to give you an overview, a kind of a high-level presentation. I'm not going to enter into the details. I just want to give you some ideas on why we need these kind of techniques in economics. What's the connection with optimal transport, with dynamics, because those were the two key words of Those were the two keywords of the workshop, and unfortunately, they are both in my talk. And you know, give you some broad ideas of what we're doing to solve which kind of problems. Okay, so I'll do this. This is a paper which is actually not completely ready yet, but it's going to be circulated pretty soon, hopefully, with Pauline Corbl√©. Pauline Corblais is at NYU Abu Dhabi, and Jeremy Fox is at Rice. They're both economists, colleagues, and friends. Okay, so let me let me. Okay, so let me let me tell you a little bit what we're going to do. So I have a slide which is full of text. So, so, but I'm, you know, let me, if you don't want to read all this, and this is why I'm here, it's to tell you what's going on. So, the idea is that, you know, there's this connection between optimal transport and matching models. Okay, so matching models are very, very prevalent models in economics where two populations need to do something. Populations need to do something together. Whether it is to marry, so in that case, we would have, you know, for instance, if we take the heterosexual marriage market, we would have two separate populations, men and women, who would basically decide that they have more or less utility together with certain type of partners than with others. And that would determine the way they match. And that determines many things about society. Why do certain type of people marry predominantly with certain type of... Predominantly with certain types of people. You can build models to study these kinds of things. But you can also study other markets, like the labor market, where you're going to have workers on one side and firms on the other side, in which case things might get more complicated, right? Because one firm might hire several workers and there might be some kind of subtle interactions between workers. And that's basically what people do. Nowadays, with weak optimal transport, typically, and so on and so forth. There are many situations, in fact, in economics that you can model with optimal transport. Now, the thing is, and we're going to talk about that a little bit, we don't have the pretension, we're not pretentious enough in economics to believe that the data. Economics to believe that the data we have is enough to capture everything about Asian. Okay, and typically we have very crude data. We talk about the marriage market, for instance, we have data on education, we have data maybe on socioeconomic status, maybe we have data on income, maybe sometimes we have a survey. We have worked a few, you know, decade ago, a decade ago, a few years ago, I worked on a very nice survey where we have the personality traits of the partners. Traits of the partners in the marriage market. So, this is a survey. We can understand what type of personality are the husbands and the wives. So, we can understand the determinant of the affinity between partners. These are things we sometimes have, but in general, there's a lot of things that we don't have. There's a lot of things that we don't have, and we need to model this uncertainty. And that's even more true in the labor market. We don't know how productive a worker really is or how effective. Really is, or how effective a manager really is. So, in order to do that, what we typically do is we introduce some heterogeneity, some variation, some randomness into the preferences or into the productivity of people. And what I'm going to show you is that if we do that in a very specific way, if we use the logit model, so if we use the extreme value theory, in fact, if we use random utilities that are If we use random utilities that are gumbo variables, we are going to be led to the appearance of entropy in a very, very natural fashion. So we are going to be led to optimal transport with an entropic regularization. And actually, this is a very, there's a very general theory you can develop. And depending how you model what you don't observe, you're going to be led to various types of regularization beyond optimal, beyond entropic regularization. But I'm going to, for the purpose of this talk, To for the purpose of this talk, I'm going to stick to anthropic orgorization. So, this is something that basically is the reason why one of the, you know, there's been a lot of interest in synchronous algorithm in, you know, in the last 15 years in economics, but actually economists were already using synchronous algorithm before and quite before all of the interest. All of the interest because of this connection with random utility theory, with basically this need to model the preferences of heterogeneous agents. So that's what we're going to have. That's basically the static picture. And in economics, again, in economics, the problems are slightly different because very often what we are trying to do is we're trying to solve an inverse problem. Okay, so it's optimal transport tells us if the transportation Transport tells us, or if the transportation plan is such and such, then we're going to predict, sorry, if the transportation surplus, you know, or the transportation cost for that matter is such and such, we're going to predict what the transportation plan is and we're going to predict properties about the transportation plan. You know, very, very early on, economists had to solve the inverse problem and they were actually observing how people match. They were observing joint distributions between two populations of agent. And based on that, they wanted. Agent and based on that, they wanted to infer what the transportation cost was, what the transportation surplus was. So, very, very early on, economists have been interested in what's now called inverse optimal transport, where you basically want to run that analysis of recovering the transportation surplus based on the observed coupling. Okay, so all this is pretty much. So all this is pretty much what's been doing to use optimal transport in economics. And that's basically before this paper. What we are doing in this paper is we're saying, okay, we can model, for instance, the work relationship between employers and employees as an optimal transport with entropic regularization, and that's fine. And basically, And basically, you know, people will have different productivities, they will have different tastes for working on some type of firms. All this is going to be embedded, and that's going to determine how people match. And based on those models, we can estimate the characteristics of individuals. But actually, we need to think if we think about it, you know, this is not a static type of situation. Type of situation, especially the labor relation, it's really dynamic, very interestingly dynamic. Why is it? Because basically, when you're going to work for a firm, you are going to learn from that firm. If you're young and if you're an intern for an investment bank, for instance, you're going to gain a lot of human capital. You're going to gain a lot of human capital. And maybe when you think about this matching problem, you should think about it. You think about it in a, you should think about it in a dynamical way. Okay, maybe I'm not going to make a lot of money as an intern. Maybe I could make more working with McDonald's. I don't know. But still, it's of high value to me to work for that firm because I'm going to learn a lot. And then later on, at the later stages in life, I'm going to be able to pull out quite a bit of value from the subsequent matching market. Subsequent matching mark. Okay, so that's the idea. And that's typically the idea of dynamic programming. Okay, we're going to model a sequence of decisions. Okay, and basically, you know, we're going to assume that we're making optimal decisions. And those decisions are going to be related in the sense that the choices that we make now are going to impact a state variable, okay, and that state variable is later on going to impact the value of subsequent choices that we make. Of subsequent choices that we make because it's going to make me more productive or less productive, depending if I intern with Goldman Sachs or with McDonald's. Okay, so that's essentially the idea. But, so you're going to tell me, okay, but this is standard dynamic programming. Yes and no, it is dynamic programming, but this is two-sided dynamic programming. Because what we're going to assume here is that both the worker and the firm are going to basically Going to basically take those decisions. Both of them are both the worker and the firm are going to have a state variable. And that state variable, both of those state variables are going to be affected by the match. In other words, if I'm an intern, maybe I'm going to develop a great software for the firm and maybe that's going to also change the type of the firm. And that's going to be true. Maybe not so much for interns, but if you're thinking of CEOs. But if you're thinking of CEOs, for instance, CEOs are going to highly impact the type of the okay, so basically, we're going to have a model where basically on the two sides of the market, there will be a dynamic programming principle. But those two dynamic programming principles will be interrelated, obviously, because this is a matching. Okay? Okay, so what we're going to do, if that's fine, first. If that's fine, first of all, I'm going to skip most of the literature review because I'm assuming that these are names that you would not know of since they're economists and most of you are not economists. Although there is one name that is going to stand out, which is actually the inspiration for this work, which is a very nice paper by McCann and a bunch of co-authors. Okay, so this is actually a two-period A two-period, the model that we're working to build is a multi-you know, is built on this model because Macan and his co-authors had this idea of a two-period sequential matching model where basically you're going to have this idea of dynamic programming for a matching program. Okay, so the way I'm going to build this thing, this story. Way I'm going to build this thing, this talk is first of all, we're going to recall the static case. So, basically, essentially, the story I'm going to tell you. Some of you have heard it many times. So, sorry about that. But this is basically the connection between matching models and economics and regular entropic regular results. So, again, sorry, many, you know, a number of you know this very well, but still, let me start with this. And then, basically, This and then basically, once we have the static case, we will see that we can extend that to the dynamic case in a relatively easy fashion. And there will be it's going to be quite easy to extend this to the to the multi-period dynamic. Okay, so so, but for now, let me set up some notations. Some notations. Let me set up the model. So we have two populations, and I'm going to assume that they are workers on one side. Assume that there are workers on one side, firms on the other side, and the workers are CEOs or would-be CEOs. The firms are firms who need a CEO. So, basically, there's only it's a one-to-one matching problem. One firm hires one worker. So, I'm going to assume that there's a finite number of types. So, it's a discrete problem. It's a finite dimensional version of the optimal transport problem. So, this is a very simple setting. Very simple setting. I'm going to assume that there are n x workers of type x. Again, there's a finite set of x's, of possible x's. Okay, so these are, you know, x stands for the skills of the CEO, whatever. And same thing, there are MY firms of type one. Okay. Okay. And I'm going to assume that. Assume that a CEO of type X may match with a firm of type Y, okay, but this is how is it called, partial optimal transport, maybe something like that. I'm going to leave the possibility to the agents not to match. Okay, so a CEO, a would-be CEO, might not find anyone, any firm to be matched with. And similarly, a firm might just decide to hire a temporary CEO if the search fails. If the search fails. Okay? So basically, we can either match a firm and a CEO, but we can also leave the possibility that a CEO remains unmatched, or sorry, a worker does not find a firm to match with, and a firm does not find a worker to match with, okay, which I denote x, zero, or zero, y. Okay, we're going to denote the colonity of a match. W x y, that's going to be an important number. It's going to be two if it's actually a matched pair and one if it's a non-match pair. Okay, I'll come back to that. If it's a non-match, okay. I'll come back to it. Okay, the very important object, okay, that we're after, in fact, but for now we're going to assume it is going to be the joint surplus of a match. Okay, so it's the economic value that is being created in dollars terms that is being created if a worker of type X matches with a firm of type Y. Okay. And we're going to make an assumption on that because, again, we are not claiming that we observe everything that is. That we observe everything that is relevant to predict these matches. So, we're going to assume that a part of this tilde xy is known, depends on things that are observable. So, it's going to be the interaction between the scale of the CEO and the characteristics of the firm. So, it's going to be this S, X, Y without a tile. But then there's also a part which is going to be random. And the part which is going to be random is going to be a part that is going to come from the CEO and the part that is going to come from the COVID CEO and the part that is going to come from the firm. So these are the randomness in preferences and in productivity of the CEO and the firm that are going to add up to the part of the productivity that is determined by the observable factor. Okay, so you see S tiled is going to be conditional on X and Y, which are the observable characteristic. X styled is going to be equal to a deterministic part X, S of X Y, plus those two. s of x y plus those two random variables epsilon y which a CEO associates with any possible types of terms plus eta x which is the same thing on the other side of the mark okay and what we're going to assume is that those epsilon and those etas they are going to be logistic they're going to have those gumball distributions from the extreme value theory which leads to the entropy as i was saying earlier okay so this is a modeling assumption uh which is A modeling assumption, which is particularly nice because it's going to lead to very tractable formulas that are going to give us the entropy regularized optimal transform. Okay, any question? Yeah? S xy without detailed, this is the deterministic part of S-tile. S-tale is random because of those two random variables. But this, so for instance, so you're going to model this, you're going to model this, you want to estimate this part, so for instance, We want to estimate this part. So, for instance, it's going to be the talent of the CEO times the size of the firm, something like that, or something much more complicated, but which would be this is a deterministic function of the observable characteristics of the CEO and the observable characteristics of the firm. Yeah, the joint gain for both of them. Exactly. It's going to be a maximization problem because basically the more. Maximization problem because basically the market is going to maximize the sum of those quantities over all the possible pairs that that over all the pairs that you that you okay so that's for a match pair and basically if the CEO decides to remain unmatched then this CEO is going to get this this value which also has a deterministic part and a random part because some some CEOs they enjoy leisure Some CEOs they enjoy leisure more, but that's that's random. And same thing for the firm. If the firm doesn't find a CEO, it has a number of outside options, which is modeled by this S style of zero Y. Okay. Okay, okay. So this is basically the primitive of the model. And now what do I want to do? Well, I want to predict who matches with whom. So I want to predict what in optimal transport would be the transportation plan. So I want to predict basically this mu. So I want to predict basically this mu xy, mu x0 and mu0 quantities that are basically the numbers of matches of each type at equilibrium. This is subject obviously to conditions because I need to respect by margins the number of workers and the number of firms of each type. But essentially, this is going to be my primal variable in the optimal transport problem. And obviously, I'm going to have also a dual variable, which is going to be the ux and the vy. Those are the Kantarovich potential. Those are the Kantarovich potential. It's very, you know, it's very, it's very, you know, and basically, what does it mean in terms of in economics? Well, that's going to be the average value that a CEO of type X is going to pull out at equilibrium. And same thing, Vy is the average profit that a firm of type Y is going to get at equilibrium. Because what's going to happen is that basically at equilibrium, there's going to be a wage. So this There's going to be a wage. So, this joint surplus here is going to be split between a quantity that is going to go to the CEO, that's going to be the wage of the CEO, and a quantity that is going to go to the firm, that is going to be the profit of the firm. But there are the random terms that need to be also split. And essentially, what we're going to get is that, on average, a CEO of type X will get UX and a firm of type Y will get UY. Okay, so let's see how those quantities are determined. Quantities are determined. We have this result. So, that result is the result by Shu and Shou. So, it's a very important paper in 2006 that actually started this literature in economics on matching, but it's very, very close, as you're going to see, to optimal transport with entropic regularization, as we discovered later. So the idea is that you have a relationship between mu, remember, Between Œº, remember Œº are the quantities of matches at equilibrium. These are the transportation plans, and u and v, which are the dual variables. So, you're not going to be surprised to find this relationship. And the precise relationship is going to be that mu xy is going to be essentially proportional to the exponential of Sxy, that's the deterministic part of the joint surplus, minus ux minus vy divided by 2 times the... Divided by 2 times the square root of nx m1. Okay, what does it mean? Okay, and also mu x of 0 is going to be nx times the exponential of f s of x0 minus ux and same, a similar formula for mu 0. What does it mean? It means that basically, you know, basically, this is the problem with the, remember, there are those heterogeneities, so those heterogeneities are going to create some randomness. So, this is not a linear programming problem, this is a problem with. Programming problem. This is a problem with some regularization. And basically, the idea is that the higher on average, the higher the match XY rings value, the more frequent it's going to be, which is why basically we have here S of X Y inside the exponential. But I need to correct that by the fact that basically I need to adjust. I need to adjust. I need to adjust the fact that mu xy, if I'm summing mu xy over y, and if I'm adding mux to zero, I need to find nx. So the types x are more or less scarce, and I need to account for that. And similarly, the type y are more or less scarce because they're subject to the other margin constraint, which is why basically these u and v's, they are the Lagrange multipliers, in fact. So they're going to be here just to adjust. They're going to be here to adjust to adjust. Here to adjust those marginals. Okay? So this is the result that I have. I have that basically, these are the relationship at equilibrium between the quantities and the prices. U and V act as prices. Basically, U and V, they are going to be subject to the population counting equation, where here basically I'm plugging the formula for mu plus the formula for mu x is 0. I'm saying when I'm summing mu x y over y and I'm adding mu x. If I and I'm adding mu x to zero, I get an x, okay, which is the correct number of workers of type x in the population, and same thing for the number for counting the number of firms of type y in the population. Yeah, sure, sure. What happens if you take away the brand? Yeah, yeah, that's a very interesting. Yeah, that's a very interesting question. So, what you can do, for instance, is you can take a temperature parameter, a scale parameter, and put it in front of the epsilon and the eta, and let that tend to zero, right? So what you're going to get is that in those equations, instead of getting divided by two, you're going to get divided by two t. And here, instead of dividing by s and here, you're dividing. By s and here, you're dividing by t here. So, what does it mean? It means that you're going to concentrate your transportation plan on basically the set of x, y such that ux plus vy is equal to s of xy. That's very standard in optimal transport. Okay. So, if I think about this like the single-point algorithm where you've got this parameter that you're taking for your regular. Okay, the low random word that you have a random exactly, exactly. Yes, yes, yes. So, thanks for bringing synchron actually because you see, this is almost synchron, this is not quite synchron. Because in synchron, you'd well, first of all, in synchron, the sum over x of n x, the total population of x equals the total population of y. There's the same number, overall number of workers and firms, which is not the case here. I don't need that. And why don't I need that? Because I'm allowing people not to match. Okay? To match okay in synchron, you're forcing everybody to match together, so you don't have those terms. But if I didn't have those terms, that would be exactly synchron. That would be exactly synchron. So what do we have? So that's a short proof. Okay, so that's a short proof. I don't know if I should do that, but maybe real quick. Should do that, but maybe real quick. And then, if you're interested, you can go back. But, but why is that? That comes from an equilibrium argument. The idea is that if X and Y match, then there's going to be basically, these are equilibrium models. So, in equilibrium models, everybody is self-interested. So, everybody basically maximizes takes choices that maximize their utility. So, in order to do that, what do we need? We need a wage. Otherwise, you need a wage. Otherwise, you need a wage to induce people to work, right? So, there's going to be a wage such that the joint surplus, the total value creation, or the deterministic part thereof, is going to be split between the part that is going to go to the worker and the part that is going to go to the firm. This might seem arbitrary, but it's not. It's going to be determined at equilibrium. It's going to be determined by market clearing. So, what we can show is that So what we can show is that this S of XY is going to be split between a part that is going to go to the worker, a part that is going to go to the firm, and the wage is going to essentially determine the splitting. The wage is an equilibrium quantity, it's like a price. And then basically, we're in the logic framework. So the worker is going to know that if this worker is matching with term y, it's going to get u of xy plus this epsilon term. XY plus this epsilon term, if you remember this epsilon term. So if you know about the logit framework, it means that the probability that a worker of type X is going to maximize utility with a firm of type Y. So the probability that an X is going to choose a firm Y is going to be basically proportional to exponential of U of X Y. And basically, we normalize this quantity so that it's a probability. So that's a Gibbs distribution. It's a probability, so that's a Gibbs distribution where u of x is going to be equal to the log sum of the exponential. Okay, so it's a Gibbs distribution. Why do we take the Gumball distribution? Because we want this Gibbs distribution for the workers and similarly for the firm. Okay, and once we have those two Gibbs distributions, what do we do? Well, we say, hey, if I multiply those two expressions term by term, basically I'm going to get exponential of uxy plus exponential. Of uxy plus exponential times exponential of vxy. So essentially, I'm going to get exponential sxy. Okay, and you see here, this is why we have this relationship between this times this, which is the square of mu xy, and the exponential of u plus v, which is the exponential of s of xy, minus ux minus vy. Okay, now, so it's really this idea. So, so, so it's really this idea that, you know, what we see when we see synchron as really, you know, I take the Really, you know, I take the Mons-Kantowitz problem, I put an entropy term in the primal, and I get this. Here, you know, people have worked from a very different logic to get there, but they got exactly the same result. They got exactly the same result. This is an equilibrium idea. This is an equilibrium idea and the idea that at equilibrium, you do the choices in your birth cutting. Okay, so let's now go back to the model, to the static model, because I want. The model, to the static model, because I want to have a little bit of time to talk about the dynamic stuff, because it's the topic of the talk after all. But still, just before we talk about that. So I've shown you the equations of the model. And you're not going to be surprised that there's an optimized variational formulation, an optimization formulation. And it's actually not surprising at all for mathematicians because in the mathematical community, we arrive there from the variational formulation. From the variational formulation, right? I mean, you know, mathematicians took the primal problem and added this penization to it to get this. Okay, but what do we have here? We have that basically these equations, these equilibrium equations that I showed you, they are going to satisfy basically a minimization problem. This is basically the regularized form. Is basically the regularized form of the dual Mons-Contour of each problem. So, here this would be the standard dual in the Monche Contour of each case. This is basically the expectation of the Contour of Each potential on the two sides of the market. Plus this function here, this Z function here, which is the sum of the exponentials. So, here there's a twist because I'm giving the possibility to the agents of remaining unmatched. So, I need to recount not only So I need to recount not only the terms that correspond to the matches, so 2 times the square root of nx my times the exponential of s minus u minus v divided by 2. Why do I have a 2 here? Well, because I have a 2 here, you're going to see. But anyway, and then I also have those terms that take into account the possibility of remaining unmatched. And then, so that's that's just, I'll talk about that later, but that does not depend on UNB. So essentially, what does this mean? And v so essentially, what does this do? This is basically a soft penization of the dual constraint, the Comte-Wich problem. This is basically a way to make deviation from ux plus vy greater or equal than s of xy costly, but not infinitely costly. And you can see that basically when I take the first order condition associated with this problem, I'm going to get exactly that nx will be equal to the sum of a y. X will be equal to the sum of the y of those quantities plus this quantity. So that's going to be exactly, remember, the margin equation that I was asking. Okay. So this function Z, this function Z is quite useful because let's look at what this function Z is. So it's basically a penalty term. I can view it purely as a penalty term, but there's also an interesting interpretation of it. Why did I call it Z? Because Z stands for. Call it Z because Z stands for zero. Why? Because this function Z is supposed to be zero at equilibrium. Right? Why? Because let's take a look at this. At equilibrium, this quantity here that I'm summing over is going to be mu xy. That's the number of matches between types x and types y. So when I sum it over x and y, I'm going to get the total number of matched of matches. If I multiply by two, I'm going to get the total number of individuals who are matched because there are two. Who are matched because there are two in a match between two individuals, there are two individuals. So that's going to be the total number of matched individuals. That's going to be the total number of unassigned individuals of type X, sorry, of the population of workers. And that's going to be the total number of unassigned firms. So this total quantity here is the total number of individuals in my population, workers and firms alike. Okay, now if I subtract the total The total nx and the total ny. There's a minus sign here. Obviously, I should get zero. Okay. So you see this function z. It's a mysterious function. It's supposed to be zero at equilibrium. And also what I'm going to, it's a potential function such that when I'm going to derive it with respect to u and v and n and m, I'm going to get a bunch of very interesting quantities. First of all, Quantity. First of all, and we saw that already, when I derive z with respect to the potentials ux and vy, I'm going to get the margins of mu or minus the margins of mu. And that's because when I derive this with respect to ux, you see the two cancel. I'm going to get the sum over y of mu xy plus the sum over plus mu x0 with a minus sign because there's a minus sign here. So when I derive z with respect to ux and vy, the potentials, Ux and vy, the potentials, I'm going to get minus the margins. And what about when I derive with respect to an x? We're going to see that in a minute. We're going to see with that in a minute. We're going to see that. Okay, all right. Okay, so let's, so this function is going to be very important because I can describe everything in terms of this, these functions. I can describe all the equations of my models in terms of my functions. Okay, so what are we going to? Okay, so what are we going to do? What are we going to do? Now we're going to take this model. Okay, so this model is a static model. S is going to be the S in this model is the static surplus that I'm going to take. But now I want to move to the dynamic. So now the idea is to say, okay, if a worker of type X and a firm of type Y are going to match, it's going to create some kind of short-term value pi XY. Phi XY. Maybe I can use this board. If X and Y match is going to create them a short-term value that's going to be the short-term value. That's the economic output that they create at the current period. But they're going to say. Period. But they're going to say, okay, if I'm a worker X who matches with a firm Y, my type is going to evolve, okay? And at the future period, maybe I'm going to be a more productive worker. So what we're going to assume, we're going to assume Markov transitions. We're going to assume that there's a probability P that if you're a worker X, Your X match with the firm Y, you're going to transition to a type X prime. Okay? Let's say, you know, if I match with, you know, Goldman Sachs, which is, you know, like the top investment bank, maybe, I don't know. If I match, if I'm a worker X, if I'm a college student, if I match with Goldman Sachs, there's a good probability that I'm going to transition to a more productive banker in the future period. Productive banker in the future period. Okay. We don't know for sure, and that's why there's a Markov chain, but basically, it's going to be this idea of these Markov transitions. Same thing for the firm. The type of the firm is also going to evolve. It's going to be a probability Q of Y prime condition on XY that if I'm a firm Y match with a worker X, I'm going to transition at the next period to a firm X prime. Okay? Okay, so now when I talk about the value of the match, what should I take into account? Well, I should take into account that there's this going to be the short-term value here, but there's also the, I need to anticipate the future value that both the worker and the firm are going to get. And because we're talking about a joint surplus, we need to pull those two terms together. So, what do I need to do? I need to basically add the discounted sum. The discounted sum of the payoff of the worker at the future period. So that's going to be the sum of x prime, which is all the possible values that the type of the worker can take, weighted by the probability. And remember, what is the value that a worker of type X extracts from the market? It's U. This is what we introduced earlier on. This is what we introduced earlier on. Okay, and I'm going to also discount the future at the rate beta. Beta is going to be between zero and win. Okay? So that's the worker term. That's the workers' future payoff. And of course, I should do the same thing for the firm. I'm going to take, let's. I'm going to take, let's, for simplification, let's take the same discounting factor for the firm, but I could take obviously different discounting factors for the worker and the firm. We're going to get that for the firm, I need to take the discounted expected future value of the firm. That's going to be the sum of a y prime of y prime given xy of v of y prime. Okay? So you see, it's kind of interesting because Interesting because basically before I was just concerned about this joint surplus phi and based on this joint surplus phi, I was solving my equation, whatever, and I was finding ux and vy as an output. Okay, but now basically the ux and the vy's, by this dynamic programming feature, they're not only in output, they're also in the input because I need to basically take them from the future. them from the future. Okay. Okay. Is that fine? No, this is something that you're going to observe, basically. Yeah. I mean, in a more complex version of the problem, you would also estimate them, but typically this is something we observe pretty easily. Okay, so that's essentially my model. So this is a two-sided version of a dynamic programming problem, the Markov decision. A dynamic programming problem and mock-up decision processes, essentially. Yes? Yeah. Yeah, so exactly. So right now we're assuming Markov transitions, but you could enlarge. but but you know you could enlarge the the the space of types to have some form of recall of the of the path you would but then you know obviously it's practical consideration that i can keep in the issue so great question so the total population we assume they don't change but we could have a birth and uh and have a birth and uh and and a rate process that's that's that's at the end of my talk yes yes but but but what's going to change is the margin the margins are going to change and that's that's an interesting you know departure from the static case that because of this you know because of these transitions the the margins are going to change although we're going to talk about a stationary solution okay is it okay is it bearable So basically, what we'll so, you know, in this simplistic version of the model, we're assuming that every year there's a new matching market. Okay. Yeah. There are more, you know, complicated version of this where we work on, where people actually, you know, depending on the match, you know, they have fixed-term contracts and they decide on the length of the contract. And after the end of the contract, they're back. the the end of the contract they're they're back on the on the matching but here it's a simple you know we're assuming that every year people rematch okay so so so how are we going to do this what we're going to do can i write over there or is it uh is it complicated if i write here word there no i can okay great okay so essentially what do we want to do We have what do we have? We have basically we need to we need to set up a language we have we have period T and we have period T plus one okay at period T the utility that X is getting from the market The utility that X is getting from the market is going to be UX, and the utility that Y is getting from the market is Vy. Okay, and these are basically what we saw as the solution of the dual. These are the counter-wish potentials. Here at C plus one, it's the same thing. We're going to call this U prime X and V prime Y. Later on, we'll talk about a stationary solution. So later on, we'll say, hey, U should be equal to U prime and V should be equal to V prime, but for now, we don't assume. To V prime, but for now we don't assume that. So these are the utilities, the prices. Okay, now we have the margins. As I said, the margins, they also change because basically they are transitioned from types to other types. So initially at period T, we have NX and MY. Okay, the number, we inherit a population with NX workers of types. A population with nx workers of type x and my firms of type y. But after the transitions are carried, we're going to get n prime x and m prime y. Okay, these are the next period populations. Okay. Okay. And so basically, what do we need? We need a device to basically relate u and v to u prime and v prime, n and m and n prime. n and m and n prime and m prime. And this is exactly, in fact, this is exactly what this z function is going to do for us. Why? Because you see that essentially when we take z, when we take z, z is parameterized by the surplus. That surplus here, that was the myopic surplus. That was the short-term surplus because I was in the static case. But now that I'm going to ensure. But now that I'm going to introduce my dynamic case, the surplus is no longer going to be just phi. It's going to be phi plus these terms. And these terms, they're going to depend on u prime and v prime. Okay, u prime and v prime, which are the future payoffs of the agents. So I'm going to plug this new value, S plus the expected U prime and the expected V prime into my. Into my S here. And I'm going to use these relationships. They're going to tell me, okay, if that's the surplus, these derivatives here, they're going to tell me at the at the the at the The at the period theta. So let's see this. Okay, so this is what's here on the slide is essentially what I was just writing. This is going to be the new surplus. That's going to be for match pairs, but I also need to have something for the unmatched X and the unmatched X. And we're going to assume that if you remain unmatched, it's become. If you remain unmatched, so conditional x0, there's a type post here, conditional on being matched, not match, and there's going to be a probability of transitioning to other types. And presumably, if you don't work, you're going to transition to lower types, but that's, you know, that's in the modeling that I'm making for P, same thing for Q. So that's going to be my new surplus. And what I'm going to get is this relationship. That's just true and source relationship. That's just true and source relationship, where I've just replaced the surplus by this new version of the surplus that takes into account the future payoffs. Okay? So, so, so, so, so. Everybody's fine? Now, what do we want to do? What we're going to do is we're going to look for a What we're going to do is, we're going to look for a stationary solution associated with this problem because we're going to assume that if this problem runs for long enough, then basically U and V are going to be stationary and the populations are going to be stationary too. So we're going to wonder if there's a fixed point of this operator. So what's this operator? This operator, I'm sorry about the light thing. thing huh so we're basically going to wonder whether there's a there's a fixed point of this operator so this operator it's an operator that takes into uh that takes into into into input nx and my which are basically the period t populations and u prime and v prime which are basically the period t plus one period C plus one payoffs. Okay, and then you solve the model and you return N prime and M prime, which are the future populations. Okay, so after basically the transition have been made, and basically U and V, which are the payoffs that you're going to obtain. This is how basically you're going to share the surplus at period. At the at period, okay. So, uh, so this is essentially what we're going to do, and let me show you how we're going to do this. Let me skip the estimation for now. So, this is what we're going to get. Remember this function z. So, remember the derivative of z with respect. With respect. So again, I've adapted it. Let's see. Maybe I should talk about that. I've adapted my function Z. So now basically it depends also on U prime, V prime, because again, I've inserted this future expected surplus into the myopic surplus, into the expression of the myopic surplus. So now my function z. Okay. So now my function z is now a function of u v, u prime, v prime, and n and n and n. And based on this function, I'll be able to express the equation of the model. Why? Because remember what happened. This is something we saw already. When you derive z with respect to ux, you're going to get minus the margins, minus the margins, the margins today. This is before the transition. And these are the margins before the transitions. Before the transitions, these are mu. These are the margins that are based on mu. So the derivative of z with respect to ux is going to be equal to minus nx, which is the margin associated with type x. The derivative of z with respect to vy is equal to minus my. Okay, so that's the easy part. Now, the derivative of z with respect to u prime, that's very interesting, the derivative of z with respect to u prime. What happens if I derive z with respect to u prime? Well, you see, u prime is here in this exponential. Here in this exponential, if I derive it, I'm going to get p, my operator p, that's my Markov transition operator, and I'm going to get this term beta. So, in fact, what you can show is if you derive z with respect to u prime of x prime, you're going to get beta times the sum over x and y of p of x prime condition xy times mu xy. Just by their very simple derivation. What is this? Well, this is basically. Well, this is basically the sum of matches of type XY, the number of those matches of type XY, times the share of those matches that undergo transition to type X. So this quantity here is exactly n prime of X prime. This is exactly the number of agents in the population after the transition. So you see, when I derive Z with respect to U, I'm going to get minus N. I'm going to get minus n. When I derive z with respect to u prime, I'm going to get beta times n prime. So you see this function z, it's really magic because I get all the equations, I get to express all the equations in the model thanks to this function z. Same thing, if I derive z with respect to the future payoff, v prime, v prime of y prime, I'm going to get b times m prime of y prime. Okay? So basically, when I derive z with respect to those potentials, Derive z with respect to those potentials. I'm going to get the present quantities and the future quantities, the present populations, numbers, and the future population numbers. Okay, and now the last thing is when I derive z with respect to n, what do I get when I derive z with respect to n? So this is something you can easily do. You're going to get something which is supposed to be equal to zero because you're going to get the total number of x. number of x's divided by nx, which is supposed to be one at equilibrium, minus one. So this is quantity here is supposed to be zero. And similarly, the derivative of zero with respect to my is something which is equal, supposed to be equal to b zero. So all these are going to be able to express the equations of the model, the stationary model. Let's see, let's recap. Again, the derivative of z with respect to u minus na derivative of z with respect to u u u u u u u u u u minus nx derivative of z with respect to v minus my derivative of z with respect to u prime x the future period utility is equal to beta n prime derivative of z with respect to v prime is equal to beta n prime the derivative of z with respect to n and the derivative of z with respect to m are equal to zero what does it mean it means that now if we're looking for a stationary solution a stationary solution which is which is going is going to be a solution such that u is equal to u prime v is equal to v prime and equal to u prime, v is equal to v prime, n equals to n prime, m equals to m prime, then what can we do? Well, we can combine those equations and say we're going to get that beta times the derivative of z with respect to u plus the derivative of z with respect to u prime is equal to zero. And beta derivative of z with respect to v plus the derivative of z with respect to v prime is equal to zero. Okay? And obviously the derivative of z with respect to n and with respect to m is equal to. And with respect to m is equal to zero. Okay, so these are the equations of my stationary model. And I only have three minutes. Okay. Okay. So three minutes to tell you what, to tell you what are we going to try to do. Well, first of all, this equation here, they are going to be predictive, but they're not what we want to do is we want to estimate things. We want to estimate the surplus. So we want to solve the inverse problem. So while this Problem in fact. So, while this is nice, because if we postulate what phi is, we're going to have a model that is going to tell us what are going to be the populations, what are going to be the wages, and so on. In fact, we want to do the inverse, we want to solve the inverse problem. We observe the wages, we observe who matches with whom, and we would like to deduce what the surpluses of matching are. We can do this quite easily, actually, by adapting this technique. This technique, and that's essentially introducing conjugate variables, canonical variables. And actually, if we take a parametrization of the surplus file, we can still run this idea that the derivative, you know, all the derivative, all the partial derivatives of z are interesting and can be expressed as nice things. So here, if we parameterize the utility file, The utility file in a linear way, the partial derivatives of z with respect to the parameters are going to be the moments that we need to match. And so basically, in that case, in order to estimate lambda, we're just adding those equations that correspond to matching those models. Okay, so this approach carries two different. So that's the first remark. The second remark is that, is this an optimization problem? An optimization problem, and the answer is no, unless beta equals one. Beta equals one, which is the limit of the unique discounting factor, is a very particular case where I can express these equations as a saddle point problem. And I have the variational formulation. I can use classical algorithms. But even in the general case, I can quite easily adapt variational algorithms to solve this type of model. To solve this type of model and to estimate lambda, which is what we do in our empirical application, which is here. We have basically a bunch of Swedish workers, Swedish engineers. So it's very nice, you know, because in Sweden, in Nordic countries, they don't have much concern for privacy. So they observe everything about people. So it gave us a nice panel of data in order to estimate our preference. To estimate our preferences. And in our application, the idea is: what are the returns to starting in a rural area of Sweden in order to gain more experience later on in your career? Okay, I'm sorry I'm over time, but thank you so much for your attention. I hope I didn't give you too much of a headache. And I'm happy to take questions if we have Thanks, Alfred, for a very nice talk. So, this is quite interesting. Is there any relevance between some Kinturovich potentials that maybe come from that equation that you wrote? Because I see that you have the sum of the p's with some condition, and then you have the sum of the q with some condition. Yeah, so your question is what you get, can you get because you know how you have it reminded me of the controls potential where you have the plus function and there's this very nice inequality? Yeah, is there something related to this or so these u prime and z prime they're going to be the controversial potential for the subsequent problem, right? Yeah. The subsequent problem, right? Yeah, okay. So, each, so, so, this is going to be this matching problem is going to produce the counter-reach potentials, which are going to be the u's and the v's. And the u primes and the v primes, they're the counter-reach potentials for the for the subsequent problem. So it's, you know, it's, it's, this is the, essentially, this is the way it works, basically. Okay, and so would it make sense to say something about is there like duality happening, or can there be some duality? Yeah, I mean, in some sense, this is duality because. You know, in some sense, this is duality because basically when you derive z with respect to u prime, you're going to get a margin. So it's a form of duality. But you know, the interesting thing is that the stationary solution, the equations, they're not associated to an optimization problem or to a saddle point problem, unless beta equals one. So it's a duality, but it's not. So it's it's a duodity, but it's not uh it's not a convex drillity in the classical sense of the of the term. Thanks. Yeah, so there's um mentioned earlier with this market clearing mechanism, and I didn't, but there's no central planner, right? No, no, no, no. There's no, I mean, you know, that's that's the thing. All those problems, whether you, whether there's a central planner or whether it's a Central planner, or whether it's a decentralized problem, they're equivalent because of the duality, because of the Montpontorbus duality. So you have the two visions. Either there's a central planner who decides for this period and for all the subsequent period what's best for agents to do. So that's going to be central planner's vision. Or basically, you have the decentralized vision where you have wages that are going to induce Egoistic behaviors, self-concerned behaviors, but the two approaches are equivalent, even in that dynamic case. So that's the interesting. That's basically, yeah. You mentioned that you wanted to reconstruct this function with a deterministic function function from observations that you once you have that function, how fundamental is it? How can we apply it to now a Swedish market at later points or American market? What did we learn from yeah? So So, you know, what you can do, very often you can do comparisons across markets. So you can, for instance, understand if people match on a certain characteristic more than another based on different markets. I would not assume that it's a fundamental universal quantity that you can extrapolate to any market, but you can locally extrapolate. But you can locally extrapolate. For instance, you can run some counterfactuals. Say, you know, if you tax, you know, if you increase, you know, if some zones are tax-free, for instance, you can basically predict what's going to happen. So that's a limited type of extrapolation where you could use those models. But I would not say it's a universal constant of the humankind or something like that. I don't really know.