And you should be prepared inside this technology. So, yeah, plan your path, Rick. So, just that. So, yeah, probably a couple of minutes we can talk. So, all right, so then let me introduce the first speaker. And so, he will. And so you will come out at the Plotical. Great. Thanks very much. And thank you to the organizers for inviting me here to give this talk. I'll say a couple of things about just where this talk is going in a second, but I should acknowledge all of my collaborators, some of whom are in the room, Farnik and Bruno, Ravi and Roya, couldn't make it out here. With a special thank you to Farnik, because everything I've learned. Because everything I've learned about optimal transport, I've learned from him, and so everything I get right is because of him, and everything that I got wrong is because I screwed up in my pieces out here. I am probably the person who knows the least about optimal transport in this room. And so when I was preparing this talk, I sort of felt like, let's see, say okay here. I was sort of reminded of this mark. Of this Mark Twain book. The book is a Connecticut Yankee in King Arthur's Court, which is kind of funny because New York is in Connecticut. And so I sort of really do feel like a Connecticut Yankee. He sort of wakes up in the middle of a long sleep and ends up in sort of medieval England out here. And so I feel like a Connecticut Yankee in the optimal transport port, sort of telling you things. It all works out pretty well. Things. It all works out pretty well for him, and hopefully, it'll all work out pretty well for me. I'll try to give you a little bit of sort of the magic of cosmology along the way. So, what I'd like to do is, I've sort of split my talk into two pieces. And you saw that I titled it my initial forays into cosmological reconstruction with optimal transport. The first part of the talk, I'm going to try to talk about just cosmology and reconstruction, set the stage for you, and as well as hopefully set the stage for. Has hopefully set the stage for both Bruno and Farnik so they can dive deep into sort of the technical aspects. And then for the second half of the talk, I'm going to spend a little bit of time talking a little bit about some numerical experiments. I've been playing around with doing very simple simulations with reconstructing cosmological like fields with reconstruction and show you some of the issues that we run into, some of the results that we're finding. Hopefully, that'll just prompt discussion. Discussion, questions, ideas, things where you say, Oh, yes, no, this is absolutely the wrong way to do it. And you know, here are the five better ways to do that. So, that's the sort of place I will sort of run this talk. One last piece, I will try to sort of keep them relatively, I don't have, you know, I'm not pushed to sort of get to 50 minutes, so please feel free to just interrupt me at any point in time with any questions I've got. Any questions I've got. Okay, with that, let me talk a little bit about cosmology. And so we're sort of obligated as cosmologists. Oh, no. Obligated as cosmologists to figure out how to zoom to us. So we're obligated as cosmologists to show this slide, which is the history of the universe in sort of one slide. This is a slide that was put together by the European Space Agency and the Planck collaboration, which Matt. Collaboration, which mapped out the cosmic microwave background, which I'll talk about. So, let me just give you a brief picture of sort of the various stages of where the universe is and how it sort of proceeds. Things start off in a big bang, whatever that big bang might be. We don't fully know. It's not going to be relevant to this talk at all out here. There's a period, the original versions of cosmology talked about a big bang, that's sort of been replaced. Big Bang, that's sort of been replaced by some period of what we call cosmological inflation. And for today, and really for a large portion of our existence as cosmologists, think about cosmological inflation as some physical mechanism that sets the initial conditions that we care about today. So it's the period of time. It wipes out all sort of everything that came out before in time, sort of inflates everything out. The universe becomes incredibly simple. The universe becomes incredibly simple and it sets up what the initial conditions are out here. And so we're going to sort of wonder about cosmological inflation, but we're really never going to go into that period. We're going to start at the end of cosmological inflation once you set up the initial conditions in this problem. Now I'll tell you what those initial conditions look like. So cosmological inflation ends and we end up in a period which is almost sort of like the classical Almost sort of like the classical hot Big Bang. It was sort of, the universe is incredibly hot. It's what we call the radiation-dominated era. This sort of ends, by the way, one of the things I like about this slide is there are units that people are comfortable with. So this is about 10 to the minus 30 seconds when inflation ends and you end up in this period of the hot big, just after the hot big bang. The universe is incredibly hot. There are, in the initial period of time, there are So, in the initial period of time, there are not even molecules and things like that, but you get the first molecules and particles starting to form. Out here, the first sort of nuclei, basically hydrogen, a little bit of helium, is starting to form in the first few seconds after the Big Bang. And then the universe is actually quite simple. It's photons, light particles, and charged particles, basically protons and electrons bouncing off one another. Electrons pouncing off one another. That's basically what's driving 90% of what's going on in this period of time. And so this is just, you know, it's just incredibly hot. And the universe continues to expand in this period. So this was a period of very rapid expansion, and then it slows down into the sort of regular expansion rate that it knows from that period of time. Yeah. Now, Yes, yes. So certain patches do expand. So you're allowed to move things faster than the speed of light as long as no physical information is being propagated through. So the actual inflation, the size of the universe does expand superluminally. And so you basically, that's one way in which you can imagine throwing out. In which you can imagine throwing out all of your sort of previous initial conditions, you just expand very fast. You just wipe out everything, stretch everything out remarkably fast, and you get a very simple universe. So, so yes, that is exactly what is happening here. Other question? Okay, so we go through this period, the universe is expanding, and as it expands, it cools down. So, just the temperatures keeps dropping as you. that just the temperatures keeps dropping as you take a box of heat and just expand the box it'll just slowly start cooling down uh and it cools down till and keeps cooling nothing's nothing nothing particularly interesting is happening things are just bouncing off one another you can think of this people people in cosmology call this period a photon baryon fluid you can really think of it as a fluid turns out there are sound waves in this fluid which will become important to the story in a second it it runs off up to about 380 Runs off until about 380,000 years after the Big Bang. And we don't really need to worry about exactly when the Big Bang was because the difference between this point and this point is 10 to the minus 30 seconds. So 380,000 years, plus or minus 10 to the minus 30 seconds, fine. At that point in time, the universe has gotten cool enough that the photons are not energetic enough to sort of take a hydrogen atom, which is one proton and one electron, and rip the electron off it. And so you form neutral. Yeah, and so you form neutral hydrogen for the first time in the universe, right? And so, all of the up till this point in time, there was nothing, nothing was neutral. There was this sea of electrons and protons all sort of floating around. And suddenly at this point, the universe turns neutral. This turns out to be critical for our observations of the universe, because when the universe turned neutral, the thing that was keeping the photons from sort of streaming all the way out through the universe and sort of bouncing around. Way out through the universe and sort of bouncing around in this fluid were these free electrons that were there. And so you take these electrons, you bind them with a proton to form a hydrogen atom. And now the electron, the proton has nothing to scatter off against. And so the photon just flies basically unperturbed all the way through the universe, and we get to observe it. And this epoch here is the cosmic microwave background. And I'll talk a little bit more about the cosmic microwave background in a second, but this is the Second, this is some people saying, you know, you get a snapshot of the very early universe. This is that first snapshot in time. You really are seeing photons that came, were sort of bouncing around and tell you what was a picture of what was going on at the universe at 380,000. Okay. So at this point, now we've gone into matter. It's just, yes, sorry. Yes. There was expansion. Yeah, absolutely. Yeah, there's expansion throughout all of the story. So again, in general relativity, what is strictly conserved is the energy, the sort of local energies, not the sort of global energy out here. So do you have a question? Yep, sure. Very easy, oh, yeah, now that's an excellent question. So you get you get a sense, it turns out it happens very, very quickly for a bunch of reasons, largely because it doesn't take that there are a huge number of photons. So let me, if I'll digress for 30 seconds out here, the ionization energy of hydrogen is about 13.6. Hydrogen is about 13.6 electron volts. However, if you sort of look at the sort of spectrum of photons out here, most of the photons are much below that point. And there's a very small tail of these photons that is above 13.6 electron volts. There's just enough of them to keep all of the hydrogen ionized. But then it cools down. If you've got a tail, that tail suddenly disappears very quickly. And so you pretty rapidly. So this is over a span. So this is over a span of maybe a few, you know, a thousand, not sure years what it is, but it's incredibly short. A few thousand years. You can think of it as instantaneous. When you do detailed calculations, you take into account the thickness and you can observe that thickness of the slice. But to a first approximation and to a very good approximation, you can think of it as just an instantaneous natural. Natural. Good. Other questions? Okay. So we've gone neutral. The photons are going to come and stream to us. I'll show you the pictures of the photons in a little bit. You've just got the rest of the stuff out here. There's the stuff that you and I are made out of. It'll turn out that that stuff is about 5% of the total matter and energy in the universe. It's about one-sixth of the total matter in the universe. Of the total matter in the universe out here. The universe also has a huge amount of dark matter in it, which is stuff we don't know what it is. And so, in a fit of sort of real creativity, we decided to call it dark matter. And so there's dark matter. And the only piece about dark matter is it just gravitationally, it just interacts gravitationally. We don't see any strong interaction. And so there are these small fluctuations in the universe that exist at that point. Situations in the universe that exist at that point in time, but really, the only thing that's happening out here is the universe is expanding and gravity is working on these pieces, right? So, you've got an expanding universe, you've got gravity that slows things down, it slows down the expansion. And in regions, if you've got a high enough overdensity of matter, if you've got enough matter out here, the gravitational forces will overcome the expansion rate of the universe, and you'll start to collapse and form structures. And I'll show you some pictures of how this structure forms. Pictures of how this structure forms. I think Bruno and Farnik will. And that's in some ways, that's going to be the story of this talk. And then you just form structure, structure forms. The gas in the universe will collapse into these structures. It'll form galaxies, you know, they'll form the first stars. First stars will form new elements. If you've been following the news, you hear about James Webb Space Telescope, which is sort of seeing this epic, which is about. Seeing this epoch, which is about 10 billion years after the Big Bang out here, you form the first stars. You know, those stars, as I said, go supernovae, they'll form new elements, they'll form the next set of stars, all of the remaining stuff in the universe turns into rocks, which turn into planets, which, you know, if you wait long enough, turn into dinosaurs and then turn into people thinking about optimal transport out here. Out here. And so that's basically the history of the universe with one little final caveat, which is as you sort of map this expansion rate in time, what we find is the expansion rate, we were expecting it to be continuing to decelerate with time. It turns out that expansion rate is accelerating. So the measurements of the expansion rate show that the expansion rate is accelerating. And well, we don't know what's driving that acceleration. We've measured that acceleration now a huge number of ways. That acceleration now is a huge number of ways, but we don't know what's driving that acceleration. And so, another fit of great creativity, we call the rest of that stuff dark energy. Okay, and that dark energy is what is driving that accelerated expansion. So, those are, that's a very brief history of the universe. And you end up here today, which is about 13.82 billion years after the Big Bang. And I'm always a little stunned by the fact that we can actually date this as well as. Date this as well as we can. It strikes me, you know, we're talking about something that runs over the entire universe, and we can talk about sort of very precise things like, you know, 13.82 billion years. And the two is actually significant. Yes. Oh, that was, I cut out what was in the box. It was the picture of a galaxy and then, you know, us sitting in. Yeah. Yeah. Don't think there was a picture of us in there, but yeah. Awesome there, but yeah. Okay, any other questions? Okay, good. So there are some paradigms in this standard cosmological model. There's some sort of key pieces that drive this model. And the sort of three pieces, I've sort of already given you hints to all of them. If you sort of look at, we like doing energy budgets in the universe. And so here's a budget of the energy. Energy. Five percent of the matter is the stuff that you and I are made out of. It's stuff that we have theories for, we make in accelerators, we go out and measure and things like that. 26% of it is this dark matter. We know it exists because we can see very clearly gravitational influences of the dark matter. You could ask, could we have gotten our theories of gravity wrong? People have tried to do that, to try to explain. Have tried to do that to try to explain the dark matter, and every time someone tries to do that, that fails. So, as far as we can tell, you know, there is something out there that is behaving like a particle that only interacts gravitationally. And that piece will become important as I tell the rest of the OT story. And then 69% of the universe is dark energy. So, just to sort of give you a little bit of a sense, you can see from here, 5% of the universe. From here, 5% of the universe is stuff we understand. You go into, you take physics classes, we'll teach you all about 5% of the universe. We've got a cosmological model that is basically missing 95% of the universe. It matches a huge number of observations, which is why I'm calling it a cosmological model. But the reason we have jobs in cosmology is we spend all of our time trying to say, can we prove profitable? Can we prove properties of the dark matter? Can we prove properties of the dark energy? Can we sort of map these things out? And so, a huge amount of our effort is driven around these two pieces, or sort of understanding these two pieces. And some of the pieces that I'll talk about in terms of optimal transport and cosmological reconstruction in general is motivated by trying to answer some actual meat on these two pieces. Meat on these two pieces out here. I think I've said mostly the things that I wanted to say about dark matter and dark energy, except I'm really not going to talk a lot about dark energy today, but I will talk a lot about dark matter. And one of the key pieces of dark matter, because it's 26% of the entire universe, you can mostly on large enough scales think of the universe as basically just being dark matter. I can just ignore the rest of our. I can just ignore the rest of us out here. And so, when I run simulations of the universe and say what's the structure of the universe that we have, we can really think about all of this as just being pure dark matter. So it's the scaffolding here. I said the third pillar out here is inflation, and this sets up the initial conditions. And one of the questions, one of the key pieces here is the initial conditions of the universe we think are a totally random realization. Random realization. It's a random field, right? So the exact universe that we live in today was just some random realization. The only thing that we can predict with any confidence are the sort of statistical properties of that. So we get one random realization that we see today. And the simplest models of inflation predict Gaussian random initial conditions. Okay. Yes. It's it's completely it'll it'll be completely mixed. Yeah. Even if you try to measure things in here. Now, there could be things where you know the gas and stuff like that, because gas is of course collisional and has other properties, right? So you could imagine some places where you will get a larger overdensity of gas, right? Because the gas will tend to condense. Because the gas will tend to condense into regions more than you will get the dark matter. But people build experiments to look for this dark matter by basically just sticking things and wait till the dark matter hits some particle and you try to look for it. So it exists in our room right now. Yeah. But in terms of like, you don't need quick layers anymore. No, right. Oh, good. Excellent. Yeah. So the Excellent. Yeah. So the dominant gravitational forces on our, you know, in our local universe here are all sort of regular matter, right? The solar system is driven by the sun and Jupiter, not the dark matter. There's not enough, there's much more sort of concentrated mass in those. And that's really a statement of the fact that it condenses. So you get these condensed bodies of very high density. Yeah. Oh, not very. Well, that's an excellent question. So, not very. Clearly, on scales here, there's a lot more stuff that we see. So, these ratios are sort of imagined that I average over a large enough patch of the universe. So, I sort of average over many galaxies and things like that to get to this mean density. So, yeah. Other questions? Other questions? I do not know. The short answer is: I don't know. Maybe Farnick remembers what the percentage of the hydro. Yeah, I can look that up and give you an answer. Enough, but not enough that it's gravitationally doing anything to our, which is good, probably. Okay, other question. Um, okay, other question. Okay, so uh, you might ask, how do we know all of you know, I've given you this entire story, and you might ask me, how do we actually know any of this? And so, a lot of this comes from measurements of the cosmic microwave background. In fact, there are a whole host of cosmological observations, and we could give multiple talks on that. But if you took the cosmic microwave background away, this is that picture of the Big Bang that I showed you earlier. Picture of the Big Bang that I showed you earlier, we would, we would, our aerobs would just all blow up. We would not really know a whole lot. So, this snapshot of the early universe, and this is an actual map of the cosmic microwave background with a little bit of artistic license in it, but very little. These spots are hot and cold spots on the sky. So basically, the Planck satellite went out and mapped in microwave bands. Micron in microwave bands, what the temperature was at different places in the sky. These fluctuations, by the way, you're seeing are one part in about 10 to the pi. So they're very, very small fluctuations. And the first measurements of the cosmic microwave background showed a very uniform distribution of temperatures out here. And so keep that in mind. The initial conditions of the universe are through very high approximation, totally uniform. It will become important as we go along. become important as we go along but you get the structure the structure there you'll notice there are there are scales out here those scales are real they're not instrumental artifacts uh out here they're set by sound waves in that early plasma sort of bouncing around and you're seeing the imprint of those sound waves and you can measure these incredibly precisely now this is a random field this is just noise right it is cosmological noise it has information in it but it is it is It but it is just one random realization, and so as cosmologists, will be since we want to sorry, uh, they're all around 2.7 Kelvin, plus and minus a part and 10 to the minus 5. So 2.732 or 23 Kelvin. But yeah, so this is it's an it this is the best known black body spectrum in the universe. It is a black body. It is a blackbody to incredible accuracy. If I had the part of the blackbody spectrum, you would see points on it. The arrow bars on those points have been blown up by about a factor of 100, just to make them visible on that figure itself. So it's incredibly well known and it's an incredibly precisely characterized spectrum. The other piece to say about this is the physics that's going on here. And the physics that's going on here is very simple physics. It's atomic physics that we understand, we've measured rates, interaction cross-sections in the lab incredibly well. So there's very little unknown physics that's driving most of this. This is just photons and electrons bouncing off one another. And so when we say we understand the physics out here, we really do understand the physics incredibly precisely. So this is a random field. And so given that this is Field and so, given that this is a random field, we need to make I wanted to show this here because we'll look at similar statistics. We it's a Gaussian random field, and so what we tend to do is we look at this in Fourier space and plot its power spectrum. Since it's on the sphere, we expand its spherical harmonics and plot the power spectrum of the spherical harmonics, but conceptually the same idea. And here's a plot of what that power spectrum is. You'll see points and error bars out here. Points and error bars out here. And the model that fits this is a six-parameter model. So there are six parameters that can fully describe all of these bumps and wiggles down to incredible accuracy. So six, when we say we really understand the cosmology and why we have such faith in the numbers that I was giving you until now, it's from things like this, where a simple model really does capture incredible variation. Incredible variation across all of this. I've already said this is a Gaussian random field. So we looked at this power spectrum. This is linear physics. The fluctuations are one part in 10 to the pi. And so I can linearize my equations incredibly well. And it works remarkably well. The second corrections are very small. What will become important, though, is this is one two-dimensional surface. I'm just seeing, you know, a map. Just seeing a map of the sky. If I've got a random field and I've got a two-dimensional surface, I only have so many measurements I can make on any particular scale. And so I'm going to be always limited by the amount of information. There's a huge amount of information in this, and I know, understand it really well, but it's limited information. And so there's an that we would like in cosmology to find other sources of more information out here. Okay, so if I need to go to more. So, if I need to go to more information, I've got to look at the rest of the universe. I can't just look at this simple piece out here. And so, the thing that we go to looking at are galaxy surveys, going working our way towards reconstruction. Here's a map of the galaxy survey. This is a survey that I'm particularly fond of because I've spent the last five, 10 years of my life working on various aspects of this. This is the dark energy spectroscopic instrument. I'll show you pictures of it in a second. Each one of these is a point. This is just a One of these is a point. This is just a small subsection of this. Each one of these is a galaxy. And this is just mapping three-dimensional in a slice on the sort of cone on the sky. It tells you the distance from the observer, which is sitting out here, where each one of these galaxies are. And you can see an incredible amount of structure out there. And the structure is really a structure that gravitationally grew out of those little fluctuations that you saw in the cosmic microwave background. You saw a snapshot of them. You saw a snapshot of them. Now you're seeing a different set of these structures gravitationally growing into these little blobs. You see it, and so there's a huge amount of information now. So this is, again, not the random field, but now this is a three-dimensional random field. And so I can try to map out as much information as I can. Now, one of the things that has really driven cosmology and galaxy surveys, and in fact, reconstruction in a large way has been the fact that we've Large way has been the fact that we've been in an age of sort of larger and larger surveys. And one of my colleagues calls it the Moore's Law of Galaxy Surveys. And so this is the number of galaxies we have measured in these surveys as a function of time. That was year 2000, which is sort of when I started thinking about these problems. You know, we had about 1,000, 10,000 objects in those days. And now we're sort of working up to millions to sort of tens of millions. To sort of tens of millions of objects out here. And you can draw a power law line out here and keep extrapolating this out forward, and we'll keep serving larger and larger volume. For the purposes of this talk, the key pieces here are the larger volumes. Let me probe larger scales, and they give me more and more information. Because random fields, again, I get more and more independent copies of the universe that I can then say, this was a random variable, a new random variable that I cut. Okay, I should show you a couple of pictures of what how we both get these things. This is the DESI telescope. This is a telescope in Arizona at Hippie. This is the Mayall telescope. It's an old telescope. It's not a particularly big one. It's a four-meter telescope. For a moment, I forgot. That's a picture of the telescope. The thing is built like a battle tank. Thing is built like a battle tank, uh, and so it's great. You could do whatever you wanted to this telescope. It was built in the 60s. I think you probably guessed from the size of this building and things like that. Uh, and so the DESI runs with a spectrograph. The spectrograph turns out to be mounted at the top of there, sitting up there out here. And I'll show you pictures of the spectrograph. We take sort of spectra of individual sets of objects, and those give us the positions of the galaxy that we see. Use the positions of the galaxies that we see. So here's a picture of the focal plane and the spectrograph out here. Each one of these little things out here is a little robot that has a fiber optic cable on it. And so we decide where we want to put the fiber optic cables. We have a map, we have an image of the sky. So we know which galaxy we want to get a spectrum off and go point to this thing. It sort of rotates out there. There are 5,000 of these little robots that all Little robots that orient themselves in a few seconds. So you can sort of tell it where it's going. Each of them all sort of has a little motor that sort of runs out to the right place. We can look at where each one of these up. So we can look down into the camera and we sort of illuminate them and we can sort of look at each one of these. And so we get these 5,000 at a time. This was a huge, this is the sort of thing that allows you to get these very large numbers of objects. The last survey that I worked on did something very similar. Worked on did something very similar, except it didn't do it with robots. It did it with people, a bunch of 5,000 people sitting up in the focal plane. But there was a plate which someone had to plug a thousand fibers in every day before, and then you went to observe those. You took another plate, you plugged another thousand fibers in, went and observed that. We had about eight plates we could do a day. So, you know, you someone in the day did a thousand fibers, eight thousand fibers, and then went with the so that's how we. With the uh, so that's how we get these uh observations. I could talk a lot more about DESI, but let me let me in uh interest of time sort of focusing on reconstruction. Okay, so that's those are the gaps, those are galaxy surveys. And so what we measured today, this is a simulation, but we'll pretend that this is an actual galaxy survey out here. We've measured this map of the universe. And we can try to do cosmology with this map of the universe. Do cosmology with this map of the universe. There are things that make this a little challenging for us. These are collaborative, you can see out here, there's a lot of structure here. The structure here does not look sort of as uniform as the cosmic microwave background. These are not parts in 10 to the 5. These are one part, you know, these are densities that are a few thousand over the mean density on average. And so none of this is linear. So what we would like to be able to say is, can we go back in time? Can we go back in time? We get to observe this snapshot of the universe. Can we run this universe back in time to get something that looks a lot like the CMB, but in three dimensions? And if I can do that, then the physics out here is much simpler. It hasn't been contaminated by all of the sort of gravitational nonlinearity. We understand it, but it's still non-linear, so it's complicated and it becomes harder and harder, and you become more and more reliant on simulations. And so you, you know, if you. And so, you know, if you could run back in time, you could hope to get much more information, much more robust information out of this field. And so that's the motivation for reconstruction. Like we would like to take the complicated universe that we see and run it back to a much simpler universe. So what I'd like to do before we launch into sort of my numerical games with optimal transport and how all of this connects up is spend a few minutes showing you. Spend a few minutes showing you reconstruction is an idea that has floated around in cosmology for many, many years. And I'd like to show you some of the non-optimal transport ways people are thinking about reconstruction. And then we'll swing over to the optimal transport version. So the conceptually, the simplest thing you could imagine doing is say, I have observed this, right? Let me randomly sample, I know it's a Gaussian random field, so let me randomly sample some initial condition. Randomly sample some initial condition. I know how it's going to evolve in time, I think. So I run it forward in time. I see what I get. I compare it to the universe that I see. If it doesn't match, I go back, I change this around, and I repeat, right? This sounds like a crazy idea. And for many, many years, it was a crazy idea. But today, thanks to sort of people's work in machine learning and things like that, people can actually do this. Still, it's pretty hard. Do this. Still, it's pretty hard to do on sort of the scales that we want for surveys, but it is getting to be possible to start doing this forward modeling. You might say, if this is the way to do this, why would we ever do anything else? You can clearly put everything into this piece and observe the universe that you see. The challenge, of course, with this is it's incredibly model-dependent. You need to know what this model is. And if you've got this model wrong, and this model is complicated, right? Because if you want to. Complicated, right? Because if you want to do this, you want to come to sort of a clear, you know, an image of the universe today. Any error in this model is going to affect what you get out here. And decoupling those is always a complicated piece and question to ask, right? And so then you're always reliant on, do you understand your simulations well enough? Are your simulations a reasonable representation of the true universe? So you can check it. Because of course, you get only one universe to do these sorts of tests. Of tests. Now, I don't want to sort of leave you with the idea that this is not possible. It's just incredibly hard, even with solving the computational problem of running huge numbers of simulations, differentiating them backwards, and repeating that. Okay, so let's try to do things a little simpler. And so, here's the first version that we came up with for reconstruction. And this comes back to this idea of the universe starts off. The universe starts off mostly homogeneous, mostly a uniform. Yeah, yeah. These are all just cold dark matter. They're just, I'll give you the explicit model that we're solving out here, but this is just gravity. Okay, in this particular case, it's just gravity. When people do this, they have to try to figure out how do I put galaxies into this and things like that. So they have to have more complicated models, which are effective models. Which are effective models, they're never, you know, no one ever knows how to form an actual galaxy in detail on a computer at the scales of these simulations. Does that answer your question? So it's just gravity in an expanding universe. Yeah, just plain gravity in an expanding. Okay, so remember, uniform, non-uniform. Uniform, non-uniform out here. There's mass conservation, we all love in this room. And so one can try to say, let's just do the continuity equation and try to go ahead and solve that. Now, if you're me 10 years ago, you've not heard about optimal transport, you've not heard about the Mohammed equation, and so you do the next best thing that you know how to do, which is you linearize and you solve the simpler version of the problem that you know how to solve. Problem that you know how to solve. The simpler version of this problem, of this version, is you say continuity, the linear version of the continuity equation is you've got some displacement field that arose, you observe some densities today from some uniform density. This is just the linearized version of that problem that we're all trying to solve in different ways. And so people have tried to do this. This has been incredibly successful. I could basically trying to recreate what these maps are. Recreate what these maps of the universe are. Now, in order to use this linearized form, you have to work on very large scales. And so, what people do is we smooth the density field. We take our galaxy survey, we basically smooth it on very large scales, and then we use that as our density field and move things back. That works pretty well, but you know, one could hope we could do better. And so, there are things that people are trying beyond that. So, this is what now. Work that a now recently graduated student of mine worked on as part of my thesis project, which, as you said, you know, you can do this on large scales. Well, since machine learning is here to save us all, let's build a machine that then could take what we do on these large scales and then try to fix up things on small scales out. And so, let me just show you some pictures of what this might look like. So, here's an n-body simulation, just a gravitational simulation. Here's Gravitational simulation. Here's the initial condition. This is the late time universe out here. A megaparsec is 3.26 million light years. You want to sort of do this inversion in your head out here. So this is the late time universe that came out of this piece. If I just do this large-scale flow with linear theory, you get something that looks like this. And you can see immediately from this, it's not reconstructing the initial field clearly. Reconstructing the initial field, clearly, this does not look like this. What it's done is it's taken large blobs and just moved them around. It turns out that for a large amount of the physics that we care about, that is a lot of what's happening out here. So if you don't care about things on small scales, this reshuffling is really what is the right thing. But you could then say, let me take this and can I train this with some neural network model appropriately. Model appropriately designed and things like that, then you can do a little bit better out here by saying I've moved the large-scale bits, now I'll get the small scale bits in here. And so where I'm, as we sort of move into my discussions of OT, is optimal transport gives us a way of not necessarily making that first approximation and of saying I need to smooth things on large scales. How well can I reconstruct things by just saying it was mass conservation started? It was mass conservation starting from my initial density field. Okay. Right. So let me now talk a little bit about optimal transport. So let me give you a couple of pieces out here. So I'm going to show you a toy model of the universe. And this may also re-answoring the question that you asked about what the exact evolution is. We're going to think about structure form. Think about structure formation in the universe as being separable into two pieces. There's going to be the expansion history of the universe, and we're going to imagine that is smooth. So there's some background expansion, and there are going to be small perturbations on that background expansion. And the perturbations never get large enough such that they back react on you. So that the sort of collapse structures sort of change the expansion rate of the universe. So I can always split this into smooth background expansion and then something. Background expansion and then something else. Okay. And so the smooth background expansion does depend on stuff in the universe. And so we parametrize that background expansion rate by a scale factor, which is the scale of the universe relative to its size today out here. And so we measure this A of t. And you can take its time derivative. That tells you the rate at which this is moving. If you've heard of Hubble's law, this is the Hubble parameter that tells you the rate at which galaxies are receding away from you. Are receding away from you is the scale factor, the time derivative of the scale factor divided by the scale factor at that particular time. So it's a relative piece there. And so you can, you know, mapping out this expansion rate is the way, for instance, we learn about dark energy. So let me say that pieces. Let me now just focus in on how these structures form. I can do this in a number of different ways. I like mechanics. I like mechanical models when I think about things. So, let me not think I could give you a fluid version of this. Let me think about this as particles. I just have a bunch of particles and I want them to gravitationally evolve. I'm going to watch how they evolve in time. And so I'm going to work in coordinates, which are sort of we take out the expansion. Remember that expansion is just a background. So I'll take that expansion out. Cosmologists call that those removing coordinates here. And so I can write down. Yeah, and so I can write down the standard sort of Newton's law-like pieces here. This is just, you know, how does the position change with scale factors? I can run this with time, treat my scale factors, my variable. How does the velocity change with time? And of course, the velocity is given by some force. The force is given by the stuff in the universe, which is giving a gravitational. And so I have a set of particles. I just calculate the gravitational force on them at every time step, and I just evolve them forward in time. That's the model that I'd like. Type that's the model that I'd like to think about. Very simple model, easy to write down a simple code, hard to write down an efficient code, but very easy to write down a very simple code that evolves. And anyway, this model will work for any initial condition. So now I have to tell you a little bit about the initial conditions. So remember, the universe was incredibly uniform. So I'm going to start the particles off uniformly. Uniformly, in this case, means I'm going to start them off all on a grid. In this case, means I'm going to start them all on a grid. I'm going to start off with some Gaussian random field. That's my initial conditions. Remember, I said some small fluctuations. I'm going to say that's the density field. I'm going to calculate the corresponding potential. And then I'm just going to displace the particles. We'll give them a little bit of a velocity based on this. I'll just move them in a straight line, just a little bit off. And then I just run these equations over and over again. The key piece to know. The key piece to point out here is you're completely parametrized by telling you what the initial potential is or the initial density, right? That's the only piece that you want to know. Yeah. Rho is the density or the mass density in the universe. Rho bar is the mean. Yeah, yeah. So it's just mean the density. Okay. Good. Other questions? Robar. Robot changes with time because the universe is expanding. Fat. Everything depends on time. Okay. Well, I really wanted to do full n-body demonstrations out here, but I couldn't quite get those to finish up in time. So I'm going to do a simpler problem. I can do one level simpler, which is take the same pieces, let me compute those that potential, right? And let me move. Right, and let me move the particles, give them their initial velocity. Let me do one thing even simpler than sort of then evolving it with this. Let me just have them continue to move with that constant velocity to their present position. That's a famous approximation known as the Zeldovich approximation. So this initial potential, we will call the Zeldovich potential. And this idea that we just move particles on a straight line with some initial velocity, we're going to call that the Zeldovich approximation. And it'll turn out, I'll show you pictures. And it'll turn out, I'll show you pictures, that it actually does a remarkably good job of capturing the structure of the universe on larger scales. And so the model now for the rest of this talk is this toy model. I have some initial position. This is starting to look very OK-ish or familiar to all of you. I have some displacement field, and that displacement field is potential flow, because it's really just coming from the Poisson equation, right? Completely derived, defined by. Derived defined by the gradient of the time defense is just a multiplication, right? So it just scales things. You can move it to any point. The reason this works remarkably well and is not a completely crazy model to look at, even as a toy model, is that for most of the universe, the particles have just moved in straight line. They do interesting orbits and stuff like that at the very end. But if you ask what's their largest displacement? Ask what's their largest displacement, it's mostly a straight line. And that's basically why we can play games with OT as well. Okay, so let me show you some pictures. So these are simulations. I'm going to do 2D simulations so I don't have to worry about showing you boxes of things and movies. I'm going to start off with this initial overdensity field. It started off completely. Exactly what I said. Start off the particles perfectly uniform on a grid. This initial overdensity field, I give it a potential. Density field, I give it a potential, they all start to move. This is the Zeldovich approximation. I just moved them forward, but I moved it only to the point where the universe, my universe or universe on my laptop, was a tenth of the size that it is today. And you can see the same, if we can come up and take a look at this, the same kinds of structures. There's a little bit of an overdensity here, same overdensities out here. No, the structure is there. So, and this is an early time, so these are all still small structures. Small structures. What's being plotted out here is just the number of particles binned onto a grid. So this is just the total number of objects. So you'll notice most of the objects are sitting around one, very uniform, and there's some small fluctuation. Yeah. I just, yeah, exactly. I just generated a random field, generated one, produced two. Okay, let me just run. This is a point one. So let me just keep running time forward. Just keep running time forward, just move forward in time out here. That was point one. This is what it is, looks like today. I could do a movie of this, but you get the basic idea. You start to form these structures. You start to see the same kind of cosmic web that I showed you in those pictures out there. And lots of on the scales, on the larger scales out here, you can see a lot of them. So, this is the toy model that we'd like to do out here. A is the time. You can think of it as time. Think of it as time. A equals one is today. A equals 0.1 is when the universe was the 10th size. That's my time variable today. Okay. So here's optimal transport now, finally, on this with my toy problem. I've got some initial field. This is totally uniform. Notice everything is at one. And I just want to know where do the particles map up to each other? Where does the density move out? Where does the density move out? And this is really optimal transport in the version that I've been getting comfortable thinking about this, which is way less sophisticated than my two collaborators who come on afterwards. This is purely think of a histogram mapping to another histogram and just asking what is the motion that gets you that, those things moving from one point to another. Okay. I don't expect to recover the true displacements. Now, you'd say this is gradient flow. Now, you'd say this is gradient flow. Optimal transport should work things out. But of course, there are things like orbit crossings and stuff like that here, which will confuse the issue. And so I don't expect to perfectly reconstruct things, but let's see what happens. If you're me, you go to the simplest possible thing. So this is from a slide by Charlotte Boon and Marco Puturi from their tutorial about a year ago. And I go and code up the Synchron algorithm. And I go and code up the synchron algorithm out here. I've just got two density, I've just got two histograms. Now I'm just solving mapping of two histograms. And as I said, I can code the synchron algorithm. It's easy for me to do. So I did that out here. There is an important point to make out here, which is particles move very locally. If I look at the amount particles moved in these simulations from their original positions, it's about a tenth of the box. Sorry, it's about 100. Bonds. Sorry, it's about a hundredth of the bonds size out here. So they really are moving in sort of a small local neighborhood out here. And so this cost matrix out here, this coupling matrix here, is incredibly sparse because I don't really need to say the particle ran over to the other side of the universe. It didn't. And so it's incredibly sparse. And on a grid, if I'm working on a grid, which I'm working on a histogram here, it's highly structured. And I can make use of that to get the algorithm to run. To get the algorithm to run well. And that's something we've been playing around. So let me, I showed you the simulation. Let me show you some of the things that come out. So I do the usual optimal transport. I calculate u and v, and I just generate those u's and v's, and that tells me what the transport plan is. And the question that I, the reason I was doing this is I was trying to understand what do I learn from these u's and v's? What do these things look like? And so let me show you some plots of u and v. This is log u. Gamma is the. Gamma is the usual Synchorn sort of entropic regularization parameter. I'm working in sort of standard Euclidean cost functions here. We're using the grid as my cost scale. And so the sort of grid spacing here is one out there. So gamma is relative to that spacing of one there. And so here was the true Zeldovich potential. This is the initial conditions, but the potential that gives rise to this motion. This is log. Motion. This is log U out here. You'll notice that log U just visually looks very much like the Zoldovich potential with sort of a sign here. Here's log V, which also in the Zeldovich case here looks quite similar to these pieces. So visually, when I first made these plots, there's clearly interesting cosmological information that I can start teasing out of these algorithms and the potentials that come out. These algorithms and the potentials that come out of these optimal transport pieces up there. And I would love to have long discussions, long, short discussions about sort of understanding whether we can clearly map within even this toy model what this potential is to what this potential. Yeah. Yep. That's right. Exactly. That's all I did. Yeah. Any other? Okay. We can look at maths like this. I like plotting. I want to sort of look at the statistics of these maps. And so I'd like plotting. These are just random fields again. So what I want to do is plot the power spectrum of these things from the cosmologist. And so here's the power spectrum of these pieces. Here's the power spectrum of these pieces. So, this is the log U field. This is the log V field. This is the Zeldovich field. This is for gamma of 10 out here. You can see they match in large scale. This is, I should say, this is in Fourier space. So, these are large scales. These are small scales out here. So, on large scales, it matches really well. Small scales, it's not the follow-up. We often take these and plot not just the These and plot not just the power spectrum, but we can also plot the cross-correlations between the two different fields. Again, in Fourier space, so we do this scale by scale. And so blue here is minus of log U crossed with the Zeldovich potential. And you can see it matches, it's incredibly well correlated out to some scale and then starts to fall off very rapidly. The V, again, V is less correlated. It turns out if I Less correlated. It turns out, if I correlate V with the final density field, it's actually much more correlated with the final density field. And that's not surprising. V is sitting, V is handling the marginal for the final density field, whereas U is handling the marginal for the initial density. So no surprises here, although it's nice to see how it works. Here's the same thing for gamma of one. So let me now just dial down on the regularization. You'll notice. The regular resolution, you'll notice these lines start to converge a lot more. And you can repeat the same process and plot these things. And now you can see you're actually mapping the initial density field and the initial potential out on the larger and larger scale. Okay, this was all done within the context of Zeldovich. I'll have just one more slide and I'll be done. This is all in the context of Zeldovich. Of course, Zeldovich is Brady in flow. And so you could say you've really made your, you've chosen the toy problem. Yours, you've chosen a toy problem, right? You've chosen this toy problem, it's fun to understand, but you've chosen a very simple toy problem. So let's make it a little bit more complicated. I said, I didn't have time to run a full n-body simulation. I might before we leave, but don't, I didn't before this talk. And so I did the next best thing. I did Zildovich to a point. And then I said, let me randomly move the particle around. And that's not a crazy idea because what's happening, I have my regular gravitational flow on large scales, and then there's just sort of gravitational. And then there's just sort of gravitational random motion from you know things close by, sort of moving things around. And so I just fuzz things out. Okay. And so let me show you the same plot. I'm not going to show you the parts of the potential. I'm just going to show you the, I didn't fuzz it out by so much that you can't see. If I part of the map, it'll look exactly the same map. It's just a little bit more noise. Here's the potentials. This confused me this morning, and I'll leave it open. Yeah. Here's the log U potential. Here's the Zoldovich potential. Potential. Here's the Zoldovic potential. This is gamma of one, and they basically lie right on top of one another. You'll notice compared to this previous one where I did gamma of one, the log B, because it's smooth, does not actually match perfectly. And I think this is the fact that the displacement is no longer just a simple gradient flow out here. But it seems to be matching onto the U potential pretty well. This made me very happy. This made me less happy. Maybe less happen. Here's the blue line, and you'll notice the blue line is actually less correlated with this. And so I think there's open questions that we'd like to understand. And, you know, this is another choice. I'd be happy. We'd be love to sort of chat whether, you know, one could actually write down something which says in the simple model of gradient flow plus noise, what does the optimal transport math look like? And how is that related to that original gradient flow questionnaire? Okay. Okay, let me end on open questions. This is really to set things up for both Bruno and Fornek. I've, up till now, I've just been pretending we've mapped all the matter in the universe. Galaxies are not all of matter in the universe. Remember, I said there's all of this dark matter. The reason it's dark is we don't see it. And so how do we sort of relate those to? How do we talk about missing mass? Parnacles talk a bunch about this. The cost function for a rail survey. Or a real survey involves sort of anisotropies that you have to worry about. And so that's something we'll talk a little bit about. And you have to worry about sort of real surveys. We don't measure the entire universe. We don't measure things perfectly uniformly. And so you're going to worry about all of these questions. I should say most of these problems are not unique to OK. They're the problems we've been dealing with a whole bunch. And so we're sort of looking at ways in which we can support those. But hopefully that gets you a little bit of a flavor of optimal. Flavor of optimal transport in the cosmological context with some toy problems and some questions that I would love to know answers. So, all of this is funded by large numbers of people and lots of things. Mostly a lot of my funding comes from the Department of Energy and lots of collaborators and things like that. So, I'll stop here and thank you and take questions. So basis is related to your so on our one yeah, so the missing sorry the open question missing mass question is there any sort Is there any sort of thing to suggest that the dark matter states dark that the regular matter states regular, or is there some possible mean or something? You're all set to become a theoretical physicist. So in the standard pictures, the dark matter stays dark and the regular matter stays regular. They're two separate sectors. You don't have them mixed. Terrors are incredibly Terrorists are incredibly creative and they come up with ways in which you can build in these things. Ideally, to say, can we put constraints on that? So, can we constrain how much dark matter could interact with regular matter, how much of it could possibly annihilate into regular matter? To a very good approximation, all of the dark matter stays dark. Otherwise, we would have seen effects. And all of the regular matter stays regular. And so they largely interact purely in gravity. And so when we run these simulations, because it's only five percent. Because it's only five percent. On the scales that we're talking about, I can just basically treat the dark the regular matter as dark matter and just move it along. So, in the how do you make it oh, that's an entire uh talk in the in and of itself. But uh the the short answer is uh The short answer is we do, it's simple geometry. So we take, it turns out the universe has been very nice to us. It gives us certain things that are basically like standard light bulbs. So there are supernovae whose brightness can be very well calibrated. And so you just look at the apparent brightness of these supernovae further and further away, how bright they look. You just got, you know, a hundred-watt light bulb and you just put it at further and further distances. And that tells you. Distances. And that tells you the distance to one of those supernovae. And then you can also measure the rate at which that supernova is moving away from us. That tells you the expansion rate. And so that basically gives you. So the universe, it would have been really nice. It's really nice if the universe gave us one of those. It turns out it gives us at least two of them. So it gives us a standard ruler as well. So there's a scale in the clustering of these galaxies, which is fixed by the physics of the cosmic microwave. By the physics of the cosmic microwave background, and so now I've got a ruler also that I can measure that's apparent size in the same kind of idea there as a function of time, and so that gives us expected by the low potentials of that most of the particles that we have. So I'm wondering, so is there any like So is there any like continuum version of the like oh sure you could I could I could go I you know I could take this into a continuum limit so it's like okay I just want to like yeah it's like you're you think of the universe move as the radial flow of the Zudovish potential right and then you construct it by using the Right. And so I didn't. So let me try. I think maybe let me try to answer what I think you're asking, which is where is that mismatch coming from? So what I didn't do is I didn't run a case where I did the universe where it was relatively young and it was, you know, the gradient flow, but I. And it was, you know, gradient flow, but I don't have sort of orbit crossing in my trajectories. I think the moment you have orbit crossing in your trajectories, you no longer will reconstruct exactly the same orbits that you would have gotten. You will reconstruct some new slightly effective version of this. And I think, so at least in the Zeldovich case, I think that's what's happened. Now, in the full n-body case, of course, it's not just straight lines. It's straight lines plus all of the other motion of that. That's just a toy model, right, right. That's just a toy model, right? Right. But yeah, it's a very easy toy model to run. Look at it.