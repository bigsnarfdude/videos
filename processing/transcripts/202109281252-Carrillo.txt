Non-local aggregation diffusion equations, entropies, gradient flows, phase transition applications. Yeah, please host. Yeah, thank you, Yun Chen. So thank you very much for the invitation in this workshop. But it's the beginning of the term here, so this week is a bit crazy, so I haven't been able to participate that much, and I'm sorry, I apologize for that. For that. So today, in fact, I want to talk about phase transitions, which is not directly related totally with the main theme of the workshop on singularities, but somehow you will, I mean, what I find very interesting about phase transitions anyhow is the different behavior that you get in terms of one parameter of some of. Of one parameter of some of these basic non-local aggregation diffusion equations. So, let me summarize a little bit quickly some of the basic things, of the basic equations that I am going to discuss later, and then I will concentrate in two particular cases. So, just quickly, the basic aggregation equation. The basic aggregation equation or non-local interaction equation comes from a continuum description of interacting particle systems. So quickly you have like m particles that are interacting through a potential that I'm defining here, I'm denoting here as W. I'm assuming W typically is going to be a radial potential, and the only possible singularity you want at the origin on the potential. You want at the origin on the potential W, and typically it will be a singular potential in many of the applications. In some of them, it will be regular. So, we will be discussing this later on. But nevertheless, here what you have is the over-damped dynamics, meaning that you consider second-order Newton equations with some of the forces that are generated by the interactions between the potentials through the pairwise, sorry, between the particles through the pairwise. Sorry, between the particles through the pairwise potential W. And I'm neglecting the inertia term. That's why I get first-order dynamics for the particles. Okay, so the typical behavior of these equations, even the dynamical system can be very complicated. And the form of the steady states of this equation depends a lot on the shape of the potential W. And you can get complicated solutions like this kind of stationary solutions. Like these kind of stationary solutions that you get by just evolving 200 particles randomly distributed on a square. So just to give you an idea of the difficulties you may encounter. So for instance, you see that this minimizer is not radially symmetric, even if your potential is radially symmetric here. The continuum version of this equation, we can think about this as a kind of We can think about this as a kind of mean field limit to derive this equation over here that I'm cycling with the mouse. But you can think also about this as in the backwards direction. So you look at this equation, which is a continued equation where the velocity field is obtained non-locally from the density rho. If you just impose that rho is a sum of diracs at certain locations, you emit At certain locations, you immediately see that the locations should follow this first-order system of ODs. Okay, so this is how the non-linear version of this first-order dynamics, I mean continuum version of first-order dynamics, where rho now represents the probability density of finding particles at certain position x, and the velocity field is obtained through that formula. Okay, so many times in Many times in these models, you extract in this potential, you have both repulsive and attractive effects. And what you usually do is you extract the repulsive effect and you localize it, while the attractive effect, you leave it non-local. So this normally leads to what is called the aggregation diffusion equation, in which this part models the attractive part only while this one is modeling the repulsive part. Is modeling the repulsive part. Think about the simplest case which corresponds to p of rho equals rho. Then what you will have here from this term is rho gradient rho, which you can write a modulo constant as gradient rho square. So you get a Laplacian rho square coming from that term, which is like a Porus-median equation with spawning two. So and that is a way, I mean, you can use this as a model for the repulsive platform. For the repulsive plant. So, an interesting question here would be: when do you have a balance between the repulsion and the attraction? And what are the conditions such that this happens? We will come back to this question a bit later on. But let me just introduce one of the basic quantities that is really important for understanding or treating this kind of this family of equations. In this family of equations, there is a particular Lyapunov function that is really important and it's crucial to understand the dynamics. In fact, you can consider that equation as a gradient flow in some sense, but I don't want to discuss today what it means exactly this sense of being a gradient flow with respect to probability measures. But the interaction, the Lebanon functional is composed of the interaction. Is composed of the interaction energy part, which you can think about theta as the potential energy part, plus the entropy part. So for instance, in the case of linear diffusion, that would be roll of rho, like in linear Fokker-Planck equations. In the Polaris median equation, this is just the integral of rho square. Okay, if you choose this function phi here conveniently, then you can recover the equation I had in the previous slide. covered the equation I had in the previous slide. So you just define capital P in terms of phi by this relation, or vice versa, you define capital Phi in terms of P by this relation here. Then you can see that the velocity field in your, I mean that you can write the equation as a continuity equation where the velocity field is minus the gradient of the formal variation of f with respect to rho when you take here variations that preserve the mass of rho. So in that So, in that sense, you can think about this equation as a gradient flow. In that way, you recover this equation in the sense that it's a continued equation and the velocity field is minus the gradient of the variation of the energy. Okay, this has a lot of implications in the theory, but I don't want to discuss that much on this, but I will make use of this free energy a lot later on. So, let me just remark that you formally at least You formally, at least, the evolution of the free energy along a solution of the PDE will give you the right. I mean, what you expect if it's a gradient flow that it decays. And you can see that this is zero if and only if the gradient of the variation is zero on the support of rho, which characterizes and how the stationary states. Okay, so if we want to find anyhow the stable, locally stable steady. Stable, steady states of this evolution, of course, you expect them to be among local minimums of the energy. Okay, so then we could define that as the balance between attraction and repulsion when we have non-trivial local means or global means, you are able to find them of the free energy. Of course, this question has been studied in many, many different applications, and here I'm just listing some of the And here I'm just listing some of the applications that already people look at this particular question for many, many years now. But let me show you that even if people have been looking at that for a long time, still there are interesting questions. Okay, one particular specific case that has been studied a lot is the case of the Keller-Siever model or Parliament. Model or pan-la-Ker-Receield model in chemotaxis, where we want to model the movement of cells that are going up the gradient of certain chemical substance, the chemoattractant. And here is just an experiment that I found over internet doing exactly that, that somebody with apipette is playing with the cells by putting that chemo tractor. So essentially, you want to model this kind of behavior, but not for six cells, but for 10 to the six. 10 to the 6, and that your density in this case, in the notation I have here, density is rho, instead of rho, is n. So the basic model of Keller and Siegel was linear diffusion instead of non-linear. So here I'm writing already with a non-linear term. And here you have the term of going up the gradient in the direction of the chemical substance. And typically, the substance was following some kind of reaction diffusion equation. Equation, where here we take into account in the models that they were introduced by Keller and Siegel, they were taking into account that the cells are producing the chemical system themselves. So that's why you have this growth term on the right-hand side in terms of directly proportional to the density of particles. Okay, so anyhow, if you neglect the blue terms, that typically you can assume that you are in quasi-stationary situation for the chemical. Situation for the chemical substance, then you can invert here the Laplacian, substitute it there, and then you get a particular case in which the interaction potential of attraction is given by the Newtonian in any dimension. Here I'm writing two dimensions because that's the classical model of Kerr and Siegel, okay, in which you have all these interesting questions about eclipicality. But let's see that this kind of problems, I mean, leads to Leads to complicated set of stationary states, even in the simplest cases. So let's look at the simplest case of the Keller sigil with nonlinear diffusion in one dimension on an interval. I'm taking power two here. So as I said, it's like a localization of the repulsion. And attraction solves the full parabolic. Solves the full parabolic equation for the chemical substance. Now I'm changing slightly the notation again. Sorry for that. Okay, the boundary conditions are no flux, which of course you can write as Neumann for both quantities, but I wrote it in that way that you see that you have conservation of the total mass for U. So let's assume it's a kind of probability density. And let me show you first two simulations for these systems. Simulations for this system depending on this parameter chi here. Chi is just a strength, I mean, it's just a parameter to measure the strength of attraction versus repulsion. So if chi is small, repulsion is stronger, chi is larger, the attraction is stronger. So that's why I put the parameter there. And here I have for a very particular value of chi, it's a 3, 4 between two certain values I will show you in the next slide. Let me show you. Slide. Let me show you here. I have an initial data which is very close to a constant, but is slightly asymmetric perturbation of the constant. Okay? So let me comment that a constant is constant equals whatever it has to be is obviously a stationary state of this equation in that in with those boundary conditions. So what this numerical simulation shows. So, what this numerical simulation shows you, that I'm not going to discuss about the numerical method I'm using, but believe me, it's a good numerical method, then tells you that the constant steady state is unstable for asymmetric perturbations. And in fact, it does converge to another steady state, which is concentrated on the boundary. It gives you that shape on the boundary for the density, that shape for the chemoater actor. Here, I do the same, but I take an I do the same, but I take an initial data which is very far away from being constant, but is symmetric. And that converges to the constant state state. So it has certain, so the constant state state is unstable, but it has certain manifold of stability, some stable manifold. In fact, you see that it's not super constant, but it's just a stop at a certain time. You can continue, believe me. Time you can continue, believe me, it goes to the constant. Okay, so how many stationary states do we have here? So, this is an interesting thing that you can compute. I mean, you can compute even all the stationary states you have. And interestingly enough, well, I mean, what you expect for chi is small when chi is very close to zero. I mean, you can. Close to zero, I mean, as you can compute in this particular case, how small chi should be, then you had that the constant is the only steady state of the problem. While when you increase chi at certain values of chi, you start to have other stationary states. In fact, the interesting thing is that at chi equals to in this particular, with this particular chess of the integrals, you get infinitely many stationary states that you get. Infinitely many stationary states that you can compute by hand. And at the end of this one parameter family solution, what you get, and this happens for several other values that you can compute. And at that value of, I mean, you have a parameter, the one parameter family here. You compute the limit of those in this parameter family. What you get finally is a solution that touches. Get finally a solution that touches down, and when it touches down, then that's the end point, and that produces a branch of stationary solutions for chi larger than chi2 that has that shape, either to the right or to the left. You can find these stationary states. And the same happens in each of the branches. Just somehow, when you are between two and five, you are not allowed, you only are allowed to concentrate on one side. That's why in my sympathy. One side, that's why my simulation was for chi equals four, which lies subtly in between the first two. And when you get to five, then you allow for a full bump solution, meaning that the bump could be inside or divided asymmetrically in both sides of the interval. And of course, if you increase chi, what you only do in this case, since we are normalizing, is that it gets closer and closer to something. Closer and closer to something very concentrated, like a Dirac delta, at a certain point. And the same happens in each of the branches. So you go to the next branch, you will have, let's say, one and a half bumps. You go to the next branch, then you allow for two bumps, two full bumps, and so on and so forth. And believe me, you can compute that explicitly. This is just combinations of cosines and sines if you do the right computation, finally. So the interesting So, the interesting thing of this particular sample is that you get, you see, you get neatly, that you have infinitely many bifurcation branches. And these bifurcation branches, in this particular case, are always of that shape that you have a jump towards a point that becomes the minimum of the free energy at that point, in fact, and then you have a branch emanating from that. So, how genetic is this? So, that's a question that we started to look at years ago for some particular cases, and we were building on the theory on this in the last years. Okay, so let me give you first a particular example with linear diffusion. And if I have time, I will come back to, I mean, I will generalize this in the case of linear diffusion. I will generalize this in the case of linear diffusion, and then I will come back to non-linear. So, this in fact, I'm going to go directly here. This is a particular model that, again, it changed the notation because it's a model for alignment in some models of collective behavior. It doesn't really matter. B here is the variable because it's a kinetic equation, and I'm looking at a specially homogeneous kinetic equation. Homogeneous kinetic equation where V is the variable velocity and F is a distribution of velocity. That's why I'm writing it with that notation. Here, the unknown is what is the probability density F that depends only on the velocity variable. And let me explain each of the three terms here. Well, this is just a given drift. In fact, the interesting thing about this is that this is the gradient of a potential, which is a double well potential, with the minimums at With the minimums at modus of p equals one. So, in one dimension, if you just think about it in one dimension, it's a total well potential with two minimums at minus one and one. Then you have noise, and then you have this term, what it means is v minus the average of the velocity. So, this uf just means the integral of v f dv. So, it's the mean of the distribution f. So, I have here just a relaxation. Have here just a relaxation towards the mean of f. So, in fact, this equation is a particular case of the equations I wrote at the beginning with an additional ingredient, this external potential over here. So, in fact, you can write it as an equation of the form I discussed at the beginning, just by identifying the different terms. You can write it as a continuity equation where the velocity field is minus the gradient of somebody, and the somebody is. Body and the sum body is given by this formula if you choose well what is phi and what is w here. So the potential is a double well potential in 1D. In more dimensions, it's just this double well thing done in the radial direction. And the interaction potential is very simple, it's just quadratic. That's why when you take the gradient of this, you get a linear term. And if you put in the convolution here, you get this term that is V minus the mean. This term that is V minus the V. So again, you have a natural entropy for this equation, a free energy, which is this quantity over here. So you can ask yourself how many steady states you have here. So do you have more than one steady state? Let's look just at the number of steady states at this point. So to compute a steady state, To compute the steady states, you can just use the fact that this has a great inflow structure, and then you just look at ψ. And then you look at assume that the solution is positive because I mean, you have the Laplacian in B, a linear term, you will expect anyhow, stationary solutions to be positive everywhere. So, and then you can compute the steady state by just saying that psi is equals to constant and you set up. And if you set up that, then you can solve for f in terms of its mean, and then you get that f has to be of that form, so it has to be exponential of something normalized. This z is the normalization of this distribution function, and this is the mean of f itself. So, this is still a non-linear integral equation now. So, you can ask yourself how many solutions this non-linear integral equation has. And here, the trick. And here, the trick that we took advantage to discuss how many solutions we have is the fact that the right-hand side depends only on the mean. So, what we do is to compute the mean of f and then write a steady state, having a closed equation for the mean. So, you can compute here the integral bf, then you get uf, and then you get a non-linear relation between uf and itself. Uf and itself. So in fact, you can look for somehow the zero, the zeros for every u and d of this equation. So the statement is if I have a zero of this function of, let's say, I mean, in any dimensions, we will have a vector here. So it's d dimension plus one. So if I have a zero of this function in the d plus one dimensions, then f defined by Then f defined by the u and the noise d is a stationary solution. So then, counting here how many stationary states you have is simplified to counting how many zeros this function has. That's the simplification that happens in this particular problem. So then you can apply a kind of implicit function theorem and kind of bifurcation Kanda-Ravinovic theorem, but in fact. Kandel-Rabinovic theorem, but in finite dimension to check that, in fact, this has bifurcation from constant value. The root that is simple is just u equals zero, because you just put u equals zero here. Obviously, this is radially symmetric, and then its mean is also zero. So u equals zero is a solution always. And then you have another branch of parameters that Another branch of parameters that appears a certain value, that it was clarified in two dimensions by a former student of Jen Dubo, that should be probably in the audience here. And in one dimension, it was also studied by Julian Toul. Anyhow, so the question is that you have a bifurcation diagram like that. If you look at it as a bifurcation of U versus the diffusion coefficient, remember U is the mean of the solution. mean of the solution. So as you see, this is coherent in the sense that if the noise is large, the constant steady state is the only steady state when the diffusion coefficient, the noise, is small, then you have another branch of solution. So here you have the constant solution, but it's unstable. And here this is for some numerics that we need to check. For some numerics that we need to check the stability, and then you see that the other branch that branches out at that point, particular point, depending on the parameters that you have in the equation, is the stable one. So just to give you an example that you can do even in one dimension that it has more than one solutions, more than one solution, and you have these bifurcation branches. I mean, this is just, you want an illustration. You want an illustration about how you get those branches depending on the value of the noise. Either, and it works the same for non-linear diffusion if you want. If you do the same with non-linear diffusion exponent two, you get the same kind of result. Okay, so in the say 10 minutes left that I have, I'm going to try to give you ideas on how to get this result. How to get this result in much more general settings. So, let me concentrate on a particular case in which we can have almost a full answer to the equation of bifurcation points. So, we put ourselves in the simplest situation, which is to consider the non-linear aggregation diffusion equation on the torus in the variable, say, space. So here I will be discussing mainly now the linear case, so m equals one, but then later if I have time, I will make some comments when m is different from one. And again, I put the strength parameter on the aggregation. So think about kappa as inverse of the noise with respect to what I was discussing in the previous slides. Okay, so what you expect is that for a small kappa, so it's large noise, you have the constant steady state. Have the constant steady state should be stable, right? For kappa large, then you will expect in certain cases to have the instability of the constant steady state. And in fact, you can check exactly what is the condition on W in this case. So let's do it with periodic boundary condition in the torus. Here I am assuming that W is coordinate-wise even in such a way that this makes sense to be considered on the torus. And here I don't want to have any problem with regularity. Have any problem with regularity, although some of the results work also with some singular potentials. Let's assume for the time being C2, because it's not a matter of the singularity of W as you will see. Okay, in this particular setting, there is a very classical model that is a particular case. It's called the noisy Kuramoto model for synchronization of oscillators that corresponds to this particular case with linear diffusion. Particular case with linear diffusion and W equals minus cosine of certain mode. In that case, it's known to produce a bifurcation at a point, and at the bifurcation point is known exactly and explicitly. Before when kappa is small, what you have is a uniform distribution on the sphere. On the sphere. This is in one dimension, if you want. If the kappa is large, what you get is a concentration or a kind of bump solution around certain location. So to understand what are the conditions on the potential, and to just that I can give you at least the theorem for bifurcation, I need some notation about Fourier modes in this setting. So don't get lost on the Get lost on the notation here. WK are just Fourier, the Fourier, I mean, I'm expanding in Fourier modes. So WK is the notation for Fourier modes. This theta of K is just the normalization of the Fourier modes that depends on in which dimension if we use cosines, one or sines. So then this theta of k has that formula, but it doesn't really matter. These are Fourier modes. So, and I'm denoting by W hat of K the Fourier coefficients of the interaction potential. Okay, so the first thing I'm gonna define is when the Fourier modes of the interaction potential are all non-negative, this is what I will call H-stable, the potential, because it coincides with certain notions in statistical mechanics. Okay, so the first thing that we can one can thing that one can check is the following result that is valid both for linear and non-linear diffusion. You use the free energy for each of them, which are again the Lyapunov functionals. And for each of them you can show that if the potential is H-stable, so if the Fourier modes of W are non-negative, or the kappa is small, I mean you can Small, I mean, you can allow for some negative, some negative Fourier modes, but the kappa is small, then the unique minimizer of the free energy is the constant steady state. This is, I mean, that I'm calling here rho infinity. Rho infinity is the constant steady state. Okay? So it does, in principle, this is coherent with what you expect. Now, the question is, what happens when I increase kappa? To understand that, To understand that, what we use is the self-consistency equation for being a steady state. This is what generalizes somehow this condition I had before on the case of the alignment equation with the mean. So now you can show that rho is a steady state if. Is a steady state if and only if is a zero of this functional. And now it's a functional, this is a functional on rho globally. It's not like before that we could reduce to the mean of rho. So it's a functional on rho. So if this is zero for the function rho, which gives you a non-linear integral equation for rho, because here you have the convolution of W rho, and this is the normalization of that thing. So if this is zero, you have a steady state. Have a steady state, and something similar you can do with a non-linear diffusion. Okay, so the question is that you can characterize for the case of linear diffusion, I'm just writing this pretty clearly here, you can characterize the stationary states of the problem by zeros of that self-consistency equation or by being critical points of the free energy. Okay, this in some sense can be done also for the non-dignit diffusion that I'm skipping, and you have a similar. Skipping, and you have a similar characterization. So, just coming back to the Kuramoto model, not to lose what happens in a particular case. So, as I told you in the Kuramoto model, you can check that you have only one Fourier mode, it's negative, and precisely the negative Fourier mode gives you the first bifurcation branch, and this is the bifurcation branch for the Kuramoto model that is known for many, many years now. So, from that point, you get this kind of a From that point, you get this kind of solution, BAMP solution, cluster solution that is in fact stable for the dynamics. Okay, so the general result that we give about bifurcation branches is analyzing or applying the Kandel-Ravinovic theorem to bifurcation in the suitable space, L2 symmetric functions in the torus, to these These relation area. So, what we show in short is that any negative Fourier mode that is non-degenerate or non-resonant in this sense, that there is only one Fourier mode such that this quotient gives you the same value. This means that there are non-resonant modes when you do the expansion in Fourier of the things there. So then every negative Fourier mode gives you. Every negative Fourier mode gives you a kappa, which you can compute in terms of the negative Fourier mode times the normalization that you use, for which you have a bifurcation point for that quantity. Okay, and you can say a little bit more about the bifurcation branch locally. It's a local result of bifurcation from the constant steady state. And the thing is, and with this, I will finish my talk. With this, I will finish my talk: is that what you want is to give more information about what happens with these branches. Can you give more information? And in fact, and that's the last slide essentially I will show if I get the right slide. Sorry about this because I need to pass it like that. Yes. So let me show you two scenarios for which we are able to give more information about the bifurcation branch. About the bifurcation branch. What kind of information do I want to give? Remember the Kuramoto model. The Kuramoto model gives you just a bifurcation from one point and is continuous in the sense that you have this bifurcation curve that goes from that point. So of course, each of the bifurcation I'm describing, they will give you locally that kind of continuous bifurcation. But this doesn't mean that this is the first value of the bifurcation parameter, kappa. Bifurcation parameter kappa for which you have another steady state. Because it could happen that this branch, instead of branching in the right direction, branches in the opposite direction. Okay? And it could happen that it goes backwards. So then before the first life location point, you could have already some value with a different steady state and even with a steady state with lower energy. So we tried to clarify if this was possible and then we talked about this continuous or We talk about this continuous or continuous phase transition depending if this happens or not. So, meaning if the first bifurcation point that you get is the first point in which you have another steady state with lower energy. So, we gave somehow two scenarios in terms of the Fourier modes of the potential in which you have either one or the other. So, you have this scenario in which the first negative Fourier mode is Negative Fourier mode is much larger in absolute value than the rests of the Fourier modes, the rest of the Fourier modes, then in that case, it's always continuous phase transition, the first one that you get. While you have some sort of resonant mode scenario, in the sense that there are some modes that verify certain conditions and they are close to each other in value, then that case leads immediately to this situation in which you. Immediately to this situation in which you have the first bifurcation branch is farther to the right, say kappa is farther to the right from the first point in which you have another steady state with lower energy. So, and this we give a quantitative version of what I'm just saying, that I'm not showing you the theorem, but we give cases in which this happens. In which this happens, both for linear and non-linear diffusion. And let me just finish by saying that the interesting thing about these bifurcation branches is to see that these models can lead to complicated phase transitions and understanding this in detail for some particular cases which are used in different. Cases which are used in different applications, like in mathematical biology, is quite interesting and it leads to many complicated phenomena that, in terms of dynamics, we are just starting to understand in particular values. Okay, so I think that's all what I wanted to say today, and thank you very much for your attention. Thank you, Corido, for the nice and interesting. A nice and interesting talk. Maybe we can accommodate for one question. Are there any questions in the audience? Please unmute yourself. Yeah, I have one question. So, for this statistic, do you have a PD? Do you have a PD equation? Do you have a this isn't the algebraic equations? Yes. So let me share again the screen. Sorry, I clicked on the wrong button. Yeah, so for the state state, of course, we have, yes. I think I wrote it in the, let me see, it should be. Just here, okay. So, uh, the steady state satisfies this equation, okay. Okay, so what I'm telling you is that this is characterized by the fact that it's a zero of that. So, and the Grand-Ravinowitz theorem, I applied at this level to the divocation branches. And this comes from essentially writing this as a divergence. This is a divergence of rho times the gradient of a velocity field. And then because rho is going to be positive, in this case with linear diffusion, from the fact that the velocity field is gradient of something has to be zero, then you solve that equation and you obtain this relation. But the steady state should satisfy that this is zero. Okay. Yeah, thank you. No problem. Are there any more questions? Are there any more questions? Okay, let's thank Karino for the nice talk again. And so let's